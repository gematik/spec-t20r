<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="773px" preserveAspectRatio="none" style="width:1023px;height:773px;background:#FFFFFF;" version="1.1" viewBox="0 0 1023 773" width="1023px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="761.1875" style="stroke:#181818;stroke-width:0.5;" width="405.7173" x="126.5586" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="320.9553" y="15.2822">LEI</text><rect fill="#E6E6FA" height="744.5469" style="stroke:#181818;stroke-width:0.5;" width="242.6343" x="126.5586" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="208.7791" y="31.9229">Prim&#228;rsystem</text><rect fill="#F4A460" height="727.9063" style="stroke:#181818;stroke-width:0.5;" width="89" x="126.5586" y="39.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="138.5586" y="48.5635">ZETA Client</text><rect fill="#C9FFC9" height="761.1875" style="stroke:#181818;stroke-width:0.5;" width="442.0239" x="544.2759" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="740.9275" y="15.2822">Anbieter</text><rect fill="#F4A460" height="744.5469" style="stroke:#181818;stroke-width:0.5;" width="330.9604" x="544.2759" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="676.6116" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="744.5469" style="stroke:#181818;stroke-width:0.5;" width="99.0635" x="887.2363" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="899.2363" y="31.9229">TI 2.0 Dienst</text><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="562.9844" width="8" x="15.8965" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="19.3965" x2="19.3965" y1="126.5625" y2="689.5469"/></g><g><title>ZETA</title><rect fill="#000000" fill-opacity="0.00000" height="562.9844" width="8" x="167.5586" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="171.0586" x2="171.0586" y1="126.5625" y2="689.5469"/></g><g><title/><rect fill="#FFFFFF" height="496.0625" style="stroke:#181818;stroke-width:1;" width="10" x="166.0586" y="175.4844"/></g><g><title>TPM</title><rect fill="#000000" fill-opacity="0.00000" height="562.9844" width="8" x="336.0713" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="339.5713" x2="339.5713" y1="126.5625" y2="689.5469"/></g><g><title>Konnektor or</title><rect fill="#000000" fill-opacity="0.00000" height="562.9844" width="8" x="421.1196" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="424.6196" x2="424.6196" y1="126.5625" y2="689.5469"/></g><g><title>SM(C)-B</title><rect fill="#000000" fill-opacity="0.00000" height="562.9844" width="8" x="497.6611" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="501.1611" x2="501.1611" y1="126.5625" y2="689.5469"/></g><g><title>PEP</title><rect fill="#000000" fill-opacity="0.00000" height="562.9844" width="8" x="577.6768" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="581.1768" x2="581.1768" y1="126.5625" y2="689.5469"/></g><g><title/><rect fill="#FFFFFF" height="212.4063" style="stroke:#181818;stroke-width:1;" width="10" x="576.1768" y="433.5"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="562.9844" width="8" x="718.6895" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="722.1895" x2="722.1895" y1="126.5625" y2="689.5469"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="562.9844" width="8" x="827.4502" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="830.9502" x2="830.9502" y1="126.5625" y2="689.5469"/></g><g><title>Resource</title><rect fill="#000000" fill-opacity="0.00000" height="562.9844" width="8" x="933.2681" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="936.7681" x2="936.7681" y1="126.5625" y2="689.5469"/></g><g><title/><rect fill="#FFFFFF" height="87.5625" style="stroke:#181818;stroke-width:1;" width="10" x="931.7681" y="532.7031"/></g><text fill="#000000" font-family="Helvetica" font-size="10" x="5" y="124.2041">User</text><ellipse cx="19.3965" cy="63.4219" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M19.3965,71.4219 L19.3965,98.4219 M6.3965,79.4219 L32.3965,79.4219 M19.3965,98.4219 L6.3965,113.4219 M19.3965,98.4219 L32.3965,113.4219" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="149.5835" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="157.9995" y="104.5635">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="156.5835" y="116.2041">Client</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="322.188" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="329.188" y="116.2041">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="385.1929" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="392.1929" y="104.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="396.1992" y="116.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="474.0464" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="481.0464" y="116.2041">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="548.2759" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="571.9873" y="104.5635">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="555.2759" y="116.2041">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="663.7148" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="712.3091" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="670.7148" y="116.2041">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="790.6641" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="821.0698" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="797.6641" y="116.2041">Policy Engine</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60.5283" x="906.5039" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="913.5039" y="104.5635">Resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="920.3716" y="116.2041">Server</text><text fill="#000000" font-family="Helvetica" font-size="10" x="5" y="758.8291">User</text><ellipse cx="19.3965" cy="698.0469" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M19.3965,706.0469 L19.3965,733.0469 M6.3965,714.0469 L32.3965,714.0469 M19.3965,733.0469 L6.3965,748.0469 M19.3965,733.0469 L32.3965,748.0469" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="149.5835" y="689.5469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="157.9995" y="705.8291">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="156.5835" y="717.4697">Client</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="322.188" y="689.5469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="329.188" y="705.8291">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="385.1929" y="689.5469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="392.1929" y="705.8291">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="396.1992" y="717.4697">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="474.0464" y="689.5469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="481.0464" y="705.8291">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="548.2759" y="689.5469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="571.9873" y="705.8291">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="555.2759" y="717.4697">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="663.7148" y="689.5469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="712.3091" y="705.8291">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="670.7148" y="717.4697">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="790.6641" y="689.5469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="821.0698" y="705.8291">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="797.6641" y="717.4697">Policy Engine</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60.5283" x="906.5039" y="689.5469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="913.5039" y="705.8291">Resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="920.3716" y="717.4697">Server</text><polygon fill="#181818" points="154.0586,171.4844,164.0586,175.4844,154.0586,179.4844,158.0586,175.4844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="19.3965" x2="160.0586" y1="175.4844" y2="175.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="26.3965" y="159.4854">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="50.9238" y="147.8447">User wants to</text><text fill="#000000" font-family="Helvetica" font-size="10" x="50.9238" y="159.4854">access resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="50.9238" y="171.126">on Resource Server</text><rect fill="#FFFFFF" height="37.9375" style="stroke:#000000;stroke-width:1.5;" width="627.0806" x="151.5835" y="183.4844"/><path d="M151.5835,183.4844 L215.5835,183.4844 L215.5835,188.4844 L205.5835,198.4844 L151.5835,198.4844 L151.5835,183.4844" fill="#EEEEEE" style="stroke:#000000;stroke-width:2;"/><text fill="#000000" font-family="Helvetica" font-size="12" font-weight="bold" x="164.5835" y="196.623">ref</text><text fill="#000000" font-family="Helvetica" font-size="12" font-weight="bold" x="368.8367" y="213.623">Discovery and Configuration</text><path d="M133.5835,230.4219 L193.5396,230.4219 L193.5396,234.0625 L183.5396,244.0625 L133.5835,244.0625 L133.5835,230.4219" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="66.5781" style="stroke:#000000;stroke-width:1.5;" width="663.0806" x="133.5835" y="230.4219"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="148.5835" y="240.7041">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="208.5396" y="241.7041">[Client has no client_id]</text><rect fill="#FFFFFF" height="37.9375" style="stroke:#000000;stroke-width:1.5;" width="627.0806" x="151.5835" y="254.0625"/><path d="M151.5835,254.0625 L215.5835,254.0625 L215.5835,259.0625 L205.5835,269.0625 L151.5835,269.0625 L151.5835,254.0625" fill="#EEEEEE" style="stroke:#000000;stroke-width:2;"/><text fill="#000000" font-family="Helvetica" font-size="12" font-weight="bold" x="164.5835" y="267.2012">ref</text><text fill="#000000" font-family="Helvetica" font-size="12" font-weight="bold" x="296.614" y="284.2012">Dynamic Client Registration with TPM Attestation</text><rect fill="#FFFFFF" height="37.9375" style="stroke:#000000;stroke-width:1.5;" width="717.6528" x="151.5835" y="311"/><path d="M151.5835,311 L215.5835,311 L215.5835,316 L205.5835,326 L151.5835,326 L151.5835,311" fill="#EEEEEE" style="stroke:#000000;stroke-width:2;"/><text fill="#000000" font-family="Helvetica" font-size="12" font-weight="bold" x="164.5835" y="324.1387">ref</text><text fill="#000000" font-family="Helvetica" font-size="12" font-weight="bold" x="349.2537" y="341.1387">Token Exchange with Client Assertion JWT Auth</text><line style="stroke:#181818;stroke-width:1;" x1="176.0586" x2="218.0586" y1="371.5781" y2="371.5781"/><line style="stroke:#181818;stroke-width:1;" x1="218.0586" x2="218.0586" y1="371.5781" y2="384.5781"/><line style="stroke:#181818;stroke-width:1;" x1="177.0586" x2="218.0586" y1="384.5781" y2="384.5781"/><polygon fill="#181818" points="187.0586,380.5781,177.0586,384.5781,187.0586,388.5781,183.0586,384.5781" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="183.0586" y="367.2197">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.5859" y="367.2197">Create DPoP Proof for RS</text><polygon fill="#181818" points="564.1768,429.5,574.1768,433.5,564.1768,437.5,568.1768,433.5" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="176.0586" x2="570.1768" y1="433.5" y2="433.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="183.0586" y="417.501">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.5859" y="405.8604">GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="213.9434" y="417.501">Authorization: DPoP ... (Accesss token)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="213.9434" y="429.1416">DPoP: ... (DPoP token)</text><line style="stroke:#181818;stroke-width:1;" x1="586.1768" x2="628.1768" y1="470.7813" y2="470.7813"/><line style="stroke:#181818;stroke-width:1;" x1="628.1768" x2="628.1768" y1="470.7813" y2="483.7813"/><line style="stroke:#181818;stroke-width:1;" x1="587.1768" x2="628.1768" y1="483.7813" y2="483.7813"/><polygon fill="#181818" points="597.1768,479.7813,587.1768,483.7813,597.1768,487.7813,593.1768,483.7813" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="593.1768" y="460.6025">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="617.7041" y="454.7822">verify Access token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="617.7041" y="466.4229">and DPoP Proof</text><polygon fill="#181818" points="919.7681,528.7031,929.7681,532.7031,919.7681,536.7031,923.7681,532.7031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="586.1768" x2="925.7681" y1="532.7031" y2="532.7031"/><text fill="#000000" font-family="Helvetica" font-size="10" x="593.1768" y="516.7041">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="617.7041" y="505.0635">forward GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="617.7041" y="516.7041">with header and</text><text fill="#000000" font-family="Helvetica" font-size="10" x="617.7041" y="528.3447">PEP header as json</text><line style="stroke:#181818;stroke-width:1;" x1="941.7681" x2="983.7681" y1="581.625" y2="581.625"/><line style="stroke:#181818;stroke-width:1;" x1="983.7681" x2="983.7681" y1="581.625" y2="594.625"/><line style="stroke:#181818;stroke-width:1;" x1="942.7681" x2="983.7681" y1="594.625" y2="594.625"/><polygon fill="#181818" points="952.7681,590.625,942.7681,594.625,952.7681,598.625,948.7681,594.625" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="948.7681" y="565.626">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="973.2954" y="553.9854">provide</text><text fill="#000000" font-family="Helvetica" font-size="10" x="973.2954" y="565.626">resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="973.2954" y="577.2666">access</text><polygon fill="#181818" points="597.1768,616.2656,587.1768,620.2656,597.1768,624.2656,593.1768,620.2656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="591.1768" x2="930.7681" y1="620.2656" y2="620.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="603.1768" y="615.9072">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="627.7041" y="615.9072">200 OK, Resource</text><polygon fill="#181818" points="187.0586,641.9063,177.0586,645.9063,187.0586,649.9063,183.0586,645.9063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="181.0586" x2="575.1768" y1="645.9063" y2="645.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="193.0586" y="641.5479">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="217.5859" y="641.5479">200 OK, Resource</text><polygon fill="#181818" points="30.3965,667.5469,20.3965,671.5469,30.3965,675.5469,26.3965,671.5469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="24.3965" x2="165.0586" y1="671.5469" y2="671.5469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="36.3965" y="667.1885">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="60.9238" y="667.1885">Resource</text><!--SRC=[XLJRSjem47ttLsp9Gn82XEQHXynmSKdQa7Y0JgOTPZh2Nh22aQWaGvplwP_qnxgMZ4qWCtt2OiyUdJrxR9OQATBr71NKBjhjovgdLrnic69hY731qiHyaS9C-1l2v_R7nKUsHhZ3P8k6X-m0Ct2OaHHIRrY8KOdkorHnL0VO1CNInDte9TK6X1HuKDFuEqKHuXWNgFA77WjNIoLJ4VLb8XKynzmSDaoE6wePRhphy_y1JPOWp6KIUUVNdlTfezXopS2WV0EZKlIyRcZerk-Q9fZBLwWz-FSrE1l6KXid1S3-7oY-_lj7wKmRN1FYWMrHHDG5K21- -jCkz1EEmb1zmaIKzPJS2Oi089NaATymOGeKCEswPg9eir2YpGczuwPfCB8Tz9i3AzWXw9iK0bVvI3cqEaar4zFxvf0PtB6iTjGr6VKiVZAww5ysUpLlJ-uywOevHuEAnfhw_Rl7fuUduG_lSEnXobHqElNX7NU1lIBmWvc8ZTb0eEHhLZl1TLCJJnnqGD3yA1L_OuPBGKjMsrp7ILVWLos1J7YOWI-MNE1xgvpcwJtSjDem8CyfeMS3fbOJP4E5-D6onaxD63KbFSIPA4IyMrPfM9uaQDxkLtnr1HsRBjWHbmOZPuA58MeDgYIamVRinOIUft01afuAeWRvrt3UTA1U7t0TvjKCo71w1SM2BrDbFQhNFPQK4Oj9kf0GsjCl7bdH9zmLRoROceVxxZ4kkJQE5tRSn3Q4NMDGc_rbDFa7QYrZWzQIiqxb2WNuhs7Cn18TKN53LvCtblxhyzHs4QLN54iREz1NID65GI23F3Xo0GjAzNXo0AM0MRU7_XIkAtC1taMeupXQhHPSTEqYygMGliiScjSwhcXXhk8HjRsW0pGZNsJWEbsP5aexg9GLQ8gDbKCwT_Ho7Cko9iJ8w1EIxv1IwmVbMSEBbi8Z2alKWOsIMnvHMqNWKcGnRlXcaswxQRVXwLkZp9CLKyNnOqnPl7LHjQYo-Wy0]--></g></svg>