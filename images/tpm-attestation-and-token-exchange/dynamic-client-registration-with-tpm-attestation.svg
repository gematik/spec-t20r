<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1209px" preserveAspectRatio="none" style="width:1436px;height:1209px;background:#FFFFFF;" version="1.1" viewBox="0 0 1436 1209" width="1436px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="1197.2344" style="stroke:#181818;stroke-width:0.5;" width="667.3726" x="140.29" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="465.5144" y="15.2822">LEI</text><rect fill="#E6E6FA" height="1180.5938" style="stroke:#181818;stroke-width:0.5;" width="504.2896" x="140.29" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="353.3381" y="31.9229">Prim&#228;rsystem</text><rect fill="#F4A460" height="1163.9531" style="stroke:#181818;stroke-width:0.5;" width="89" x="140.29" y="39.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="152.29" y="48.5635">ZETA Client</text><rect fill="#C9FFC9" height="1197.2344" style="stroke:#181818;stroke-width:0.5;" width="572.6709" x="819.6626" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1081.6377" y="15.2822">Anbieter</text><rect fill="#F4A460" height="1180.5938" style="stroke:#181818;stroke-width:0.5;" width="461.6074" x="819.6626" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1017.3218" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="1180.5938" style="stroke:#181818;stroke-width:0.5;" width="99.0635" x="1293.27" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1305.27" y="31.9229">TI 2.0 Dienst</text><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="999.0313" width="8" x="34.8965" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="38.3965" x2="38.3965" y1="126.5625" y2="1125.5938"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="33.3965" y="234.7656"/></g><g><title>ZETA</title><rect fill="#000000" fill-opacity="0.00000" height="999.0313" width="8" x="181.29" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="184.79" x2="184.79" y1="126.5625" y2="1125.5938"/></g><g><title/><rect fill="#FFFFFF" height="944.3906" style="stroke:#181818;stroke-width:1;" width="10" x="179.79" y="162.2031"/></g><g><title>TPM</title><rect fill="#000000" fill-opacity="0.00000" height="999.0313" width="8" x="611.458" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="614.958" x2="614.958" y1="126.5625" y2="1125.5938"/></g><g><title/><rect fill="#FFFFFF" height="43.2813" style="stroke:#181818;stroke-width:1;" width="10" x="609.958" y="286.0469"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="609.958" y="394.6094"/></g><g><title>Konnektor or</title><rect fill="#000000" fill-opacity="0.00000" height="999.0313" width="8" x="696.5063" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="700.0063" x2="700.0063" y1="126.5625" y2="1125.5938"/></g><g><title>SM(C)-B</title><rect fill="#000000" fill-opacity="0.00000" height="999.0313" width="8" x="773.0479" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="776.5479" x2="776.5479" y1="126.5625" y2="1125.5938"/></g><g><title>PEP</title><rect fill="#000000" fill-opacity="0.00000" height="999.0313" width="8" x="853.0635" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="856.5635" x2="856.5635" y1="126.5625" y2="1125.5938"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="999.0313" width="8" x="954.439" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="957.939" x2="957.939" y1="126.5625" y2="1125.5938"/></g><g><title/><rect fill="#FFFFFF" height="407.0938" style="stroke:#181818;stroke-width:1;" width="10" x="952.939" y="445.8906"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="999.0313" width="8" x="1233.4839" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1236.9839" x2="1236.9839" y1="126.5625" y2="1125.5938"/></g><g><title>Resource</title><rect fill="#000000" fill-opacity="0.00000" height="999.0313" width="8" x="1339.3018" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1342.8018" x2="1342.8018" y1="126.5625" y2="1125.5938"/></g><text fill="#000000" font-family="Helvetica" font-size="10" x="24" y="124.2041">User</text><ellipse cx="38.3965" cy="63.4219" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38.3965,71.4219 L38.3965,98.4219 M25.3965,79.4219 L51.3965,79.4219 M38.3965,98.4219 L25.3965,113.4219 M38.3965,98.4219 L51.3965,113.4219" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="163.3149" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="171.731" y="104.5635">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="170.3149" y="116.2041">Client</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="597.5747" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="604.5747" y="116.2041">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="660.5796" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="667.5796" y="104.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="671.5859" y="116.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="749.4331" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="756.4331" y="116.2041">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="823.6626" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="847.374" y="104.5635">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="830.6626" y="116.2041">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="899.4644" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="948.0586" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="906.4644" y="116.2041">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1196.6978" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1227.1035" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1203.6978" y="116.2041">Policy Engine</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60.5283" x="1312.5376" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1319.5376" y="104.5635">Resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1326.4053" y="116.2041">Server</text><text fill="#000000" font-family="Helvetica" font-size="10" x="24" y="1194.876">User</text><ellipse cx="38.3965" cy="1134.0938" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38.3965,1142.0938 L38.3965,1169.0938 M25.3965,1150.0938 L51.3965,1150.0938 M38.3965,1169.0938 L25.3965,1184.0938 M38.3965,1169.0938 L51.3965,1184.0938" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="163.3149" y="1125.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="171.731" y="1141.876">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="170.3149" y="1153.5166">Client</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="597.5747" y="1125.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="604.5747" y="1141.876">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="660.5796" y="1125.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="667.5796" y="1141.876">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="671.5859" y="1153.5166">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="749.4331" y="1125.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="756.4331" y="1141.876">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="823.6626" y="1125.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="847.374" y="1141.876">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="830.6626" y="1153.5166">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="899.4644" y="1125.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="948.0586" y="1141.876">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="906.4644" y="1153.5166">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1196.6978" y="1125.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1227.1035" y="1141.876">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1203.6978" y="1153.5166">Policy Engine</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60.5283" x="1312.5376" y="1125.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1319.5376" y="1141.876">Resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1326.4053" y="1153.5166">Server</text><path d="M8,138.5625 L67.9561,138.5625 L67.9561,142.2031 L57.9561,152.2031 L8,152.2031 L8,138.5625" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="963.0313" style="stroke:#000000;stroke-width:1.5;" width="1412.0239" x="8" y="138.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="23" y="148.8447">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="82.9561" y="149.8447">[Client has no client_id]</text><line style="stroke:#181818;stroke-width:1;" x1="189.79" x2="231.79" y1="179.8438" y2="179.8438"/><line style="stroke:#181818;stroke-width:1;" x1="231.79" x2="231.79" y1="179.8438" y2="192.8438"/><line style="stroke:#181818;stroke-width:1;" x1="190.79" x2="231.79" y1="192.8438" y2="192.8438"/><polygon fill="#181818" points="200.79,188.8438,190.79,192.8438,200.79,196.8438,196.79,192.8438" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="196.79" y="175.4854">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="221.3174" y="175.4854">Generate Client Instance Key Pair (for Client Auth)</text><path d="M485.373,167.2031 L485.373,200.2031 L846.373,200.2031 L846.373,177.2031 L836.373,167.2031 L485.373,167.2031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M836.373,167.2031 L836.373,177.2031 L846.373,177.2031 L836.373,167.2031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="491.373" y="181.4854">Key Pair for private_key_jwt</text><text fill="#000000" font-family="Helvetica" font-size="10" x="491.373" y="193.126">(could potentially be TPM-backed, but distinct from Attestation Key)</text><polygon fill="#181818" points="54.3965,230.7656,44.3965,234.7656,54.3965,238.7656,50.3965,234.7656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="48.3965" x2="178.79" y1="234.7656" y2="234.7656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="60.3965" y="224.5869">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.9238" y="218.7666">Obtain Admin</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.9238" y="230.4072">access to TPM</text><polygon fill="#181818" points="167.79,256.4063,177.79,260.4063,167.79,264.4063,171.79,260.4063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="43.3965" x2="173.79" y1="260.4063" y2="260.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="50.3965" y="256.0479">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="74.9238" y="256.0479">TPM Admin access</text><polygon fill="#181818" points="597.958,282.0469,607.958,286.0469,597.958,290.0469,601.958,286.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="189.79" x2="603.958" y1="286.0469" y2="286.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="196.79" y="281.6885">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="221.3174" y="281.6885">Trigger Generation of TPM Attestation Key Pair</text><path d="M624.958,273.4063 L624.958,306.4063 L825.958,306.4063 L825.958,283.4063 L815.958,273.4063 L624.958,273.4063" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M815.958,273.4063 L815.958,283.4063 L825.958,283.4063 L815.958,273.4063" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="630.958" y="287.6885">Key Pair generated securely in TPM.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="630.958" y="299.3291">Private key does not leave TPM.</text><polygon fill="#181818" points="200.79,325.3281,190.79,329.3281,200.79,333.3281,196.79,329.3281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="194.79" x2="608.958" y1="329.3281" y2="329.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.79" y="324.9697">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.3174" y="324.9697">Return Attestation Public Key / Certificate Chain</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1424.0239" x="5" y="356.1484"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1429.0239" y1="356.1484" y2="356.1484"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1429.0239" y1="359.1484" y2="359.1484"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="348.5313" x="542.7463" y="347.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="548.7463" y="360.6104">2. Dynamic Client Registration (DCR) with TPM Attestation</text><polygon fill="#181818" points="597.958,390.6094,607.958,394.6094,597.958,398.6094,601.958,394.6094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="189.79" x2="603.958" y1="394.6094" y2="394.6094"/><text fill="#000000" font-family="Helvetica" font-size="10" x="196.79" y="390.251">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="221.3174" y="390.251">Request Attestation Statement for Registration</text><line style="stroke:#181818;stroke-width:1;" x1="190.79" x2="200.79" y1="420.25" y2="416.25"/><line style="stroke:#181818;stroke-width:1;" x1="190.79" x2="200.79" y1="420.25" y2="424.25"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="189.79" x2="608.958" y1="420.25" y2="420.25"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.79" y="415.8916">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.3174" y="415.8916">Return Attestation Statement (e.g., Certificate Chain with Extension Data)</text><polygon fill="#181818" points="940.939,441.8906,950.939,445.8906,940.939,449.8906,944.939,445.8906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="189.79" x2="946.939" y1="445.8906" y2="445.8906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="196.79" y="441.5322">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="221.3174" y="441.5322">POST /register (RFC 7591)</text><path d="M194.79,458.8906 L194.79,619.8906 L648.79,619.8906 L648.79,468.8906 L638.79,458.8906 L194.79,458.8906" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M638.79,458.8906 L638.79,468.8906 L648.79,468.8906 L638.79,458.8906" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="200.79" y="473.1729">DCR Request Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="200.79" y="484.8135">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="496.4541">"redirect_uris": ["..."],</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="508.0947">"client_name": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="519.7354">"token_endpoint_auth_method": "private_key_jwt",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="531.376">"grant_types": ["urn:ietf:params:oauth:grant-type:token-exchange","refresh_token"],</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="543.0166">"jwks": { "keys": [ &lt;Client_Instance_Public_Key_JWK&gt; ] },</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="554.6572">// Custom parameter for attestation:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="566.2979">"urn:gematik:params:oauth:client-attestation-type:tpm2": {</text><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6836" y="577.9385">"attestation_data": "&lt;Base64(TPM Attestation Statement)&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6836" y="589.5791">"attestation_format": "tpm-attestation-jwt"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="210.3262" y="601.2197">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="200.79" y="612.8604">}</text><line style="stroke:#181818;stroke-width:1;" x1="962.939" x2="1004.939" y1="642.8594" y2="642.8594"/><line style="stroke:#181818;stroke-width:1;" x1="1004.939" x2="1004.939" y1="642.8594" y2="655.8594"/><line style="stroke:#181818;stroke-width:1;" x1="963.939" x2="1004.939" y1="655.8594" y2="655.8594"/><polygon fill="#181818" points="973.939,651.8594,963.939,655.8594,973.939,659.8594,969.939,655.8594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="969.939" y="638.501">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="994.4663" y="638.501">Validate TPM Attestation Statement</text><path d="M1185.7144,630.2188 L1185.7144,674.2188 L1398.7144,674.2188 L1398.7144,640.2188 L1388.7144,630.2188 L1185.7144,630.2188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1388.7144,630.2188 L1388.7144,640.2188 L1398.7144,640.2188 L1388.7144,630.2188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1191.7144" y="644.501">Check signature against trusted roots.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1191.7144" y="656.1416">Extract device/OS/App status.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1191.7144" y="667.7822">Verify Attestation Key properties.</text><path d="M168.79,684.1406 L228.7461,684.1406 L228.7461,687.7813 L218.7461,697.7813 L168.79,697.7813 L168.79,684.1406" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="403.4531" style="stroke:#000000;stroke-width:1.5;" width="1084.1938" x="168.79" y="684.1406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="183.79" y="694.4229">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="243.7461" y="695.4229">[Attestation valid]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="168.79" x2="1252.9839" y1="1043.3125" y2="1043.3125"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="173.79" y="1054.5947">[Attestation invalid]</text><line style="stroke:#181818;stroke-width:1;" x1="962.939" x2="1004.939" y1="725.4219" y2="725.4219"/><line style="stroke:#181818;stroke-width:1;" x1="1004.939" x2="1004.939" y1="725.4219" y2="738.4219"/><line style="stroke:#181818;stroke-width:1;" x1="963.939" x2="1004.939" y1="738.4219" y2="738.4219"/><polygon fill="#181818" points="973.939,734.4219,963.939,738.4219,973.939,742.4219,969.939,738.4219" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="969.939" y="721.0635">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="994.4663" y="721.0635">Generate client_id</text><line style="stroke:#181818;stroke-width:1;" x1="962.939" x2="1004.939" y1="764.0625" y2="764.0625"/><line style="stroke:#181818;stroke-width:1;" x1="1004.939" x2="1004.939" y1="764.0625" y2="777.0625"/><line style="stroke:#181818;stroke-width:1;" x1="963.939" x2="1004.939" y1="777.0625" y2="777.0625"/><polygon fill="#181818" points="973.939,773.0625,963.939,777.0625,973.939,781.0625,969.939,777.0625" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="969.939" y="759.7041">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="994.4663" y="759.7041">Store client metadata, incl. Client Instance Key</text><line style="stroke:#181818;stroke-width:1;" x1="962.939" x2="1004.939" y1="814.3438" y2="814.3438"/><line style="stroke:#181818;stroke-width:1;" x1="1004.939" x2="1004.939" y1="814.3438" y2="827.3438"/><line style="stroke:#181818;stroke-width:1;" x1="963.939" x2="1004.939" y1="827.3438" y2="827.3438"/><polygon fill="#181818" points="973.939,823.3438,963.939,827.3438,973.939,831.3438,969.939,827.3438" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="969.939" y="804.165">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="994.4663" y="798.3447">Generate Nonce (Challenge)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="994.4663" y="809.9854">// Short-lived for Client to SM(C)-B Binding</text><line style="stroke:#181818;stroke-width:1;" x1="190.79" x2="200.79" y1="852.9844" y2="848.9844"/><line style="stroke:#181818;stroke-width:1;" x1="190.79" x2="200.79" y1="852.9844" y2="856.9844"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="189.79" x2="951.939" y1="852.9844" y2="852.9844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.79" y="848.626">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.3174" y="848.626">201 Created</text><path d="M194.79,865.9844 L194.79,1026.9844 L698.79,1026.9844 L698.79,875.9844 L688.79,865.9844 L194.79,865.9844" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M688.79,865.9844 L688.79,875.9844 L698.79,875.9844 L688.79,865.9844" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="200.79" y="880.2666">DCR Response Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="200.79" y="891.9072">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="903.5479">"client_id": "&lt;generated-client-id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="915.1885">"client_id_issued_at": ...,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="926.8291">"client_name": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="938.4697">"token_endpoint_auth_method": "private_key_jwt",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="950.1104">"grant_types": ["urn:ietf:params:oauth:grant-type:token-exchange","refresh_token"],</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="961.751">"jwks": { &lt;Client_Instance_Public_Key_JWK&gt; }, // Confirming registered key</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="973.3916">// ... other registered metadata</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="985.0322">"registration_access_token": "...", // Optional for config updates</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="996.6729">"registration_client_uri": "...", // Optional for config updates</text><text fill="#000000" font-family="Helvetica" font-size="10" x="207.1475" y="1008.3135">"challenge": "&lt;random_nonce_value&gt;" // For Client to SM(C)-B Binding during Token Exchange</text><text fill="#000000" font-family="Helvetica" font-size="10" x="200.79" y="1019.9541">}</text><line style="stroke:#181818;stroke-width:1;" x1="190.79" x2="200.79" y1="1079.5938" y2="1075.5938"/><line style="stroke:#181818;stroke-width:1;" x1="190.79" x2="200.79" y1="1079.5938" y2="1083.5938"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="189.79" x2="956.939" y1="1079.5938" y2="1079.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.79" y="1075.2354">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.3174" y="1075.2354">400 Bad Request</text><!--SRC=[jLRTRXf75BxVfpWb5m47i6EbhOfYImOSsuqT8t0JjQLQ3Rk7PS8oivsTnIQHtwPlqXVhERExi1YIIArwOmppdV_lV3CYirfbYmaQgDMFZXerBvrBbGWZ5X3YL6InVQEL7SbF22-FzX- -4mk4IuoNQ6KWAfX-ZhdHIgU9231SetiwCn9D1HkZYkpiBFoOfHQKLbWvI_7F35M0GvoYuN-w8fX7HcSgxEbO6_WmaxPgC7fgiAdXs3jy_YsWNSK84ns7tlD3p_ikCI9Q2B2eFu4r6NhUMM0fwYyfLJ3H3r2xFh-gmREBcKvjdWg0-trWvEBllqowIYqk274jbgX2iW8e4B-Ttvr1BvQeB9sFX0fNNQFlbKC0K9RKKva8PGiKY3It6gl2p479BJlqdXhT3MwS1NqoS0EhWjvgfN3E9J5qyqsRiRgxQbq8Y_TYLNjYDRhfElpefjvhjBerhtIUz-HCJIHQD5JMtNdlyjtjzUt5hrwrx8jCc72twcgCou4BCJWVZDNCsWG6HZ-iQZkuiypEHZcqJr3-gety9ApKYePibfp7ZjNWV6CoqB4CLd2k8gbmkrLvpdTNSDm-WZxrd1Zwh2_CV8JYmY3k6zOmpsQ8AJ4zmB4gajWQrhfX8bwFTqPcIaFWllaozBpYuCMByh_MQGdkm0KgD3IVyfShIauGZ-4jhc0Wf87wb2PPd79V6fxIX3SocjdE1iQenCWb-VBdkF8_tbiOgtgWipY4X2oKbIAELp119bLhGYk8OHCccOLGfbQgmCBKw0MSMOkKX6izkMzKqkQDeK8exzk95LB1MRYGQgn4462QWjNisdEergRALeiCcCWE3JcuufMFdDCxAYeYsw8fd82UvfRRERcIz_SXAXeQake4cK6gc6AIZpPn9EyFK7yWrCY3iYHSjDGEu76aJTuT6ABDZDeAFiWcn3CNxX1wI8IPacRo_6RKZyA3vvsS4DcWlr9YGUYYr256rEYYi7g_Dsp0lRIpdG9FJlOrPyXIHyoj8aVqYGj6ylYh_htdK6rFrOWc7MSXffsnQkqqDfMH4bGryc4VbvAeA4CcpvJqFkLVkvgwnZROXFTe-22i_CYGsn6VfEIqILEnmGokSOcn2vWaSDLlkiyrXh-CoiXmAT9PEOjj4kqPoAO5TMn7xURkKF8cdp_G2d0qw0ih6bwbnRduk2OFRaTtS6XS8uc8zU6R7lpu_Kylgql7d2oCdyNymoJEqEd2mG4DTJsehWvNdOC3T_Ava9YQmL0Q3AnFzsTQwy3ljNQxNVkZMPuNka6yGJfrX-ipg-UeV1ATH4l224hRNo0fPSZG9yk_COiC2PflLmdc0Qc37LBsQSTTeMb7iwEEGxKOrN5nMlWGp8IAiDQafAS6qvdl3Yh9VhoViylFKAEWpZcypZlZbphcvmlZ4xVydp-yFOK_uB6qFwGDejS2IOxBX2yRnsEn6M-d3CL9HxYW7-VRUUSDQrLiYYAInJ7dLZXW7nMC7n89k6klkoB57rxLd-xWcbQDqtKdd_gWN2aXzaB1jZBW_fT6Zrx-boyB9X6zFXpVriJhm7iHov3v-iKijhIkDyDWljbK416nd0X7RvkKXS_GBgOaTqHv8qZLGxV6XxUZGzupzftniTlTrOu294Odl4AOjjszLZrVSgAkdfqQrXVPvkRRYnlHmwG40SrSy2IQJfJQ-ox1FLugmTvfXjLfpsD-W69Zh8XL8teys5OibzICokr9rrFnre6kLA5KKTNvKwqvFde9FODybJZOLmGWgZmYDYgG9bgbk2K3LIcehhjq6_nwVNUr2bRBS8jz5RmlqpJ3q7Vy8vNOXzed8lz1IFvVCTaMb6_Ao6FJoOTMKsdeKH51gTaqydd1chNAK0D0snd9ImLLSgyQtrHkK3z_fnHvbcraTxS9dulOSIlW52B84bxWz8lEYf6GwlyRLq79RqSJQcwe5xvYxlkqaXcUrjZPcwzH7KAAJHztN0xTXlayra4UrmzRfr4O4tEt7mqxk_zqOLuT7K5NXENzvmIF16HpqxRu9-yV]--></g></svg>