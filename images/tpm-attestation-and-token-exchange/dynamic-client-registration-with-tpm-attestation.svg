<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1146px" preserveAspectRatio="none" style="width:1354px;height:1146px;background:#FFFFFF;" version="1.1" viewBox="0 0 1354 1146" width="1354px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="1134.3125" style="stroke:#181818;stroke-width:0.5;" width="667.3726" x="58.793" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="384.0173" y="15.2822">LEI</text><rect fill="#E6E6FA" height="1117.6719" style="stroke:#181818;stroke-width:0.5;" width="504.2896" x="58.793" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="271.8411" y="31.9229">Prim&#228;rsystem</text><rect fill="#F4A460" height="1101.0313" style="stroke:#181818;stroke-width:0.5;" width="89" x="58.793" y="39.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="70.793" y="48.5635">ZETA Client</text><rect fill="#C9FFC9" height="1134.3125" style="stroke:#181818;stroke-width:0.5;" width="572.6709" x="738.1655" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1000.1406" y="15.2822">Anbieter</text><rect fill="#F4A460" height="1117.6719" style="stroke:#181818;stroke-width:0.5;" width="461.6074" x="738.1655" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="935.8247" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="1117.6719" style="stroke:#181818;stroke-width:0.5;" width="99.0635" x="1211.7729" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1223.7729" y="31.9229">TI 2.0 Dienst</text><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="936.1094" width="8" x="34.8965" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="38.3965" x2="38.3965" y1="126.5625" y2="1062.6719"/></g><g><title>ZETA</title><rect fill="#000000" fill-opacity="0.00000" height="936.1094" width="8" x="99.793" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="103.293" x2="103.293" y1="126.5625" y2="1062.6719"/></g><g><title/><rect fill="#FFFFFF" height="881.4688" style="stroke:#181818;stroke-width:1;" width="10" x="98.293" y="162.2031"/></g><g><title>TPM</title><rect fill="#000000" fill-opacity="0.00000" height="936.1094" width="8" x="529.9609" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="533.4609" x2="533.4609" y1="126.5625" y2="1062.6719"/></g><g><title/><rect fill="#FFFFFF" height="43.2813" style="stroke:#181818;stroke-width:1;" width="10" x="528.4609" y="223.125"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="528.4609" y="331.6875"/></g><g><title>Konnektor or</title><rect fill="#000000" fill-opacity="0.00000" height="936.1094" width="8" x="615.0093" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="618.5093" x2="618.5093" y1="126.5625" y2="1062.6719"/></g><g><title>SM(C)-B</title><rect fill="#000000" fill-opacity="0.00000" height="936.1094" width="8" x="691.5508" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="695.0508" x2="695.0508" y1="126.5625" y2="1062.6719"/></g><g><title>PEP</title><rect fill="#000000" fill-opacity="0.00000" height="936.1094" width="8" x="771.5664" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="775.0664" x2="775.0664" y1="126.5625" y2="1062.6719"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="936.1094" width="8" x="872.9419" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="876.4419" x2="876.4419" y1="126.5625" y2="1062.6719"/></g><g><title/><rect fill="#FFFFFF" height="407.0938" style="stroke:#181818;stroke-width:1;" width="10" x="871.4419" y="382.9688"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="936.1094" width="8" x="1151.9868" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1155.4868" x2="1155.4868" y1="126.5625" y2="1062.6719"/></g><g><title>Resource</title><rect fill="#000000" fill-opacity="0.00000" height="936.1094" width="8" x="1257.8047" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1261.3047" x2="1261.3047" y1="126.5625" y2="1062.6719"/></g><text fill="#000000" font-family="Helvetica" font-size="10" x="24" y="124.2041">User</text><ellipse cx="38.3965" cy="63.4219" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38.3965,71.4219 L38.3965,98.4219 M25.3965,79.4219 L51.3965,79.4219 M38.3965,98.4219 L25.3965,113.4219 M38.3965,98.4219 L51.3965,113.4219" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="81.8179" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="90.2339" y="104.5635">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="88.8179" y="116.2041">Client</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="516.0776" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="523.0776" y="116.2041">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="579.0825" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="586.0825" y="104.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="590.0889" y="116.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="667.936" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="674.936" y="116.2041">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="742.1655" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="765.877" y="104.5635">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="749.1655" y="116.2041">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="817.9673" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="866.5615" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="824.9673" y="116.2041">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1115.2007" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1145.6064" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1122.2007" y="116.2041">Policy Engine</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60.5283" x="1231.0405" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1238.0405" y="104.5635">Resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1244.9082" y="116.2041">Server</text><text fill="#000000" font-family="Helvetica" font-size="10" x="24" y="1131.9541">User</text><ellipse cx="38.3965" cy="1071.1719" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38.3965,1079.1719 L38.3965,1106.1719 M25.3965,1087.1719 L51.3965,1087.1719 M38.3965,1106.1719 L25.3965,1121.1719 M38.3965,1106.1719 L51.3965,1121.1719" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="81.8179" y="1062.6719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="90.2339" y="1078.9541">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="88.8179" y="1090.5947">Client</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="516.0776" y="1062.6719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="523.0776" y="1078.9541">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="579.0825" y="1062.6719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="586.0825" y="1078.9541">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="590.0889" y="1090.5947">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="667.936" y="1062.6719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="674.936" y="1078.9541">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="742.1655" y="1062.6719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="765.877" y="1078.9541">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="749.1655" y="1090.5947">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="817.9673" y="1062.6719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="866.5615" y="1078.9541">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="824.9673" y="1090.5947">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1115.2007" y="1062.6719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1145.6064" y="1078.9541">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1122.2007" y="1090.5947">Policy Engine</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60.5283" x="1231.0405" y="1062.6719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1238.0405" y="1078.9541">Resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1244.9082" y="1090.5947">Server</text><path d="M8,138.5625 L67.9561,138.5625 L67.9561,142.2031 L57.9561,152.2031 L8,152.2031 L8,138.5625" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="900.1094" style="stroke:#000000;stroke-width:1.5;" width="1330.5269" x="8" y="138.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="23" y="148.8447">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="82.9561" y="149.8447">[Client has no client_id]</text><line style="stroke:#181818;stroke-width:1;" x1="108.293" x2="150.293" y1="179.8438" y2="179.8438"/><line style="stroke:#181818;stroke-width:1;" x1="150.293" x2="150.293" y1="179.8438" y2="192.8438"/><line style="stroke:#181818;stroke-width:1;" x1="109.293" x2="150.293" y1="192.8438" y2="192.8438"/><polygon fill="#181818" points="119.293,188.8438,109.293,192.8438,119.293,196.8438,115.293,192.8438" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="115.293" y="175.4854">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="139.8203" y="175.4854">Generate Client Instance Key Pair (for Client Auth)</text><path d="M403.876,167.2031 L403.876,200.2031 L764.876,200.2031 L764.876,177.2031 L754.876,167.2031 L403.876,167.2031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M754.876,167.2031 L754.876,177.2031 L764.876,177.2031 L754.876,167.2031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="409.876" y="181.4854">Key Pair for private_key_jwt</text><text fill="#000000" font-family="Helvetica" font-size="10" x="409.876" y="193.126">(could potentially be TPM-backed, but distinct from Attestation Key)</text><polygon fill="#181818" points="516.4609,219.125,526.4609,223.125,516.4609,227.125,520.4609,223.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="108.293" x2="522.4609" y1="223.125" y2="223.125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="115.293" y="218.7666">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="139.8203" y="218.7666">Trigger Generation of TPM Attestation Key Pair</text><path d="M543.4609,210.4844 L543.4609,243.4844 L744.4609,243.4844 L744.4609,220.4844 L734.4609,210.4844 L543.4609,210.4844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M734.4609,210.4844 L734.4609,220.4844 L744.4609,220.4844 L734.4609,210.4844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="549.4609" y="224.7666">Key Pair generated securely in TPM.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="549.4609" y="236.4072">Private key does not leave TPM.</text><polygon fill="#181818" points="119.293,262.4063,109.293,266.4063,119.293,270.4063,115.293,266.4063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="113.293" x2="527.4609" y1="266.4063" y2="266.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="125.293" y="262.0479">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="149.8203" y="262.0479">Return Attestation Public Key / Certificate Chain</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1342.5269" x="5" y="293.2266"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1347.5269" y1="293.2266" y2="293.2266"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1347.5269" y1="296.2266" y2="296.2266"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="348.5313" x="501.9978" y="284.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="507.9978" y="297.6885">2. Dynamic Client Registration (DCR) with TPM Attestation</text><polygon fill="#181818" points="516.4609,327.6875,526.4609,331.6875,516.4609,335.6875,520.4609,331.6875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="108.293" x2="522.4609" y1="331.6875" y2="331.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="115.293" y="327.3291">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="139.8203" y="327.3291">Request Attestation Statement for Registration</text><line style="stroke:#181818;stroke-width:1;" x1="109.293" x2="119.293" y1="357.3281" y2="353.3281"/><line style="stroke:#181818;stroke-width:1;" x1="109.293" x2="119.293" y1="357.3281" y2="361.3281"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="108.293" x2="527.4609" y1="357.3281" y2="357.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="125.293" y="352.9697">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="149.8203" y="352.9697">Return Attestation Statement (e.g., Certificate Chain with Extension Data)</text><polygon fill="#181818" points="859.4419,378.9688,869.4419,382.9688,859.4419,386.9688,863.4419,382.9688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="108.293" x2="865.4419" y1="382.9688" y2="382.9688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="115.293" y="378.6104">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="139.8203" y="378.6104">POST /register (RFC 7591)</text><path d="M113.293,395.9688 L113.293,556.9688 L567.293,556.9688 L567.293,405.9688 L557.293,395.9688 L113.293,395.9688" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M557.293,395.9688 L557.293,405.9688 L567.293,405.9688 L557.293,395.9688" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="119.293" y="410.251">DCR Request Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="119.293" y="421.8916">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="433.5322">"redirect_uris": ["..."],</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="445.1729">"client_name": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="456.8135">"token_endpoint_auth_method": "private_key_jwt",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="468.4541">"grant_types": ["urn:ietf:params:oauth:grant-type:token-exchange","refresh_token"],</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="480.0947">"jwks": { "keys": [ &lt;Client_Instance_Public_Key_JWK&gt; ] },</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="491.7354">// Custom parameter for attestation:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="503.376">"urn:gematik:params:oauth:client-attestation-type:tpm2": {</text><text fill="#000000" font-family="Helvetica" font-size="10" x="135.1865" y="515.0166">"attestation_data": "&lt;Base64(TPM Attestation Statement)&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="135.1865" y="526.6572">"attestation_format": "tpm-attestation-jwt"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="128.8291" y="538.2979">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="119.293" y="549.9385">}</text><line style="stroke:#181818;stroke-width:1;" x1="881.4419" x2="923.4419" y1="579.9375" y2="579.9375"/><line style="stroke:#181818;stroke-width:1;" x1="923.4419" x2="923.4419" y1="579.9375" y2="592.9375"/><line style="stroke:#181818;stroke-width:1;" x1="882.4419" x2="923.4419" y1="592.9375" y2="592.9375"/><polygon fill="#181818" points="892.4419,588.9375,882.4419,592.9375,892.4419,596.9375,888.4419,592.9375" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="888.4419" y="575.5791">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="912.9692" y="575.5791">Validate TPM Attestation Statement</text><path d="M1104.2173,567.2969 L1104.2173,611.2969 L1317.2173,611.2969 L1317.2173,577.2969 L1307.2173,567.2969 L1104.2173,567.2969" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1307.2173,567.2969 L1307.2173,577.2969 L1317.2173,577.2969 L1307.2173,567.2969" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1110.2173" y="581.5791">Check signature against trusted roots.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1110.2173" y="593.2197">Extract device/OS/App status.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1110.2173" y="604.8604">Verify Attestation Key properties.</text><path d="M87.293,621.2188 L147.249,621.2188 L147.249,624.8594 L137.249,634.8594 L87.293,634.8594 L87.293,621.2188" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="403.4531" style="stroke:#000000;stroke-width:1.5;" width="1084.1938" x="87.293" y="621.2188"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="102.293" y="631.501">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="162.249" y="632.501">[Attestation valid]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="87.293" x2="1171.4868" y1="980.3906" y2="980.3906"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="92.293" y="991.6729">[Attestation invalid]</text><line style="stroke:#181818;stroke-width:1;" x1="881.4419" x2="923.4419" y1="662.5" y2="662.5"/><line style="stroke:#181818;stroke-width:1;" x1="923.4419" x2="923.4419" y1="662.5" y2="675.5"/><line style="stroke:#181818;stroke-width:1;" x1="882.4419" x2="923.4419" y1="675.5" y2="675.5"/><polygon fill="#181818" points="892.4419,671.5,882.4419,675.5,892.4419,679.5,888.4419,675.5" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="888.4419" y="658.1416">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="912.9692" y="658.1416">Generate client_id</text><line style="stroke:#181818;stroke-width:1;" x1="881.4419" x2="923.4419" y1="701.1406" y2="701.1406"/><line style="stroke:#181818;stroke-width:1;" x1="923.4419" x2="923.4419" y1="701.1406" y2="714.1406"/><line style="stroke:#181818;stroke-width:1;" x1="882.4419" x2="923.4419" y1="714.1406" y2="714.1406"/><polygon fill="#181818" points="892.4419,710.1406,882.4419,714.1406,892.4419,718.1406,888.4419,714.1406" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="888.4419" y="696.7822">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="912.9692" y="696.7822">Store client metadata, incl. Client Instance Key</text><line style="stroke:#181818;stroke-width:1;" x1="881.4419" x2="923.4419" y1="751.4219" y2="751.4219"/><line style="stroke:#181818;stroke-width:1;" x1="923.4419" x2="923.4419" y1="751.4219" y2="764.4219"/><line style="stroke:#181818;stroke-width:1;" x1="882.4419" x2="923.4419" y1="764.4219" y2="764.4219"/><polygon fill="#181818" points="892.4419,760.4219,882.4419,764.4219,892.4419,768.4219,888.4419,764.4219" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="888.4419" y="741.2432">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="912.9692" y="735.4229">Generate Nonce (Challenge)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="912.9692" y="747.0635">// Short-lived for Client to SM(C)-B Binding</text><line style="stroke:#181818;stroke-width:1;" x1="109.293" x2="119.293" y1="790.0625" y2="786.0625"/><line style="stroke:#181818;stroke-width:1;" x1="109.293" x2="119.293" y1="790.0625" y2="794.0625"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="108.293" x2="870.4419" y1="790.0625" y2="790.0625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="125.293" y="785.7041">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="149.8203" y="785.7041">201 Created</text><path d="M113.293,803.0625 L113.293,964.0625 L617.293,964.0625 L617.293,813.0625 L607.293,803.0625 L113.293,803.0625" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M607.293,803.0625 L607.293,813.0625 L617.293,813.0625 L607.293,803.0625" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="119.293" y="817.3447">DCR Response Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="119.293" y="828.9854">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="840.626">"client_id": "&lt;generated-client-id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="852.2666">"client_id_issued_at": ...,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="863.9072">"client_name": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="875.5479">"token_endpoint_auth_method": "private_key_jwt",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="887.1885">"grant_types": ["urn:ietf:params:oauth:grant-type:token-exchange","refresh_token"],</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="898.8291">"jwks": { &lt;Client_Instance_Public_Key_JWK&gt; }, // Confirming registered key</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="910.4697">// ... other registered metadata</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="922.1104">"registration_access_token": "...", // Optional for config updates</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="933.751">"registration_client_uri": "...", // Optional for config updates</text><text fill="#000000" font-family="Helvetica" font-size="10" x="125.6504" y="945.3916">"challenge": "&lt;random_nonce_value&gt;" // For Client to SM(C)-B Binding during Token Exchange</text><text fill="#000000" font-family="Helvetica" font-size="10" x="119.293" y="957.0322">}</text><line style="stroke:#181818;stroke-width:1;" x1="109.293" x2="119.293" y1="1016.6719" y2="1012.6719"/><line style="stroke:#181818;stroke-width:1;" x1="109.293" x2="119.293" y1="1016.6719" y2="1020.6719"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="108.293" x2="875.4419" y1="1016.6719" y2="1016.6719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="125.293" y="1012.3135">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="149.8203" y="1012.3135">400 Bad Request</text><!--SRC=[jLRRRjj647tdLqoLXqYs93j6sg927C2I7DkD7GkIcw2j2s95ZgYDg5rskPIj1FwR_ab_h3Chag8kIO0MVR5CpfdBpfmvIv5PhRBv60tKwiV7ZPgNpgHAX15p274YijY-qSgEv2U45yVxZU_47E4IumLQ6OWAfh_2t6YbqqG469RediwCH5F1ngWYEpqBFsQf1QKLLcmf_fcX2d284pJyJrS4iyZeJ8Kz7Mi37wRILXr6smxhCvnuHy-_1RJB666iuz1xVkHvtoL6H7C15lKdi2P3ppiBB6Nz9QKJZFKZrAxFhshmx6AgKxig1S2z7nWv__ilaovJYtD2N8i5gf2y07B4R-TtPz2B9IfBzf5GuR9hz8Do202gadeg4w5iZWAHhhpkLUxce1IM0thRJdU36-T1lmnSmwgWjrefdF6H6Bf-qkPUtLsrBeJ51x6iRNcDRheEFxgfzngjRiqhWgzwSgR64YqQEjRTUU_otUtrxSMlNlNO5vamuUwfgpak1ox5u7nmhwRM9Z0m-d5Psy6TPNOwMa7x1EL7RUGdOQLMD6Ipu3fsl0RdQvU1ZcMmX7CLIOMRhLhLV7S59-rZw5FFYQ7F-iBCHYWk3EA-OGrNrGmn9QO7UA_o8ZQ6LJPCnELuf-IcD0JkoPUXv-M6myFYlzRh0jo12rHeQ3x5coigJX2FuIqkOI2aWVg49fbRkIyDJsd26nbDRMSDOrHYv89Y-JDS-XyVBDohUg2pE8I4F9IL8ewNC4OcLMjCAuXX4yQPXL2cLgh0miJeEPnPYrI4Qps5RrJAPZOU7bBPTvG-8it9osUedZZpbhShRd_5KNxqaFGXo0nIRL9nZ3PDStKIe9D0g95RQabYQFqSmEDChRAF7HYYpOpQI3x8niG8b-u8UaYZdP2wSQUdGgeyWkUTdX8jeBzKOaxe_AX3ZAWb-S7g_Twm0G_IJdSEU7gwhpb35YNYM1Kveb-SCv87LOtlFOTgUwfED9Cu2p7jtAlMJcDJ6Ib1fqOszd4XYJGov35FI9bJVjlLr3NsmIQyHyE6iFAI8RSZjgGKj4bJiS4Khd61iKkO973LRxhV4iCFeo8pN8fqMioY97Mh1Ni7icv17TjHkxaxb5MJpn-9h9mD-iAAXbTfyKecN9C7jwCxE3AkaKJ4-l1D3txy_gSNrVLWJkREps9-COupT1jyS413BGVLrU6oSt3WB9zpCQWP3AN1mFfqqwMr3lnUQxVRjJ-QXJtVSE8DajKPIvlLCrG-oKEY9M44bUtFaJGjPEZMcgxT8aFIuzjbWgk4rC4EQV2auowxjACvKCUXMepgk3mjV0ocGaLOQrBH4uFfr7U6Ih4V7sOSyZFKAAaB3gzMdV4BnV5N2-CJj_oVFxnz3N_0K-5_H1j4zpg9Wwk4hmN7Ox4URwT8nKL7EAUNiyswLmrhLNpoGoJp4wuj3y0nAXW_919mrrvrHOe_lAnlxs19gyRhifFRCQXMAeYZKBAD2hZ_XTEJj_hBiiuaeky4nxUIU1ruBs8PCb-_MCM6rlMc6CpMcmeY8fOJuUWh96NXCxIBASaTKTu8qj_GhV7HxUY8zunZPsnskxlSKO34w8HN2DEsku6gzWKNwiwpSuRoobdVKNjn8_g4A410CnSyYQOJfVQ-wsfFb4goTvfXTThpc3yLiN6lY5KZkkPjAvOBQaRbdhCQygyIw4eLIXLLWszhpSdn2-WPvAl4mRuY057bkb-hG9febUA635IbeBhkqctmg_BkQkMibk46-ofuNwPfXg7l-4SgiG-rJqJ-Wv3ylsAoAIZVb96dffCFhIRIp6cIK6WsZNoMiwPK6Me0Q3ibUQcW2kvLyvlA3UgB8C0qpUiisiZXRXEsYzXnA-0I8iWINk3qYy7oaP3g_vjGGS5lHnDgRgZdlcBk-xII6RwkSR0tNwCwX9IRVkxuE7GRhkPH9dagFq6THc5CpDtyQDZP_Us5UNby35qH5lUV4pmIaFLDs-9NtZy0]--></g></svg>