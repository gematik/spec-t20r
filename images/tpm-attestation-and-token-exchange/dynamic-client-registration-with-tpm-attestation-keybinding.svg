<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2349px" preserveAspectRatio="none" style="width:1497px;height:2349px;background:#FFFFFF;" version="1.1" viewBox="0 0 1497 2349" width="1497px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="2337.75" style="stroke:#181818;stroke-width:0.5;" width="708.6753" x="17.5" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="363.3757" y="15.2822">LEI</text><rect fill="#E6E6FA" height="2321.1094" style="stroke:#181818;stroke-width:0.5;" width="708.6753" x="17.5" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="332.741" y="31.9229">Prim&#228;rsystem</text><rect fill="#F4A460" height="2304.4688" style="stroke:#181818;stroke-width:0.5;" width="89" x="17.5" y="39.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="29.5" y="48.5635">ZETA Client</text><rect fill="#C9FFC9" height="2337.75" style="stroke:#181818;stroke-width:0.5;" width="549.7891" x="738.1753" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="988.7095" y="15.2822">Anbieter</text><rect fill="#F4A460" height="2321.1094" style="stroke:#181818;stroke-width:0.5;" width="438.7256" x="738.1753" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="924.3936" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="2321.1094" style="stroke:#181818;stroke-width:0.5;" width="99.0635" x="1188.9009" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1200.9009" y="31.9229">TI 2.0 Dienst</text><g><title>ZETA</title><rect fill="#000000" fill-opacity="0.00000" height="2206.2656" width="8" x="58.5" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="62" x2="62" y1="93.2031" y2="2299.4688"/></g><g><title/><rect fill="#FFFFFF" height="2179.2656" style="stroke:#181818;stroke-width:1;" width="10" x="57" y="101.2031"/></g><g><title>ZETA Attestation Service</title><rect fill="#000000" fill-opacity="0.00000" height="2206.2656" width="8" x="359.7764" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="363.2764" x2="363.2764" y1="93.2031" y2="2299.4688"/></g><g><title/><rect fill="#FFFFFF" height="465.4531" style="stroke:#181818;stroke-width:1;" width="10" x="358.2764" y="392.5313"/></g><g><title>TPM</title><rect fill="#000000" fill-opacity="0.00000" height="2206.2656" width="8" x="701.292" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="704.792" x2="704.792" y1="93.2031" y2="2299.4688"/></g><g><title/><rect fill="#FFFFFF" height="345.6094" style="stroke:#181818;stroke-width:1;" width="10" x="699.792" y="445.8125"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="2206.2656" width="8" x="797.1499" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="800.6499" x2="800.6499" y1="93.2031" y2="2299.4688"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="795.6499" y="201.4063"/></g><g><title/><rect fill="#FFFFFF" height="1190.7188" style="stroke:#181818;stroke-width:1;" width="10" x="795.6499" y="1062.75"/></g><g><title>PDP DB</title><rect fill="#000000" fill-opacity="0.00000" height="2206.2656" width="8" x="1143.6509" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1147.1509" x2="1147.1509" y1="93.2031" y2="2299.4688"/></g><g><title/><rect fill="#FFFFFF" height="389.8125" style="stroke:#181818;stroke-width:1;" width="10" x="1142.1509" y="1678.8906"/></g><g><title>Resource</title><rect fill="#000000" fill-opacity="0.00000" height="2206.2656" width="8" x="1234.9326" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1238.4326" x2="1238.4326" y1="93.2031" y2="2299.4688"/></g><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="40.5249" y="54.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.9409" y="71.2041">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="47.5249" y="82.8447">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.6826" x="293.9351" y="54.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="300.9351" y="71.2041">ZETA Attestation Service</text><text fill="#000000" font-family="Helvetica" font-size="10" x="327.4097" y="82.8447">(Admin rights)</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="687.4087" y="66.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="694.4087" y="82.8447">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="742.1753" y="54.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="790.7695" y="71.2041">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="749.1753" y="82.8447">Authorization Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.5" x="1121.4009" y="66.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1128.4009" y="82.8447">PDP DB</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60.5283" x="1208.1685" y="54.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1215.1685" y="71.2041">Resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1222.0361" y="82.8447">Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="40.5249" y="2299.4688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.9409" y="2315.751">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="47.5249" y="2327.3916">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.6826" x="293.9351" y="2299.4688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="300.9351" y="2315.751">ZETA Attestation Service</text><text fill="#000000" font-family="Helvetica" font-size="10" x="327.4097" y="2327.3916">(Admin rights)</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="687.4087" y="2299.4688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="694.4087" y="2315.751">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="742.1753" y="2299.4688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="790.7695" y="2315.751">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="749.1753" y="2327.3916">Authorization Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.5" x="1121.4009" y="2299.4688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1128.4009" y="2315.751">PDP DB</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60.5283" x="1208.1685" y="2299.4688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1215.1685" y="2315.751">Resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1222.0361" y="2327.3916">Server</text><path d="M8,105.2031 L67.9561,105.2031 L67.9561,108.8438 L57.9561,118.8438 L8,118.8438 L8,105.2031" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2170.2656" style="stroke:#000000;stroke-width:1.5;" width="1483.5679" x="8" y="105.2031"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="23" y="115.4854">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="82.9561" y="116.4854">[Client has no client_id]</text><line style="stroke:#181818;stroke-width:1;" x1="67" x2="109" y1="158.125" y2="158.125"/><line style="stroke:#181818;stroke-width:1;" x1="109" x2="109" y1="158.125" y2="171.125"/><line style="stroke:#181818;stroke-width:1;" x1="68" x2="109" y1="171.125" y2="171.125"/><polygon fill="#181818" points="78,167.125,68,171.125,78,175.125,74,171.125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="147.9463">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="142.126">Generate Client Instance</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="153.7666">Key Pair (for Client Auth)</text><path d="M235.0732,133.8438 L235.0732,177.8438 L398.0732,177.8438 L398.0732,143.8438 L388.0732,133.8438 L235.0732,133.8438" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M388.0732,133.8438 L388.0732,143.8438 L398.0732,143.8438 L388.0732,133.8438" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="241.0732" y="148.126">Key Pair for private_key_jwt</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.0732" y="159.7666">(Public Key MUST be bound</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.0732" y="171.4072">to TPM Attestation)</text><polygon fill="#181818" points="783.6499,197.4063,793.6499,201.4063,783.6499,205.4063,787.6499,201.4063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="67" x2="789.6499" y1="201.4063" y2="201.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="197.0479">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="197.0479">GET /nonce</text><polygon fill="#181818" points="78,223.0469,68,227.0469,78,231.0469,74,227.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="72" x2="794.6499" y1="227.0469" y2="227.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="84" y="222.6885">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="108.5273" y="222.6885">return 200 OK new-nonce: nonce</text><path d="M46,239.0469 L105.9561,239.0469 L105.9561,242.6875 L95.9561,252.6875 L46,252.6875 L46,239.0469" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="792.0625" style="stroke:#000000;stroke-width:1.5;" width="960.7822" x="46" y="239.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="61" y="249.3291">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="120.9561" y="250.3291">[ZETA Attestation Service available]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="46" x2="1006.7822" y1="950.5469" y2="950.5469"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="51" y="961.8291">[ZETA Attestation 'Service is not available]</text><line style="stroke:#181818;stroke-width:1;" x1="67" x2="109" y1="291.9688" y2="291.9688"/><line style="stroke:#181818;stroke-width:1;" x1="109" x2="109" y1="291.9688" y2="304.9688"/><line style="stroke:#181818;stroke-width:1;" x1="68" x2="109" y1="304.9688" y2="304.9688"/><polygon fill="#181818" points="78,300.9688,68,304.9688,78,308.9688,74,304.9688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="281.79">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="275.9697">Calculate Public Key Hash</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="287.6104">(e.g., SHA256(PublicKeyJWK))</text><line style="stroke:#181818;stroke-width:1;" x1="67" x2="109" y1="342.25" y2="342.25"/><line style="stroke:#181818;stroke-width:1;" x1="109" x2="109" y1="342.25" y2="355.25"/><line style="stroke:#181818;stroke-width:1;" x1="68" x2="109" y1="355.25" y2="355.25"/><polygon fill="#181818" points="78,351.25,68,355.25,78,359.25,74,355.25" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="332.0713">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="326.251">Calculate Combined Data for TPM</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="337.8916">`combined_data = HASH(nonce + pubKeyHash)`</text><polygon fill="#181818" points="346.2764,388.5313,356.2764,392.5313,346.2764,396.5313,350.2764,392.5313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="67" x2="352.2764" y1="392.5313" y2="392.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="382.3525">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="376.5322">Get Attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="388.1729">with `combined_data`</text><path d="M347.2764,404.5313 L407.2324,404.5313 L407.2324,408.1719 L397.2324,418.1719 L347.2764,418.1719 L347.2764,404.5313" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="176.4844" style="stroke:#000000;stroke-width:1.5;" width="378.5156" x="347.2764" y="404.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="362.2764" y="414.8135">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="422.2324" y="415.8135">[ZETA TPM Service has no TPM Attestation Key]</text><polygon fill="#181818" points="687.792,441.8125,697.792,445.8125,687.792,449.8125,691.792,445.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="368.2764" x2="693.792" y1="445.8125" y2="445.8125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="375.2764" y="441.4541">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="441.4541">Generate Attestation Key Pair</text><polygon fill="#181818" points="379.2764,467.4531,369.2764,471.4531,379.2764,475.4531,375.2764,471.4531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="373.2764" x2="698.792" y1="471.4531" y2="471.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="385.2764" y="467.0947">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="409.8037" y="467.0947">Return Attestation Public Key</text><polygon fill="#181818" points="687.792,493.0938,697.792,497.0938,687.792,501.0938,691.792,497.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="368.2764" x2="693.792" y1="497.0938" y2="497.0938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="375.2764" y="492.7354">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="492.7354">Get Certificate Chain</text><polygon fill="#181818" points="379.2764,518.7344,369.2764,522.7344,379.2764,526.7344,375.2764,522.7344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="373.2764" x2="698.792" y1="522.7344" y2="522.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="385.2764" y="518.376">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="409.8037" y="518.376">Return Certificate Chain</text><line style="stroke:#181818;stroke-width:1;" x1="368.2764" x2="410.2764" y1="560.0156" y2="560.0156"/><line style="stroke:#181818;stroke-width:1;" x1="410.2764" x2="410.2764" y1="560.0156" y2="573.0156"/><line style="stroke:#181818;stroke-width:1;" x1="369.2764" x2="410.2764" y1="573.0156" y2="573.0156"/><polygon fill="#181818" points="379.2764,569.0156,369.2764,573.0156,379.2764,577.0156,375.2764,573.0156" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="375.2764" y="549.8369">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="544.0166">Store AK Handle, AK Public Key</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="555.6572">and Certificate Chain</text><line style="stroke:#181818;stroke-width:1;" x1="368.2764" x2="410.2764" y1="612.6563" y2="612.6563"/><line style="stroke:#181818;stroke-width:1;" x1="410.2764" x2="410.2764" y1="612.6563" y2="625.6563"/><line style="stroke:#181818;stroke-width:1;" x1="369.2764" x2="410.2764" y1="625.6563" y2="625.6563"/><polygon fill="#181818" points="379.2764,621.6563,369.2764,625.6563,379.2764,629.6563,375.2764,625.6563" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="375.2764" y="608.2979">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="608.2979">Select AK Handle</text><polygon fill="#181818" points="687.792,658.9375,697.792,662.9375,687.792,666.9375,691.792,662.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="368.2764" x2="693.792" y1="662.9375" y2="662.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="375.2764" y="652.7588">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="646.9385">Get TPM Quote for PCRs (4, 5, 7, 10, 11, 22 oder 23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="658.5791">and `combined_data` (as qualifyingData), signed with AK</text><path d="M112.2031,638.6563 L112.2031,682.6563 L358.2031,682.6563 L358.2031,648.6563 L348.2031,638.6563 L112.2031,638.6563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M348.2031,638.6563 L348.2031,648.6563 L358.2031,648.6563 L348.2031,638.6563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="118.2031" y="652.9385">Binding:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="168.4131" y="652.9385">`combined_data` enth&#228;lt Hash des</text><text fill="#000000" font-family="Helvetica" font-size="10" x="118.2031" y="664.5791">Client Instance Public Keys und die Nonce.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="118.2031" y="676.2197">TPM signiert PCRs + `combined_data`.</text><path d="M714.792,638.6563 L714.792,729.6563 L984.792,729.6563 L984.792,648.6563 L974.792,638.6563 L714.792,638.6563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M974.792,638.6563 L974.792,648.6563 L984.792,648.6563 L974.792,638.6563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="652.9385">PCR 4: Boot Loader Code, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="664.5791">PCR 5: Boot Loader Configuration, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="676.2197">PCR 7: Secure Boot State / Policy, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="687.8604">PCR   10:OS Kernel / IMA, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="699.501">PCR 11: OS Components / VSM, Digest,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="711.1416">PCR 22 oder 23 (wenn frei) App Data (ID, Version,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="722.7822">Signature Hash),   Digest</text><line style="stroke:#181818;stroke-width:1;" x1="368.2764" x2="410.2764" y1="752.7813" y2="752.7813"/><line style="stroke:#181818;stroke-width:1;" x1="410.2764" x2="410.2764" y1="752.7813" y2="765.7813"/><line style="stroke:#181818;stroke-width:1;" x1="369.2764" x2="410.2764" y1="765.7813" y2="765.7813"/><polygon fill="#181818" points="379.2764,761.7813,369.2764,765.7813,379.2764,769.7813,375.2764,765.7813" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="375.2764" y="748.4229">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="748.4229">Get TCG Event Log (from OS/Firmware)</text><polygon fill="#181818" points="379.2764,787.4219,369.2764,791.4219,379.2764,795.4219,375.2764,791.4219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="373.2764" x2="698.792" y1="791.4219" y2="791.4219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="385.2764" y="787.0635">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="409.8037" y="787.0635">Return TPM Quote</text><path d="M714.792,778.7813 L714.792,834.7813 L941.792,834.7813 L941.792,788.7813 L931.792,778.7813 L714.792,778.7813" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M931.792,778.7813 L931.792,788.7813 L941.792,788.7813 L931.792,778.7813" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="793.0635">Quote contains:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="804.7041">- `combined_data` (as qualifyingData)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="816.3447">- Attested Data (PCR Select, PCR Digest),</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="827.9854">- Signature</text><polygon fill="#181818" points="78,853.9844,68,857.9844,78,861.9844,74,857.9844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="72" x2="357.2764" y1="857.9844" y2="857.9844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="84" y="853.626">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="108.5273" y="853.626">Return Attestation (Quote, EventLog, CertChain)</text><line style="stroke:#181818;stroke-width:1;" x1="67" x2="109" y1="918.5469" y2="918.5469"/><line style="stroke:#181818;stroke-width:1;" x1="109" x2="109" y1="918.5469" y2="931.5469"/><line style="stroke:#181818;stroke-width:1;" x1="68" x2="109" y1="931.5469" y2="931.5469"/><polygon fill="#181818" points="78,927.5469,68,931.5469,78,935.5469,74,931.5469" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="896.7275">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="879.2666">Create Client Statement JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="890.9072">with posture-tpm,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="902.5479">includes Attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="914.1885">Signed with Client Instance</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="238.2539" y="914.1885">Private</text><text fill="#000000" font-family="Helvetica" font-size="10" x="281.9502" y="914.1885">Key</text><line style="stroke:#181818;stroke-width:1;" x1="67" x2="109" y1="1010.1094" y2="1010.1094"/><line style="stroke:#181818;stroke-width:1;" x1="109" x2="109" y1="1010.1094" y2="1023.1094"/><line style="stroke:#181818;stroke-width:1;" x1="68" x2="109" y1="1023.1094" y2="1023.1094"/><polygon fill="#181818" points="78,1019.1094,68,1023.1094,78,1027.1094,74,1023.1094" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="994.1104">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="982.4697">Create Client Statement JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="994.1104">with posture-software</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="1005.751">Signed with Client Instance Key</text><polygon fill="#181818" points="783.6499,1058.75,793.6499,1062.75,783.6499,1066.75,787.6499,1062.75" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="67" x2="789.6499" y1="1062.75" y2="1062.75"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="1058.3916">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="1058.3916">POST /register (RFC 7591)</text><path d="M72,1075.75 L72,1247.75 L526,1247.75 L526,1085.75 L516,1075.75 L72,1075.75" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M516,1075.75 L516,1085.75 L526,1085.75 L516,1075.75" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="78" y="1090.0322">DCR Request Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="78" y="1101.6729">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1113.3135">"redirect_uris": ["..."],</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1124.9541">"client_name": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1136.5947">"token_endpoint_auth_method": "private_key_jwt",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1148.2354">"grant_types": ["urn:ietf:params:oauth:grant-type:token-exchange","refresh_token"],</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1159.876">"jwks": { "keys": [ &lt;Client_Instance_Public_Key_JWK&gt; ] },</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1171.5166">"nonce": "&lt;nonce&gt;", // From GET /nonce, for replay protection &amp; binding check</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1183.1572">// Custom parameter for attestation:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1194.7979">"urn:gematik:params:oauth:client-attestation-type:tpm2": {</text><text fill="#000000" font-family="Helvetica" font-size="10" x="93.8936" y="1206.4385">"client_statement": "&lt;Base64(Client Statement JWT)&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="93.8936" y="1218.0791">"client_statement_format": "client-statement-jwt"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="87.5361" y="1229.7197">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="78" y="1241.3604">}</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1271.3594" y2="1271.3594"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1271.3594" y2="1284.3594"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1284.3594" y2="1284.3594"/><polygon fill="#181818" points="816.6499,1280.3594,806.6499,1284.3594,816.6499,1288.3594,812.6499,1284.3594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1267.001">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1267.001">Validate nonce (Replay Check)</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1321.6406" y2="1321.6406"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1321.6406" y2="1334.6406"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1334.6406" y2="1334.6406"/><polygon fill="#181818" points="816.6499,1330.6406,806.6499,1334.6406,816.6499,1338.6406,812.6499,1334.6406" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1311.4619">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1305.6416">Validate Client Assertion JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1317.2822">(Signature with Public Key from jwks)</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1371.9219" y2="1371.9219"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1371.9219" y2="1384.9219"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1384.9219" y2="1384.9219"/><polygon fill="#181818" points="816.6499,1380.9219,806.6499,1384.9219,816.6499,1388.9219,812.6499,1384.9219" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1361.7432">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1355.9229">Calculate expected_combined_data</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1367.5635">HASH(nonce + HASH(PublicKeyFromJWKS))</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1410.5625" y2="1410.5625"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1410.5625" y2="1423.5625"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1423.5625" y2="1423.5625"/><polygon fill="#181818" points="816.6499,1419.5625,806.6499,1423.5625,816.6499,1427.5625,812.6499,1423.5625" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1406.2041">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1406.2041">Verify qualifyingData in Quote == expected_combined_data</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1460.8438" y2="1460.8438"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1460.8438" y2="1473.8438"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1473.8438" y2="1473.8438"/><polygon fill="#181818" points="816.6499,1469.8438,806.6499,1473.8438,816.6499,1477.8438,812.6499,1473.8438" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1450.665">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1444.8447">Validate Client Statement JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1456.4854">(Signature with Public Key from jwks)</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1511.125" y2="1511.125"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1511.125" y2="1524.125"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1524.125" y2="1524.125"/><polygon fill="#181818" points="816.6499,1520.125,806.6499,1524.125,816.6499,1528.125,812.6499,1524.125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1500.9463">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1495.126">Extract TPM Quote &amp; Cert Chain</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1506.7666">from Client Statement</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1561.4063" y2="1561.4063"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1561.4063" y2="1574.4063"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1574.4063" y2="1574.4063"/><polygon fill="#181818" points="816.6499,1570.4063,806.6499,1574.4063,816.6499,1578.4063,812.6499,1574.4063" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1551.2275">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1545.4072">Validate TPM Quote Signature</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1557.0479">(using AK Cert Chain / Trusted Roots)</text><path d="M1036.0669,1537.125 L1036.0669,1616.125 L1407.0669,1616.125 L1407.0669,1547.125 L1397.0669,1537.125 L1036.0669,1537.125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1397.0669,1537.125 L1397.0669,1547.125 L1407.0669,1547.125 L1397.0669,1537.125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1042.0669" y="1551.4072">Checks ensure:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1042.0669" y="1563.0479">1. Client owns Private Key.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1042.0669" y="1574.6885">2. TPM Quote is valid &amp; from trusted TPM.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1042.0669" y="1586.3291">3.</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1054.7866" y="1586.3291">Quote was generated for *this specific* Client Key &amp; Nonce.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1042.0669" y="1597.9697">4. Device state (PCRs) is compliant.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1042.0669" y="1609.6104">5. Request is not a replay.</text><path d="M27,1625.9688 L86.9561,1625.9688 L86.9561,1629.6094 L76.9561,1639.6094 L27,1639.6094 L27,1625.9688" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="635.5" style="stroke:#000000;stroke-width:1.5;" width="1439.5679" x="27" y="1625.9688"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="42" y="1636.251">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="101.9561" y="1637.251">[Attestation and Binding valid]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="27" x2="1466.5679" y1="2217.1875" y2="2217.1875"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="32" y="2228.4697">[Attestation or Binding invalid]</text><polygon fill="#181818" points="1130.1509,1674.8906,1140.1509,1678.8906,1130.1509,1682.8906,1134.1509,1678.8906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="1136.1509" y1="1678.8906" y2="1678.8906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1668.7119">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1662.8916">Check if Client</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1674.5322">already exists (by PubKey Hash?)</text><polygon fill="#181818" points="816.6499,1700.5313,806.6499,1704.5313,816.6499,1708.5313,812.6499,1704.5313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="810.6499" x2="1141.1509" y1="1704.5313" y2="1704.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="822.6499" y="1700.1729">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="847.1772" y="1700.1729">&#160;</text><path d="M1157.1509,1717.5313 L1157.1509,1761.5313 L1403.1509,1761.5313 L1403.1509,1727.5313 L1393.1509,1717.5313 L1157.1509,1717.5313" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1393.1509,1717.5313 L1393.1509,1727.5313 L1403.1509,1727.5313 L1393.1509,1717.5313" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="1731.8135">Check if client_id already exists in DB for</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1166.3296" y="1743.4541">Client_Instance_Public_Key_JWK Thumbprint</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1166.3296" y="1755.0947">(or potentially based on AK/EK cert if stable)</text><path d="M46,1771.4531 L105.9561,1771.4531 L105.9561,1775.0938 L95.9561,1785.0938 L46,1785.0938 L46,1771.4531" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="420.7344" style="stroke:#000000;stroke-width:1.5;" width="1395.5679" x="46" y="1771.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="61" y="1781.7354">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="120.9561" y="1782.7354">[Client exists in DB (based on Public Key)]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="46" x2="1441.5679" y1="1831.7344" y2="1831.7344"/><polygon fill="#181818" points="78,1808.7344,68,1812.7344,78,1816.7344,74,1812.7344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="72" x2="794.6499" y1="1812.7344" y2="1812.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="84" y="1808.376">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="108.5273" y="1808.376">409 Conflict (Client with this key already registered)</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1856.375" y2="1856.375"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1856.375" y2="1869.375"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1869.375" y2="1869.375"/><polygon fill="#181818" points="816.6499,1865.375,806.6499,1869.375,816.6499,1873.375,812.6499,1869.375" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1852.0166">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1852.0166">Generate client_id</text><polygon fill="#181818" points="1130.1509,1902.6563,1140.1509,1906.6563,1130.1509,1910.6563,1134.1509,1906.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="1136.1509" y1="1906.6563" y2="1906.6563"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1896.4775">(31)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1890.6572">Store client metadata,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1902.2979">incl. Client Instance Key Thumbprint, Attestation details</text><path d="M1157.1509,1919.6563 L1157.1509,2045.6563 L1420.1509,2045.6563 L1420.1509,1929.6563 L1410.1509,1919.6563 L1157.1509,1919.6563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1410.1509,1919.6563 L1410.1509,1929.6563 L1420.1509,1929.6563 L1410.1509,1919.6563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="1933.9385">Store client metadata in DB:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="1945.5791">- client_id</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="1957.2197">- client_instance_key_thumbprint</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="1968.8604">- attestation_data (PCRs, AK used)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="1980.501">- attestation_key_cert_thumbprint?</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="1992.1416">- redirect_uris</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="2003.7822">- client_name</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="2015.4229">- token_endpoint_auth_method</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="2027.0635">- grant_types</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="2038.7041">- state // Client registered but not yet activated?</text><polygon fill="#181818" points="816.6499,2064.7031,806.6499,2068.7031,816.6499,2072.7031,812.6499,2068.7031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="810.6499" x2="1141.1509" y1="2068.7031" y2="2068.7031"/><text fill="#000000" font-family="Helvetica" font-size="10" x="822.6499" y="2064.3447">(32)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="847.1772" y="2064.3447">201 Created</text><line style="stroke:#181818;stroke-width:1;" x1="68" x2="78" y1="2094.3438" y2="2090.3438"/><line style="stroke:#181818;stroke-width:1;" x1="68" x2="78" y1="2094.3438" y2="2098.3438"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="67" x2="794.6499" y1="2094.3438" y2="2094.3438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="84" y="2089.9854">(33)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="108.5273" y="2089.9854">201 Created</text><path d="M72,2107.3438 L72,2186.3438 L281,2186.3438 L281,2117.3438 L271,2107.3438 L72,2107.3438" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M271,2107.3438 L271,2117.3438 L281,2117.3438 L271,2107.3438" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="78" y="2121.626">DCR Response Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="78" y="2133.2666">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="2144.9072">"client_id": "&lt;generated-client-id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="2156.5479">"client_id_issued_at": ...,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="2168.1885">// ... other metadata</text><text fill="#000000" font-family="Helvetica" font-size="10" x="78" y="2179.8291">}</text><line style="stroke:#181818;stroke-width:1;" x1="68" x2="78" y1="2253.4688" y2="2249.4688"/><line style="stroke:#181818;stroke-width:1;" x1="68" x2="78" y1="2253.4688" y2="2257.4688"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="67" x2="794.6499" y1="2253.4688" y2="2253.4688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="84" y="2249.1104">(34)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="108.5273" y="2249.1104">400 Bad Request (Attestation/Binding failed)</text><!--SRC=[dLZhSjks4lwlfzYZp2IIBCcNEisKawGZouxjsabyB9zaJeywAaH24c8AL47GZjB9s_HD-cBT1K0If6GdStvuB96BlNwx-q4iqudCbbEkeDdQssit6-cja2kcs18YFcDPhDyaKe_45mxxUzjVlcDB3cSylkDQXCoJEROoRnEPf2iMygYG7YQP4bnviZ6NSxqOH9-oL8DC9FVUfVoFZCkGN_CPL_JXY8MtSvLaCXecSQBWuq9e_y2eVg2CuQ2n- -nRWdeTSvWcSTHujjje_6kbs7p9GFFa2sYLyKPZcdo6vkN9UHEUd2wIL5lx0ERvbHBBl_zIwJhLV8aIb-oEomY31N0IlvxS360O2ourlXyn6QsFL78lZGG0keQ952icjPC2bjfJO-cE6L5KImeRzKE_3aR52HXepLFDj4WaXglkHCZ7iZM8baA24lE5JjlD3GqtLs-D1lnFBtD3-N-RW86S2gwvmXXkJePdxzvVlZ_zRyEFyJHZAjeCqRSqoFJ2UdjrV3MMz3LHualfB-hVE8IYnqVv8JW-ydtCitnp3WVzFJZ6T26YdXmpTJlYx5HnlYtFrzQ7QvuYCYb3lkcDy5rLTdOQB2vgj405Ce7GV9k828-wDxtN-QS0JhdaYccUFpb7xvWaYnTy3LTCA6ZD4DBkDUMZZPfaWaTCkG8e14bkfSGTgflSylNaqxq6hErLDer5QCJU_cTq0rC2C_RAMEh4LDQ3HBlYfIt6pWxvUN83kzY78U7QFk-LSVHw0IYkCoNXO6yFtb-0vFSz8nw0FON7A3aFOH3O7HCncyRSfBYUgG26B0wpc3BbnNF6qWL6oFlpVXT6PuE3vp-wSF7jBnylskrlQXicowcGF89Zffb98QPaB7yFtVD9HCzVmTbWTDOoeS0EhB8f6Y3hxTzh5gZPRCQuzWCTotkX5r3LQmyNUQ5YvFbmyAdLXw9sS2L3Q8y4d3s7f9gumOOxGy8zwsG0rxPWldYPsWqZDg0XnnwPuLYdp2sOa8yeVaZMwJIY8vqezFW2AocZc7VfO-d4MEBJ1_HWypKQ6-fup4DTwcjiYu5y_NT63KJLlXfUfz0wxCBpBhpeubB3l_qk71n0WaCQ3dveMozgXOCMrkUFZCLYjXPoJk1fTo4LSuAIgVJWmbWtdHhp6OAkqpaICaBfeDFPq8VmMVpz5oA1K8NhDCrdUp4IlCIaWFqBaU3mZX3P7qiAYgpZ5jKsffswYNxfZviSA0U70HmbYORBX56yGuowYrDoZfWOIn9uNXUGCp7Fb05CLV855I3CiA3cm4XJnNRXAa6lrrLHm4G7xqSOYv8yHg7pjuEgnFv-02Y0xRd2xIzrYa8VHczpeQwLAii4hNik9SmK5sqOh5Qsdrldnrtum5LApk8KnmmnJHwQtksY7rRT1f8CK8QdS7979RXCvZY6LR94btRV2BMyPuhRsU8Xtun11_u2P1j9jz0BaLWWbDDWB7lVWoqIivsQZweMnMy1tpMLj96qkoHQ15e6LftMMvg_PJphsf0nugxfFDDn3uvHnRtTPGg-f4-_VBnnysw5T0ZTwEdL4XqJCempn7PrC8wyhgbZljEviXiDMyQE9HwdV7EDFCldfg2ngR-zJhxRypIPQIhtutuwtsHKMywLLLTOoVDWghzIIPI5H17yRtSMjEQHzOG-ChzU3aC84GSghiD-kz5uQ8TVlSVjlwluN22Aa5TSlnd2Y-S_xLS91IIp_FYJc1vCuuoxqTtf72FGheab8uawIg8rZZBtxa_t7w2fU2GKudA2h3vj1l2_Ph_VR_xMBIKSAv98_l6zUUszrSajbnDCvYeHACKmXCcI8nECIBX6SVo3SuNaRQBNAsxD8iG3vAIpmD3xD4X8LM2aUYGL64iz_ZbSC3ddpIwwZXCaNKpCYuhBd-vlIUcVq4J3HZsyj7cQv2YOs0azGJ1Ca7syXj_WgwV1i0UAuANvzBhPXTrTU4DZfQHNNREL55_5R4rWq9X7glPJcDhb0U62XxU5LjGmn3iIwZ0n4W4t6Zoa1AKBb90vN-BZssfER45wtYcNeDNoWA8kL7ZLItCycvYEMCf_F6njwwZsQwz8snHCq6DqYlGuHufNFIfnUVXhe_nF_5lQ4UiOQGxt03xWz8oemorbQrtRX0ufT-r73-HCEqs9Ts3cpKXebQl3zBz7GirU87HirLioJVvvXRN48L-PzcDPOPRcIq5X2Hi8f55xkyjSuOQeRGgSBMuQl7hrWCdl2Rys4V_ly4y-QyL2dtGzDMl5ChcnDAVhDXzriDHK-8J-PIcr1XA_KZaIXXkLcOLvZNmahT-R31PIH56AAd0Ix_TpH_1YceBREnGZygk3lcSOTymTkOEn6F-rCuCIAFf37-Ua5Rp7HJvtl3moRTdH2poTObc8qdPoYvJ8fuxCTJfZUTY7OsxscMa4i-pJDXd6IgvYWGCCBJtl5xCuNtjkSlJTTSjVFyHY7G6rxfjMAX9jBz5cKPZCWCZt01BW6DTbj4OyuUf0kZnT4mBo6zZFbXvO1RsyPa6D-T1UCIAkWmiZnGqPQcQmXAWGivQt_-FZ5cuMsNAAsq7g_42BRiJeWTI2nV4QfZYZ8i1S32vsJouW9AoW1wWEcKAxkDpBdBTvr_cAJwr2KTa8RMTqut8SmE7UJuOtewI6V4AQFZ9em7rIX9vlPnuvTv3jL1MNBL7S-FpV63Phcj-oh1JWYc0q1HmTws-ZCbugknKCHNXOnAcpyt1nORjDcxvo7_KsNFUVvMMcHQytQWiLDcIlwQPDp2KoI_CCRegIFYgzf_HdJxJ2NZRT8ixYFNsOgtX27Y_ndjhMfWLkirJM7gQPDlsynci8ZaypYQBSoGf4D_hEqFk3lNr7SQCwB4iEl2dq20kSUx-K-LGmnUjPocjSiCe7_PKl38LxMGp5djlt8gfn1E_4HAHfXhlB40IaYbKvp1y-WqGlaFdaGFCalcxBcYNgvYhXmnl7HJuXXToOaMNkyBDfwpquOb4nWrkUgjrSpmpxnKBH_M9HQA3V3nl_0000]--></g></svg>