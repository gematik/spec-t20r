<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2425px" preserveAspectRatio="none" style="width:1497px;height:2425px;background:#FFFFFF;" version="1.1" viewBox="0 0 1497 2425" width="1497px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="2413.5938" style="stroke:#181818;stroke-width:0.5;" width="708.6753" x="17.5" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="363.3757" y="15.2822">LEI</text><rect fill="#E6E6FA" height="2396.9531" style="stroke:#181818;stroke-width:0.5;" width="708.6753" x="17.5" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="332.741" y="31.9229">Prim&#228;rsystem</text><rect fill="#F4A460" height="2380.3125" style="stroke:#181818;stroke-width:0.5;" width="89" x="17.5" y="39.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="29.5" y="48.5635">ZETA Client</text><rect fill="#C9FFC9" height="2413.5938" style="stroke:#181818;stroke-width:0.5;" width="549.7891" x="738.1753" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="988.7095" y="15.2822">Anbieter</text><rect fill="#F4A460" height="2396.9531" style="stroke:#181818;stroke-width:0.5;" width="438.7256" x="738.1753" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="924.3936" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="2396.9531" style="stroke:#181818;stroke-width:0.5;" width="99.0635" x="1188.9009" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1200.9009" y="31.9229">TI 2.0 Dienst</text><g><title>ZETA</title><rect fill="#000000" fill-opacity="0.00000" height="2282.1094" width="8" x="58.5" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="62" x2="62" y1="93.2031" y2="2375.3125"/></g><g><title/><rect fill="#FFFFFF" height="2255.1094" style="stroke:#181818;stroke-width:1;" width="10" x="57" y="101.2031"/></g><g><title>ZETA Attestation Service</title><rect fill="#000000" fill-opacity="0.00000" height="2282.1094" width="8" x="359.7764" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="363.2764" x2="363.2764" y1="93.2031" y2="2375.3125"/></g><g><title/><rect fill="#FFFFFF" height="541.2969" style="stroke:#181818;stroke-width:1;" width="10" x="358.2764" y="392.5313"/></g><g><title>TPM</title><rect fill="#000000" fill-opacity="0.00000" height="2282.1094" width="8" x="701.292" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="704.792" x2="704.792" y1="93.2031" y2="2375.3125"/></g><g><title/><rect fill="#FFFFFF" height="345.6094" style="stroke:#181818;stroke-width:1;" width="10" x="699.792" y="521.6563"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="2282.1094" width="8" x="797.1499" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="800.6499" x2="800.6499" y1="93.2031" y2="2375.3125"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="795.6499" y="201.4063"/></g><g><title/><rect fill="#FFFFFF" height="1190.7188" style="stroke:#181818;stroke-width:1;" width="10" x="795.6499" y="1138.5938"/></g><g><title>PDP DB</title><rect fill="#000000" fill-opacity="0.00000" height="2282.1094" width="8" x="1143.6509" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1147.1509" x2="1147.1509" y1="93.2031" y2="2375.3125"/></g><g><title/><rect fill="#FFFFFF" height="389.8125" style="stroke:#181818;stroke-width:1;" width="10" x="1142.1509" y="1754.7344"/></g><g><title>Resource</title><rect fill="#000000" fill-opacity="0.00000" height="2282.1094" width="8" x="1234.9326" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1238.4326" x2="1238.4326" y1="93.2031" y2="2375.3125"/></g><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="40.5249" y="54.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.9409" y="71.2041">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="47.5249" y="82.8447">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.6826" x="293.9351" y="54.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="300.9351" y="71.2041">ZETA Attestation Service</text><text fill="#000000" font-family="Helvetica" font-size="10" x="327.4097" y="82.8447">(Admin rights)</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="687.4087" y="66.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="694.4087" y="82.8447">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="742.1753" y="54.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="790.7695" y="71.2041">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="749.1753" y="82.8447">Authorization Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.5" x="1121.4009" y="66.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1128.4009" y="82.8447">PDP DB</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60.5283" x="1208.1685" y="54.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1215.1685" y="71.2041">Resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1222.0361" y="82.8447">Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="40.5249" y="2375.3125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.9409" y="2391.5947">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="47.5249" y="2403.2354">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.6826" x="293.9351" y="2375.3125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="300.9351" y="2391.5947">ZETA Attestation Service</text><text fill="#000000" font-family="Helvetica" font-size="10" x="327.4097" y="2403.2354">(Admin rights)</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="687.4087" y="2375.3125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="694.4087" y="2391.5947">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="742.1753" y="2375.3125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="790.7695" y="2391.5947">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="749.1753" y="2403.2354">Authorization Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.5" x="1121.4009" y="2375.3125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1128.4009" y="2391.5947">PDP DB</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="60.5283" x="1208.1685" y="2375.3125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1215.1685" y="2391.5947">Resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1222.0361" y="2403.2354">Server</text><path d="M8,105.2031 L67.9561,105.2031 L67.9561,108.8438 L57.9561,118.8438 L8,118.8438 L8,105.2031" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2246.1094" style="stroke:#000000;stroke-width:1.5;" width="1483.5679" x="8" y="105.2031"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="23" y="115.4854">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="82.9561" y="116.4854">[Client has no client_id]</text><line style="stroke:#181818;stroke-width:1;" x1="67" x2="109" y1="158.125" y2="158.125"/><line style="stroke:#181818;stroke-width:1;" x1="109" x2="109" y1="158.125" y2="171.125"/><line style="stroke:#181818;stroke-width:1;" x1="68" x2="109" y1="171.125" y2="171.125"/><polygon fill="#181818" points="78,167.125,68,171.125,78,175.125,74,171.125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="147.9463">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="142.126">Generate Client Instance</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="153.7666">Key Pair (for Client Auth)</text><path d="M235.0732,133.8438 L235.0732,177.8438 L398.0732,177.8438 L398.0732,143.8438 L388.0732,133.8438 L235.0732,133.8438" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M388.0732,133.8438 L388.0732,143.8438 L398.0732,143.8438 L388.0732,133.8438" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="241.0732" y="148.126">Key Pair for private_key_jwt</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.0732" y="159.7666">(Public Key MUST be bound</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.0732" y="171.4072">to TPM Attestation)</text><polygon fill="#181818" points="783.6499,197.4063,793.6499,201.4063,783.6499,205.4063,787.6499,201.4063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="67" x2="789.6499" y1="201.4063" y2="201.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="197.0479">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="197.0479">GET /nonce</text><polygon fill="#181818" points="78,223.0469,68,227.0469,78,231.0469,74,227.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="72" x2="794.6499" y1="227.0469" y2="227.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="84" y="222.6885">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="108.5273" y="222.6885">return 200 OK new-nonce: nonce</text><path d="M46,239.0469 L105.9561,239.0469 L105.9561,242.6875 L95.9561,252.6875 L46,252.6875 L46,239.0469" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="867.9063" style="stroke:#000000;stroke-width:1.5;" width="956.1484" x="46" y="239.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="61" y="249.3291">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="120.9561" y="250.3291">[ZETA Attestation Service available]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="46" x2="1002.1484" y1="1026.3906" y2="1026.3906"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="51" y="1037.6729">[ZETA Attestation 'Service is not available]</text><line style="stroke:#181818;stroke-width:1;" x1="67" x2="109" y1="291.9688" y2="291.9688"/><line style="stroke:#181818;stroke-width:1;" x1="109" x2="109" y1="291.9688" y2="304.9688"/><line style="stroke:#181818;stroke-width:1;" x1="68" x2="109" y1="304.9688" y2="304.9688"/><polygon fill="#181818" points="78,300.9688,68,304.9688,78,308.9688,74,304.9688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="281.79">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="275.9697">Calculate Public Key Hash</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="287.6104">(e.g., SHA256(PublicKeyJWK))</text><line style="stroke:#181818;stroke-width:1;" x1="67" x2="109" y1="342.25" y2="342.25"/><line style="stroke:#181818;stroke-width:1;" x1="109" x2="109" y1="342.25" y2="355.25"/><line style="stroke:#181818;stroke-width:1;" x1="68" x2="109" y1="355.25" y2="355.25"/><polygon fill="#181818" points="78,351.25,68,355.25,78,359.25,74,355.25" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="332.0713">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="326.251">Calculate Combined Data for TPM</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="337.8916">`combined_data = HASH(nonce + pubKeyHash)`</text><polygon fill="#181818" points="346.2764,388.5313,356.2764,392.5313,346.2764,396.5313,350.2764,392.5313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="67" x2="352.2764" y1="392.5313" y2="392.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="382.3525">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="376.5322">Get Attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="388.1729">with `combined_data`</text><path d="M373.2764,368.25 L373.2764,471.25 L861.2764,471.25 L861.2764,378.25 L851.2764,368.25 L373.2764,368.25" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M851.2764,368.25 L851.2764,378.25 L861.2764,378.25 L851.2764,368.25" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="379.2764" y="382.5322">The Prim&#228;rsystem and the ZETA Attestation Service are in the same trust domain.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="379.2764" y="394.1729">At the time of client installation, the ZETA Attestation Service computes a</text><text fill="#000000" font-family="Helvetica" font-size="10" x="379.2764" y="405.8135">cryptographic hash of the Prim&#228;rsystem software and extends this hash into a specific</text><text fill="#000000" font-family="Helvetica" font-size="10" x="379.2764" y="417.4541">PCR (22 or 23) using TPM2_PCR_Extend. The ZETA Attestation Service reads</text><text fill="#000000" font-family="Helvetica" font-size="10" x="379.2764" y="429.0947">and stores the resulting PCR value as a reference measurement or baseline.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="379.2764" y="440.7354">At every boot of the Prim&#228;rsystem, the ZETA Attestation Service measures the Prim&#228;rsystem</text><text fill="#000000" font-family="Helvetica" font-size="10" x="379.2764" y="452.376">software and extends the resulting hash into the same PCR (22 or 23) using</text><text fill="#000000" font-family="Helvetica" font-size="10" x="379.2764" y="464.0166">TPM2_PCR_Extend.</text><path d="M347.2764,480.375 L407.2324,480.375 L407.2324,484.0156 L397.2324,494.0156 L347.2764,494.0156 L347.2764,480.375" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="176.4844" style="stroke:#000000;stroke-width:1.5;" width="378.5156" x="347.2764" y="480.375"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="362.2764" y="490.6572">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="422.2324" y="491.6572">[ZETA TPM Service has no TPM Attestation Key]</text><polygon fill="#181818" points="687.792,517.6563,697.792,521.6563,687.792,525.6563,691.792,521.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="368.2764" x2="693.792" y1="521.6563" y2="521.6563"/><text fill="#000000" font-family="Helvetica" font-size="10" x="375.2764" y="517.2979">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="517.2979">Generate Attestation Key Pair</text><polygon fill="#181818" points="379.2764,543.2969,369.2764,547.2969,379.2764,551.2969,375.2764,547.2969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="373.2764" x2="698.792" y1="547.2969" y2="547.2969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="385.2764" y="542.9385">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="409.8037" y="542.9385">Return Attestation Public Key</text><polygon fill="#181818" points="687.792,568.9375,697.792,572.9375,687.792,576.9375,691.792,572.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="368.2764" x2="693.792" y1="572.9375" y2="572.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="375.2764" y="568.5791">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="568.5791">Get Certificate Chain</text><polygon fill="#181818" points="379.2764,594.5781,369.2764,598.5781,379.2764,602.5781,375.2764,598.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="373.2764" x2="698.792" y1="598.5781" y2="598.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" x="385.2764" y="594.2197">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="409.8037" y="594.2197">Return Certificate Chain</text><line style="stroke:#181818;stroke-width:1;" x1="368.2764" x2="410.2764" y1="635.8594" y2="635.8594"/><line style="stroke:#181818;stroke-width:1;" x1="410.2764" x2="410.2764" y1="635.8594" y2="648.8594"/><line style="stroke:#181818;stroke-width:1;" x1="369.2764" x2="410.2764" y1="648.8594" y2="648.8594"/><polygon fill="#181818" points="379.2764,644.8594,369.2764,648.8594,379.2764,652.8594,375.2764,648.8594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="375.2764" y="625.6807">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="619.8604">Store AK Handle, AK Public Key</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="631.501">and Certificate Chain</text><line style="stroke:#181818;stroke-width:1;" x1="368.2764" x2="410.2764" y1="688.5" y2="688.5"/><line style="stroke:#181818;stroke-width:1;" x1="410.2764" x2="410.2764" y1="688.5" y2="701.5"/><line style="stroke:#181818;stroke-width:1;" x1="369.2764" x2="410.2764" y1="701.5" y2="701.5"/><polygon fill="#181818" points="379.2764,697.5,369.2764,701.5,379.2764,705.5,375.2764,701.5" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="375.2764" y="684.1416">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="684.1416">Select AK Handle</text><polygon fill="#181818" points="687.792,734.7813,697.792,738.7813,687.792,742.7813,691.792,738.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="368.2764" x2="693.792" y1="738.7813" y2="738.7813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="375.2764" y="728.6025">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="722.7822">Get TPM Quote for PCRs (4, 5, 7, 10, 11, 22 or 23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="734.4229">and `combined_data` (as qualifyingData), signed with AK</text><path d="M112.2031,714.5 L112.2031,758.5 L358.2031,758.5 L358.2031,724.5 L348.2031,714.5 L112.2031,714.5" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M348.2031,714.5 L348.2031,724.5 L358.2031,724.5 L348.2031,714.5" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="118.2031" y="728.7822">Binding:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="168.4131" y="728.7822">`combined_data` enth&#228;lt Hash des</text><text fill="#000000" font-family="Helvetica" font-size="10" x="118.2031" y="740.4229">Client Instance Public Keys und die Nonce.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="118.2031" y="752.0635">TPM signiert PCRs + `combined_data`.</text><path d="M714.792,714.5 L714.792,805.5 L980.792,805.5 L980.792,724.5 L970.792,714.5 L714.792,714.5" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M970.792,714.5 L970.792,724.5 L980.792,724.5 L970.792,714.5" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="728.7822">PCR 4: Boot Loader Code, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="740.4229">PCR 5: Boot Loader Configuration, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="752.0635">PCR 7: Secure Boot State / Policy, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="763.7041">PCR   10:OS Kernel / IMA, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="775.3447">PCR 11: OS Components / VSM, Digest,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="786.9854">PCR 22 or 23 (if available) App Data (ID, Version,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="798.626">Signature Hash),   Digest</text><line style="stroke:#181818;stroke-width:1;" x1="368.2764" x2="410.2764" y1="828.625" y2="828.625"/><line style="stroke:#181818;stroke-width:1;" x1="410.2764" x2="410.2764" y1="828.625" y2="841.625"/><line style="stroke:#181818;stroke-width:1;" x1="369.2764" x2="410.2764" y1="841.625" y2="841.625"/><polygon fill="#181818" points="379.2764,837.625,369.2764,841.625,379.2764,845.625,375.2764,841.625" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="375.2764" y="824.2666">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="399.8037" y="824.2666">Get TCG Event Log (from OS/Firmware)</text><polygon fill="#181818" points="379.2764,863.2656,369.2764,867.2656,379.2764,871.2656,375.2764,867.2656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="373.2764" x2="698.792" y1="867.2656" y2="867.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="385.2764" y="862.9072">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="409.8037" y="862.9072">Return TPM Quote</text><path d="M714.792,854.625 L714.792,910.625 L941.792,910.625 L941.792,864.625 L931.792,854.625 L714.792,854.625" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M931.792,854.625 L931.792,864.625 L941.792,864.625 L931.792,854.625" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="868.9072">Quote contains:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="880.5479">- `combined_data` (as qualifyingData)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="892.1885">- Attested Data (PCR Select, PCR Digest),</text><text fill="#000000" font-family="Helvetica" font-size="10" x="720.792" y="903.8291">- Signature</text><polygon fill="#181818" points="78,929.8281,68,933.8281,78,937.8281,74,933.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="72" x2="357.2764" y1="933.8281" y2="933.8281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="84" y="929.4697">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="108.5273" y="929.4697">Return Attestation (Quote, EventLog, CertChain)</text><line style="stroke:#181818;stroke-width:1;" x1="67" x2="109" y1="994.3906" y2="994.3906"/><line style="stroke:#181818;stroke-width:1;" x1="109" x2="109" y1="994.3906" y2="1007.3906"/><line style="stroke:#181818;stroke-width:1;" x1="68" x2="109" y1="1007.3906" y2="1007.3906"/><polygon fill="#181818" points="78,1003.3906,68,1007.3906,78,1011.3906,74,1007.3906" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="972.5713">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="955.1104">Create Client Statement JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="966.751">with posture-tpm,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="978.3916">includes Attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="990.0322">Signed with Client Instance Key</text><line style="stroke:#181818;stroke-width:1;" x1="67" x2="109" y1="1085.9531" y2="1085.9531"/><line style="stroke:#181818;stroke-width:1;" x1="109" x2="109" y1="1085.9531" y2="1098.9531"/><line style="stroke:#181818;stroke-width:1;" x1="68" x2="109" y1="1098.9531" y2="1098.9531"/><polygon fill="#181818" points="78,1094.9531,68,1098.9531,78,1102.9531,74,1098.9531" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="1069.9541">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="1058.3135">Create Client Statement JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="1069.9541">with posture-software</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="1081.5947">Signed with Client Instance Key</text><polygon fill="#181818" points="783.6499,1134.5938,793.6499,1138.5938,783.6499,1142.5938,787.6499,1138.5938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="67" x2="789.6499" y1="1138.5938" y2="1138.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="74" y="1134.2354">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="98.5273" y="1134.2354">POST /register (RFC 7591)</text><path d="M72,1151.5938 L72,1323.5938 L526,1323.5938 L526,1161.5938 L516,1151.5938 L72,1151.5938" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M516,1151.5938 L516,1161.5938 L526,1161.5938 L516,1151.5938" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="78" y="1165.876">DCR Request Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="78" y="1177.5166">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1189.1572">"redirect_uris": ["..."],</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1200.7979">"client_name": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1212.4385">"token_endpoint_auth_method": "private_key_jwt",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1224.0791">"grant_types": ["urn:ietf:params:oauth:grant-type:token-exchange","refresh_token"],</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1235.7197">"jwks": { "keys": [ &lt;Client_Instance_Public_Key_JWK&gt; ] },</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1247.3604">"nonce": "&lt;nonce&gt;", // From GET /nonce, for replay protection &amp; binding check</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1259.001">// Custom parameter for attestation:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="1270.6416">"urn:gematik:params:oauth:client-attestation-type:tpm2": {</text><text fill="#000000" font-family="Helvetica" font-size="10" x="93.8936" y="1282.2822">"client_statement": "&lt;Base64(Client Statement JWT)&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="93.8936" y="1293.9229">"client_statement_format": "client-statement-jwt"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="87.5361" y="1305.5635">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="78" y="1317.2041">}</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1347.2031" y2="1347.2031"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1347.2031" y2="1360.2031"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1360.2031" y2="1360.2031"/><polygon fill="#181818" points="816.6499,1356.2031,806.6499,1360.2031,816.6499,1364.2031,812.6499,1360.2031" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1342.8447">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1342.8447">Validate nonce (Replay Check)</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1397.4844" y2="1397.4844"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1397.4844" y2="1410.4844"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1410.4844" y2="1410.4844"/><polygon fill="#181818" points="816.6499,1406.4844,806.6499,1410.4844,816.6499,1414.4844,812.6499,1410.4844" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1387.3057">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1381.4854">Validate Client Assertion JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1393.126">(Signature with Public Key from jwks)</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1447.7656" y2="1447.7656"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1447.7656" y2="1460.7656"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1460.7656" y2="1460.7656"/><polygon fill="#181818" points="816.6499,1456.7656,806.6499,1460.7656,816.6499,1464.7656,812.6499,1460.7656" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1437.5869">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1431.7666">Calculate expected_combined_data</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1443.4072">HASH(nonce + HASH(PublicKeyFromJWKS))</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1486.4063" y2="1486.4063"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1486.4063" y2="1499.4063"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1499.4063" y2="1499.4063"/><polygon fill="#181818" points="816.6499,1495.4063,806.6499,1499.4063,816.6499,1503.4063,812.6499,1499.4063" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1482.0479">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1482.0479">Verify qualifyingData in Quote == expected_combined_data</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1536.6875" y2="1536.6875"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1536.6875" y2="1549.6875"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1549.6875" y2="1549.6875"/><polygon fill="#181818" points="816.6499,1545.6875,806.6499,1549.6875,816.6499,1553.6875,812.6499,1549.6875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1526.5088">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1520.6885">Validate Client Statement JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1532.3291">(Signature with Public Key from jwks)</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1586.9688" y2="1586.9688"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1586.9688" y2="1599.9688"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1599.9688" y2="1599.9688"/><polygon fill="#181818" points="816.6499,1595.9688,806.6499,1599.9688,816.6499,1603.9688,812.6499,1599.9688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1576.79">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1570.9697">Extract TPM Quote &amp; Cert Chain</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1582.6104">from Client Statement</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1637.25" y2="1637.25"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1637.25" y2="1650.25"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1650.25" y2="1650.25"/><polygon fill="#181818" points="816.6499,1646.25,806.6499,1650.25,816.6499,1654.25,812.6499,1650.25" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1627.0713">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1621.251">Validate TPM Quote Signature</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1632.8916">(using AK Cert Chain / Trusted Roots)</text><path d="M1036.0669,1612.9688 L1036.0669,1691.9688 L1407.0669,1691.9688 L1407.0669,1622.9688 L1397.0669,1612.9688 L1036.0669,1612.9688" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1397.0669,1612.9688 L1397.0669,1622.9688 L1407.0669,1622.9688 L1397.0669,1612.9688" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1042.0669" y="1627.251">Checks ensure:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1042.0669" y="1638.8916">1. Client owns Private Key.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1042.0669" y="1650.5322">2. TPM Quote is valid &amp; from trusted TPM.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1042.0669" y="1662.1729">3.</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1054.7866" y="1662.1729">Quote was generated for *this specific* Client Key &amp; Nonce.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1042.0669" y="1673.8135">4. Device state (PCRs) is compliant.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1042.0669" y="1685.4541">5. Request is not a replay.</text><path d="M27,1701.8125 L86.9561,1701.8125 L86.9561,1705.4531 L76.9561,1715.4531 L27,1715.4531 L27,1701.8125" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="635.5" style="stroke:#000000;stroke-width:1.5;" width="1439.5679" x="27" y="1701.8125"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="42" y="1712.0947">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="101.9561" y="1713.0947">[Attestation and Binding valid]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="27" x2="1466.5679" y1="2293.0313" y2="2293.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="32" y="2304.3135">[Attestation or Binding invalid]</text><polygon fill="#181818" points="1130.1509,1750.7344,1140.1509,1754.7344,1130.1509,1758.7344,1134.1509,1754.7344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="1136.1509" y1="1754.7344" y2="1754.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1744.5557">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1738.7354">Check if Client</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1750.376">already exists (by PubKey Hash?)</text><polygon fill="#181818" points="816.6499,1776.375,806.6499,1780.375,816.6499,1784.375,812.6499,1780.375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="810.6499" x2="1141.1509" y1="1780.375" y2="1780.375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="822.6499" y="1776.0166">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="847.1772" y="1776.0166">&#160;</text><path d="M1157.1509,1793.375 L1157.1509,1837.375 L1403.1509,1837.375 L1403.1509,1803.375 L1393.1509,1793.375 L1157.1509,1793.375" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1393.1509,1793.375 L1393.1509,1803.375 L1403.1509,1803.375 L1393.1509,1793.375" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="1807.6572">Check if client_id already exists in DB for</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1166.3296" y="1819.2979">Client_Instance_Public_Key_JWK Thumbprint</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1166.3296" y="1830.9385">(or potentially based on AK/EK cert if stable)</text><path d="M46,1847.2969 L105.9561,1847.2969 L105.9561,1850.9375 L95.9561,1860.9375 L46,1860.9375 L46,1847.2969" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="420.7344" style="stroke:#000000;stroke-width:1.5;" width="1395.5679" x="46" y="1847.2969"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="61" y="1857.5791">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="120.9561" y="1858.5791">[Client exists in DB (based on Public Key)]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="46" x2="1441.5679" y1="1907.5781" y2="1907.5781"/><polygon fill="#181818" points="78,1884.5781,68,1888.5781,78,1892.5781,74,1888.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="72" x2="794.6499" y1="1888.5781" y2="1888.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" x="84" y="1884.2197">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="108.5273" y="1884.2197">409 Conflict (Client with this key already registered)</text><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="847.6499" y1="1932.2188" y2="1932.2188"/><line style="stroke:#181818;stroke-width:1;" x1="847.6499" x2="847.6499" y1="1932.2188" y2="1945.2188"/><line style="stroke:#181818;stroke-width:1;" x1="806.6499" x2="847.6499" y1="1945.2188" y2="1945.2188"/><polygon fill="#181818" points="816.6499,1941.2188,806.6499,1945.2188,816.6499,1949.2188,812.6499,1945.2188" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1927.8604">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1927.8604">Generate client_id</text><polygon fill="#181818" points="1130.1509,1978.5,1140.1509,1982.5,1130.1509,1986.5,1134.1509,1982.5" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="805.6499" x2="1136.1509" y1="1982.5" y2="1982.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.6499" y="1972.3213">(31)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1966.501">Store client metadata,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="837.1772" y="1978.1416">incl. Client Instance Key Thumbprint, Attestation details</text><path d="M1157.1509,1995.5 L1157.1509,2121.5 L1420.1509,2121.5 L1420.1509,2005.5 L1410.1509,1995.5 L1157.1509,1995.5" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1410.1509,1995.5 L1410.1509,2005.5 L1420.1509,2005.5 L1410.1509,1995.5" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="2009.7822">Store client metadata in DB:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="2021.4229">- client_id</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="2033.0635">- client_instance_key_thumbprint</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="2044.7041">- attestation_data (PCRs, AK used)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="2056.3447">- attestation_key_cert_thumbprint?</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="2067.9854">- redirect_uris</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="2079.626">- client_name</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="2091.2666">- token_endpoint_auth_method</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="2102.9072">- grant_types</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1163.1509" y="2114.5479">- state // Client registered but not yet activated?</text><polygon fill="#181818" points="816.6499,2140.5469,806.6499,2144.5469,816.6499,2148.5469,812.6499,2144.5469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="810.6499" x2="1141.1509" y1="2144.5469" y2="2144.5469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="822.6499" y="2140.1885">(32)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="847.1772" y="2140.1885">201 Created</text><line style="stroke:#181818;stroke-width:1;" x1="68" x2="78" y1="2170.1875" y2="2166.1875"/><line style="stroke:#181818;stroke-width:1;" x1="68" x2="78" y1="2170.1875" y2="2174.1875"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="67" x2="794.6499" y1="2170.1875" y2="2170.1875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="84" y="2165.8291">(33)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="108.5273" y="2165.8291">201 Created</text><path d="M72,2183.1875 L72,2262.1875 L281,2262.1875 L281,2193.1875 L271,2183.1875 L72,2183.1875" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M271,2183.1875 L271,2193.1875 L281,2193.1875 L271,2183.1875" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="78" y="2197.4697">DCR Response Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="78" y="2209.1104">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="2220.751">"client_id": "&lt;generated-client-id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="2232.3916">"client_id_issued_at": ...,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.3574" y="2244.0322">// ... other metadata</text><text fill="#000000" font-family="Helvetica" font-size="10" x="78" y="2255.6729">}</text><line style="stroke:#181818;stroke-width:1;" x1="68" x2="78" y1="2329.3125" y2="2325.3125"/><line style="stroke:#181818;stroke-width:1;" x1="68" x2="78" y1="2329.3125" y2="2333.3125"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="67" x2="794.6499" y1="2329.3125" y2="2329.3125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="84" y="2324.9541">(34)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="108.5273" y="2324.9541">400 Bad Request (Attestation/Binding failed)</text><!--SRC=[dLZhSjks4lwlfzZZp2IIBScN9irKawGZouwTEXSVooUPqwEE2f6GX9W2LHAqetJoDdsJlbY_1NY1A3d9d1yUqSHYiPTlTpzGP2RMsM8Y4zff7XoqTXhfZT9BaOW5XN8giiYyZBKPgi-I3W-sBxuL2qddChgLHWN2apbnCczY7QTB4SYmb1x4MQ9auib6Ki_Cl1z-p593EjRIMqlb7vdKWRoIKvdmmx48RcP9dEbm44TnGX_colWRXlKDbGz7ZVr7tn8qgqZI98x2ngFzHkDVoqJC5eACZ3-JIJBPQ4pYJxJp-lJL3ZqucyUfSUSJsVUNYLhy_LUIhb8Z5v1uBMwb3k4iKIxnw-brdmQHajfWVIXqk3fEuZjj9OXW6WAfbaARN8f4wdQDTBxDYa8jAspKD_tQ7vOxg6-CJ8qmAjPmDxbLWHpfPZzSA4s9cirDsjhPq71z-SPgm2yl5WSLlou0VJrHqiW4FboV3ixVldlzxko_3T_7iqmauQQB_adzpCoTjPSdboFD_yQ9-bpP2_qRco1wSbniefDZtyOYojUlwAXxG2S85n3ru4GaDqCfpX8fjyNvojbm9LCWaoFa7xtXVfwLlRs6YCeSpQ50nnJO_yOgnDPyfVEYUEhHcTGo4KOMRrx1Eg7vn0kveakX4cfE0UbycUFHWYOTOujDLuzAGPPR9keMwiOtSZN-U6S8kRtC9f4AhDYR_molQS9WHgsCj8bjPZr8jDQiTCdOssCxJwzf7tKOCAxT-qxbHwVJeqIQBD5qT710xov8oxkE5U-HsuLj79pxC4ZYLgX8J29fGroFL8y68WgoY2Fb-NCkqZaybDrPjqt3y_xHanzpTx7wouUBLkkRsWRnOgAq3Eb46653Y92CzEz1_duSylldTDuVdZUjAxH7oso20_Zqrk-r4xZONCIayHqTwJjbvhIkrsqkuyB9AEAHmwUM7_OwXwiFWUivmkBt6KA5aS7R- -ETI4B9iqpABHYT37KHnWkXT1U5P-oIKLYAfpcAiG5geiXgQdzTF_nSPdXDOgI3PBKqyImHopaI1y_chDDi69t6KtF7Xh7ryfD1WQKGKwdRenYmWjAb3DHK1IDzERYYvj4H8Mb7FxGeIvMUSSIEnbWPdre5NHkSUyrCf0ZJaUO3KnCdChLcuHU3YhNn4RSYoYJt0u65V33GGeeqI-I2muBp9oAL4VBgGYVHArQeijXiTVGReSjLfviRH_gU4FacLx4gaxijK2DTZrGEB4OmWCp8ou6SjwWQ3ctJoVUmSCUXlqTNhXFuubNDRXpYAcKWqNoHL5kISs3mAuhlayrrMj4X9vFw5sWHEenacnyh8rp2j-j191gD3NKoae6fz3Ms-S2s_ZlZikGsWi2cr7pSfYTjUje6MyBVOPlAB3WRQls0ce3P7vc8r7I5775FQhKfLJFkKBQ1z2yQPVL7SehYtzqzLZg4T6ztTqCVu3d_-oyq66vMO6bfGHdAIUE59IMC1GgLfBVSwBeM8lPqa3FZFDgh7z5jrBiHe-rnZuuP_gzZ0Qw3BXiY1oTg1aIukdrI5z1JDSkIlBNuaayv_04AmcqO6ixNFbt6i7grBae8S-_T4BuaMaOGUlMclovnUDWZ2A3hBq4gjKaXz7xufX1gEwaYITHKqseojQY_NBevqNnrqgRtCadPMh03X4WODj7EX3OCSVesW6HnCZYZqrlEmUjuXl6Un0lOjFzI9GikRJUpFE3RyPfZlyJOHjGTyW8GLY0vxOrqvtl0nMAkK8iHsEG0EBotRIgT9wqsYvQELewjiu0jjT-qbhMTo_2uRGlF5jozunbjkU94DkEsqVxouJgVeqlGR9ZHCSi535CwY3A0UttW3hsogOFUTI8PfLlwyAEY4IiUmURRrEIxhIswztVPfiCQqLkR5UKfXUysuyia3hE0wQR_twq3gdtbBE57uUSenmtF3mSaQO9kgz6uZmzUlWEJt4_aJ04vuAXNBmVqzCbFX-labATVllr1n2yccAHvjzxTFG6uhlZ61U9n78ShzAzyxS_ybsWdaQ5AWCKnReZfJe_-jzFjTdT-QrSIESFM67HOjylUgeblf1uZcCiOCt4iuC9u8N6h25cuHfVzZQ0ha3UhfNJ70jOzt6-cFNjLJ7ing-fPgGvBzUn97Vafc0izapjjc3x5L9wFxSAQoH_lRbZfdxI3WwrwUkRYD2vGC7PjUGmmZC5aNz1lzCNJO9aeU_3CFhtOQTF-FhtaLb9HzROTH8bSHcB5O3288sVx8KtSnA1WBeERKYiq3C02eSFwo9Svgy53IgyoWGCoamkylbcFYKj8nzkL1sYvE6AlInLUzj82pzQdOx2f7nytjrLKwuMNf6qAnh0OHh6Ut91ogSCfhZP_QLI_V9VJhgtcjvi2xZrwZuuPSeKx-j-ySW4TSEnQNzrGtDhIbAa68czRGhCQ5xR-lGkDdGMCZgrwgrkB_0GIZ9OzNklm8xrsIx7_bDSXnWQ0D6njDracc0grwS0N1DSDdZ-_vyZlSR_M4Vzlzq5J4n7uFEkX7IMEl8sqtLq_ywi6LffAcs2VkqU0wrNAmHAk-OA4bdq54fBMx-0M2obGnCGTdVYmMnWIt-cKIJot6VOHfEgewnsC6NFBvi0NQx_9Zu44H7_eeaywmJiCxrbEnKDRbhlsQbHSXtQB4pcG3tC6jxixqe-xT2BjFBE5O0TyskA3-OuMAJGmdFIaM_RYOkpbdQERNztzySFKDMUTpdnRIcMWtGSPEoXiP4WLSm2iD-8xrmfumkW0Gvwi6075RVvdHmcSWawHirwDxV1SiI9v1PU7b5zRg7OCKWY5Y5fH_bzljxWqPei9feCsnOOcVrs11TeeN85NziON4cBHlzW_lQ20iG8Be8wfOlcXI1TSpViqj6PJirHK5K8hFtJZGqkF7X_yPCao90qL7TBMaKK3vadfUZ6TPPYR0xQphhWgYVAIvt-lsinfSR7AlmTWH0Zk0Za5wswZCbuessiO2h5PHUd6vunwScdxcIvyrJpgR9ZklolIp8FUREIMrjYG- -HZoyJU6xEqYE2cAElZr7jAV_P4rzZBfbdCMRotztCLJyZZ9TvRLzeym5sKgjpJ93EsdbUuUg1zsauK5aQkGNIZxYobFpeup2bkM8TbnO4tXRx20cVULrUV2gQuawMonWNN-Q0_yfMbSC_AfjZ9vxqAQnp1sp5MQPfXTbc20AguBeVuuHt5PWxcKm3Da_YoBMgEgDkhX0zlj8kYGogzqIEhsE7PblK17OkmxC5DJzL-eMUAUd5Gp3zIb1huMtJZ7m00]--></g></svg>