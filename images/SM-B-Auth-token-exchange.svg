<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="3030px" preserveAspectRatio="none" style="width:1556px;height:3030px;background:#FFFFFF;" version="1.1" viewBox="0 0 1556 3030" width="1556px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="3018.6719" style="stroke:#181818;stroke-width:0.5;" width="685.0078" x="150.1621" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="484.2041" y="15.2822">LEI</text><rect fill="#E6E6FA" height="3002.0313" style="stroke:#181818;stroke-width:0.5;" width="468.9233" x="150.1621" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="345.5271" y="31.9229">Prim&#228;rsystem</text><rect fill="#F4A460" height="2985.3906" style="stroke:#181818;stroke-width:0.5;" width="89" x="150.1621" y="39.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="162.1621" y="48.5635">ZETA Client</text><rect fill="#C9FFC9" height="3018.6719" style="stroke:#181818;stroke-width:0.5;" width="667.1343" x="847.1699" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1156.3767" y="15.2822">Anbieter</text><rect fill="#F4A460" height="3002.0313" style="stroke:#181818;stroke-width:0.5;" width="550.6343" x="847.1699" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1089.3425" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="3002.0313" style="stroke:#181818;stroke-width:0.5;" width="104.5" x="1409.8042" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1424.5225" y="31.9229">TI 2.0 Dienst</text><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="2820.4688" width="8" x="39.5" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="43" x2="43" y1="126.5625" y2="2947.0313"/></g><g><title>ZETA</title><rect fill="#000000" fill-opacity="0.00000" height="2820.4688" width="8" x="191.1621" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="194.6621" x2="194.6621" y1="126.5625" y2="2947.0313"/></g><g><title/><rect fill="#FFFFFF" height="2753.5469" style="stroke:#181818;stroke-width:1;" width="10" x="189.6621" y="175.4844"/></g><g><title>TPM</title><rect fill="#000000" fill-opacity="0.00000" height="2820.4688" width="8" x="585.9639" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="589.4639" x2="589.4639" y1="126.5625" y2="2947.0313"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="584.4639" y="741.9375"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="584.4639" y="1539.2344"/></g><g><title>Konnektor or</title><rect fill="#000000" fill-opacity="0.00000" height="2820.4688" width="8" x="671.0122" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="674.5122" x2="674.5122" y1="126.5625" y2="2947.0313"/></g><g><title/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1;" width="10" x="669.5122" y="1176.9063"/></g><g><title>SM(C)-B</title><rect fill="#000000" fill-opacity="0.00000" height="2820.4688" width="8" x="800.5552" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="804.0552" x2="804.0552" y1="126.5625" y2="2947.0313"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="799.0552" y="1202.5469"/></g><g><title>PEP</title><rect fill="#000000" fill-opacity="0.00000" height="2820.4688" width="8" x="880.5708" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="884.0708" x2="884.0708" y1="126.5625" y2="2947.0313"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="879.0708" y="268.4063"/></g><g><title/><rect fill="#FFFFFF" height="262.6875" style="stroke:#181818;stroke-width:1;" width="10" x="879.0708" y="2666.3438"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="2820.4688" width="8" x="1076.9888" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1080.4888" x2="1080.4888" y1="126.5625" y2="2947.0313"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="1075.4888" y="319.6875"/></g><g><title/><rect fill="#FFFFFF" height="2059.9688" style="stroke:#181818;stroke-width:1;" width="10" x="1075.4888" y="518.8125"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="2820.4688" width="8" x="1350.0181" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1353.5181" x2="1353.5181" y1="126.5625" y2="2947.0313"/></g><g><title/><rect fill="#FFFFFF" height="37.2813" style="stroke:#181818;stroke-width:1;" width="10" x="1348.5181" y="2453.9375"/></g><g><title>Resource Server</title><rect fill="#000000" fill-opacity="0.00000" height="2820.4688" width="8" x="1458.5542" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1462.0542" x2="1462.0542" y1="126.5625" y2="2947.0313"/></g><g><title/><rect fill="#FFFFFF" height="87.5625" style="stroke:#181818;stroke-width:1;" width="10" x="1457.0542" y="2815.8281"/></g><text fill="#000000" font-family="Helvetica" font-size="10" x="28.6035" y="124.2041">User</text><ellipse cx="43" cy="63.4219" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M43,71.4219 L43,98.4219 M30,79.4219 L56,79.4219 M43,98.4219 L30,113.4219 M43,98.4219 L56,113.4219" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="173.187" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="181.603" y="104.5635">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="180.187" y="116.2041">Client</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="572.0806" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="579.0806" y="116.2041">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="635.0854" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="642.0854" y="104.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="646.0918" y="116.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="776.9404" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="783.9404" y="116.2041">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="851.1699" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="874.8813" y="104.5635">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="858.1699" y="116.2041">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="1022.0142" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1070.6084" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1029.0142" y="116.2041">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1313.2319" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1343.6377" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1320.2319" y="116.2041">Policy Engine</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.5" x="1413.8042" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1420.8042" y="116.2041">Resource Server</text><text fill="#000000" font-family="Helvetica" font-size="10" x="28.6035" y="3016.3135">User</text><ellipse cx="43" cy="2955.5313" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M43,2963.5313 L43,2990.5313 M30,2971.5313 L56,2971.5313 M43,2990.5313 L30,3005.5313 M43,2990.5313 L56,3005.5313" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="173.187" y="2947.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="181.603" y="2963.3135">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="180.187" y="2974.9541">Client</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="572.0806" y="2947.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="579.0806" y="2963.3135">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="635.0854" y="2947.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="642.0854" y="2963.3135">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="646.0918" y="2974.9541">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="776.9404" y="2947.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="783.9404" y="2963.3135">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="851.1699" y="2947.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="874.8813" y="2963.3135">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="858.1699" y="2974.9541">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="1022.0142" y="2947.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1070.6084" y="2963.3135">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1029.0142" y="2974.9541">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1313.2319" y="2947.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1343.6377" y="2963.3135">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1320.2319" y="2974.9541">Policy Engine</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.5" x="1413.8042" y="2947.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1420.8042" y="2963.3135">Resource Server</text><polygon fill="#181818" points="177.6621,171.4844,187.6621,175.4844,177.6621,179.4844,181.6621,175.4844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43" x2="183.6621" y1="175.4844" y2="175.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="50" y="159.4854">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="74.5273" y="147.8447">User wants to</text><text fill="#000000" font-family="Helvetica" font-size="10" x="74.5273" y="159.4854">access resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="74.5273" y="171.126">on Resource Server</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1544.2729" x="5" y="202.3047"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1549.2729" y1="202.3047" y2="202.3047"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1549.2729" y1="205.3047" y2="205.3047"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="72.7109" x="740.781" y="193.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="746.781" y="206.7666">Discovery</text><path d="M178.6621,227.125 L507.2998,227.125 L507.2998,230.7656 L497.2998,240.7656 L178.6621,240.7656 L178.6621,227.125" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="192.7656" style="stroke:#000000;stroke-width:1.5;" width="922.8267" x="178.6621" y="227.125"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="193.6621" y="237.4072">ZETA Client has Resource Server FQDN (RS-FQDN)</text><polygon fill="#181818" points="867.0708,264.4063,877.0708,268.4063,867.0708,272.4063,871.0708,268.4063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="873.0708" y1="268.4063" y2="268.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="264.0479">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="264.0479">GET /.well-known/oauth-protected-resource Host: RS-FQDN</text><polygon fill="#181818" points="210.6621,290.0469,200.6621,294.0469,210.6621,298.0469,206.6621,294.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="878.0708" y1="294.0469" y2="294.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="289.6885">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="289.6885">Client: 200 OK; json body with Well-Known json Document (RFC draft-ietf-oauth-resource-metadata)</text><polygon fill="#181818" points="1063.4888,315.6875,1073.4888,319.6875,1063.4888,323.6875,1067.4888,319.6875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="1069.4888" y1="319.6875" y2="319.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="315.3291">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="315.3291">GET /.well-known/oauth-authorization-server&#160;Host: AuthS-FQDN</text><polygon fill="#181818" points="210.6621,341.3281,200.6621,345.3281,210.6621,349.3281,206.6621,345.3281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="1074.4888" y1="345.3281" y2="345.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="340.9697">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="340.9697">200 OK; json body with Well-Known json Document (RFC8414)</text><path d="M204.6621,358.3281 L204.6621,414.3281 L535.6621,414.3281 L535.6621,368.3281 L525.6621,358.3281 L204.6621,358.3281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M525.6621,358.3281 L525.6621,368.3281 L535.6621,368.3281 L525.6621,358.3281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="210.6621" y="372.6104">Offene Fragen:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="210.6621" y="384.251">- Werden die Well-known JSON Dokumente signiert?</text><text fill="#000000" font-family="Helvetica" font-size="10" x="210.6621" y="395.8916">- Wenn ja, welches Zertifikat wird f&#252;r die Signatur verwendet?</text><text fill="#000000" font-family="Helvetica" font-size="10" x="210.6621" y="407.5322">- Wie wird die Signatur &#252;berpr&#252;ft?</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1544.2729" x="5" y="452.7109"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1549.2729" y1="452.7109" y2="452.7109"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1549.2729" y1="455.7109" y2="455.7109"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="175.46" x="689.4065" y="443.8906"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="695.4065" y="457.1729">Dynamic Client Registration</text><path d="M178.6621,477.5313 L238.6182,477.5313 L238.6182,481.1719 L228.6182,491.1719 L178.6621,491.1719 L178.6621,477.5313" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="74.9219" style="stroke:#000000;stroke-width:1.5;" width="922.8267" x="178.6621" y="477.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="193.6621" y="487.8135">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="253.6182" y="488.8135">[Client has no client_id]</text><polygon fill="#181818" points="1063.4888,514.8125,1073.4888,518.8125,1063.4888,522.8125,1067.4888,518.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="1069.4888" y1="518.8125" y2="518.8125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="514.4541">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="514.4541">POST /register (RFC7591)</text><polygon fill="#181818" points="210.6621,540.4531,200.6621,544.4531,210.6621,548.4531,206.6621,544.4531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="1074.4888" y1="544.4531" y2="544.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="540.0947">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="540.0947">Client Information Response with client_id (RFC7591)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1544.2729" x="5" y="585.2734"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1549.2729" y1="585.2734" y2="585.2734"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1549.2729" y1="588.2734" y2="588.2734"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="104.7813" x="724.7458" y="576.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="730.7458" y="589.7354">Key Generation</text><path d="M8,610.0938 L67.9561,610.0938 L67.9561,613.7344 L57.9561,623.7344 L8,623.7344 L8,610.0938" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="247.7656" style="stroke:#000000;stroke-width:1.5;" width="627.4639" x="8" y="610.0938"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="23" y="620.376">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="82.9561" y="621.376">[Client has no Client Attestation Key Pair]</text><path d="M27,637.7344 L86.9561,637.7344 L86.9561,641.375 L76.9561,651.375 L27,651.375 L27,637.7344" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="206.125" style="stroke:#000000;stroke-width:1.5;" width="583.4639" x="27" y="637.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="42" y="648.0166">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="101.9561" y="649.0166">[Client uses TPM]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="27" x2="610.4639" y1="786.5781" y2="786.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="32" y="797.8604">[Client uses self signed Attestation Key (deprecated)]</text><polygon fill="#181818" points="54,686.6563,44,690.6563,54,694.6563,50,690.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="48" x2="188.6621" y1="690.6563" y2="690.6563"/><text fill="#000000" font-family="Helvetica" font-size="10" x="60" y="680.4775">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.5273" y="674.6572">Obtain Admin</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.5273" y="686.2979">access to TPM</text><polygon fill="#181818" points="177.6621,712.2969,187.6621,716.2969,177.6621,720.2969,181.6621,716.2969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="43" x2="183.6621" y1="716.2969" y2="716.2969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="50" y="711.9385">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="74.5273" y="711.9385">TPM Admin access</text><polygon fill="#181818" points="572.4639,737.9375,582.4639,741.9375,572.4639,745.9375,576.4639,741.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="578.4639" y1="741.9375" y2="741.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="737.5791">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="737.5791">Create Client Attestation Key Pair in TPM</text><polygon fill="#181818" points="210.6621,763.5781,200.6621,767.5781,210.6621,771.5781,206.6621,767.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="583.4639" y1="767.5781" y2="767.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="763.2197">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="763.2197">Public Attestation Key</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="822.8594" y2="822.8594"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="822.8594" y2="835.8594"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="835.8594" y2="835.8594"/><polygon fill="#181818" points="210.6621,831.8594,200.6621,835.8594,210.6621,839.8594,206.6621,835.8594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="818.501">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="818.501">Create self signed Client Attestation Key Pair</text><path d="M178.6621,875.8594 L238.6182,875.8594 L238.6182,879.5 L228.6182,889.5 L178.6621,889.5 L178.6621,875.8594" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="62.2813" style="stroke:#000000;stroke-width:1.5;" width="312.1816" x="178.6621" y="875.8594"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="193.6621" y="886.1416">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="253.6182" y="887.1416">[Client has no Client Instance Key Pair]</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="917.1406" y2="917.1406"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="917.1406" y2="930.1406"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="930.1406" y2="930.1406"/><polygon fill="#181818" points="210.6621,926.1406,200.6621,930.1406,210.6621,934.1406,206.6621,930.1406" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="912.7822">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="912.7822">Create Client Instance Key Pair</text><path d="M12.6035,956.1406 L72.5596,956.1406 L72.5596,959.7813 L62.5596,969.7813 L12.6035,969.7813 L12.6035,956.1406" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1466.1563" style="stroke:#000000;stroke-width:1.5;" width="1346.436" x="12.6035" y="956.1406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="27.6035" y="966.4229">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="87.5596" y="967.4229">[Client has no valid refresh token]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="12.6035" x2="1359.0396" y1="2187.5313" y2="2187.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="17.6035" y="2198.8135">[Client has valid Refresh token]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1544.2729" x="5" y="998.6016"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1549.2729" y1="998.6016" y2="998.6016"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1549.2729" y1="1001.6016" y2="1001.6016"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="117.9746" x="718.1492" y="989.7813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="724.1492" y="1003.0635">Token Generation</text><path d="M178.6621,1023.4219 L373.6084,1023.4219 L373.6084,1027.0625 L363.6084,1037.0625 L178.6621,1037.0625 L178.6621,1023.4219" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="277.0469" style="stroke:#000000;stroke-width:1.5;" width="646.3931" x="178.6621" y="1023.4219"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="193.6621" y="1033.7041">SM(C)-B Access Token JWT</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="1064.7031" y2="1064.7031"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="1064.7031" y2="1077.7031"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="1077.7031" y2="1077.7031"/><polygon fill="#181818" points="210.6621,1073.7031,200.6621,1077.7031,210.6621,1081.7031,206.6621,1077.7031" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1060.3447">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1060.3447">generate DPoP key pair</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="1138.2656" y2="1138.2656"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="1138.2656" y2="1151.2656"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="1151.2656" y2="1151.2656"/><polygon fill="#181818" points="210.6621,1147.2656,200.6621,1151.2656,210.6621,1155.2656,206.6621,1151.2656" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1116.4463">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="231.1895" y="1098.9854">Generate SM(C)-B Access Token JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1110.626">("typ": "JWT", "alg": "ES256"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1122.2666">"sub": "telematik_id",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1133.9072">"scope": "RS specific scopes" "cnf": with public Client Attestation Key)</text><polygon fill="#181818" points="657.5122,1172.9063,667.5122,1176.9063,657.5122,1180.9063,661.5122,1176.9063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="663.5122" y1="1176.9063" y2="1176.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1172.5479">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1172.5479">externalAuthenticate SM(C)-B Access Token JWT-hash</text><polygon fill="#181818" points="787.0552,1198.5469,797.0552,1202.5469,787.0552,1206.5469,791.0552,1202.5469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="679.5122" x2="793.0552" y1="1202.5469" y2="1202.5469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="686.5122" y="1198.1885">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="711.0396" y="1198.1885">sign JWT-hash</text><polygon fill="#181818" points="690.5122,1224.1875,680.5122,1228.1875,690.5122,1232.1875,686.5122,1228.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="684.5122" x2="798.0552" y1="1228.1875" y2="1228.1875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="696.5122" y="1223.8291">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="721.0396" y="1223.8291">JWT-Signature</text><polygon fill="#181818" points="210.6621,1249.8281,200.6621,1253.8281,210.6621,1257.8281,206.6621,1253.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="204.6621" x2="668.5122" y1="1253.8281" y2="1253.8281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="1249.4697">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="1249.4697">JWT-Signature</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="1279.4688" y2="1279.4688"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="1279.4688" y2="1292.4688"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="1292.4688" y2="1292.4688"/><polygon fill="#181818" points="210.6621,1288.4688,200.6621,1292.4688,210.6621,1296.4688,206.6621,1292.4688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1275.1104">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1275.1104">Add JWT-Signature to SM(C)-B Access Token</text><path d="M159.6621,1318.4688 L329.833,1318.4688 L329.833,1322.1094 L319.833,1332.1094 L159.6621,1332.1094 L159.6621,1318.4688" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="336.6875" style="stroke:#000000;stroke-width:1.5;" width="475.8018" x="159.6621" y="1318.4688"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="174.6621" y="1328.751">Client Attestation JWT</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="1383.0313" y2="1383.0313"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="1383.0313" y2="1396.0313"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="1396.0313" y2="1396.0313"/><polygon fill="#181818" points="210.6621,1392.0313,200.6621,1396.0313,210.6621,1400.0313,206.6621,1396.0313" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1367.0322">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="231.1895" y="1355.3916">Generate Client Attestation JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1367.0322">("typ": "oauth-client-attestation+jwt", "alg": "ES256"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1378.6729">"sub": "client_id", "cnf" with public Client Instance Key)</text><path d="M178.6621,1408.0313 L238.6182,1408.0313 L238.6182,1411.6719 L228.6182,1421.6719 L178.6621,1421.6719 L178.6621,1408.0313" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="233.125" style="stroke:#000000;stroke-width:1.5;" width="431.8018" x="178.6621" y="1408.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="193.6621" y="1418.3135">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="253.6182" y="1419.3135">[Client uses TPM]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="178.6621" x2="610.4639" y1="1583.875" y2="1583.875"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="183.6621" y="1595.1572">[Client uses self signed Attestation Key (deprecated)]</text><polygon fill="#181818" points="577.4639,1445.3125,587.4639,1449.3125,577.4639,1453.3125,581.4639,1449.3125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="583.4639" y1="1449.3125" y2="1449.3125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1444.9541">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1444.9541">Get TPM evidence</text><polygon fill="#181818" points="210.6621,1470.9531,200.6621,1474.9531,210.6621,1478.9531,206.6621,1474.9531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="588.4639" y1="1474.9531" y2="1474.9531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="1470.5947">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="1470.5947">TPM2B_ATTEST Objekt and TPM EK certificate chain</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="1500.5938" y2="1500.5938"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="1500.5938" y2="1513.5938"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="1513.5938" y2="1513.5938"/><polygon fill="#181818" points="210.6621,1509.5938,200.6621,1513.5938,210.6621,1517.5938,206.6621,1513.5938" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1496.2354">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1496.2354">Add TPM evidence to Client Attestation JWT</text><polygon fill="#181818" points="572.4639,1535.2344,582.4639,1539.2344,572.4639,1543.2344,576.4639,1539.2344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="578.4639" y1="1539.2344" y2="1539.2344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1534.876">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1534.876">Sign Client Attestation JWT with Client Attestation Key</text><polygon fill="#181818" points="210.6621,1560.875,200.6621,1564.875,210.6621,1568.875,206.6621,1564.875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="583.4639" y1="1564.875" y2="1564.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="1560.5166">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="1560.5166">Client Attestation JWT Signature</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="1620.1563" y2="1620.1563"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="1620.1563" y2="1633.1563"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="1633.1563" y2="1633.1563"/><polygon fill="#181818" points="210.6621,1629.1563,200.6621,1633.1563,210.6621,1637.1563,206.6621,1633.1563" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1615.7979">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1615.7979">Sign Client Attestation JWT with Client Key</text><path d="M178.6621,1673.1563 L431.6602,1673.1563 L431.6602,1676.7969 L421.6602,1686.7969 L178.6621,1686.7969 L178.6621,1673.1563" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="187.125" style="stroke:#000000;stroke-width:1.5;" width="917.8267" x="178.6621" y="1673.1563"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="193.6621" y="1683.4385">Client Attestation PoP and DPoP JWT</text><polygon fill="#181818" points="1063.4888,1710.4375,1073.4888,1714.4375,1063.4888,1718.4375,1067.4888,1714.4375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="1069.4888" y1="1714.4375" y2="1714.4375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1710.0791">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="231.1895" y="1710.0791">GET /nonce</text><polygon fill="#181818" points="210.6621,1736.0781,200.6621,1740.0781,210.6621,1744.0781,206.6621,1740.0781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="1074.4888" y1="1740.0781" y2="1740.0781"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="1735.7197">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="1735.7197">return 200 OK new-nonce: nonce</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="1789" y2="1789"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="1789" y2="1802"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="1802" y2="1802"/><polygon fill="#181818" points="210.6621,1798,200.6621,1802,210.6621,1806,206.6621,1802" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1773.001">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="231.1895" y="1761.3604">Generate Client Attestation PoP JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1773.001">("typ": "oauth-client-attestation-pop+jwt", "nonce"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1784.6416">sign with the private Client Instance Key)</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="1839.2813" y2="1839.2813"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="1839.2813" y2="1852.2813"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="1852.2813" y2="1852.2813"/><polygon fill="#181818" points="210.6621,1848.2813,200.6621,1852.2813,210.6621,1856.2813,206.6621,1852.2813" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1829.1025">(31)</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="231.1895" y="1823.2822">Generate DPoP JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1834.9229">("nonce", sign with the private DPoP Key)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1544.2729" x="5" y="1893.1016"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1549.2729" y1="1893.1016" y2="1893.1016"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1549.2729" y1="1896.1016" y2="1896.1016"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="109.3418" x="722.4656" y="1884.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="728.4656" y="1897.5635">Token Exchange</text><polygon fill="#181818" points="1063.4888,2032.3281,1073.4888,2036.3281,1063.4888,2040.3281,1067.4888,2036.3281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="1069.4888" y1="2036.3281" y2="2036.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1979.5869">(32)</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="231.1895" y="1927.2041">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1938.8447">POST /token HTTP/1.1</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1950.4854">Host: auths.example.com</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1962.126">Content-Type: application/x-www-form-urlencoded</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1973.7666">OAuth-Client-Attestation: &lt;Base64url-kodiertes Client Attestation JWT&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1985.4072">OAuth-Client-Attestation-PoP: &lt;Base64url-kodiertes Client Attestation PoP JWT&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1997.0479">grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Atoken-exchange&amp;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="2008.6885">subject_token=&lt;SM(C)-B Access Token JWT&gt;&amp;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="2020.3291">subject_token_type=urn%3Aexample%3Asmc-b-jwt&amp;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="2031.9697">audience=https%3A%2F%2Fbackend.example.com%2Fapi</text><path d="M809.0933,2049.3281 L809.0933,2070.3281 L1075.0933,2070.3281 L1075.0933,2059.3281 L1065.0933,2049.3281 L809.0933,2049.3281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1065.0933,2049.3281 L1065.0933,2059.3281 L1075.0933,2059.3281 L1065.0933,2049.3281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="815.0933" y="2063.6104">RFC7523 (JWT Client Assertion), RFC9449 (DPoP)</text><line style="stroke:#181818;stroke-width:1;" x1="1085.4888" x2="1127.4888" y1="2116.8906" y2="2116.8906"/><line style="stroke:#181818;stroke-width:1;" x1="1127.4888" x2="1127.4888" y1="2116.8906" y2="2129.8906"/><line style="stroke:#181818;stroke-width:1;" x1="1086.4888" x2="1127.4888" y1="2129.8906" y2="2129.8906"/><polygon fill="#181818" points="1096.4888,2125.8906,1086.4888,2129.8906,1096.4888,2133.8906,1092.4888,2129.8906" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1092.4888" y="2100.8916">(33)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1117.0161" y="2089.251">verify</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1117.0161" y="2100.8916">SM(C)-B Access Token JWT and DPoP JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1117.0161" y="2112.5322">Client Attestation JWT and PoP JWT</text><line style="stroke:#181818;stroke-width:1;" x1="1085.4888" x2="1127.4888" y1="2155.5313" y2="2155.5313"/><line style="stroke:#181818;stroke-width:1;" x1="1127.4888" x2="1127.4888" y1="2155.5313" y2="2168.5313"/><line style="stroke:#181818;stroke-width:1;" x1="1086.4888" x2="1127.4888" y1="2168.5313" y2="2168.5313"/><polygon fill="#181818" points="1096.4888,2164.5313,1086.4888,2168.5313,1096.4888,2172.5313,1092.4888,2168.5313" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1092.4888" y="2151.1729">(34)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1117.0161" y="2151.1729">Create state for Session, Identity and Client</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1544.2729" x="5" y="2224.9922"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1549.2729" y1="2224.9922" y2="2224.9922"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1549.2729" y1="2227.9922" y2="2227.9922"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="156.4414" x="698.9158" y="2216.1719"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="704.9158" y="2229.4541">Refresh Token Exchange</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="2263.4531" y2="2263.4531"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="2263.4531" y2="2276.4531"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="2276.4531" y2="2276.4531"/><polygon fill="#181818" points="210.6621,2272.4531,200.6621,2276.4531,210.6621,2280.4531,206.6621,2276.4531" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="2259.0947">(35)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="2259.0947">create DPoP JWT without nonce</text><polygon fill="#181818" points="1063.4888,2333.0156,1073.4888,2337.0156,1063.4888,2341.0156,1067.4888,2337.0156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="1069.4888" y1="2337.0156" y2="2337.0156"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="2315.1963">(36)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="2297.7354">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="2309.376">DPoP: ... (DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="2321.0166">grant_type=refresh_token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="2332.6572">refresh_token= ... (Refresh token)</text><line style="stroke:#181818;stroke-width:1;" x1="1085.4888" x2="1127.4888" y1="2362.6563" y2="2362.6563"/><line style="stroke:#181818;stroke-width:1;" x1="1127.4888" x2="1127.4888" y1="2362.6563" y2="2375.6563"/><line style="stroke:#181818;stroke-width:1;" x1="1086.4888" x2="1127.4888" y1="2375.6563" y2="2375.6563"/><polygon fill="#181818" points="1096.4888,2371.6563,1086.4888,2375.6563,1096.4888,2379.6563,1092.4888,2375.6563" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1092.4888" y="2358.2979">(37)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1117.0161" y="2358.2979">verify Refresh token and DPoP JWT</text><line style="stroke:#181818;stroke-width:1;" x1="1085.4888" x2="1127.4888" y1="2401.2969" y2="2401.2969"/><line style="stroke:#181818;stroke-width:1;" x1="1127.4888" x2="1127.4888" y1="2401.2969" y2="2414.2969"/><line style="stroke:#181818;stroke-width:1;" x1="1086.4888" x2="1127.4888" y1="2414.2969" y2="2414.2969"/><polygon fill="#181818" points="1096.4888,2410.2969,1086.4888,2414.2969,1096.4888,2418.2969,1092.4888,2414.2969" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1092.4888" y="2396.9385">(38)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1117.0161" y="2396.9385">invalidate Refresh token</text><polygon fill="#181818" points="1336.5181,2449.9375,1346.5181,2453.9375,1336.5181,2457.9375,1340.5181,2453.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1085.4888" x2="1342.5181" y1="2453.9375" y2="2453.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1092.4888" y="2449.5791">(39)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1117.0161" y="2449.5791">POST /v1/data/authz, body {  "input": {...}}</text><polygon fill="#181818" points="1096.4888,2487.2188,1086.4888,2491.2188,1096.4888,2495.2188,1092.4888,2491.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1090.4888" x2="1347.5181" y1="2491.2188" y2="2491.2188"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1102.4888" y="2481.04">(40)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1127.0161" y="2475.2197">200 OK, body {"result": {"allow": true,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1127.0161" y="2486.8604">"access_token_attributes": {...}}</text><line style="stroke:#181818;stroke-width:1;" x1="1085.4888" x2="1127.4888" y1="2540.1406" y2="2540.1406"/><line style="stroke:#181818;stroke-width:1;" x1="1127.4888" x2="1127.4888" y1="2540.1406" y2="2553.1406"/><line style="stroke:#181818;stroke-width:1;" x1="1086.4888" x2="1127.4888" y1="2553.1406" y2="2553.1406"/><polygon fill="#181818" points="1096.4888,2549.1406,1086.4888,2553.1406,1096.4888,2557.1406,1092.4888,2553.1406" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1092.4888" y="2524.1416">(41)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1117.0161" y="2512.501">issue Access and Refresh token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1117.0161" y="2524.1416">with DPoP Binding and</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1117.0161" y="2535.7822">Access token attributes</text><polygon fill="#181818" points="210.6621,2574.7813,200.6621,2578.7813,210.6621,2582.7813,206.6621,2578.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="1074.4888" y1="2578.7813" y2="2578.7813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="2574.4229">(42)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="2574.4229">200 OK, Access token, Refresh token, bound to DPoP</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="2604.4219" y2="2604.4219"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="2604.4219" y2="2617.4219"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="2617.4219" y2="2617.4219"/><polygon fill="#181818" points="210.6621,2613.4219,200.6621,2617.4219,210.6621,2621.4219,206.6621,2617.4219" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="2600.0635">(43)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="2600.0635">Create DPoP Proof for RS</text><polygon fill="#181818" points="867.0708,2662.3438,877.0708,2666.3438,867.0708,2670.3438,871.0708,2666.3438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="873.0708" y1="2666.3438" y2="2666.3438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="2650.3447">(44)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="2638.7041">GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="2650.3447">Authorization: DPoP ... (Accesss token)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="2661.9854">DPoP: ... (DPoP token)</text><line style="stroke:#181818;stroke-width:1;" x1="889.0708" x2="931.0708" y1="2703.625" y2="2703.625"/><line style="stroke:#181818;stroke-width:1;" x1="931.0708" x2="931.0708" y1="2703.625" y2="2716.625"/><line style="stroke:#181818;stroke-width:1;" x1="890.0708" x2="931.0708" y1="2716.625" y2="2716.625"/><polygon fill="#181818" points="900.0708,2712.625,890.0708,2716.625,900.0708,2720.625,896.0708,2716.625" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="896.0708" y="2693.4463">(45)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="920.5981" y="2687.626">verify Access token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="920.5981" y="2699.2666">and DPoP Proof</text><line style="stroke:#181818;stroke-width:1;" x1="889.0708" x2="931.0708" y1="2753.9063" y2="2753.9063"/><line style="stroke:#181818;stroke-width:1;" x1="931.0708" x2="931.0708" y1="2753.9063" y2="2766.9063"/><line style="stroke:#181818;stroke-width:1;" x1="890.0708" x2="931.0708" y1="2766.9063" y2="2766.9063"/><polygon fill="#181818" points="900.0708,2762.9063,890.0708,2766.9063,900.0708,2770.9063,896.0708,2766.9063" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="896.0708" y="2743.7275">(46)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="920.5981" y="2737.9072">additional checks according to</text><text fill="#000000" font-family="Helvetica" font-size="10" x="920.5981" y="2749.5479">Access token attributes</text><polygon fill="#181818" points="1445.0542,2811.8281,1455.0542,2815.8281,1445.0542,2819.8281,1449.0542,2815.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="889.0708" x2="1451.0542" y1="2815.8281" y2="2815.8281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="896.0708" y="2799.8291">(47)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="920.5981" y="2788.1885">forward GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="920.5981" y="2799.8291">with header and</text><text fill="#000000" font-family="Helvetica" font-size="10" x="920.5981" y="2811.4697">PEP header as json</text><line style="stroke:#181818;stroke-width:1;" x1="1467.0542" x2="1509.0542" y1="2864.75" y2="2864.75"/><line style="stroke:#181818;stroke-width:1;" x1="1509.0542" x2="1509.0542" y1="2864.75" y2="2877.75"/><line style="stroke:#181818;stroke-width:1;" x1="1468.0542" x2="1509.0542" y1="2877.75" y2="2877.75"/><polygon fill="#181818" points="1478.0542,2873.75,1468.0542,2877.75,1478.0542,2881.75,1474.0542,2877.75" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1474.0542" y="2848.751">(48)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1498.5815" y="2837.1104">provide</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1498.5815" y="2848.751">resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1498.5815" y="2860.3916">access</text><polygon fill="#181818" points="900.0708,2899.3906,890.0708,2903.3906,900.0708,2907.3906,896.0708,2903.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="894.0708" x2="1456.0542" y1="2903.3906" y2="2903.3906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="906.0708" y="2899.0322">(49)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="930.5981" y="2899.0322">200 OK, resource</text><polygon fill="#181818" points="210.6621,2925.0313,200.6621,2929.0313,210.6621,2933.0313,206.6621,2929.0313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="878.0708" y1="2929.0313" y2="2929.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="2924.6729">(50)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="2924.6729">200 OK, resource</text><!--SRC=[fLZfSkEu4VxFf-XeQxEsO_fQxoQZh2Sbs_8nbnbBgQbigMeA8biIHnJ00a7Bcgrzb_pOnvXVEo-MRe2aI1rUPrBb6Gf0t_sXqO38ZPBvR8WQMZj7HxijBvl6CXLQp232aSWJSwMawSMV48wFDY- -4pE46qmUqCIXgD5SEfgtIgei5I565VM5odMCkaQRe1oRIIVwc6S6f9BeUNzAjHZF11XKdy3edAOweL4Q_fKHwr0zGkjDzxO5trnFL6RUJsA37e2T3tGy-_ARpXQPmHbHl14FA2FY0YWeVkxsEt2Hn2WDhVU4Z1RdMisbfG0WeyYPE1NI55GWCiSra0MR9IMnBD1RPUe7Roq7VPbmILOdUgsan2cxnAJBaT83sR_rhuN1kLYqLhXwRyyjVU_jpiMkVzxoIk4k9XqvZD6W9hVwtOkRTtTlxgx_xTNTliw5ZjQzhkku2QoAe1iCvCIO50Aj7XUjDRfERYOzHtf9f3nKEluaJAmaz50_i1rhN45toHAe90uNq9NZM68pLCxc_YsS71p19SMSeF7DfT3J7efhZRWfMVVEcdlC268XbZOqSbN5Yu44_iiYmsqBB9YJc0oC6aWHXfXbe0jP0u8bh0ZsH6ZY1yfJ8SFppix8r2nKjBY0ipFF6skLfr336qp8mXKvSFNFotUmSz_p-SSkcLlGadKtGHkkktquF9XZalXJIGaxL892xQTQ6GmDHdvf9DpGNcX38OZaL0RU13IYlFerXylloT4HtBt-EtpCoCMXYXOmZyq4thE-rwpFhLogC9-nLJltLnSGQJ4oFc5jv3jhIXly6HeH2IFOZmYR5YpzijZPwfgeGydFR9H-_u_ppdAkEMXdQS9XikxcrxZtjzFZqnNxImNq9odkeEFnn80QbRbdZDsDHYWHhgXqeMpRAPyKwGWbH34wdTPFUDMxUqSwfrOdGXQF9TL4yu-AIP9TOXyeDE44C_YP5kDHF1M6pDSHZBvyrbPcZpY5oJLGYEPSvvOoQDNIDiY-VAPwd-eldqUMaBS3- -Fnnd00NaWnYyCoL_SuZZEZtQOcI8l4rA4i5OHsz24czWqP3kvwb69jfH3KERf__U75yUxpabU8kvKZfMVE1jeygP8PkZHMockIIqzUumAkAI5BupTONumwnc1c727p1IBc0wD6dsUK1gheDhfBDxbijE5kQ4GieHFDObdL3gCgUbTiQexn4M6fmH6lIALbSbxZihXij128lrHHHRESO1LrbK4-f6gxAiUIrd3kk379iE5uXid8eXIZDKjs8amrXiGTxQxuKUNHkLANydJWEOVyRsl2Rkb0499gNerfgzwjF1OgwpeUH4A8qZYYgZQXF4xfk654zVdNAgO0N9KlZcJekEmxsbVl-zwMc8oT68JBG0Km9PDIDcaBzTxUTKc_JT7Uta3kjCmYRRMXHUFMFhH4CkPHjtVomu-jWMnb-P371XFa_JIbdTFQv_bGfSWhT8PcAOPKQqAmaraBMg4SqPhTSAb3qURihQQ_wchQW8-q_QL8U8_JQXm-vObFUPWqKLs9ijFBTecqK4_KjgZQmahhTe9xfwPHJ5zMHbpT2ILRGrUPZYSvcxQkvx8JHKq1N2esnQBO21N4DaIT0VQ7YDdCry2BEtXTEVN5al0l7-Vc2I1LzPTf62QRK5BVTmuYs-hgMWsyHjTEuqDCfsY81TLgRQFnoVc7Jh_VfTFcRlYHeW_Ku5gwxci8tUbfCHTEg5AlAQkdfgwFC_D4rDVivPHkON2HsRnn2c5hDNpTqosocrZSKD7_tvg-ALZFTRPqaB7ynuZcQiYvisLn7Tv5Nq7evjwHsl8Gz_OipNhxe9528eiM42JEVKlV1llvgdrJ6FMilUEdAYttZzL86yVMAHiSgeEGwle5OiD6UTAyouOnJiC-RDPWQGknPOFawcttaRQ47ACzp3R4sNLmzX1aHRKXtFJxmU7nmV50kjwSuv0TuAEOfGaUX6f6zsMwzdDO-ekKuYxIDE5jIC4vVFJdyxdFZPsVwuGscuem6iWxLkmxE_nQvDlmqxd8yCTJ8lQdAk9scK2y6NuljylnAH3FbrL4cEIDDTqDFr36yOmmzUtt7RxyqCS-OMJqmwA0lfRGPq8Qs3ZvM8JupvJ_dAfJI89uuUodRIVWorNIkkOYmFGhcuN-q2U84Rd8oG-2m1dVsTcWRq-kw6yeGcAFwbcXMP76dkSTVlUCX1C8_zSSWeLR6muE3c2dHEakptzT5Cb1VuX2esOP8ikudYjvXejN4wkZp5ovOlLvtnrwzgwMuCXUrSfxXhqfd7mFEroeLbbtztdznUdf2sUwlK-uEr9HOAfGqPKh7Yq6SbiI6sMiV3fQgvHCL9QwLGrbtspuVmepz4W1CUx3RSHTb5bOzlBzeLxYkPLrVUpzMXzRpZnP0Cg24peRIZziQL6vAMhebWkVrVLC81HzzeUAfp5nvfWRJknkIKNJrUOfiieHIniTTgqP85iTA-gWMxhqS7p8xng73D1F- -ufuHU0LYpJtD0ny0lP-Ukli7mL2hfUqBNdKQ7IdKCbQujqvedbfEugKNFwnI-Tt8wxIs6ny-b4qV4m9zHKMhpQ-KvgrdpBiXnBE78K6XuEf3qTR6JEOnd5Sin40zafxwqsU9LMRzkZoZxKEVQRMjZDd5HJ0yMQlBMt56_hTSrQ5cX5MvOnVz_pDZo8BL_ctCbVlHUr7Rz5ZRElC71t4nuBFDNVgVYTp2agK5NtakfiYIfhOOrQH57C1eY4camCfndVxPMsyUKdnMtXTHBkAM_axLpeQDL1cwu9YWYrIrJG3QfnPj-lbWvGjEvxfS1KAsva1t8fh7Xlk7S9PRlBP9OqzLIHj9LdmwUeRu8Ltjgeg57_1G00]--></g></svg>