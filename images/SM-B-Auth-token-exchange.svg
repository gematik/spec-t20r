<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2855px" preserveAspectRatio="none" style="width:1632px;height:2855px;background:#FFFFFF;" version="1.1" viewBox="0 0 1632 2855" width="1632px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="2843.5469" style="stroke:#181818;stroke-width:0.5;" width="675.2275" x="188.1621" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="517.314" y="15.2822">LEI</text><rect fill="#E6E6FA" height="2826.9063" style="stroke:#181818;stroke-width:0.5;" width="459.1431" x="188.1621" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="378.637" y="31.9229">Prim&#228;rsystem</text><rect fill="#F4A460" height="2810.2656" style="stroke:#181818;stroke-width:0.5;" width="89" x="188.1621" y="39.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="200.1621" y="48.5635">ZETA Client</text><rect fill="#C9FFC9" height="2843.5469" style="stroke:#181818;stroke-width:0.5;" width="715.479" x="875.3896" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1208.7688" y="15.2822">Anbieter</text><rect fill="#F4A460" height="2826.9063" style="stroke:#181818;stroke-width:0.5;" width="598.979" x="875.3896" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1141.7346" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="2826.9063" style="stroke:#181818;stroke-width:0.5;" width="104.5" x="1486.3687" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1501.0869" y="31.9229">TI 2.0 Dienst</text><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="2645.3438" width="8" x="77.5" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="81" x2="81" y1="126.5625" y2="2771.9063"/></g><g><title>ZETA</title><rect fill="#000000" fill-opacity="0.00000" height="2645.3438" width="8" x="229.1621" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="232.6621" x2="232.6621" y1="126.5625" y2="2771.9063"/></g><g><title/><rect fill="#FFFFFF" height="2578.4219" style="stroke:#181818;stroke-width:1;" width="10" x="227.6621" y="175.4844"/></g><g><title>TPM</title><rect fill="#000000" fill-opacity="0.00000" height="2645.3438" width="8" x="614.1836" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="617.6836" x2="617.6836" y1="126.5625" y2="2771.9063"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="612.6836" y="757.5781"/></g><g><title>Konnektor or</title><rect fill="#000000" fill-opacity="0.00000" height="2645.3438" width="8" x="699.2319" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="702.7319" x2="702.7319" y1="126.5625" y2="2771.9063"/></g><g><title/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1;" width="10" x="697.7319" y="1125.2656"/></g><g><title>SM(C)-B</title><rect fill="#000000" fill-opacity="0.00000" height="2645.3438" width="8" x="828.7749" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="832.2749" x2="832.2749" y1="126.5625" y2="2771.9063"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="827.2749" y="1150.9063"/></g><g><title>PEP</title><rect fill="#000000" fill-opacity="0.00000" height="2645.3438" width="8" x="908.7905" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="912.2905" x2="912.2905" y1="126.5625" y2="2771.9063"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="907.2905" y="268.4063"/></g><g><title/><rect fill="#FFFFFF" height="239.4063" style="stroke:#181818;stroke-width:1;" width="10" x="907.2905" y="2514.5"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="2645.3438" width="8" x="1129.9302" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1133.4302" x2="1133.4302" y1="126.5625" y2="2771.9063"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="1128.4302" y="319.6875"/></g><g><title/><rect fill="#FFFFFF" height="1880.4844" style="stroke:#181818;stroke-width:1;" width="10" x="1128.4302" y="546.4531"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="2645.3438" width="8" x="1426.5825" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1430.0825" x2="1430.0825" y1="126.5625" y2="2771.9063"/></g><g><title/><rect fill="#FFFFFF" height="37.2813" style="stroke:#181818;stroke-width:1;" width="10" x="1425.0825" y="2313.7344"/></g><g><title>Resource Server</title><rect fill="#000000" fill-opacity="0.00000" height="2645.3438" width="8" x="1535.1187" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1538.6187" x2="1538.6187" y1="126.5625" y2="2771.9063"/></g><g><title/><rect fill="#FFFFFF" height="87.5625" style="stroke:#181818;stroke-width:1;" width="10" x="1533.6187" y="2640.7031"/></g><text fill="#000000" font-family="Helvetica" font-size="10" x="66.6035" y="124.2041">User</text><ellipse cx="81" cy="63.4219" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M81,71.4219 L81,98.4219 M68,79.4219 L94,79.4219 M81,98.4219 L68,113.4219 M81,98.4219 L94,113.4219" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="211.187" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="219.603" y="104.5635">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="218.187" y="116.2041">Client</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="600.3003" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="607.3003" y="116.2041">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="663.3052" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="670.3052" y="104.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="674.3115" y="116.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="805.1602" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.1602" y="116.2041">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="879.3896" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="903.1011" y="104.5635">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="886.3896" y="116.2041">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="1074.9556" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1123.5498" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1081.9556" y="116.2041">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1389.7964" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1420.2021" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1396.7964" y="116.2041">Policy Engine</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.5" x="1490.3687" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1497.3687" y="116.2041">Resource Server</text><text fill="#000000" font-family="Helvetica" font-size="10" x="66.6035" y="2841.1885">User</text><ellipse cx="81" cy="2780.4063" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M81,2788.4063 L81,2815.4063 M68,2796.4063 L94,2796.4063 M81,2815.4063 L68,2830.4063 M81,2815.4063 L94,2830.4063" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="211.187" y="2771.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="219.603" y="2788.1885">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="218.187" y="2799.8291">Client</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="600.3003" y="2771.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="607.3003" y="2788.1885">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="663.3052" y="2771.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="670.3052" y="2788.1885">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="674.3115" y="2799.8291">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="805.1602" y="2771.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="812.1602" y="2788.1885">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="879.3896" y="2771.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="903.1011" y="2788.1885">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="886.3896" y="2799.8291">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="1074.9556" y="2771.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1123.5498" y="2788.1885">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1081.9556" y="2799.8291">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1389.7964" y="2771.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1420.2021" y="2788.1885">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1396.7964" y="2799.8291">Policy Engine</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.5" x="1490.3687" y="2771.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1497.3687" y="2788.1885">Resource Server</text><polygon fill="#181818" points="215.6621,171.4844,225.6621,175.4844,215.6621,179.4844,219.6621,175.4844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="81" x2="221.6621" y1="175.4844" y2="175.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="88" y="159.4854">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="112.5273" y="147.8447">User wants to</text><text fill="#000000" font-family="Helvetica" font-size="10" x="112.5273" y="159.4854">access resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="112.5273" y="171.126">on Resource Server</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1620.8374" x="5" y="202.3047"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1625.8374" y1="202.3047" y2="202.3047"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1625.8374" y1="205.3047" y2="205.3047"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="72.7109" x="779.0632" y="193.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="785.0632" y="206.7666">Discovery</text><path d="M216.6621,227.125 L545.2998,227.125 L545.2998,230.7656 L535.2998,240.7656 L216.6621,240.7656 L216.6621,227.125" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="192.7656" style="stroke:#000000;stroke-width:1.5;" width="937.7681" x="216.6621" y="227.125"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="231.6621" y="237.4072">ZETA Client has Resource Server FQDN (RS-FQDN)</text><polygon fill="#181818" points="895.2905,264.4063,905.2905,268.4063,895.2905,272.4063,899.2905,268.4063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="901.2905" y1="268.4063" y2="268.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="264.0479">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="264.0479">GET /.well-known/oauth-protected-resource Host: RS-FQDN</text><polygon fill="#181818" points="248.6621,290.0469,238.6621,294.0469,248.6621,298.0469,244.6621,294.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="242.6621" x2="906.2905" y1="294.0469" y2="294.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="254.6621" y="289.6885">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.1895" y="289.6885">Client: 200 OK; json body with Well-Known json Document (RFC draft-ietf-oauth-resource-metadata)</text><polygon fill="#181818" points="1116.4302,315.6875,1126.4302,319.6875,1116.4302,323.6875,1120.4302,319.6875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="1122.4302" y1="319.6875" y2="319.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="315.3291">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="315.3291">GET /.well-known/oauth-authorization-server&#160;Host: AuthS-FQDN</text><polygon fill="#181818" points="248.6621,341.3281,238.6621,345.3281,248.6621,349.3281,244.6621,345.3281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="242.6621" x2="1127.4302" y1="345.3281" y2="345.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="254.6621" y="340.9697">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.1895" y="340.9697">200 OK; json body with Well-Known json Document (RFC8414)</text><path d="M242.6621,358.3281 L242.6621,414.3281 L573.6621,414.3281 L573.6621,368.3281 L563.6621,358.3281 L242.6621,358.3281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M563.6621,358.3281 L563.6621,368.3281 L573.6621,368.3281 L563.6621,358.3281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="248.6621" y="372.6104">Offene Fragen:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="248.6621" y="384.251">- Werden die Well-known JSON Dokumente signiert?</text><text fill="#000000" font-family="Helvetica" font-size="10" x="248.6621" y="395.8916">- Wenn ja, welches Zertifikat wird f&#252;r die Signatur verwendet?</text><text fill="#000000" font-family="Helvetica" font-size="10" x="248.6621" y="407.5322">- Wie wird die Signatur &#252;berpr&#252;ft?</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1620.8374" x="5" y="452.7109"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1625.8374" y1="452.7109" y2="452.7109"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1625.8374" y1="455.7109" y2="455.7109"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="109.3418" x="760.7478" y="443.8906"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="766.7478" y="457.1729">Token Exchange</text><path d="M8,477.5313 L67.9561,477.5313 L67.9561,481.1719 L57.9561,491.1719 L8,491.1719 L8,477.5313" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1804.5625" style="stroke:#000000;stroke-width:1.5;" width="1403.981" x="8" y="477.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="23" y="487.8135">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="82.9561" y="488.8135">[Client has no valid refresh token]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="8" x2="1411.981" y1="2086.9688" y2="2086.9688"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="13" y="2098.251">[Client has valid Refresh token]</text><path d="M216.6621,505.1719 L276.6182,505.1719 L276.6182,508.8125 L266.6182,518.8125 L216.6621,518.8125 L216.6621,505.1719" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="74.9219" style="stroke:#000000;stroke-width:1.5;" width="937.7681" x="216.6621" y="505.1719"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="231.6621" y="515.4541">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="291.6182" y="516.4541">[Client has no client_id]</text><polygon fill="#181818" points="1116.4302,542.4531,1126.4302,546.4531,1116.4302,550.4531,1120.4302,546.4531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="1122.4302" y1="546.4531" y2="546.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="542.0947">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="542.0947">POST /register (RFC7591)</text><polygon fill="#181818" points="248.6621,568.0938,238.6621,572.0938,248.6621,576.0938,244.6621,572.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="242.6621" x2="1127.4302" y1="572.0938" y2="572.0938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="254.6621" y="567.7354">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.1895" y="567.7354">Client Information Response with client_id (RFC7591)</text><path d="M27,598.0938 L172.4932,598.0938 L172.4932,601.7344 L162.4932,611.7344 L27,611.7344 L27,598.0938" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1185.9063" style="stroke:#000000;stroke-width:1.5;" width="1147.4302" x="27" y="598.0938"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="42" y="608.376">Token Generation</text><path d="M46,625.7344 L105.9561,625.7344 L105.9561,629.375 L95.9561,639.375 L46,639.375 L46,625.7344" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="247.7656" style="stroke:#000000;stroke-width:1.5;" width="617.6836" x="46" y="625.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="61" y="636.0166">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="120.9561" y="637.0166">[Client has no Client Attestation Key Pair]</text><path d="M65,653.375 L124.9561,653.375 L124.9561,657.0156 L114.9561,667.0156 L65,667.0156 L65,653.375" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="206.125" style="stroke:#000000;stroke-width:1.5;" width="573.6836" x="65" y="653.375"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="80" y="663.6572">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="139.9561" y="664.6572">[Client uses TPM]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="65" x2="638.6836" y1="802.2188" y2="802.2188"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="70" y="813.501">[Client uses self signed Attestation Key (deprecated)]</text><polygon fill="#181818" points="92,702.2969,82,706.2969,92,710.2969,88,706.2969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="86" x2="226.6621" y1="706.2969" y2="706.2969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="98" y="696.1182">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="122.5273" y="690.2979">Obtain Admin</text><text fill="#000000" font-family="Helvetica" font-size="10" x="122.5273" y="701.9385">access to TPM</text><polygon fill="#181818" points="215.6621,727.9375,225.6621,731.9375,215.6621,735.9375,219.6621,731.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="81" x2="221.6621" y1="731.9375" y2="731.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="88" y="727.5791">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="112.5273" y="727.5791">TPM Admin access</text><polygon fill="#181818" points="600.6836,753.5781,610.6836,757.5781,600.6836,761.5781,604.6836,757.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="606.6836" y1="757.5781" y2="757.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="753.2197">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="753.2197">Create Client Attestation Key Pair in TPM</text><polygon fill="#181818" points="248.6621,779.2188,238.6621,783.2188,248.6621,787.2188,244.6621,783.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="242.6621" x2="611.6836" y1="783.2188" y2="783.2188"/><text fill="#000000" font-family="Helvetica" font-size="10" x="254.6621" y="778.8604">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.1895" y="778.8604">Public Attestation Key</text><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="279.6621" y1="838.5" y2="838.5"/><line style="stroke:#181818;stroke-width:1;" x1="279.6621" x2="279.6621" y1="838.5" y2="851.5"/><line style="stroke:#181818;stroke-width:1;" x1="238.6621" x2="279.6621" y1="851.5" y2="851.5"/><polygon fill="#181818" points="248.6621,847.5,238.6621,851.5,248.6621,855.5,244.6621,851.5" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="834.1416">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="834.1416">Create self signed Client Attestation Key Pair</text><path d="M216.6621,891.5 L276.6182,891.5 L276.6182,895.1406 L266.6182,905.1406 L216.6621,905.1406 L216.6621,891.5" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="62.2813" style="stroke:#000000;stroke-width:1.5;" width="312.1816" x="216.6621" y="891.5"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="231.6621" y="901.7822">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="291.6182" y="902.7822">[Client has no Client Instance Key Pair]</text><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="279.6621" y1="932.7813" y2="932.7813"/><line style="stroke:#181818;stroke-width:1;" x1="279.6621" x2="279.6621" y1="932.7813" y2="945.7813"/><line style="stroke:#181818;stroke-width:1;" x1="238.6621" x2="279.6621" y1="945.7813" y2="945.7813"/><polygon fill="#181818" points="248.6621,941.7813,238.6621,945.7813,248.6621,949.7813,244.6621,945.7813" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="928.4229">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="928.4229">Create Client Instance Key Pair</text><path d="M216.6621,971.7813 L411.6084,971.7813 L411.6084,975.4219 L401.6084,985.4219 L216.6621,985.4219 L216.6621,971.7813" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="277.0469" style="stroke:#000000;stroke-width:1.5;" width="636.6128" x="216.6621" y="971.7813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="231.6621" y="982.0635">SM(C)-B Access Token JWT</text><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="279.6621" y1="1013.0625" y2="1013.0625"/><line style="stroke:#181818;stroke-width:1;" x1="279.6621" x2="279.6621" y1="1013.0625" y2="1026.0625"/><line style="stroke:#181818;stroke-width:1;" x1="238.6621" x2="279.6621" y1="1026.0625" y2="1026.0625"/><polygon fill="#181818" points="248.6621,1022.0625,238.6621,1026.0625,248.6621,1030.0625,244.6621,1026.0625" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="1008.7041">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1008.7041">generate DPoP key pair</text><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="279.6621" y1="1086.625" y2="1086.625"/><line style="stroke:#181818;stroke-width:1;" x1="279.6621" x2="279.6621" y1="1086.625" y2="1099.625"/><line style="stroke:#181818;stroke-width:1;" x1="238.6621" x2="279.6621" y1="1099.625" y2="1099.625"/><polygon fill="#181818" points="248.6621,1095.625,238.6621,1099.625,248.6621,1103.625,244.6621,1099.625" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="1064.8057">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="269.1895" y="1047.3447">Generate SM(C)-B Access Token JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1058.9854">("typ": "JWT", "alg": "ES256"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1070.626">"sub": "telematik_id",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1082.2666">"scope": "token_exchange" "cnf": with public Client Attestation Key)</text><polygon fill="#181818" points="685.7319,1121.2656,695.7319,1125.2656,685.7319,1129.2656,689.7319,1125.2656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="691.7319" y1="1125.2656" y2="1125.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="1120.9072">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1120.9072">externalAuthenticate SM(C)-B Access Token JWT-hash</text><polygon fill="#181818" points="815.2749,1146.9063,825.2749,1150.9063,815.2749,1154.9063,819.2749,1150.9063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="707.7319" x2="821.2749" y1="1150.9063" y2="1150.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="714.7319" y="1146.5479">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="739.2593" y="1146.5479">sign JWT-hash</text><polygon fill="#181818" points="718.7319,1172.5469,708.7319,1176.5469,718.7319,1180.5469,714.7319,1176.5469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="712.7319" x2="826.2749" y1="1176.5469" y2="1176.5469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="724.7319" y="1172.1885">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="749.2593" y="1172.1885">JWT-Signature</text><polygon fill="#181818" points="248.6621,1198.1875,238.6621,1202.1875,248.6621,1206.1875,244.6621,1202.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="242.6621" x2="696.7319" y1="1202.1875" y2="1202.1875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="254.6621" y="1197.8291">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.1895" y="1197.8291">JWT-Signature</text><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="279.6621" y1="1227.8281" y2="1227.8281"/><line style="stroke:#181818;stroke-width:1;" x1="279.6621" x2="279.6621" y1="1227.8281" y2="1240.8281"/><line style="stroke:#181818;stroke-width:1;" x1="238.6621" x2="279.6621" y1="1240.8281" y2="1240.8281"/><polygon fill="#181818" points="248.6621,1236.8281,238.6621,1240.8281,248.6621,1244.8281,244.6621,1240.8281" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="1223.4697">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1223.4697">Add JWT-Signature to SM(C)-B Access Token</text><path d="M197.6621,1266.8281 L367.833,1266.8281 L367.833,1270.4688 L357.833,1280.4688 L197.6621,1280.4688 L197.6621,1266.8281" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="298.0469" style="stroke:#000000;stroke-width:1.5;" width="461.0215" x="197.6621" y="1266.8281"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="212.6621" y="1277.1104">Client Attestation JWT</text><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="279.6621" y1="1331.3906" y2="1331.3906"/><line style="stroke:#181818;stroke-width:1;" x1="279.6621" x2="279.6621" y1="1331.3906" y2="1344.3906"/><line style="stroke:#181818;stroke-width:1;" x1="238.6621" x2="279.6621" y1="1344.3906" y2="1344.3906"/><polygon fill="#181818" points="248.6621,1340.3906,238.6621,1344.3906,248.6621,1348.3906,244.6621,1344.3906" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="1315.3916">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="269.1895" y="1303.751">Generate Client Attestation JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1315.3916">("typ": "oauth-client-attestation+jwt", "alg": "ES256"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1327.0322">"sub": "client_id", "cnf" with public Client Instance Key)</text><path d="M216.6621,1356.3906 L276.6182,1356.3906 L276.6182,1360.0313 L266.6182,1370.0313 L216.6621,1370.0313 L216.6621,1356.3906" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="194.4844" style="stroke:#000000;stroke-width:1.5;" width="417.0215" x="216.6621" y="1356.3906"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="231.6621" y="1366.6729">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="291.6182" y="1367.6729">[Client uses TPM]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="216.6621" x2="633.6836" y1="1493.5938" y2="1493.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="221.6621" y="1504.876">[Client uses self signed Attestation Key (deprecated)]</text><polygon fill="#181818" points="605.6836,1393.6719,615.6836,1397.6719,605.6836,1401.6719,609.6836,1397.6719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="611.6836" y1="1397.6719" y2="1397.6719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="1393.3135">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1393.3135">Sign Client Attestation JWT with Client Attestation Key</text><polygon fill="#181818" points="248.6621,1419.3125,238.6621,1423.3125,248.6621,1427.3125,244.6621,1423.3125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="242.6621" x2="616.6836" y1="1423.3125" y2="1423.3125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="254.6621" y="1418.9541">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.1895" y="1418.9541">Client Attestation JWT Signature</text><polygon fill="#181818" points="605.6836,1444.9531,615.6836,1448.9531,605.6836,1452.9531,609.6836,1448.9531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="611.6836" y1="1448.9531" y2="1448.9531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="1444.5947">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1444.5947">Get TPM evidence</text><polygon fill="#181818" points="248.6621,1470.5938,238.6621,1474.5938,248.6621,1478.5938,244.6621,1474.5938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="242.6621" x2="616.6836" y1="1474.5938" y2="1474.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="254.6621" y="1470.2354">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.1895" y="1470.2354">TPM2B_ATTEST Objekt and TPM EK certificate chain</text><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="279.6621" y1="1529.875" y2="1529.875"/><line style="stroke:#181818;stroke-width:1;" x1="279.6621" x2="279.6621" y1="1529.875" y2="1542.875"/><line style="stroke:#181818;stroke-width:1;" x1="238.6621" x2="279.6621" y1="1542.875" y2="1542.875"/><polygon fill="#181818" points="248.6621,1538.875,238.6621,1542.875,248.6621,1546.875,244.6621,1542.875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="1525.5166">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1525.5166">Sign Client Attestation JWT with Client Key</text><path d="M216.6621,1582.875 L469.6602,1582.875 L469.6602,1586.5156 L459.6602,1596.5156 L216.6621,1596.5156 L216.6621,1582.875" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="187.125" style="stroke:#000000;stroke-width:1.5;" width="932.7681" x="216.6621" y="1582.875"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="231.6621" y="1593.1572">Client Attestation PoP and DPoP JWT</text><polygon fill="#181818" points="1116.4302,1620.1563,1126.4302,1624.1563,1116.4302,1628.1563,1120.4302,1624.1563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="1122.4302" y1="1624.1563" y2="1624.1563"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="1619.7979">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="269.1895" y="1619.7979">GET /nonce</text><polygon fill="#181818" points="248.6621,1645.7969,238.6621,1649.7969,248.6621,1653.7969,244.6621,1649.7969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="242.6621" x2="1127.4302" y1="1649.7969" y2="1649.7969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="254.6621" y="1645.4385">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.1895" y="1645.4385">return 200 OK new-nonce: nonce</text><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="279.6621" y1="1698.7188" y2="1698.7188"/><line style="stroke:#181818;stroke-width:1;" x1="279.6621" x2="279.6621" y1="1698.7188" y2="1711.7188"/><line style="stroke:#181818;stroke-width:1;" x1="238.6621" x2="279.6621" y1="1711.7188" y2="1711.7188"/><polygon fill="#181818" points="248.6621,1707.7188,238.6621,1711.7188,248.6621,1715.7188,244.6621,1711.7188" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="1682.7197">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="269.1895" y="1671.0791">Generate Client Attestation PoP JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1682.7197">("typ": "oauth-client-attestation-pop+jwt", "nonce"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1694.3604">sign with the private Client Instance Key)</text><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="279.6621" y1="1749" y2="1749"/><line style="stroke:#181818;stroke-width:1;" x1="279.6621" x2="279.6621" y1="1749" y2="1762"/><line style="stroke:#181818;stroke-width:1;" x1="238.6621" x2="279.6621" y1="1762" y2="1762"/><polygon fill="#181818" points="248.6621,1758,238.6621,1762,248.6621,1766,244.6621,1762" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="1738.8213">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="269.1895" y="1733.001">Generate DPoP JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1744.6416">("nonce", sign with the private DPoP Key)</text><polygon fill="#181818" points="1116.4302,1916.4063,1126.4302,1920.4063,1116.4302,1924.4063,1120.4302,1920.4063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="1122.4302" y1="1920.4063" y2="1920.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="1863.665">(31)</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="269.1895" y="1811.2822">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1822.9229">POST /token HTTP/1.1</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1834.5635">Host: auths.example.com</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1846.2041">Content-Type: application/x-www-form-urlencoded</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1857.8447">OAuth-Client-Attestation: &lt;Base64url-kodiertes Client Attestation JWT&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1869.4854">OAuth-Client-Attestation-PoP: &lt;Base64url-kodiertes Client Attestation PoP JWT&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1881.126">grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Atoken-exchange&amp;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1892.7666">subject_token=&lt;SM(C)-B Access Token JWT&gt;&amp;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1904.4072">subject_token_type=urn%3Aexample%3Asmc-b-jwt&amp;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="1916.0479">audience=https%3A%2F%2Fbackend.example.com%2Fapi</text><path d="M862.0347,1933.4063 L862.0347,1954.4063 L1128.0347,1954.4063 L1128.0347,1943.4063 L1118.0347,1933.4063 L862.0347,1933.4063" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1118.0347,1933.4063 L1118.0347,1943.4063 L1128.0347,1943.4063 L1118.0347,1933.4063" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="868.0347" y="1947.6885">RFC7523 (JWT Client Assertion), RFC9449 (DPoP)</text><line style="stroke:#181818;stroke-width:1;" x1="1138.4302" x2="1180.4302" y1="1977.6875" y2="1977.6875"/><line style="stroke:#181818;stroke-width:1;" x1="1180.4302" x2="1180.4302" y1="1977.6875" y2="1990.6875"/><line style="stroke:#181818;stroke-width:1;" x1="1139.4302" x2="1180.4302" y1="1990.6875" y2="1990.6875"/><polygon fill="#181818" points="1149.4302,1986.6875,1139.4302,1990.6875,1149.4302,1994.6875,1145.4302,1990.6875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1145.4302" y="1973.3291">(32)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1169.9575" y="1973.3291">verify SM(C)-B Access Token JWT</text><line style="stroke:#181818;stroke-width:1;" x1="1138.4302" x2="1180.4302" y1="2016.3281" y2="2016.3281"/><line style="stroke:#181818;stroke-width:1;" x1="1180.4302" x2="1180.4302" y1="2016.3281" y2="2029.3281"/><line style="stroke:#181818;stroke-width:1;" x1="1139.4302" x2="1180.4302" y1="2029.3281" y2="2029.3281"/><polygon fill="#181818" points="1149.4302,2025.3281,1139.4302,2029.3281,1149.4302,2033.3281,1145.4302,2029.3281" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1145.4302" y="2011.9697">(33)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1169.9575" y="2011.9697">verify Client Attestation JWT and PoP JWT</text><line style="stroke:#181818;stroke-width:1;" x1="1138.4302" x2="1180.4302" y1="2054.9688" y2="2054.9688"/><line style="stroke:#181818;stroke-width:1;" x1="1180.4302" x2="1180.4302" y1="2054.9688" y2="2067.9688"/><line style="stroke:#181818;stroke-width:1;" x1="1139.4302" x2="1180.4302" y1="2067.9688" y2="2067.9688"/><polygon fill="#181818" points="1149.4302,2063.9688,1139.4302,2067.9688,1149.4302,2071.9688,1145.4302,2067.9688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1145.4302" y="2050.6104">(34)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1169.9575" y="2050.6104">Create state for Session, Identity and Client</text><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="279.6621" y1="2123.25" y2="2123.25"/><line style="stroke:#181818;stroke-width:1;" x1="279.6621" x2="279.6621" y1="2123.25" y2="2136.25"/><line style="stroke:#181818;stroke-width:1;" x1="238.6621" x2="279.6621" y1="2136.25" y2="2136.25"/><polygon fill="#181818" points="248.6621,2132.25,238.6621,2136.25,248.6621,2140.25,244.6621,2136.25" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="2118.8916">(35)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="2118.8916">create DPoP JWT without nonce</text><polygon fill="#181818" points="1116.4302,2192.8125,1126.4302,2196.8125,1116.4302,2200.8125,1120.4302,2196.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="1122.4302" y1="2196.8125" y2="2196.8125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="2174.9932">(36)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="2157.5322">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="275.5469" y="2169.1729">DPoP: ... (DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="275.5469" y="2180.8135">grant_type=refresh_token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="275.5469" y="2192.4541">refresh_token= ... (Refresh token)</text><line style="stroke:#181818;stroke-width:1;" x1="1138.4302" x2="1180.4302" y1="2222.4531" y2="2222.4531"/><line style="stroke:#181818;stroke-width:1;" x1="1180.4302" x2="1180.4302" y1="2222.4531" y2="2235.4531"/><line style="stroke:#181818;stroke-width:1;" x1="1139.4302" x2="1180.4302" y1="2235.4531" y2="2235.4531"/><polygon fill="#181818" points="1149.4302,2231.4531,1139.4302,2235.4531,1149.4302,2239.4531,1145.4302,2235.4531" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1145.4302" y="2218.0947">(37)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1169.9575" y="2218.0947">verify Refresh token and DPoP JWT</text><line style="stroke:#181818;stroke-width:1;" x1="1138.4302" x2="1180.4302" y1="2261.0938" y2="2261.0938"/><line style="stroke:#181818;stroke-width:1;" x1="1180.4302" x2="1180.4302" y1="2261.0938" y2="2274.0938"/><line style="stroke:#181818;stroke-width:1;" x1="1139.4302" x2="1180.4302" y1="2274.0938" y2="2274.0938"/><polygon fill="#181818" points="1149.4302,2270.0938,1139.4302,2274.0938,1149.4302,2278.0938,1145.4302,2274.0938" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1145.4302" y="2256.7354">(38)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1169.9575" y="2256.7354">invalidate Refresh token</text><polygon fill="#181818" points="1413.0825,2309.7344,1423.0825,2313.7344,1413.0825,2317.7344,1417.0825,2313.7344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1138.4302" x2="1419.0825" y1="2313.7344" y2="2313.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1145.4302" y="2309.376">(39)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1169.9575" y="2309.376">POST /v1/data/authz, json body {  "input": {...}}</text><polygon fill="#181818" points="1149.4302,2347.0156,1139.4302,2351.0156,1149.4302,2355.0156,1145.4302,2351.0156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1143.4302" x2="1424.0825" y1="2351.0156" y2="2351.0156"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1155.4302" y="2340.8369">(40)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1179.9575" y="2335.0166">200 OK, json body {"result": {"allow": true,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1179.9575" y="2346.6572">"access_token_attributes": {...}}</text><line style="stroke:#181818;stroke-width:1;" x1="1138.4302" x2="1180.4302" y1="2388.2969" y2="2388.2969"/><line style="stroke:#181818;stroke-width:1;" x1="1180.4302" x2="1180.4302" y1="2388.2969" y2="2401.2969"/><line style="stroke:#181818;stroke-width:1;" x1="1139.4302" x2="1180.4302" y1="2401.2969" y2="2401.2969"/><polygon fill="#181818" points="1149.4302,2397.2969,1139.4302,2401.2969,1149.4302,2405.2969,1145.4302,2401.2969" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1145.4302" y="2378.1182">(41)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1169.9575" y="2372.2979">issue Access and Refresh token with DPoP Binding</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1176.3149" y="2383.9385">and Access token attributes</text><polygon fill="#181818" points="248.6621,2422.9375,238.6621,2426.9375,248.6621,2430.9375,244.6621,2426.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="242.6621" x2="1127.4302" y1="2426.9375" y2="2426.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="254.6621" y="2422.5791">(42)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.1895" y="2422.5791">200 OK, Access token, Refresh token, bound to DPoP</text><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="279.6621" y1="2452.5781" y2="2452.5781"/><line style="stroke:#181818;stroke-width:1;" x1="279.6621" x2="279.6621" y1="2452.5781" y2="2465.5781"/><line style="stroke:#181818;stroke-width:1;" x1="238.6621" x2="279.6621" y1="2465.5781" y2="2465.5781"/><polygon fill="#181818" points="248.6621,2461.5781,238.6621,2465.5781,248.6621,2469.5781,244.6621,2465.5781" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="2448.2197">(43)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="2448.2197">Create DPoP Proof for RS</text><polygon fill="#181818" points="895.2905,2510.5,905.2905,2514.5,895.2905,2518.5,899.2905,2514.5" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="237.6621" x2="901.2905" y1="2514.5" y2="2514.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="244.6621" y="2498.501">(44)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="269.1895" y="2486.8604">GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="275.5469" y="2498.501">Authorization: DPoP ... (Accesss token)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="275.5469" y="2510.1416">DPoP: ... (DPoP token)</text><line style="stroke:#181818;stroke-width:1;" x1="917.2905" x2="959.2905" y1="2540.1406" y2="2540.1406"/><line style="stroke:#181818;stroke-width:1;" x1="959.2905" x2="959.2905" y1="2540.1406" y2="2553.1406"/><line style="stroke:#181818;stroke-width:1;" x1="918.2905" x2="959.2905" y1="2553.1406" y2="2553.1406"/><polygon fill="#181818" points="928.2905,2549.1406,918.2905,2553.1406,928.2905,2557.1406,924.2905,2553.1406" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="924.2905" y="2535.7822">(45)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="948.8179" y="2535.7822">verify Access token and DPoP Proof</text><line style="stroke:#181818;stroke-width:1;" x1="917.2905" x2="959.2905" y1="2590.4219" y2="2590.4219"/><line style="stroke:#181818;stroke-width:1;" x1="959.2905" x2="959.2905" y1="2590.4219" y2="2603.4219"/><line style="stroke:#181818;stroke-width:1;" x1="918.2905" x2="959.2905" y1="2603.4219" y2="2603.4219"/><polygon fill="#181818" points="928.2905,2599.4219,918.2905,2603.4219,928.2905,2607.4219,924.2905,2603.4219" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="924.2905" y="2580.2432">(46)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="948.8179" y="2574.4229">additional checks according to</text><text fill="#000000" font-family="Helvetica" font-size="10" x="948.8179" y="2586.0635">Access token attributes</text><polygon fill="#181818" points="1521.6187,2636.7031,1531.6187,2640.7031,1521.6187,2644.7031,1525.6187,2640.7031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="917.2905" x2="1527.6187" y1="2640.7031" y2="2640.7031"/><text fill="#000000" font-family="Helvetica" font-size="10" x="924.2905" y="2630.5244">(47)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="948.8179" y="2624.7041">forward GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="948.8179" y="2636.3447">with header and header content as json</text><line style="stroke:#181818;stroke-width:1;" x1="1543.6187" x2="1585.6187" y1="2689.625" y2="2689.625"/><line style="stroke:#181818;stroke-width:1;" x1="1585.6187" x2="1585.6187" y1="2689.625" y2="2702.625"/><line style="stroke:#181818;stroke-width:1;" x1="1544.6187" x2="1585.6187" y1="2702.625" y2="2702.625"/><polygon fill="#181818" points="1554.6187,2698.625,1544.6187,2702.625,1554.6187,2706.625,1550.6187,2702.625" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1550.6187" y="2673.626">(48)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1575.146" y="2661.9854">provide</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1575.146" y="2673.626">resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1575.146" y="2685.2666">access</text><polygon fill="#181818" points="928.2905,2724.2656,918.2905,2728.2656,928.2905,2732.2656,924.2905,2728.2656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="922.2905" x2="1532.6187" y1="2728.2656" y2="2728.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="934.2905" y="2723.9072">(49)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="958.8179" y="2723.9072">200 OK, resource</text><polygon fill="#181818" points="248.6621,2749.9063,238.6621,2753.9063,248.6621,2757.9063,244.6621,2753.9063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="242.6621" x2="906.2905" y1="2753.9063" y2="2753.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="254.6621" y="2749.5479">(50)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.1895" y="2749.5479">200 OK, resource</text><!--SRC=[jLZlRkEu4V-kfvZgSBqujVBlSjUkUzd2IHmdczsrQhjOz60We2NQrbec1OgAuptSk_J3FSP-kdsnpf2IBTbMBbsWG12BvFoV7uT3ianBaIt6N85xS7BIS9rq7ec4ARQ0a4zO5kiRAVGW-iJXz6J_udksu73BuqUkeu2LQAujpJifP9gmW8ThwYkPgOYh4ctCnLJFsk77BDKWfE2EywT4iUc2WURo4sYLuLGxq5B1lr9a7SidSDzsxbpufZkJgVumYpHt0CoyhwB5bzzKkaerNo35M_R8HOXS03d5pvrX6wxYY0kDwmCcmjMbaajXA03GA7GcIfZGEHMmr7ADHCvcI54i2NIscOR-EyE1lqIu8IiJtKiX-9nS8jBDIAgH6DvvNQRvagtSBQx1kqj3FtXtSDNmBbsd46vZqXRZY6kkqArXv-hsVUzjh_jlf-nsDsCgtFMwhEFMDohyZZyICwqJy9LyMhaxTErCpmQMz1f9QIXLz8dfI0eOSFL8Tknm-PqDYo_ZA5X1HqmZmQkXiZOFx-3iw0IkCUO8ZM-kcPeFEEigplSbgs-jwVCK8HRmmePAhjRn8Y21zphFSCi02vOe9WKjHu850KzJKBci4S8IjWGxBD3H8-Ofb-4u5nTeQXf8N5p1nONZJ9NC4YZX3MPeuPOSkFddzNiuw0yy-cYWkJajMdVhjw3R6SBnqPB7iJSNcB1ZoJ3KNgAave7ceLSO2RUu5rgG2q8vQmDlVHnXNhsImyNlsSa9zEx_3XzJT74imnKi8ps33wJldlJPbMiPP0kowg1_SmMXOXFj8TOcdhMciC5RSCr2fXdv4VAg1Hk_37PgNMDbA7cfYTBl_x7U6SuT1yqiJbXCbjty6lV-TdvwlcL_eG3_1COTL3ITQP2J8lU4iTvamWM76onTNBJCb8UALCW5X16tEesVy6RGUuywvqOdXpIQ2go9-Xzh9e5siIPWQ88PJ-5dN8mcqPnfD5-5CFdoMHcP0-HaEbE08LfIdTl8m5L3Mo7xyXdhVQA-V9uOGjeEv8z36yC0U2ZdQ6xdAPWnCUK6nIpMPVWA2OyiZaBS71DC-mpt2xBi8mlCw252oNkIx_S6c7t5fn5MQcK2_zSVNfqsNfRNNDoTc4Yri3K7zrKYHSfjXjVAIvADatPJMZ-xc31bkCd4NG_oKLjhdcghvPwlm6UHFKzA75cAUSAIdnUcZRjKMLhG6siM2MY7YqYioukM9GvRaKekqZbYwC6IxqX60Wo4ufiQjDTIG0aRDUlORgP8KLcndusnC6_BoebBcwAGmEEKLyAGydXYGCt37OiEGfue7Y1_sDZnQ9rTwrHPpX-bWd9h_p-NoJiyI9Z0MbdXhJNW6QvSaqLJVXv3s-RLWklDXw5J8tvgSSVXsfS-p55gGb9hg0yFkmLzdQB3mv4uSFKgSLlWujXjWilYAOqwWxCVVdH7maspCOqrZpdjc3dk3RT9yu5Ck5aXQGyyt_ikk86OuBpPJed5nFuiDBOCNxSpBU1FkBa5Ysa7useKFEU5XycQEHMKhaMPwKsVX5gm6MePTDImuhgPeAQfQXJH5oMHErkeBjWgkefKFCjPjNKtZ-qmh0gW0h0l5jlmsXDr0jSVecK_NmKhziIrnT9Z6yA_V5pgPq2qhgv4Gp3PXvBojccyk5wQgaOXgZ7VQjeFn9g2LYEeciWT6xhSzlByCS8ZFE0rmd5yTldG7WuxU9xrnXyH0O3TjQ7ht4DWZsw3UznOaVW_bSoNHgo8KgLUriACoXCvO-hKBkRoenmXHvqSDia1FpmqDBidjk8OQf4tP23uqZFqBJ0_NmNctAWN0TfBP5A0scX4D9lYOOA3nGaILMxdzw3tMVEkAyPO3KtOhy7Gvc8f0oOBUw9gMoHJbabiQGYtmw5_V7fqEXAsBoQlqoF-n1P9p8y2kS2xAbwvAGZ3LO9HPaaI4men5CTFtdAvzAXpyZA5r-z0XZmSYHufzgmTNYdEBVZfagNyntCazkOof5OL8RiVRA_hvNZezijbvV54ULE5zx87p2-_G0Hz-tsRBXxuOvuFKlmmESTVG-WH8GvCdBpYDFipPZl3pHcW85gu-Adk47gzJLhMd0SOlz95u8qz11IIimpzm8HVq7sP3Fhsx0R_nYn0zh2S5PnbIUGupl5tBqWuGkv_pI4OSBNWwEW83WfCDcZ-wwA83dfZpXHN98EbAPKpAIxuwitCw2WoLwmOVSvtnuwv9yLyOgv9HIDlMl6px-60oj8sQwD9ww_EprzPqqt3RkydUJbPXmglEz5aLTztrT3Nr4UgS4M1s-OiMb5D_p7SU6jFKsHimbr83OrU6VRY3Q1SsAdrj5UbVkMgj5j70gkao9Uf63BJUMcikJePOI_CU7vNUrZpL2OkB7F5oaPT32jKrSDXcoCIndrohHe1K_3Mr7wdSEdnz9WU3uu9YP-QfKlxBm1k999COud_1OtzzLVOlB_u7SVlcBCcrslFc0g_YzgpsB1ZJnFB9NxHmo8rmFPwbMzsF39KDCuG86jLJgd7GrqxNgPfnWi8KZog4JBLtuJeCX9X9APc8o5PkxW4cZYkrJfrZnZD2aUpggQ9VcOe53jAqkNil5qujPSSOvkl96vJmdT_uEnvWDgyXDcpVVq-qxBy1a3Mljp0nZvevj0glmlHkvHLb0Ei6fS2NyR04Z4BmuZqinZRAXxCKxebIqK1DYzuTT6r4lgODtHsoLIuxP_9ruop4A_Zf3t_36mbfYT6WjN61OnNVr38J9IaRd4aDlBootlVffHCBz9Pq9IJXTAs7kgUexxrjtXBexmY_HS0]--></g></svg>