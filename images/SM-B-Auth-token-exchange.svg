<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2515px" preserveAspectRatio="none" style="width:1524px;height:2515px;background:#FFFFFF;" version="1.1" viewBox="0 0 1524 2515" width="1524px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="2503.1406" style="stroke:#181818;stroke-width:0.5;" width="604.5342" x="150.1621" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="443.9673" y="15.2822">LEI</text><rect fill="#E6E6FA" height="2486.5" style="stroke:#181818;stroke-width:0.5;" width="388.4497" x="150.1621" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="305.2903" y="31.9229">Prim&#228;rsystem</text><rect fill="#F4A460" height="2469.8594" style="stroke:#181818;stroke-width:0.5;" width="89" x="150.1621" y="39.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="162.1621" y="48.5635">ZETA Client</text><rect fill="#C9FFC9" height="2503.1406" style="stroke:#181818;stroke-width:0.5;" width="715.479" x="766.6963" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1100.0754" y="15.2822">Anbieter</text><rect fill="#F4A460" height="2486.5" style="stroke:#181818;stroke-width:0.5;" width="598.979" x="766.6963" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1033.0413" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="2486.5" style="stroke:#181818;stroke-width:0.5;" width="104.5" x="1377.6753" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1392.3936" y="31.9229">TI 2.0 Dienst</text><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="2304.9375" width="8" x="39.5" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="43" x2="43" y1="126.5625" y2="2431.5"/></g><g><title>ZETA</title><rect fill="#000000" fill-opacity="0.00000" height="2304.9375" width="8" x="191.1621" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="194.6621" x2="194.6621" y1="126.5625" y2="2431.5"/></g><g><title/><rect fill="#FFFFFF" height="2238.0156" style="stroke:#181818;stroke-width:1;" width="10" x="189.6621" y="175.4844"/></g><g><title>TPM</title><rect fill="#000000" fill-opacity="0.00000" height="2304.9375" width="8" x="505.4902" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="508.9902" x2="508.9902" y1="126.5625" y2="2431.5"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="503.9902" y="609.375"/></g><g><title/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1;" width="10" x="503.9902" y="874.5"/></g><g><title>Konnektor or</title><rect fill="#000000" fill-opacity="0.00000" height="2304.9375" width="8" x="590.5386" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="594.0386" x2="594.0386" y1="126.5625" y2="2431.5"/></g><g><title/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1;" width="10" x="589.0386" y="1380.5938"/></g><g><title>SM(C)-B</title><rect fill="#000000" fill-opacity="0.00000" height="2304.9375" width="8" x="720.0815" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="723.5815" x2="723.5815" y1="126.5625" y2="2431.5"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="718.5815" y="1406.2344"/></g><g><title>PEP</title><rect fill="#000000" fill-opacity="0.00000" height="2304.9375" width="8" x="800.0972" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="803.5972" x2="803.5972" y1="126.5625" y2="2431.5"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="798.5972" y="268.4063"/></g><g><title/><rect fill="#FFFFFF" height="239.4063" style="stroke:#181818;stroke-width:1;" width="10" x="798.5972" y="2174.0938"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="2304.9375" width="8" x="1021.2368" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1024.7368" x2="1024.7368" y1="126.5625" y2="2431.5"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="1019.7368" y="319.6875"/></g><g><title/><rect fill="#FFFFFF" height="220.4063" style="stroke:#181818;stroke-width:1;" width="10" x="1019.7368" y="823.2188"/></g><g><title/><rect fill="#FFFFFF" height="819.1406" style="stroke:#181818;stroke-width:1;" width="10" x="1019.7368" y="1267.3906"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="2304.9375" width="8" x="1317.8892" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1321.3892" x2="1321.3892" y1="126.5625" y2="2431.5"/></g><g><title/><rect fill="#FFFFFF" height="37.2813" style="stroke:#181818;stroke-width:1;" width="10" x="1316.3892" y="1973.3281"/></g><g><title>Resource Server</title><rect fill="#000000" fill-opacity="0.00000" height="2304.9375" width="8" x="1426.4253" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1429.9253" x2="1429.9253" y1="126.5625" y2="2431.5"/></g><g><title/><rect fill="#FFFFFF" height="87.5625" style="stroke:#181818;stroke-width:1;" width="10" x="1424.9253" y="2300.2969"/></g><text fill="#000000" font-family="Helvetica" font-size="10" x="28.6035" y="124.2041">User</text><ellipse cx="43" cy="63.4219" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M43,71.4219 L43,98.4219 M30,79.4219 L56,79.4219 M43,98.4219 L30,113.4219 M43,98.4219 L56,113.4219" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="173.187" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="181.603" y="104.5635">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="180.187" y="116.2041">Client</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="491.6069" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="498.6069" y="116.2041">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="554.6118" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="561.6118" y="104.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="565.6182" y="116.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="696.4668" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="703.4668" y="116.2041">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="770.6963" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="794.4077" y="104.5635">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="777.6963" y="116.2041">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="966.2622" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1014.8564" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="973.2622" y="116.2041">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1281.103" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1311.5088" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1288.103" y="116.2041">Policy Engine</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.5" x="1381.6753" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1388.6753" y="116.2041">Resource Server</text><text fill="#000000" font-family="Helvetica" font-size="10" x="28.6035" y="2500.7822">User</text><ellipse cx="43" cy="2440" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M43,2448 L43,2475 M30,2456 L56,2456 M43,2475 L30,2490 M43,2475 L56,2490" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="173.187" y="2431.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="181.603" y="2447.7822">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="180.187" y="2459.4229">Client</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="491.6069" y="2431.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="498.6069" y="2447.7822">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="554.6118" y="2431.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="561.6118" y="2447.7822">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="565.6182" y="2459.4229">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="696.4668" y="2431.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="703.4668" y="2447.7822">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="770.6963" y="2431.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="794.4077" y="2447.7822">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="777.6963" y="2459.4229">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="966.2622" y="2431.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1014.8564" y="2447.7822">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="973.2622" y="2459.4229">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1281.103" y="2431.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1311.5088" y="2447.7822">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1288.103" y="2459.4229">Policy Engine</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.5" x="1381.6753" y="2431.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1388.6753" y="2447.7822">Resource Server</text><polygon fill="#181818" points="177.6621,171.4844,187.6621,175.4844,177.6621,179.4844,181.6621,175.4844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="43" x2="183.6621" y1="175.4844" y2="175.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="50" y="159.4854">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="74.5273" y="147.8447">User wants to</text><text fill="#000000" font-family="Helvetica" font-size="10" x="74.5273" y="159.4854">access resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="74.5273" y="171.126">on Resource Server</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1512.144" x="5" y="202.3047"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1517.144" y1="202.3047" y2="202.3047"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1517.144" y1="205.3047" y2="205.3047"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="72.7109" x="724.7166" y="193.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="730.7166" y="206.7666">Discovery</text><path d="M178.6621,227.125 L507.2998,227.125 L507.2998,230.7656 L497.2998,240.7656 L178.6621,240.7656 L178.6621,227.125" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="192.7656" style="stroke:#000000;stroke-width:1.5;" width="867.0747" x="178.6621" y="227.125"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="193.6621" y="237.4072">ZETA Client has Resource Server FQDN (RS-FQDN)</text><polygon fill="#181818" points="786.5972,264.4063,796.5972,268.4063,786.5972,272.4063,790.5972,268.4063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="792.5972" y1="268.4063" y2="268.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="264.0479">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="264.0479">GET /.well-known/oauth-protected-resource Host: RS-FQDN</text><polygon fill="#181818" points="210.6621,290.0469,200.6621,294.0469,210.6621,298.0469,206.6621,294.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="797.5972" y1="294.0469" y2="294.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="289.6885">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="289.6885">Client: 200 OK; json body with Well-Known json Document (RFC draft-ietf-oauth-resource-metadata)</text><polygon fill="#181818" points="1007.7368,315.6875,1017.7368,319.6875,1007.7368,323.6875,1011.7368,319.6875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="1013.7368" y1="319.6875" y2="319.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="315.3291">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="315.3291">GET /.well-known/oauth-authorization-server&#160;Host: AuthS-FQDN</text><polygon fill="#181818" points="210.6621,341.3281,200.6621,345.3281,210.6621,349.3281,206.6621,345.3281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="1018.7368" y1="345.3281" y2="345.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="340.9697">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="340.9697">200 OK; json body with Well-Known json Document (RFC8414)</text><path d="M204.6621,358.3281 L204.6621,414.3281 L535.6621,414.3281 L535.6621,368.3281 L525.6621,358.3281 L204.6621,358.3281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M525.6621,358.3281 L525.6621,368.3281 L535.6621,368.3281 L525.6621,358.3281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="210.6621" y="372.6104">Offene Fragen:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="210.6621" y="384.251">- Werden die Well-known JSON Dokumente signiert?</text><text fill="#000000" font-family="Helvetica" font-size="10" x="210.6621" y="395.8916">- Wenn ja, welches Zertifikat wird f&#252;r die Signatur verwendet?</text><text fill="#000000" font-family="Helvetica" font-size="10" x="210.6621" y="407.5322">- Wie wird die Signatur &#252;berpr&#252;ft?</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1512.144" x="5" y="452.7109"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1517.144" y1="452.7109" y2="452.7109"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1517.144" y1="455.7109" y2="455.7109"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="175.46" x="673.342" y="443.8906"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="679.342" y="457.1729">Dynamic Client Registration</text><path d="M8,477.5313 L67.9561,477.5313 L67.9561,481.1719 L57.9561,491.1719 L8,491.1719 L8,477.5313" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="247.7656" style="stroke:#000000;stroke-width:1.5;" width="546.9902" x="8" y="477.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="23" y="487.8135">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="82.9561" y="488.8135">[Client has no Key Pair for Client Attestation]</text><path d="M27,505.1719 L86.9561,505.1719 L86.9561,508.8125 L76.9561,518.8125 L27,518.8125 L27,505.1719" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="206.125" style="stroke:#000000;stroke-width:1.5;" width="502.9902" x="27" y="505.1719"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="42" y="515.4541">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="101.9561" y="516.4541">[Client uses TPM]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="27" x2="529.9902" y1="654.0156" y2="654.0156"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="32" y="665.2979">[Client uses self signed Key (deprecated)]</text><polygon fill="#181818" points="54,554.0938,44,558.0938,54,562.0938,50,558.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="48" x2="188.6621" y1="558.0938" y2="558.0938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="60" y="547.915">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.5273" y="542.0947">Require Admin</text><text fill="#000000" font-family="Helvetica" font-size="10" x="84.5273" y="553.7354">access to TPM</text><polygon fill="#181818" points="177.6621,579.7344,187.6621,583.7344,177.6621,587.7344,181.6621,583.7344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="43" x2="183.6621" y1="583.7344" y2="583.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="50" y="579.376">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="74.5273" y="579.376">TPM Admin access</text><polygon fill="#181818" points="491.9902,605.375,501.9902,609.375,491.9902,613.375,495.9902,609.375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="497.9902" y1="609.375" y2="609.375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="605.0166">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="605.0166">Create Client Attestation Key Pair in TPM</text><polygon fill="#181818" points="210.6621,631.0156,200.6621,635.0156,210.6621,639.0156,206.6621,635.0156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="502.9902" y1="635.0156" y2="635.0156"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="630.6572">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="630.6572">Public Attestation Key</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="690.2969" y2="690.2969"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="690.2969" y2="703.2969"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="703.2969" y2="703.2969"/><polygon fill="#181818" points="210.6621,699.2969,200.6621,703.2969,210.6621,707.2969,206.6621,703.2969" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="685.9385">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="685.9385">Create Client Key Pair</text><path d="M178.6621,743.2969 L329.6973,743.2969 L329.6973,746.9375 L319.6973,756.9375 L178.6621,756.9375 L178.6621,743.2969" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="386.5313" style="stroke:#000000;stroke-width:1.5;" width="1112.728" x="178.6621" y="743.2969"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="193.6621" y="753.5791">Client Registration</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="784.5781" y2="784.5781"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="784.5781" y2="797.5781"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="797.5781" y2="797.5781"/><polygon fill="#181818" points="210.6621,793.5781,200.6621,797.5781,210.6621,801.5781,206.6621,797.5781" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="780.2197">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="780.2197">Create client statement</text><polygon fill="#181818" points="1007.7368,819.2188,1017.7368,823.2188,1007.7368,827.2188,1011.7368,823.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="1013.7368" y1="823.2188" y2="823.2188"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="818.8604">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="818.8604">GET /nonce</text><polygon fill="#181818" points="210.6621,844.8594,200.6621,848.8594,210.6621,852.8594,206.6621,848.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="1018.7368" y1="848.8594" y2="848.8594"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="844.501">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="844.501">return 200 OK new-nonce: nonce</text><polygon fill="#181818" points="491.9902,870.5,501.9902,874.5,491.9902,878.5,495.9902,874.5" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="497.9902" y1="874.5" y2="874.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="870.1416">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="870.1416">Sign client statement</text><polygon fill="#181818" points="210.6621,896.1406,200.6621,900.1406,210.6621,904.1406,206.6621,900.1406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="502.9902" y1="900.1406" y2="900.1406"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="895.7822">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="895.7822">client statement Signature (Attestation Statement)</text><polygon fill="#181818" points="491.9902,921.7813,501.9902,925.7813,491.9902,929.7813,495.9902,925.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="497.9902" y1="925.7813" y2="925.7813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="921.4229">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="921.4229">Create "Certify Key" Quote for Attestation Key</text><polygon fill="#181818" points="210.6621,947.4219,200.6621,951.4219,210.6621,955.4219,206.6621,951.4219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="502.9902" y1="951.4219" y2="951.4219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="947.0635">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="947.0635">"Certify Key" Quote</text><polygon fill="#181818" points="1007.7368,973.0625,1017.7368,977.0625,1007.7368,981.0625,1011.7368,977.0625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="1013.7368" y1="977.0625" y2="977.0625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="972.7041">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="972.7041">Client Registration Request</text><path d="M1034.7368,964.4219 L1034.7368,1008.4219 L1269.7368,1008.4219 L1269.7368,974.4219 L1259.7368,964.4219 L1034.7368,964.4219" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1259.7368,964.4219 L1259.7368,974.4219 L1269.7368,974.4219 L1259.7368,964.4219" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1040.7368" y="978.7041">client_statement.yaml</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1040.7368" y="990.3447">Includes attestation statement, public key,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1040.7368" y="1001.9854">and client statement</text><polygon fill="#181818" points="210.6621,1039.625,200.6621,1043.625,210.6621,1047.625,206.6621,1043.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="1018.7368" y1="1043.625" y2="1043.625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="1033.4463">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="1027.626">Client Registration Response</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="1039.2666">(client_id)</text><path d="M204.6621,1056.625 L204.6621,1124.625 L600.6621,1124.625 L600.6621,1066.625 L590.6621,1056.625 L204.6621,1056.625" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M590.6621,1056.625 L590.6621,1066.625 L600.6621,1066.625 L590.6621,1056.625" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="210.6621" y="1070.9072">Offene Fragen:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="210.6621" y="1082.5479">- Wie wird die Signatur des Attestation Statements &#252;berpr&#252;ft?</text><text fill="#000000" font-family="Helvetica" font-size="10" x="210.6621" y="1094.1885">- Wie wird die Signatur des Attestation Statements erstellt?</text><text fill="#000000" font-family="Helvetica" font-size="10" x="210.6621" y="1105.8291">- Beschreibung Client Registration Endpoint (RFC7591) in gemSpec_ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="210.6621" y="1117.4697">- Beschreibung Client Configuration Endpoint (RFC7592) in gemSpec_ZETA</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1512.144" x="5" y="1162.6484"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1517.144" y1="1162.6484" y2="1162.6484"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1517.144" y1="1165.6484" y2="1165.6484"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="229.3809" x="646.3816" y="1153.8281"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="652.3816" y="1167.1104">Token Exchange (under construction)</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="1201.1094" y2="1201.1094"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="1201.1094" y2="1214.1094"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="1214.1094" y2="1214.1094"/><polygon fill="#181818" points="210.6621,1210.1094,200.6621,1214.1094,210.6621,1218.1094,206.6621,1214.1094" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1196.751">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1196.751">generate DPoP key pair</text><path d="M178.6621,1226.1094 L238.6182,1226.1094 L238.6182,1229.75 L228.6182,1239.75 L178.6621,1239.75 L178.6621,1226.1094" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="715.5781" style="stroke:#000000;stroke-width:1.5;" width="1111.2856" x="178.6621" y="1226.1094"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="193.6621" y="1236.3916">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="253.6182" y="1237.3916">[Client has no valid refresh token]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="178.6621" x2="1289.9478" y1="1746.5625" y2="1746.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="183.6621" y="1757.8447">[Client has valid Refresh token]</text><polygon fill="#181818" points="1007.7368,1263.3906,1017.7368,1267.3906,1007.7368,1271.3906,1011.7368,1267.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="1013.7368" y1="1267.3906" y2="1267.3906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1263.0322">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1263.0322">GET /nonce</text><polygon fill="#181818" points="210.6621,1289.0313,200.6621,1293.0313,210.6621,1297.0313,206.6621,1293.0313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="1018.7368" y1="1293.0313" y2="1293.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="1288.6729">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="1288.6729">return 200 OK new-nonce: nonce</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="1341.9531" y2="1341.9531"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="1341.9531" y2="1354.9531"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="1354.9531" y2="1354.9531"/><polygon fill="#181818" points="210.6621,1350.9531,200.6621,1354.9531,210.6621,1358.9531,206.6621,1354.9531" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1325.9541">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1314.3135">create Client Assertion JWT with nonce</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="1325.9541">Client and OS Information</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="1337.5947">DPoP Thumbprint</text><polygon fill="#181818" points="577.0386,1376.5938,587.0386,1380.5938,577.0386,1384.5938,581.0386,1380.5938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="583.0386" y1="1380.5938" y2="1380.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1376.2354">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1376.2354">externalAuthenticate JWT-hash</text><polygon fill="#181818" points="706.5815,1402.2344,716.5815,1406.2344,706.5815,1410.2344,710.5815,1406.2344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="599.0386" x2="712.5815" y1="1406.2344" y2="1406.2344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="606.0386" y="1401.876">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="630.5659" y="1401.876">sign JWT-hash</text><polygon fill="#181818" points="610.0386,1427.875,600.0386,1431.875,610.0386,1435.875,606.0386,1431.875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="604.0386" x2="717.5815" y1="1431.875" y2="1431.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="616.0386" y="1427.5166">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="640.5659" y="1427.5166">JWT-Signature</text><polygon fill="#181818" points="210.6621,1453.5156,200.6621,1457.5156,210.6621,1461.5156,206.6621,1457.5156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="204.6621" x2="588.0386" y1="1457.5156" y2="1457.5156"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="1453.1572">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="1453.1572">JWT-signature</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="1494.7969" y2="1494.7969"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="1494.7969" y2="1507.7969"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="1507.7969" y2="1507.7969"/><polygon fill="#181818" points="210.6621,1503.7969,200.6621,1507.7969,210.6621,1511.7969,206.6621,1507.7969" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1484.6182">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1478.7979">add SM-B Signature to Client Assertion JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1490.4385">cC4h... (Client Assertion JWT)</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="1533.4375" y2="1533.4375"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="1533.4375" y2="1546.4375"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="1546.4375" y2="1546.4375"/><polygon fill="#181818" points="210.6621,1542.4375,200.6621,1546.4375,210.6621,1550.4375,206.6621,1546.4375" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1529.0791">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1529.0791">create DPoP JWT with nonce</text><polygon fill="#181818" points="1007.7368,1614.6406,1017.7368,1618.6406,1007.7368,1622.6406,1011.7368,1618.6406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="1013.7368" y1="1618.6406" y2="1618.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1591.001">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1567.7197">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="1579.3604">Content-Type: application/x-www-form-urlencoded</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="1591.001">DPoP: ... (DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="1602.6416">grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="1614.2822">assertion=eyJh... (Client Assertion JWT)</text><path d="M753.3413,1631.6406 L753.3413,1652.6406 L1019.3413,1652.6406 L1019.3413,1641.6406 L1009.3413,1631.6406 L753.3413,1631.6406" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1009.3413,1631.6406 L1009.3413,1641.6406 L1019.3413,1641.6406 L1009.3413,1631.6406" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="759.3413" y="1645.9229">RFC7523 (JWT Client Assertion), RFC9449 (DPoP)</text><line style="stroke:#181818;stroke-width:1;" x1="1029.7368" x2="1071.7368" y1="1675.9219" y2="1675.9219"/><line style="stroke:#181818;stroke-width:1;" x1="1071.7368" x2="1071.7368" y1="1675.9219" y2="1688.9219"/><line style="stroke:#181818;stroke-width:1;" x1="1030.7368" x2="1071.7368" y1="1688.9219" y2="1688.9219"/><polygon fill="#181818" points="1040.7368,1684.9219,1030.7368,1688.9219,1040.7368,1692.9219,1036.7368,1688.9219" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1036.7368" y="1671.5635">(31)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1061.2642" y="1671.5635">verify Client Assertion JWT and DPoP JWT</text><line style="stroke:#181818;stroke-width:1;" x1="1029.7368" x2="1071.7368" y1="1714.5625" y2="1714.5625"/><line style="stroke:#181818;stroke-width:1;" x1="1071.7368" x2="1071.7368" y1="1714.5625" y2="1727.5625"/><line style="stroke:#181818;stroke-width:1;" x1="1030.7368" x2="1071.7368" y1="1727.5625" y2="1727.5625"/><polygon fill="#181818" points="1040.7368,1723.5625,1030.7368,1727.5625,1040.7368,1731.5625,1036.7368,1727.5625" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1036.7368" y="1710.2041">(32)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1061.2642" y="1710.2041">Create state for Identity/App/Device</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="1782.8438" y2="1782.8438"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="1782.8438" y2="1795.8438"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="1795.8438" y2="1795.8438"/><polygon fill="#181818" points="210.6621,1791.8438,200.6621,1795.8438,210.6621,1799.8438,206.6621,1795.8438" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1778.4854">(33)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1778.4854">create DPoP JWT without nonce</text><polygon fill="#181818" points="1007.7368,1852.4063,1017.7368,1856.4063,1007.7368,1860.4063,1011.7368,1856.4063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="1013.7368" y1="1856.4063" y2="1856.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="1834.5869">(34)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="1817.126">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="1828.7666">DPoP: ... (DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="1840.4072">grant_type=refresh_token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="1852.0479">refresh_token= ... (Refresh token)</text><line style="stroke:#181818;stroke-width:1;" x1="1029.7368" x2="1071.7368" y1="1882.0469" y2="1882.0469"/><line style="stroke:#181818;stroke-width:1;" x1="1071.7368" x2="1071.7368" y1="1882.0469" y2="1895.0469"/><line style="stroke:#181818;stroke-width:1;" x1="1030.7368" x2="1071.7368" y1="1895.0469" y2="1895.0469"/><polygon fill="#181818" points="1040.7368,1891.0469,1030.7368,1895.0469,1040.7368,1899.0469,1036.7368,1895.0469" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1036.7368" y="1877.6885">(35)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1061.2642" y="1877.6885">verify Refresh token and DPoP JWT</text><line style="stroke:#181818;stroke-width:1;" x1="1029.7368" x2="1071.7368" y1="1920.6875" y2="1920.6875"/><line style="stroke:#181818;stroke-width:1;" x1="1071.7368" x2="1071.7368" y1="1920.6875" y2="1933.6875"/><line style="stroke:#181818;stroke-width:1;" x1="1030.7368" x2="1071.7368" y1="1933.6875" y2="1933.6875"/><polygon fill="#181818" points="1040.7368,1929.6875,1030.7368,1933.6875,1040.7368,1937.6875,1036.7368,1933.6875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1036.7368" y="1916.3291">(36)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1061.2642" y="1916.3291">invalidate Refresh token</text><polygon fill="#181818" points="1304.3892,1969.3281,1314.3892,1973.3281,1304.3892,1977.3281,1308.3892,1973.3281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1029.7368" x2="1310.3892" y1="1973.3281" y2="1973.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1036.7368" y="1968.9697">(37)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1061.2642" y="1968.9697">POST /v1/data/authz, json body {  "input": {...}}</text><polygon fill="#181818" points="1040.7368,2006.6094,1030.7368,2010.6094,1040.7368,2014.6094,1036.7368,2010.6094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1034.7368" x2="1315.3892" y1="2010.6094" y2="2010.6094"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1046.7368" y="2000.4307">(38)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1071.2642" y="1994.6104">200 OK, json body {"result": {"allow": true,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1071.2642" y="2006.251">"access_token_attributes": {...}}</text><line style="stroke:#181818;stroke-width:1;" x1="1029.7368" x2="1071.7368" y1="2047.8906" y2="2047.8906"/><line style="stroke:#181818;stroke-width:1;" x1="1071.7368" x2="1071.7368" y1="2047.8906" y2="2060.8906"/><line style="stroke:#181818;stroke-width:1;" x1="1030.7368" x2="1071.7368" y1="2060.8906" y2="2060.8906"/><polygon fill="#181818" points="1040.7368,2056.8906,1030.7368,2060.8906,1040.7368,2064.8906,1036.7368,2060.8906" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1036.7368" y="2037.7119">(39)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1061.2642" y="2031.8916">issue Access and Refresh token with DPoP Binding</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1067.6216" y="2043.5322">and Access token attributes</text><polygon fill="#181818" points="210.6621,2082.5313,200.6621,2086.5313,210.6621,2090.5313,206.6621,2086.5313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="1018.7368" y1="2086.5313" y2="2086.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="2082.1729">(40)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="2082.1729">200 OK, Access token, Refresh token, bound to DPoP</text><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="241.6621" y1="2112.1719" y2="2112.1719"/><line style="stroke:#181818;stroke-width:1;" x1="241.6621" x2="241.6621" y1="2112.1719" y2="2125.1719"/><line style="stroke:#181818;stroke-width:1;" x1="200.6621" x2="241.6621" y1="2125.1719" y2="2125.1719"/><polygon fill="#181818" points="210.6621,2121.1719,200.6621,2125.1719,210.6621,2129.1719,206.6621,2125.1719" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="2107.8135">(41)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="2107.8135">Create DPoP Proof for RS</text><polygon fill="#181818" points="786.5972,2170.0938,796.5972,2174.0938,786.5972,2178.0938,790.5972,2174.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="199.6621" x2="792.5972" y1="2174.0938" y2="2174.0938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="206.6621" y="2158.0947">(42)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="231.1895" y="2146.4541">GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="2158.0947">Authorization: DPoP ... (Accesss token)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="237.5469" y="2169.7354">DPoP: ... (DPoP token)</text><line style="stroke:#181818;stroke-width:1;" x1="808.5972" x2="850.5972" y1="2199.7344" y2="2199.7344"/><line style="stroke:#181818;stroke-width:1;" x1="850.5972" x2="850.5972" y1="2199.7344" y2="2212.7344"/><line style="stroke:#181818;stroke-width:1;" x1="809.5972" x2="850.5972" y1="2212.7344" y2="2212.7344"/><polygon fill="#181818" points="819.5972,2208.7344,809.5972,2212.7344,819.5972,2216.7344,815.5972,2212.7344" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="815.5972" y="2195.376">(43)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="840.1245" y="2195.376">verify Access token and DPoP Proof</text><line style="stroke:#181818;stroke-width:1;" x1="808.5972" x2="850.5972" y1="2250.0156" y2="2250.0156"/><line style="stroke:#181818;stroke-width:1;" x1="850.5972" x2="850.5972" y1="2250.0156" y2="2263.0156"/><line style="stroke:#181818;stroke-width:1;" x1="809.5972" x2="850.5972" y1="2263.0156" y2="2263.0156"/><polygon fill="#181818" points="819.5972,2259.0156,809.5972,2263.0156,819.5972,2267.0156,815.5972,2263.0156" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="815.5972" y="2239.8369">(44)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="840.1245" y="2234.0166">additional checks according to</text><text fill="#000000" font-family="Helvetica" font-size="10" x="840.1245" y="2245.6572">Access token attributes</text><polygon fill="#181818" points="1412.9253,2296.2969,1422.9253,2300.2969,1412.9253,2304.2969,1416.9253,2300.2969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="808.5972" x2="1418.9253" y1="2300.2969" y2="2300.2969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="815.5972" y="2290.1182">(45)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="840.1245" y="2284.2979">forward GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="840.1245" y="2295.9385">with header and header content as json</text><line style="stroke:#181818;stroke-width:1;" x1="1434.9253" x2="1476.9253" y1="2349.2188" y2="2349.2188"/><line style="stroke:#181818;stroke-width:1;" x1="1476.9253" x2="1476.9253" y1="2349.2188" y2="2362.2188"/><line style="stroke:#181818;stroke-width:1;" x1="1435.9253" x2="1476.9253" y1="2362.2188" y2="2362.2188"/><polygon fill="#181818" points="1445.9253,2358.2188,1435.9253,2362.2188,1445.9253,2366.2188,1441.9253,2362.2188" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1441.9253" y="2333.2197">(46)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1466.4526" y="2321.5791">provide</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1466.4526" y="2333.2197">resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1466.4526" y="2344.8604">access</text><polygon fill="#181818" points="819.5972,2383.8594,809.5972,2387.8594,819.5972,2391.8594,815.5972,2387.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="813.5972" x2="1423.9253" y1="2387.8594" y2="2387.8594"/><text fill="#000000" font-family="Helvetica" font-size="10" x="825.5972" y="2383.501">(47)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="850.1245" y="2383.501">200 OK, resource</text><polygon fill="#181818" points="210.6621,2409.5,200.6621,2413.5,210.6621,2417.5,206.6621,2413.5" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="204.6621" x2="797.5972" y1="2413.5" y2="2413.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="216.6621" y="2409.1416">(48)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="241.1895" y="2409.1416">200 OK, resource</text><!--SRC=[dLZRRkF84NtdLrIq2601fksPTP2C0YVmHMDxRkPA2WPP61YqoPBKOwgRssnQrYpsN_AGpvYdp8-bgfkaI8esPXSG895TbrDLfwgx9GghLR6wGmE3lQEZuI38xwNAX14hI70kYjI-rifEvHU45qVzYn_42k4AqmUqCXODcGilyruhdMSYngIMFjU5aMWQiYcgXLsU9f-Bt8BI2eFWJvaHYvK0Y_eBM5FGgzFOQWF_oadrJZ_2uDtuUW0_N2vrRZykfSK0mBsFZ5nz-w_9Dxd55Kcy4m-e4j82A2L-7izEuJoLg2ojJuLADcT6hvMJ021G58pCXBAb58ZSQzsgKis9abas67ILPj5xfq7VBBWLQmgzrKhXFOV4ejidRMxLx3gy51RNOZFeQ4tVdpdvwVkzys5uDWWgupudf-fEeaL3OSt6vrSVRjxTNFuxQ8PzMGYJx4RTz74LEHVHEBfLIsipY8n-t0nsv4uBkvnwqGiIvKTjv1TXfLOmHVF0E7Qqel5M9TAfZ3SmLWkfi9qgZtbs3IyFZk22SaxK-E52cFifYak3s5UiYKSpmPme5cE5eLMhEbzC90Z_KLPuv8W5QpAJWzMtIiGnvZcOqjOjqH8wXWCHM_b0TIfj1C792K7DOqsB6pWv2HP65naqw0PB0jWn0wz_klW0UvDfo3-6XBQK9N1NqGWknpCuF5XZceRtYkfrg0LbEioCjXXRJC8A8rnHAuoWD4HsQdnN4JrHMSD6lDNtowCZk7dxT_YSKuHtEjd0MjebV6H_RzcVNxdGSR5YL7kJr-UG636t8L5j7deq5OPmXLOamWgE8y4sWcrSZZfFXYQQJ0fpbwN__ST7vpHt0dHlwOMdP3FCFnBUtuvV77VmLmxeeoZlOEHYQK7Fgz8pnMxcSrG8hsboeHgvLo4vCWagI2HwdovEU3Ez-K0-xvrFX5mk58r4-yzQIH4kiG-KcdY9EVnCYt8kxuKb-2Q1-RUlnjcSagQmXG5AqPh7tDO6hJhPbjYthpJkC_Fjwzm9SZTmF07tXUVlHecLZAjQJN0XSsjyJnEZ0v7Q9fULXhUuWKX80tEQNkNIgRMOMwV5PThg53b5GtFHWTpoWPkFc8k_5D9GifELL7KBMbqh-9vjL9SdhPC6BzmnIyj4T8FR7cqYso8d_Sf5NV7g1RjekeoAEnfQNJjEjC4NhurfZgt8SqpdhjgOEEzx2MO6Oz98XXtiTP-su5UGVUryrVoKwIbOy8ozs2zm2BZo3EvlJnfyCNvVhnaaYgcovK3XEdJA8t1VhdawjM5Uza7fvB5RWwv6pM-4lMPXffN0y1bY3CvTSsqujmFugU3sPYhtLRWBf4St27Q8q9VRllvY_fFBreofWlrK1tkm4QlqLbshE2qIufHeuAo5zY7pFBt7pJwr4lLvJvftIzWFAy-qocaFt2knoAHtFFx-uTWxepYetYhctV7rXsoWeODXcjO6pZ2FbmRbNQ4MlV6FLP9fMUuDV_tBgnT37XWBN4qpZ3_nxlwCfNEjvd9HF67gPP-fzb2ccJpJzxI5Z1_ZfL0BedZ1nrc8gIPqCexPy91dyswlKwhHS7qk8Xqn5UYuHBEZPuW_Y5GcrC1psiYND7B9OV3SFEXK_lVEWXwiSNjCvpbt5gNipSUPtxATugsgUuavVJE5QqNDkdBfvKKNwMn9rvhCKA8RZkeZzWZmaSx8IgGCcrOb3s1s558sbjlOQerWUpmdGtG67xaXtgD2Qm6VqTl-MAuUKK6ZRrYyPRlA1claVHfRJ3qv54b29iEpnZoatRClfRSgFZzU7XmSm5xVyl3f0ha4jukoovJePafKSJHo5QEx7mc4iqr6311PbdBAoTVXOxXUhqEkO5WOkWV6Ei6agkC87C3Auv3VBmmTqJzPCdH2_FhpZwTy2AKlTvFCwOSxGjAt4mnPa1u-hsruXyAWOHkY2lK4Ds-UIuARPYdEtJ2hzZtNkIz_X3rEGbTlkC_hhuwFNtdSmw3kvh97wXpHYOrtZbx2CxUhi7SKottB3NAtKrqdJ6AxEJpDiiCBV90npux6sOERt7Vuv8aEVwx8kh3VMUVlA5evOZxLEgqN9rwvXNBuLEPQKi-dJ2eNFeVMpe0xGDNIqRWAwU758TzY3fbCN_ORjuTV0GPIPOKTZE1N0llRRx3j_cWSqFKstFhruw-bFo3lHUhK1o9DzPf-yHySj4iF_27Mf-8JxUk6jXBQmsfNpK50ldQYpFE29h8_DdC-sXbo3UjIT2PL8jN2zGA9dLO7RPV7sctmr6rglwMnttQpJt7I1iM3Xtq5kwU49y-a3bjaD3KRqteo3NfkmjiRkJ-_r1V5aTTt1FBuIe33FcgMr6fUKFc2x1sL16ldfUAN0zWGfg4hsRz8WUvgyNtETn5jEC7kduIdikijJAXk5EnQq0cc4v-hrn85R_RilVmP-s7AVtKmhROXKBucqyfcPlI3JCZArbvvHPhuaZBqgfoLJBDOPAtpZy5pqbTHHxVnL9u2_my0]--></g></svg>