<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2761px" preserveAspectRatio="none" style="width:1326px;height:2761px;background:#FFFFFF;" version="1.1" viewBox="0 0 1326 2761" width="1326px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="2749.3906" style="stroke:#181818;stroke-width:0.5;" width="522.1729" x="44.3965" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="266.064" y="15.2822">Mobile Device</text><rect fill="#C9FFC9" height="2749.3906" style="stroke:#181818;stroke-width:0.5;" width="379.3188" x="578.5693" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="743.8684" y="15.2822">Anbieter</text><rect fill="#F4A460" height="2732.75" style="stroke:#181818;stroke-width:0.5;" width="253.2266" x="578.5693" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="672.0381" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="2732.75" style="stroke:#181818;stroke-width:0.5;" width="68.5283" x="889.3599" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="905.4429" y="31.9229">TI 2.0</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="905.4429" y="43.5635">Dienst</text><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="2556.1875" width="8" x="20.5" y="121.5625"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="24" x2="24" y1="121.5625" y2="2677.75"/></g><g><title>User Agent</title><rect fill="#000000" fill-opacity="0.00000" height="2556.1875" width="8" x="79.6821" y="121.5625"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="83.1821" x2="83.1821" y1="121.5625" y2="2677.75"/></g><g><title/><rect fill="#F0F0F0" height="37.2813" style="stroke:#000000;stroke-width:1;" width="10" x="78.1821" y="919.9844"/></g><g><title/><rect fill="#F0F0F0" height="567.7344" style="stroke:#000000;stroke-width:1;" width="10" x="78.1821" y="1550.9219"/></g><g><title>Mail</title><rect fill="#000000" fill-opacity="0.00000" height="2556.1875" width="8" x="178.5552" y="121.5625"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="182.0552" x2="182.0552" y1="121.5625" y2="2677.75"/></g><g><title/><rect fill="#F0F0F0" height="116.8438" style="stroke:#000000;stroke-width:1;" width="10" x="177.0552" y="803.1406"/></g><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="2556.1875" width="8" x="273.9214" y="121.5625"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="277.4214" x2="277.4214" y1="121.5625" y2="2677.75"/></g><g><title/><rect fill="#F0F0F0" height="2490.9063" style="stroke:#000000;stroke-width:1;" width="10" x="272.4214" y="186.8438"/></g><g><title>Android TEE</title><rect fill="#000000" fill-opacity="0.00000" height="2556.1875" width="8" x="418.9712" y="121.5625"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="422.4712" x2="422.4712" y1="121.5625" y2="2677.75"/></g><g><title/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="417.4712" y="251.7656"/></g><g><title/><rect fill="#F0F0F0" height="31.6406" style="stroke:#000000;stroke-width:1;" width="10" x="417.4712" y="365.9688"/></g><g><title>Authenticator</title><rect fill="#000000" fill-opacity="0.00000" height="2556.1875" width="8" x="517.8677" y="121.5625"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="521.3677" x2="521.3677" y1="121.5625" y2="2677.75"/></g><g><title/><rect fill="#F0F0F0" height="128.2031" style="stroke:#000000;stroke-width:1;" width="10" x="516.3677" y="1736.0469"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="2556.1875" width="8" x="619.3555" y="121.5625"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="622.8555" x2="622.8555" y1="121.5625" y2="2677.75"/></g><g><title/><rect fill="#F0F0F0" height="741.7031" style="stroke:#000000;stroke-width:1;" width="10" x="617.8555" y="510.1719"/></g><g><title/><rect fill="#F0F0F0" height="70.2813" style="stroke:#000000;stroke-width:1;" width="10" x="617.8555" y="1455"/></g><g><title/><rect fill="#F0F0F0" height="850.7813" style="stroke:#000000;stroke-width:1;" width="10" x="617.8555" y="1576.5625"/></g><g><title>PEP</title><rect fill="#000000" fill-opacity="0.00000" height="2556.1875" width="8" x="788.7754" y="121.5625"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="792.2754" x2="792.2754" y1="121.5625" y2="2677.75"/></g><g><title/><rect fill="#F0F0F0" height="138.8438" style="stroke:#000000;stroke-width:1;" width="10" x="787.2754" y="2520.9063"/></g><g><title>Resource</title><rect fill="#000000" fill-opacity="0.00000" height="2556.1875" width="8" x="920.124" y="121.5625"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="923.624" x2="923.624" y1="121.5625" y2="2677.75"/></g><g><title/><rect fill="#F0F0F0" height="64.2813" style="stroke:#000000;stroke-width:1;" width="10" x="918.624" y="2608.4688"/></g><g><title>Attestation</title><rect fill="#000000" fill-opacity="0.00000" height="2556.1875" width="8" x="1005.0127" y="121.5625"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1008.5127" x2="1008.5127" y1="121.5625" y2="2677.75"/></g><g><title/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="1003.5127" y="303.0469"/></g><g><title/><rect fill="#F0F0F0" height="156.8438" style="stroke:#000000;stroke-width:1;" width="10" x="1003.5127" y="565.0938"/></g><g><title>IDP</title><rect fill="#000000" fill-opacity="0.00000" height="2556.1875" width="8" x="1123.5146" y="121.5625"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1127.0146" x2="1127.0146" y1="121.5625" y2="2677.75"/></g><g><title/><rect fill="#F0F0F0" height="361.6094" style="stroke:#000000;stroke-width:1;" width="10" x="1122.0146" y="1641.4844"/></g><g><title>Federation </title><rect fill="#000000" fill-opacity="0.00000" height="2556.1875" width="8" x="1209.4922" y="121.5625"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1212.9922" x2="1212.9922" y1="121.5625" y2="2677.75"/></g><text fill="#000000" font-family="sans-serif" font-size="10" x="9.6035" y="119.2041">User</text><ellipse cx="24" cy="58.4219" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M24,66.4219 L24,93.4219 M11,74.4219 L37,74.4219 M24,93.4219 L11,108.4219 M24,93.4219 L37,108.4219" fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="48.3965" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="55.3965" y="111.2041">User Agent</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="147.2695" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="171.8989" y="99.5635">Mail</text><text fill="#000000" font-family="sans-serif" font-size="10" x="154.2695" y="111.2041">User Agent</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="42.9502" x="255.9463" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="262.9463" y="111.2041">Client</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="74.8057" x="385.0684" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="392.0684" y="111.2041">Android TEE</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="82.4033" x="480.166" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="487.166" y="111.2041">Authenticator</text><rect fill="#FFFFFF" height="48.9219" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="582.5693" y="71.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" x="612.9751" y="87.9229">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="596.9668" y="99.5635">AuthS and</text><text fill="#000000" font-family="sans-serif" font-size="10" x="589.5693" y="111.2041">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="756.7549" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="783.0859" y="99.5635">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="763.7549" y="111.2041">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="893.3599" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="900.3599" y="99.5635">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="907.2275" y="111.2041">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.249" x="973.8882" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="980.8882" y="99.5635">Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="990.0337" y="111.2041">Service</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="30.6797" x="1111.6748" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1118.6748" y="111.2041">IDP</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="70.9775" x="1177.5034" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1184.5034" y="99.5635">Federation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1195.917" y="111.2041">Master</text><text fill="#000000" font-family="sans-serif" font-size="10" x="9.6035" y="2747.0322">User</text><ellipse cx="24" cy="2686.25" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M24,2694.25 L24,2721.25 M11,2702.25 L37,2702.25 M24,2721.25 L11,2736.25 M24,2721.25 L37,2736.25" fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="48.3965" y="2677.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="55.3965" y="2694.0322">User Agent</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="147.2695" y="2677.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="171.8989" y="2694.0322">Mail</text><text fill="#000000" font-family="sans-serif" font-size="10" x="154.2695" y="2705.6729">User Agent</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="42.9502" x="255.9463" y="2677.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="262.9463" y="2694.0322">Client</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="74.8057" x="385.0684" y="2677.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="392.0684" y="2694.0322">Android TEE</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="82.4033" x="480.166" y="2677.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="487.166" y="2694.0322">Authenticator</text><rect fill="#FFFFFF" height="48.9219" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="582.5693" y="2677.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="612.9751" y="2694.0322">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="596.9668" y="2705.6729">AuthS and</text><text fill="#000000" font-family="sans-serif" font-size="10" x="589.5693" y="2717.3135">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="756.7549" y="2677.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="783.0859" y="2694.0322">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="763.7549" y="2705.6729">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="893.3599" y="2677.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="900.3599" y="2694.0322">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="907.2275" y="2705.6729">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.249" x="973.8882" y="2677.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="980.8882" y="2694.0322">Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="990.0337" y="2705.6729">Service</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="30.6797" x="1111.6748" y="2677.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1118.6748" y="2694.0322">IDP</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="70.9775" x="1177.5034" y="2677.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1184.5034" y="2694.0322">Federation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1195.917" y="2705.6729">Master</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1314.4014" x="5" y="148.3828"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1319.4014" y1="148.3828" y2="148.3828"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1319.4014" y1="151.3828" y2="151.3828"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="323.1455" x="500.6279" y="139.5625"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="506.6279" y="152.8447">Client Registration (with Client Attestation and Email)</text><polygon fill="#000000" points="260.4214,182.8438,270.4214,186.8438,260.4214,190.8438,264.4214,186.8438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="266.4214" y1="186.8438" y2="186.8438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="31" y="182.4854">User Starts Registration</text><path d="M261.4214,198.8438 L321.3774,198.8438 L321.3774,202.4844 L311.3774,212.4844 L261.4214,212.4844 L261.4214,198.8438" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="279.6875" style="stroke:#000000;stroke-width:1.5;" width="768.0913" x="261.4214" y="198.8438"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="276.4214" y="209.126">alt</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="336.3774" y="210.126">[Android Attestation]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="261.4214" x2="1029.5127" y1="416.6094" y2="416.6094"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="266.4214" y="427.8916">[iOS Attestation]</text><polygon fill="#000000" points="405.4712,247.7656,415.4712,251.7656,405.4712,255.7656,409.4712,251.7656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="411.4712" y1="251.7656" y2="251.7656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="235.7666">Generate Key Pair</text><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="247.4072">for Attestation</text><path d="M432.4712,227.4844 L432.4712,248.4844 L658.4712,248.4844 L658.4712,237.4844 L648.4712,227.4844 L432.4712,227.4844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M648.4712,227.4844 L648.4712,237.4844 L658.4712,237.4844 L648.4712,227.4844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="438.4712" y="241.7666">Using Android TEE or iOS Secure Enclave</text><polygon fill="#000000" points="293.4214,273.4063,283.4214,277.4063,293.4214,281.4063,289.4214,277.4063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="416.4712" y1="277.4063" y2="277.4063"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="273.0479">Public Key</text><polygon fill="#000000" points="991.5127,299.0469,1001.5127,303.0469,991.5127,307.0469,995.5127,303.0469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="997.5127" y1="303.0469" y2="303.0469"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="298.6885">Request Attestation Challenge</text><polygon fill="#000000" points="293.4214,324.6875,283.4214,328.6875,293.4214,332.6875,289.4214,328.6875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="1002.5127" y1="328.6875" y2="328.6875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="324.3291">Attestation Challenge</text><polygon fill="#000000" points="405.4712,361.9688,415.4712,365.9688,405.4712,369.9688,409.4712,365.9688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="411.4712" y1="365.9688" y2="365.9688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="349.9697">Sign Challenge with</text><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="361.6104">Attestation Key</text><path d="M432.4712,341.6875 L432.4712,374.6875 L659.4712,374.6875 L659.4712,351.6875 L649.4712,341.6875 L432.4712,341.6875" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M649.4712,341.6875 L649.4712,351.6875 L659.4712,351.6875 L649.4712,341.6875" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="438.4712" y="355.9697">Using Android SafetyNet/Play Integrity or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="438.4712" y="367.6104">iOS DeviceCheck/App Attest API</text><polygon fill="#000000" points="293.4214,393.6094,283.4214,397.6094,293.4214,401.6094,289.4214,397.6094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="416.4712" y1="397.6094" y2="397.6094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="393.251">Attestation Statement</text><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="324.4214" y1="441.25" y2="441.25"/><line style="stroke:#000000;stroke-width:1;" x1="324.4214" x2="324.4214" y1="441.25" y2="454.25"/><line style="stroke:#000000;stroke-width:1;" x1="283.4214" x2="324.4214" y1="454.25" y2="454.25"/><polygon fill="#000000" points="293.4214,450.25,283.4214,454.25,293.4214,458.25,289.4214,454.25" style="stroke:#000000;stroke-width:1;"/><path d="M337.4214,440.25 L337.4214,473.25 L546.4214,473.25 L546.4214,450.25 L536.4214,440.25 L337.4214,440.25" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M536.4214,440.25 L536.4214,450.25 L546.4214,450.25 L536.4214,440.25" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="343.4214" y="454.5322">iOS Attestation with App Attest API or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="343.4214" y="466.1729">DeviceCheck API</text><polygon fill="#000000" points="605.8555,506.1719,615.8555,510.1719,605.8555,514.1719,609.8555,510.1719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="611.8555" y1="510.1719" y2="510.1719"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="505.8135">Client Registration Request</text><path d="M632.8555,497.5313 L632.8555,541.5313 L867.8555,541.5313 L867.8555,507.5313 L857.8555,497.5313 L632.8555,497.5313" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M857.8555,497.5313 L857.8555,507.5313 L867.8555,507.5313 L857.8555,497.5313" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="638.8555" y="511.8135">client_instance.yaml</text><text fill="#000000" font-family="sans-serif" font-size="10" x="638.8555" y="523.4541">Includes attestation statement, public key,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="638.8555" y="535.0947">User Email and software statement</text><polygon fill="#000000" points="991.5127,561.0938,1001.5127,565.0938,991.5127,569.0938,995.5127,565.0938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="627.8555" x2="997.5127" y1="565.0938" y2="565.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="560.7354">Verify Client Attestation</text><path d="M1018.5127,552.4531 L1018.5127,585.4531 L1192.5127,585.4531 L1192.5127,562.4531 L1182.5127,552.4531 L1018.5127,552.4531" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1182.5127,552.4531 L1182.5127,562.4531 L1192.5127,562.4531 L1182.5127,552.4531" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1024.5127" y="566.7354">AS A forwards attestation data</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1024.5127" y="578.376">to Attestation Service</text><line style="stroke:#000000;stroke-width:1;" x1="1013.5127" x2="1055.5127" y1="620.0156" y2="620.0156"/><line style="stroke:#000000;stroke-width:1;" x1="1055.5127" x2="1055.5127" y1="620.0156" y2="633.0156"/><line style="stroke:#000000;stroke-width:1;" x1="1014.5127" x2="1055.5127" y1="633.0156" y2="633.0156"/><polygon fill="#000000" points="1024.5127,629.0156,1014.5127,633.0156,1024.5127,637.0156,1020.5127,633.0156" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1020.5127" y="604.0166">Validate Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1020.5127" y="615.6572">Statement</text><polygon fill="#000000" points="638.8555,654.6563,628.8555,658.6563,638.8555,662.6563,634.8555,658.6563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="632.8555" x2="1002.5127" y1="658.6563" y2="658.6563"/><text fill="#000000" font-family="sans-serif" font-size="10" x="644.8555" y="654.2979">Attestation Verification Result</text><line style="stroke:#000000;stroke-width:1;" x1="627.8555" x2="669.8555" y1="695.9375" y2="695.9375"/><line style="stroke:#000000;stroke-width:1;" x1="669.8555" x2="669.8555" y1="695.9375" y2="708.9375"/><line style="stroke:#000000;stroke-width:1;" x1="628.8555" x2="669.8555" y1="708.9375" y2="708.9375"/><polygon fill="#000000" points="638.8555,704.9375,628.8555,708.9375,638.8555,712.9375,634.8555,708.9375" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="679.9385">Verify Email Confirmation JWT</text><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="691.5791">if exists</text><path d="M8,720.9375 L67.9561,720.9375 L67.9561,724.5781 L57.9561,734.5781 L8,734.5781 L8,720.9375" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="511.9375" style="stroke:#000000;stroke-width:1.5;" width="921.5586" x="8" y="720.9375"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="23" y="731.2197">alt</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="82.9561" y="732.2197">[Email Confirmation Required because E-Mail Confirmation JWT not</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="82.9561" y="743.8604">provided or Email Confirmation JWT expired]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="8" x2="929.5586" y1="1176.9531" y2="1176.9531"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="13" y="1188.2354">[Valid Email Confirmation was provided]</text><line style="stroke:#000000;stroke-width:1;" x1="627.8555" x2="669.8555" y1="782.1406" y2="782.1406"/><line style="stroke:#000000;stroke-width:1;" x1="669.8555" x2="669.8555" y1="782.1406" y2="795.1406"/><line style="stroke:#000000;stroke-width:1;" x1="628.8555" x2="669.8555" y1="795.1406" y2="795.1406"/><polygon fill="#000000" points="638.8555,791.1406,628.8555,795.1406,638.8555,799.1406,634.8555,795.1406" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="766.1416">Generate Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="777.7822">Link and send Email</text><line style="stroke:#000000;stroke-width:1;" x1="187.0552" x2="229.0552" y1="820.7813" y2="820.7813"/><line style="stroke:#000000;stroke-width:1;" x1="229.0552" x2="229.0552" y1="820.7813" y2="833.7813"/><line style="stroke:#000000;stroke-width:1;" x1="188.0552" x2="229.0552" y1="833.7813" y2="833.7813"/><polygon fill="#000000" points="198.0552,829.7813,188.0552,833.7813,198.0552,837.7813,194.0552,833.7813" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="194.0552" y="816.4229">Receive Email</text><polygon fill="#000000" points="165.0552,867.0625,175.0552,871.0625,165.0552,875.0625,169.0552,871.0625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="171.0552" y1="871.0625" y2="871.0625"/><text fill="#000000" font-family="sans-serif" font-size="10" x="31" y="855.0635">Click Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="31" y="866.7041">Link in Email</text><polygon fill="#000000" points="99.1821,915.9844,89.1821,919.9844,99.1821,923.9844,95.1821,919.9844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="93.1821" x2="176.0552" y1="919.9844" y2="919.9844"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="892.3447">Open</text><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="903.9854">Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="915.626">Link</text><polygon fill="#000000" points="605.8555,953.2656,615.8555,957.2656,605.8555,961.2656,609.8555,957.2656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="611.8555" y1="957.2656" y2="957.2656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="941.2666">Email Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="952.9072">Request</text><line style="stroke:#000000;stroke-width:1;" x1="627.8555" x2="669.8555" y1="1006.1875" y2="1006.1875"/><line style="stroke:#000000;stroke-width:1;" x1="669.8555" x2="669.8555" y1="1006.1875" y2="1019.1875"/><line style="stroke:#000000;stroke-width:1;" x1="628.8555" x2="669.8555" y1="1019.1875" y2="1019.1875"/><polygon fill="#000000" points="638.8555,1015.1875,628.8555,1019.1875,638.8555,1023.1875,634.8555,1019.1875" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="978.5479">Verify Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="990.1885">Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="1001.8291">Request</text><line style="stroke:#000000;stroke-width:1;" x1="627.8555" x2="669.8555" y1="1056.4688" y2="1056.4688"/><line style="stroke:#000000;stroke-width:1;" x1="669.8555" x2="669.8555" y1="1056.4688" y2="1069.4688"/><line style="stroke:#000000;stroke-width:1;" x1="628.8555" x2="669.8555" y1="1069.4688" y2="1069.4688"/><polygon fill="#000000" points="638.8555,1065.4688,628.8555,1069.4688,638.8555,1073.4688,634.8555,1069.4688" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="1040.4697">Generate Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="1052.1104">Confirmation JWT</text><path d="M733.8525,1032.1875 L733.8525,1123.1875 L907.8525,1123.1875 L907.8525,1042.1875 L897.8525,1032.1875 L733.8525,1032.1875" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M897.8525,1032.1875 L897.8525,1042.1875 L907.8525,1042.1875 L897.8525,1032.1875" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="739.8525" y="1046.4697">JWT Claims:</text><text fill="#000000" font-family="sans-serif" font-size="10" x="743.0313" y="1058.1104">- iss: AS_A_ID</text><text fill="#000000" font-family="sans-serif" font-size="10" x="743.0313" y="1069.751">- sub: Client_id</text><text fill="#000000" font-family="sans-serif" font-size="10" x="743.0313" y="1081.3916">- aud: (all AS)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="743.0313" y="1093.0322">- exp: (Policy Engine decision)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="743.0313" y="1104.6729">- iat: (now)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="743.0313" y="1116.3135">- Email_verified: true</text><polygon fill="#000000" points="293.4214,1153.9531,283.4214,1157.9531,293.4214,1161.9531,289.4214,1157.9531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="616.8555" y1="1157.9531" y2="1157.9531"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="1141.9541">Client Registration Response</text><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="1153.5947">(client_id, Email Confirmation JWT)</text><polygon fill="#000000" points="293.4214,1220.875,283.4214,1224.875,293.4214,1228.875,289.4214,1224.875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="616.8555" y1="1224.875" y2="1224.875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="1208.876">Client Registration Response</text><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="1220.5166">(client_id)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1314.4014" x="5" y="1265.6953"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1319.4014" y1="1265.6953" y2="1265.6953"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1319.4014" y1="1268.6953" y2="1268.6953"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="364.293" x="480.0542" y="1256.875"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="486.0542" y="1270.1572">OAuth 2.0 Authorization Code Flow with PAR, PKCE and DPoP</text><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="324.4214" y1="1315.7969" y2="1315.7969"/><line style="stroke:#000000;stroke-width:1;" x1="324.4214" x2="324.4214" y1="1315.7969" y2="1328.7969"/><line style="stroke:#000000;stroke-width:1;" x1="283.4214" x2="324.4214" y1="1328.7969" y2="1328.7969"/><polygon fill="#000000" points="293.4214,1324.7969,283.4214,1328.7969,293.4214,1332.7969,289.4214,1328.7969" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1299.7979">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1311.4385">Code Verifier</text><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="324.4214" y1="1366.0781" y2="1366.0781"/><line style="stroke:#000000;stroke-width:1;" x1="324.4214" x2="324.4214" y1="1366.0781" y2="1379.0781"/><line style="stroke:#000000;stroke-width:1;" x1="283.4214" x2="324.4214" y1="1379.0781" y2="1379.0781"/><polygon fill="#000000" points="293.4214,1375.0781,283.4214,1379.0781,293.4214,1383.0781,289.4214,1379.0781" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1350.0791">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1361.7197">Code Challenge</text><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="324.4214" y1="1404.7188" y2="1404.7188"/><line style="stroke:#000000;stroke-width:1;" x1="324.4214" x2="324.4214" y1="1404.7188" y2="1417.7188"/><line style="stroke:#000000;stroke-width:1;" x1="283.4214" x2="324.4214" y1="1417.7188" y2="1417.7188"/><polygon fill="#000000" points="293.4214,1413.7188,283.4214,1417.7188,293.4214,1421.7188,289.4214,1417.7188" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1400.3604">Generate DPoP Key Pair</text><polygon fill="#000000" points="605.8555,1451,615.8555,1455,605.8555,1459,609.8555,1455" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="611.8555" y1="1455" y2="1455"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1439.001">PAR Request</text><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1450.6416">(client_id, redirect_uri, scope, etc., dpop_jkt)</text><path d="M632.8555,1430.7188 L632.8555,1463.7188 L1015.8555,1463.7188 L1015.8555,1440.7188 L1005.8555,1430.7188 L632.8555,1430.7188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1005.8555,1430.7188 L1005.8555,1440.7188 L1015.8555,1440.7188 L1005.8555,1430.7188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="638.8555" y="1445.001">Authorization Code Request</text><text fill="#000000" font-family="sans-serif" font-size="10" x="638.8555" y="1456.6416">(inkl. DPoP Proof, code_challenge, code_challenge_method, redirect_uri)</text><line style="stroke:#000000;stroke-width:1;" x1="627.8555" x2="669.8555" y1="1486.6406" y2="1486.6406"/><line style="stroke:#000000;stroke-width:1;" x1="669.8555" x2="669.8555" y1="1486.6406" y2="1499.6406"/><line style="stroke:#000000;stroke-width:1;" x1="628.8555" x2="669.8555" y1="1499.6406" y2="1499.6406"/><polygon fill="#000000" points="638.8555,1495.6406,628.8555,1499.6406,638.8555,1503.6406,634.8555,1499.6406" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="1482.2822">Validate DPoP Proof</text><polygon fill="#000000" points="293.4214,1521.2813,283.4214,1525.2813,293.4214,1529.2813,289.4214,1525.2813" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="616.8555" y1="1525.2813" y2="1525.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="1520.9229">Request URI</text><polygon fill="#000000" points="99.1821,1546.9219,89.1821,1550.9219,99.1821,1554.9219,95.1821,1550.9219" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="93.1821" x2="271.4214" y1="1550.9219" y2="1550.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1546.5635">Navigate to Request URI</text><polygon fill="#000000" points="605.8555,1572.5625,615.8555,1576.5625,605.8555,1580.5625,609.8555,1576.5625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="611.8555" y1="1576.5625" y2="1576.5625"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1572.2041">Authorization Request (with Request URI)</text><path d="M261.4214,1588.5625 L582.3931,1588.5625 L582.3931,1592.2031 L572.3931,1602.2031 L261.4214,1602.2031 L261.4214,1588.5625" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="422.5313" style="stroke:#000000;stroke-width:1.5;" width="1048.98" x="261.4214" y="1588.5625"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="276.4214" y="1598.8447">OIDC user authentication with confidential client</text><polygon fill="#000000" points="1110.0146,1637.4844,1120.0146,1641.4844,1110.0146,1645.4844,1114.0146,1641.4844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="627.8555" x2="1116.0146" y1="1641.4844" y2="1641.4844"/><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="1625.4854">PAR Request (OpenID Connect), redirect_uri, client_id_idpsek</text><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="1637.126">see https://gemspec.gematik.de/docs/gemSpec/gemSpec_IDP_Sek/latest/#7.1.2</text><path d="M1137.0146,1617.2031 L1137.0146,1661.2031 L1289.0146,1661.2031 L1289.0146,1627.2031 L1279.0146,1617.2031 L1137.0146,1617.2031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1279.0146,1617.2031 L1279.0146,1627.2031 L1289.0146,1627.2031 L1279.0146,1617.2031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1143.0146" y="1631.4854">AS A acts as Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1146.1934" y="1643.126">for the IDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1143.0146" y="1654.7666">(client_id_idpsek)</text><polygon fill="#000000" points="638.8555,1680.7656,628.8555,1684.7656,638.8555,1688.7656,634.8555,1684.7656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="632.8555" x2="1121.0146" y1="1684.7656" y2="1684.7656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="644.8555" y="1680.4072">URI-PAR Response, request_uri, expires_in</text><polygon fill="#000000" points="293.4214,1706.4063,283.4214,1710.4063,293.4214,1714.4063,289.4214,1710.4063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="616.8555" y1="1710.4063" y2="1710.4063"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="1706.0479">Redirect URI-PAR to IDP, request_uri</text><polygon fill="#000000" points="504.3677,1732.0469,514.3677,1736.0469,504.3677,1740.0469,508.3677,1736.0469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="282.4214" x2="510.3677" y1="1736.0469" y2="1736.0469"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1731.6885">Redirect URI-PAR to IDP, request_uri</text><polygon fill="#000000" points="1110.0146,1757.6875,1120.0146,1761.6875,1110.0146,1765.6875,1114.0146,1761.6875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="526.3677" x2="1116.0146" y1="1761.6875" y2="1761.6875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="533.3677" y="1757.3291">Navigate to URI-PAR, request_uri</text><polygon fill="#000000" points="537.3677,1783.3281,527.3677,1787.3281,537.3677,1791.3281,533.3677,1787.3281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="531.3677" x2="1121.0146" y1="1787.3281" y2="1787.3281"/><text fill="#000000" font-family="sans-serif" font-size="10" x="543.3677" y="1782.9697">Authentication Prompt, consent</text><polygon fill="#000000" points="1110.0146,1808.9688,1120.0146,1812.9688,1110.0146,1816.9688,1114.0146,1812.9688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="526.3677" x2="1116.0146" y1="1812.9688" y2="1812.9688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="533.3677" y="1808.6104">User Credentials, consent</text><polygon fill="#000000" points="537.3677,1834.6094,527.3677,1838.6094,537.3677,1842.6094,533.3677,1838.6094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="531.3677" x2="1121.0146" y1="1838.6094" y2="1838.6094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="543.3677" y="1834.251">Redirect to AuthS, auth_code, redirect_uri</text><polygon fill="#000000" points="293.4214,1860.25,283.4214,1864.25,293.4214,1868.25,289.4214,1864.25" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="287.4214" x2="515.3677" y1="1864.25" y2="1864.25"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="1859.8916">Redirect to AuthS, auth_code, redirect_uri</text><polygon fill="#000000" points="605.8555,1885.8906,615.8555,1889.8906,605.8555,1893.8906,609.8555,1889.8906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="611.8555" y1="1889.8906" y2="1889.8906"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1885.5322">Redirect to AuthS, auth_code, redirect_uri</text><polygon fill="#000000" points="1110.0146,1911.5313,1120.0146,1915.5313,1110.0146,1919.5313,1114.0146,1915.5313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="627.8555" x2="1116.0146" y1="1915.5313" y2="1915.5313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="1911.1729">Token Request (Authorization Code Grant), auth_code</text><line style="stroke:#000000;stroke-width:1;" x1="1132.0146" x2="1174.0146" y1="1964.4531" y2="1964.4531"/><line style="stroke:#000000;stroke-width:1;" x1="1174.0146" x2="1174.0146" y1="1964.4531" y2="1977.4531"/><line style="stroke:#000000;stroke-width:1;" x1="1133.0146" x2="1174.0146" y1="1977.4531" y2="1977.4531"/><polygon fill="#000000" points="1143.0146,1973.4531,1133.0146,1977.4531,1143.0146,1981.4531,1139.0146,1977.4531" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1139.0146" y="1936.8135">Validate</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1139.0146" y="1948.4541">Authorization</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1139.0146" y="1960.0947">Code</text><polygon fill="#000000" points="638.8555,1999.0938,628.8555,2003.0938,638.8555,2007.0938,634.8555,2003.0938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="632.8555" x2="1121.0146" y1="2003.0938" y2="2003.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="644.8555" y="1998.7354">Authentication Response (ID Token)</text><line style="stroke:#000000;stroke-width:1;" x1="627.8555" x2="669.8555" y1="2054.375" y2="2054.375"/><line style="stroke:#000000;stroke-width:1;" x1="669.8555" x2="669.8555" y1="2054.375" y2="2067.375"/><line style="stroke:#000000;stroke-width:1;" x1="628.8555" x2="669.8555" y1="2067.375" y2="2067.375"/><polygon fill="#000000" points="638.8555,2063.375,628.8555,2067.375,638.8555,2071.375,634.8555,2067.375" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="2038.376">Validate</text><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="2050.0166">ID Token</text><polygon fill="#000000" points="99.1821,2089.0156,89.1821,2093.0156,99.1821,2097.0156,95.1821,2093.0156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="616.8555" y1="2093.0156" y2="2093.0156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="2088.6572">Authorization Code</text><polygon fill="#000000" points="260.4214,2114.6563,270.4214,2118.6563,260.4214,2122.6563,264.4214,2118.6563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="266.4214" y1="2118.6563" y2="2118.6563"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="2114.2979">Redirect with Authorization Code</text><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="324.4214" y1="2155.9375" y2="2155.9375"/><line style="stroke:#000000;stroke-width:1;" x1="324.4214" x2="324.4214" y1="2155.9375" y2="2168.9375"/><line style="stroke:#000000;stroke-width:1;" x1="283.4214" x2="324.4214" y1="2168.9375" y2="2168.9375"/><polygon fill="#000000" points="293.4214,2164.9375,283.4214,2168.9375,293.4214,2172.9375,289.4214,2168.9375" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="2139.9385">Generate</text><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="2151.5791">DPoP Proof JWT</text><polygon fill="#000000" points="605.8555,2190.5781,615.8555,2194.5781,605.8555,2198.5781,609.8555,2194.5781" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="611.8555" y1="2194.5781" y2="2194.5781"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="2190.2197">Token Request (Authorization Code Grant)</text><path d="M632.8555,2181.9375 L632.8555,2214.9375 L852.8555,2214.9375 L852.8555,2191.9375 L842.8555,2181.9375 L632.8555,2181.9375" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M842.8555,2181.9375 L842.8555,2191.9375 L852.8555,2191.9375 L842.8555,2181.9375" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="638.8555" y="2196.2197">Enth&#228;lt Authorization Code, DPoP Proof,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="638.8555" y="2207.8604">client_id, redirect_uri, code_verifier</text><line style="stroke:#000000;stroke-width:1;" x1="627.8555" x2="669.8555" y1="2249.5" y2="2249.5"/><line style="stroke:#000000;stroke-width:1;" x1="669.8555" x2="669.8555" y1="2249.5" y2="2262.5"/><line style="stroke:#000000;stroke-width:1;" x1="628.8555" x2="669.8555" y1="2262.5" y2="2262.5"/><polygon fill="#000000" points="638.8555,2258.5,628.8555,2262.5,638.8555,2266.5,634.8555,2262.5" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="2233.501">Validate</text><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="2245.1416">Authorization Code</text><line style="stroke:#000000;stroke-width:1;" x1="627.8555" x2="669.8555" y1="2288.1406" y2="2288.1406"/><line style="stroke:#000000;stroke-width:1;" x1="669.8555" x2="669.8555" y1="2288.1406" y2="2301.1406"/><line style="stroke:#000000;stroke-width:1;" x1="628.8555" x2="669.8555" y1="2301.1406" y2="2301.1406"/><polygon fill="#000000" points="638.8555,2297.1406,628.8555,2301.1406,638.8555,2305.1406,634.8555,2301.1406" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="2283.7822">Validate DPoP Proof</text><line style="stroke:#000000;stroke-width:1;" x1="627.8555" x2="669.8555" y1="2338.4219" y2="2338.4219"/><line style="stroke:#000000;stroke-width:1;" x1="669.8555" x2="669.8555" y1="2338.4219" y2="2351.4219"/><line style="stroke:#000000;stroke-width:1;" x1="628.8555" x2="669.8555" y1="2351.4219" y2="2351.4219"/><polygon fill="#000000" points="638.8555,2347.4219,628.8555,2351.4219,638.8555,2355.4219,634.8555,2351.4219" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="2322.4229">Validate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="2334.0635">Code Verifier</text><line style="stroke:#000000;stroke-width:1;" x1="627.8555" x2="669.8555" y1="2388.7031" y2="2388.7031"/><line style="stroke:#000000;stroke-width:1;" x1="669.8555" x2="669.8555" y1="2388.7031" y2="2401.7031"/><line style="stroke:#000000;stroke-width:1;" x1="628.8555" x2="669.8555" y1="2401.7031" y2="2401.7031"/><polygon fill="#000000" points="638.8555,2397.7031,628.8555,2401.7031,638.8555,2405.7031,634.8555,2401.7031" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="2372.7041">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="634.8555" y="2384.3447">on Input Data</text><polygon fill="#000000" points="293.4214,2423.3438,283.4214,2427.3438,293.4214,2431.3438,289.4214,2427.3438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="616.8555" y1="2427.3438" y2="2427.3438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="2422.9854">Access Token, Refresh Token</text><path d="M132.6323,2414.7031 L132.6323,2447.7031 L271.6323,2447.7031 L271.6323,2424.7031 L261.6323,2414.7031 L132.6323,2414.7031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M261.6323,2414.7031 L261.6323,2424.7031 L271.6323,2424.7031 L261.6323,2414.7031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="138.6323" y="2428.9854">Access Token bound to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="138.6323" y="2440.626">client's DPoP public key</text><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="324.4214" y1="2470.625" y2="2470.625"/><line style="stroke:#000000;stroke-width:1;" x1="324.4214" x2="324.4214" y1="2470.625" y2="2483.625"/><line style="stroke:#000000;stroke-width:1;" x1="283.4214" x2="324.4214" y1="2483.625" y2="2483.625"/><polygon fill="#000000" points="293.4214,2479.625,283.4214,2483.625,293.4214,2487.625,289.4214,2483.625" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="2466.2666">Generate DPoP Token</text><polygon fill="#000000" points="775.2754,2516.9063,785.2754,2520.9063,775.2754,2524.9063,779.2754,2520.9063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="781.2754" y1="2520.9063" y2="2520.9063"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="2504.9072">Access Protected Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="2516.5479">(with Access Token and DPoP Proof)</text><line style="stroke:#000000;stroke-width:1;" x1="797.2754" x2="839.2754" y1="2558.1875" y2="2558.1875"/><line style="stroke:#000000;stroke-width:1;" x1="839.2754" x2="839.2754" y1="2558.1875" y2="2571.1875"/><line style="stroke:#000000;stroke-width:1;" x1="798.2754" x2="839.2754" y1="2571.1875" y2="2571.1875"/><polygon fill="#000000" points="808.2754,2567.1875,798.2754,2571.1875,808.2754,2575.1875,804.2754,2571.1875" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="804.2754" y="2542.1885">Validate Access Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="804.2754" y="2553.8291">and DPoP Proof</text><polygon fill="#000000" points="906.624,2604.4688,916.624,2608.4688,906.624,2612.4688,910.624,2608.4688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="797.2754" x2="912.624" y1="2608.4688" y2="2608.4688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="804.2754" y="2592.4697">Forward Request to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="804.2754" y="2604.1104">Resource Server A</text><polygon fill="#000000" points="808.2754,2630.1094,798.2754,2634.1094,808.2754,2638.1094,804.2754,2634.1094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="802.2754" x2="917.624" y1="2634.1094" y2="2634.1094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="814.2754" y="2629.751">Resource Data</text><polygon fill="#000000" points="293.4214,2655.75,283.4214,2659.75,293.4214,2663.75,289.4214,2659.75" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="786.2754" y1="2659.75" y2="2659.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="2655.3916">Resource Data</text><!--SRC=[fLXjRzis4FwkNy6b7nO3ZjFkom037Q3QJkgrIGJRNR51WC58PvkrJ6eYvTGTzc_sJ_R7TYJrGhquQpSaW4toxdYlpnqjzuodDAC74iE6vecw4LmjsHSWhrvwiZgSsiCxmOLCQGIn9hkd1o0JaMSCCeSs0RvLEp_-b4j5kE3WEOSIVi-1Hq3-y0W9QAPOn5BArHkHnP1DH28oyfZGQDywnfrj9d8UMvAd7LE097waHDR7Qm_ESMMPU6hIlsSRUCyuzCcgpbhYNjoyr7z8SIzKBwVPxt3DRcQJcVUdvtsNPdHxe4I1-49KbgEdZDxaWqIFFehFvE9EFB84qFz75i45UN6x4r9zBEmW9ArTP9ZyBU0tAic5NX6plEXGtdtm3SqTPKd8dwES9AmKQBzsINmUPuB5gzdCa1LBWkiUsbpjK0YBgBRIaBix5nxmcA3TdZNUvuyC56HezsesUNl_yFxXzbSZr1p_Dblvv3QdMOm4IyhZqnkCApS4VJSlpOt1D0XviUHno0EHiEX4PdoB8RxePGvcWMMT8UlRrIeWGIO-donngNAbrcfEVXYz3FaK_IKLgZQbsNu9z3O3w5TkOJLRWCHYYY3aIyYEQ7P3VkKQb_F2Lmgaeee9RjbCcg0qF2YMJORvD33d-Dayk05CNoE8XFoEIkDt9CHzk_Ayrw_BX5Z0babLa5y-CRKhJno5j7_9x819DY2lNtkUIRIhdmhAiKbOibIeX6m8z6Yas94gA2WzcbHfvietxYckHR5r8ex9BN1j391tS48SOLd8DvXnRURgefhNx7EiMvAnxSveoVYME6bDK11xM98bH7a6c3XHGe-s79rQk78C3V97p36jYw6AuTozZZ5L-CRe6yHCsNJjP4SJ3RJGigEEkj6dMZRqEI_8LQqfgj_FIxPrH12T25XSZlZIvc_tz99kG9tkGLq72JsHELUmpPWweVj3hlrlCN6oWsX_xQTfOHNnW_bpiN2LmznJSD0PTZuia4WmuJwVU8NeZZqjBkCTqjJK6ECOOhJ7IlSSTske6lSMNf4OddjfPEZM3A67OfyTdUW1CNwEIPh780brz96b-KEIsWpTmsbOD0HJjwQ2fTYe9ugPNj7N1MgKyooQjhBs5yZOvjG32rvVYhac-EWsWkMAbyPDZMEgQCYLQ4Qn4E4cUqiLch2ukD11oygSLfaK7dVlCCRe9cNTBd4MSgosz8N1rd4JmJSiErY6dp-kC6Kt13vZxAJNNsGQv7fuTOnP1eZz4D4SSt5sTTTtWSwyaAUPEB8OgKLsHX5K8jNoR8sqJAXWq-KAEGu_UviAK29wiwXne30RUh10QVYXKIi2TWI7lCH_SunvWUdUSm_Z3aiXi1fjnkGX1QJiyZKLgXZQbLrgMWzBjVLTXuMyBB6McARyvpAXhQihyApxUpXrx3e8e-CvIIWxo778oHLXKkhoMVlh-THioFonX8urYyqMpUCnkKJ4HiA1sS6Cm9t678IsHapYjPQ2KRpiaeidkpJghO-c9W2bcT7LCSY1stxOagdW4kUSonAjuk6PT1rO03OLt4VoX1DAcVJ_KuM10LwtE0suwQddGN_LKvtP4ndxKZHF4GEvISIJnVR0Nmn9y6uoCyKo3KIWvvvEewZZh6brc56AHHYSihwEl6xRpz0R3Se9gDjIKDsoXJH3WV20416fDJxjXaH68eKX0HMDXYHEHRh-j5U3TWze07ZNIVKzMAl9oAg6KxJO34c41EkeDAYzNXy0fRMq6dJHjyJuMhBNpOLobFgmcFT4klQG0pZtzCYscWZRZilUWmLzeDBqHId0ZioEk87NTgX-CwRaOJwTa5m39wrVIjKm4UbIYFKkJOhEtmGMdF8RSIQN6Z_dKrr477qvQ0UxoWByJoNiGomI83kbKZc-ljx2GQOGZV0JjTYFOhYEHIJr_XBtoqz4ds2zXFrrGdKBlNxnu-ZLw8VQGFtsw3HyF9NwlR60vAJdGFtwFo7SwBaTBTTCRfOM-WsClNZcTcxqvvKrsbQvDjAORssq7L3YZ7G6CHQ5Iof167gyeY6cCGCMLrSFsQyKqOXunLmfLR-KoqYwkLW8xYhbEiFHo6_c3rR88LMwsD11JjfqBpLjUu9fOlDCDddEt5RPhuSrxU2XIU2rhkrcplNVt0d5lyjfrNFJdrPUdIB_GR-we5PY3qujzy3TROPlwe4Zi_PL8QF4A_jRHCLkuTrh9NGhTcLUaqkiPAFCmBLUbvTkPRsZINLjoTgg0GVvkdPrHwTEdEmZfylPEpmzqxpmMLG1kPbzEkthQwFGW9ePLxk__qfKZuf3joc5_6m_DEtfMBRhymxkSS8tDAqkJT-mq2QU7McI6s8xpJrI2JZsuVrpdkQAJF41rTCM_IW2AQr7X-ZI3SBZhaWFuxq4DYqoygX_qiJoAJtrlRHMr4_9Ppji_x1YhwofWbbGNOlkKHW4VDpKFvJPFjhGgngzZ3kTEGLbUVgNl59i_Ifqs4FUv2yv5kZS6_iahL9EsrwgGknFTiIlxriilOLrixckeZGnC68RzUEUEexJMZjB5FeF]--></g></svg>