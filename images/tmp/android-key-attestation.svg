<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1516px" preserveAspectRatio="none" style="width:2508px;height:1516px;background:#FFFFFF;" version="1.1" viewBox="0 0 2508 1516" width="2508px" zoomAndPan="magnify"><defs/><g><g><title>App</title><rect fill="#FFFFFF" height="1392.7813" style="stroke:#181818;stroke-width:1;" width="10" x="367.6753" y="62.5938"/></g><g><title>Android Keystore API</title><rect fill="#FFFFFF" height="468.8242" style="stroke:#181818;stroke-width:1;" width="10" x="723.9966" y="101.8594"/></g><g><title>Keystore/Keymaster HAL</title><rect fill="#FFFFFF" height="396.9922" style="stroke:#181818;stroke-width:1;" width="10" x="1085.1504" y="133.9922"/></g><g><title>Sichere Hardware (TEE/SE)</title><rect fill="#FFFFFF" height="338.7266" style="stroke:#181818;stroke-width:1;" width="10" x="1465.6816" y="163.125"/></g><g><title>Zero Trust System</title><rect fill="#FFFFFF" height="627.5586" style="stroke:#181818;stroke-width:1;" width="10" x="1798.2246" y="636.082"/></g><g><title>Zero Trust System</title><rect fill="#ADD8E6" height="295.7266" style="stroke:#181818;stroke-width:1;" width="10" x="1803.2246" y="698.9141"/></g><rect fill="none" height="161.6016" style="stroke:#000000;stroke-width:1.5;" width="779.7314" x="1721.4268" y="1058.7734"/><rect fill="none" height="169.7344" style="stroke:#000000;stroke-width:1.5;" width="639.8691" x="79" y="1278.6406"/><g><title>App</title><rect fill="#000000" fill-opacity="0.00000" height="1412.7813" width="8" x="368.6753" y="52.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="372" x2="372" y1="52.5938" y2="1465.375"/></g><g><title>Android Keystore API</title><rect fill="#000000" fill-opacity="0.00000" height="1412.7813" width="8" x="724.9966" y="52.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="728.3564" x2="728.3564" y1="52.5938" y2="1465.375"/></g><g><title>Keystore/Keymaster HAL</title><rect fill="#000000" fill-opacity="0.00000" height="1412.7813" width="8" x="1086.1504" y="52.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1089.9922" x2="1089.9922" y1="52.5938" y2="1465.375"/></g><g><title>Sichere Hardware (TEE/SE)</title><rect fill="#000000" fill-opacity="0.00000" height="1412.7813" width="8" x="1466.6816" y="52.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1470.1851" x2="1470.1851" y1="52.5938" y2="1465.375"/></g><g><title>Zero Trust System</title><rect fill="#000000" fill-opacity="0.00000" height="1412.7813" width="8" x="1799.2246" y="52.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1802.4268" x2="1802.4268" y1="52.5938" y2="1465.375"/></g><g class="participant participant-head" data-participant="App"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41.3506" x="352" y="21.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27.3506" x="359" y="41.292">App</text></g><g class="participant participant-tail" data-participant="App"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41.3506" x="352" y="1464.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27.3506" x="359" y="1484.3701">App</text></g><g class="participant participant-head" data-participant="KeystoreAPI"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="161.2803" x="648.3564" y="21.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147.2803" x="655.3564" y="41.292">Android Keystore API</text></g><g class="participant participant-tail" data-participant="KeystoreAPI"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="161.2803" x="648.3564" y="1464.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147.2803" x="655.3564" y="1484.3701">Android Keystore API</text></g><g class="participant participant-head" data-participant="HAL"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="188.3164" x="995.9922" y="21.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174.3164" x="1002.9922" y="41.292">Keystore/Keymaster HAL</text></g><g class="participant participant-tail" data-participant="HAL"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="188.3164" x="995.9922" y="1464.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174.3164" x="1002.9922" y="1484.3701">Keystore/Keymaster HAL</text></g><g class="participant participant-head" data-participant="TEE"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="202.9932" x="1369.1851" y="21.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="188.9932" x="1376.1851" y="41.292">Sichere Hardware (TEE/SE)</text></g><g class="participant participant-tail" data-participant="TEE"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="202.9932" x="1369.1851" y="1464.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="188.9932" x="1376.1851" y="1484.3701">Sichere Hardware (TEE/SE)</text></g><g class="participant participant-head" data-participant="ZT"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="143.5957" x="1731.4268" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129.5957" x="1738.4268" y="24.9951">Zero Trust System</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69.0361" x="1768.7065" y="41.292">(PEP/PDP)</text></g><g class="participant participant-tail" data-participant="ZT"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="143.5957" x="1731.4268" y="1464.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129.5957" x="1738.4268" y="1484.3701">Zero Trust System</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69.0361" x="1768.7065" y="1500.667">(PEP/PDP)</text></g><g><title>App</title><rect fill="#FFFFFF" height="1392.7813" style="stroke:#181818;stroke-width:1;" width="10" x="367.6753" y="62.5938"/></g><g><title>Android Keystore API</title><rect fill="#FFFFFF" height="468.8242" style="stroke:#181818;stroke-width:1;" width="10" x="723.9966" y="101.8594"/></g><g><title>Keystore/Keymaster HAL</title><rect fill="#FFFFFF" height="396.9922" style="stroke:#181818;stroke-width:1;" width="10" x="1085.1504" y="133.9922"/></g><g><title>Sichere Hardware (TEE/SE)</title><rect fill="#FFFFFF" height="338.7266" style="stroke:#181818;stroke-width:1;" width="10" x="1465.6816" y="163.125"/></g><g><title>Zero Trust System</title><rect fill="#FFFFFF" height="627.5586" style="stroke:#181818;stroke-width:1;" width="10" x="1798.2246" y="636.082"/></g><g><title>Zero Trust System</title><rect fill="#ADD8E6" height="295.7266" style="stroke:#181818;stroke-width:1;" width="10" x="1803.2246" y="698.9141"/></g><g class="message" data-participant-1="App" data-participant-2="KeystoreAPI"><polygon fill="#181818" points="711.9966,97.8594,721.9966,101.8594,711.9966,105.8594,715.9966,101.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="377.6753" x2="717.9966" y1="101.8594" y2="101.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244.2515" x="384.6753" y="81.6606">Schl&#252;sselpaar-Generierung anfordern</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.7944" x="384.6753" y="96.7935">(mit Attestation Challenge `challenge`)</text></g><path d="M53,67.5938 L53,107.5938 L362,107.5938 L362,77.5938 L352,67.5938 L53,67.5938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M352,67.5938 L352,77.5938 L362,77.5938 L352,67.5938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.5425" x="59" y="84.6606">Spezifiziert Alias, Zweck, Algorithmus,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="288.374" x="59" y="99.7935">und fordert Attestierung mit `challenge` an.</text><g class="message" data-participant-1="KeystoreAPI" data-participant-2="HAL"><polygon fill="#181818" points="1073.1504,129.9922,1083.1504,133.9922,1073.1504,137.9922,1077.1504,133.9922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="733.9966" x2="1079.1504" y1="133.9922" y2="133.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="332.1538" x="740.9966" y="128.9263">Schl&#252;sselpaar generieren (Parameter, `challenge`)</text></g><g class="message" data-participant-1="HAL" data-participant-2="TEE"><polygon fill="#181818" points="1453.6816,159.125,1463.6816,163.125,1453.6816,167.125,1457.6816,163.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1095.1504" x2="1459.6816" y1="163.125" y2="163.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="332.1538" x="1102.1504" y="158.0591">Schl&#252;sselpaar generieren (Parameter, `challenge`)</text></g><g class="message" data-participant-1="TEE" data-participant-2="TEE"><line style="stroke:#181818;stroke-width:1;" x1="1475.6816" x2="1517.6816" y1="207.3906" y2="207.3906"/><line style="stroke:#181818;stroke-width:1;" x1="1517.6816" x2="1517.6816" y1="207.3906" y2="220.3906"/><line style="stroke:#181818;stroke-width:1;" x1="1476.6816" x2="1517.6816" y1="220.3906" y2="220.3906"/><polygon fill="#181818" points="1486.6816,216.3906,1476.6816,220.3906,1486.6816,224.3906,1482.6816,220.3906" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.1963" x="1482.6816" y="187.1919">Neues Schl&#252;sselpaar generieren</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298.543" x="1482.6816" y="202.3247">(Privater Schl&#252;ssel `privKey` verbleibt in TEE)</text></g><g class="message" data-participant-1="TEE" data-participant-2="TEE"><line style="stroke:#181818;stroke-width:1;" x1="1475.6816" x2="1517.6816" y1="249.5234" y2="249.5234"/><line style="stroke:#181818;stroke-width:1;" x1="1517.6816" x2="1517.6816" y1="249.5234" y2="262.5234"/><line style="stroke:#181818;stroke-width:1;" x1="1476.6816" x2="1517.6816" y1="262.5234" y2="262.5234"/><polygon fill="#181818" points="1486.6816,258.5234,1476.6816,262.5234,1486.6816,266.5234,1482.6816,262.5234" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290.1006" x="1482.6816" y="244.4575">&#214;ffentlichen Schl&#252;ssel `pubKey` extrahieren</text></g><g class="message" data-participant-1="TEE" data-participant-2="TEE"><line style="stroke:#181818;stroke-width:1;" x1="1475.6816" x2="1517.6816" y1="291.6563" y2="291.6563"/><line style="stroke:#181818;stroke-width:1;" x1="1517.6816" x2="1517.6816" y1="291.6563" y2="304.6563"/><line style="stroke:#181818;stroke-width:1;" x1="1476.6816" x2="1517.6816" y1="304.6563" y2="304.6563"/><polygon fill="#181818" points="1486.6816,300.6563,1476.6816,304.6563,1486.6816,308.6563,1482.6816,304.6563" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.8735" x="1482.6816" y="286.5903">Attestierungszertifikat erstellen</text></g><path d="M1480,317.6563 L1480,417.6563 L1828,417.6563 L1828,327.6563 L1818,317.6563 L1480,317.6563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1818,317.6563 L1818,327.6563 L1828,327.6563 L1818,317.6563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.2666" x="1486" y="334.7231">- F&#252;gt `pubKey` hinzu</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.3711" x="1486" y="349.856">- F&#252;gt `challenge` hinzu</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.9214" x="1486" y="364.9888">- F&#252;gt Ger&#228;teeigenschaften hinzu</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.2852" x="1494.2646" y="380.1216">(Boot-Status, OS-Version, Patch-Level,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.1572" x="1498.397" y="395.2544">Verified Boot Status, TEE/SE Details etc.)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="327.5264" x="1486" y="410.3872">- Verwendet Attestierungsschl&#252;ssel zum Signieren</text><g class="message" data-participant-1="TEE" data-participant-2="TEE"><line style="stroke:#181818;stroke-width:1;" x1="1475.6816" x2="1517.6816" y1="459.7188" y2="459.7188"/><line style="stroke:#181818;stroke-width:1;" x1="1517.6816" x2="1517.6816" y1="459.7188" y2="472.7188"/><line style="stroke:#181818;stroke-width:1;" x1="1476.6816" x2="1517.6816" y1="472.7188" y2="472.7188"/><polygon fill="#181818" points="1486.6816,468.7188,1476.6816,472.7188,1486.6816,476.7188,1482.6816,472.7188" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.0576" x="1482.6816" y="439.52">Zertifikatskette zusammenstellen</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.0425" x="1482.6816" y="454.6528">(Blattzertifikat + Zwischenzertifikate + Root)</text></g><g class="message" data-participant-1="TEE" data-participant-2="HAL"><polygon fill="#181818" points="1106.1504,497.8516,1096.1504,501.8516,1106.1504,505.8516,1102.1504,501.8516" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1100.1504" x2="1469.6816" y1="501.8516" y2="501.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346.5313" x="1112.1504" y="496.7856">`pubKey` + Attestierungszertifikatskette `certChain`</text></g><g class="message" data-participant-1="HAL" data-participant-2="KeystoreAPI"><polygon fill="#181818" points="744.9966,526.9844,734.9966,530.9844,744.9966,534.9844,740.9966,530.9844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="738.9966" x2="1089.1504" y1="530.9844" y2="530.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.8379" x="750.9966" y="525.9185">`pubKey` + `certChain`</text></g><g class="message" data-participant-1="KeystoreAPI" data-participant-2="App"><polygon fill="#181818" points="388.6753,566.6836,378.6753,570.6836,388.6753,574.6836,384.6753,570.6836" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="382.6753" x2="727.9966" y1="570.6836" y2="570.6836"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.8379" x="394.6753" y="565.6177">`pubKey` + `certChain`</text></g><path d="M5,543.9844 L5,583.9844 L363,583.9844 L363,553.9844 L353,543.9844 L5,543.9844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M353,543.9844 L353,553.9844 L363,553.9844 L353,543.9844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.6226" x="11" y="561.0513">App hat nun `pubKey` und `certChain`,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="337.2065" x="11" y="576.1841">welche die Herkunft und den Ger&#228;testatus belegen.</text><g class="message" data-participant-1="App" data-participant-2="ZT"><polygon fill="#181818" points="1786.2246,632.082,1796.2246,636.082,1786.2246,640.082,1790.2246,636.082" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="377.6753" x2="1792.2246" y1="636.082" y2="636.082"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.2612" x="384.6753" y="615.8833">Registrierungs-/Zugriffsanfrage</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331.2271" x="384.6753" y="631.0161">(sendet `certChain`, `challenge`, [ggf. User-Auth])</text></g><path d="M37,594.25 L37,649.25 L362,649.25 L362,604.25 L352,594.25 L37,594.25" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M352,594.25 L352,604.25 L362,604.25 L352,594.25" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304.6177" x="43" y="611.3169">Dies ist der Punkt, an dem der Client versucht,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.9868" x="43" y="626.4497">Zugriff zu erhalten oder sich zu registrieren.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.521" x="43" y="641.5825">Der PEP f&#228;ngt die Anfrage ab.</text><g class="message" data-participant-1="ZT" data-participant-2="ZT"><line style="stroke:#181818;stroke-width:1;" x1="1808.2246" x2="1855.2246" y1="685.9141" y2="685.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1855.2246" x2="1855.2246" y1="685.9141" y2="698.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1814.2246" x2="1855.2246" y1="698.9141" y2="698.9141"/><polygon fill="#181818" points="1824.2246,694.9141,1814.2246,698.9141,1824.2246,702.9141,1820.2246,698.9141" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254.9155" x="1820.2246" y="665.7153">(PEP -&gt; PDP) Anfragekontext &amp; Signale</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270.0229" x="1820.2246" y="680.8481">(`certChain`, `challenge`, User-Info, etc.)</text></g><g class="message" data-participant-1="ZT" data-participant-2="ZT"><line style="stroke:#181818;stroke-width:1;" x1="1813.2246" x2="1855.2246" y1="748.1797" y2="748.1797"/><line style="stroke:#181818;stroke-width:1;" x1="1855.2246" x2="1855.2246" y1="748.1797" y2="761.1797"/><line style="stroke:#181818;stroke-width:1;" x1="1814.2246" x2="1855.2246" y1="761.1797" y2="761.1797"/><polygon fill="#181818" points="1824.2246,757.1797,1814.2246,761.1797,1824.2246,765.1797,1820.2246,761.1797" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.689" x="1820.2246" y="727.981">Zertifikatskette validieren</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="365.8281" x="1820.2246" y="743.1138">(Signaturen, G&#252;ltigkeit, Root CA Vertrauen, Sperrstatus)</text></g><g class="message" data-participant-1="ZT" data-participant-2="ZT"><line style="stroke:#181818;stroke-width:1;" x1="1813.2246" x2="1855.2246" y1="850.8438" y2="850.8438"/><line style="stroke:#181818;stroke-width:1;" x1="1855.2246" x2="1855.2246" y1="850.8438" y2="863.8438"/><line style="stroke:#181818;stroke-width:1;" x1="1814.2246" x2="1855.2246" y1="863.8438" y2="863.8438"/><polygon fill="#181818" points="1824.2246,859.8438,1814.2246,863.8438,1824.2246,867.8438,1820.2246,863.8438" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292.9761" x="1820.2246" y="785.2466">Attestation Extension Daten parsen &amp; pr&#252;fen</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.3301" x="1820.2246" y="800.3794">- `challenge` muss &#252;bereinstimmen</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="346.4678" x="1820.2246" y="815.5122">- Ger&#228;testatus pr&#252;fen (Bootloader, Verified Boot etc.)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.1558" x="1820.2246" y="830.645">- Security Level (TEE/SE) pr&#252;fen</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="274.46" x="1820.2246" y="845.7778">- OS-Version/Patch-Level pr&#252;fen (optional)</text></g><path d="M1818,876.8438 L1818,961.8438 L2093,961.8438 L2093,886.8438 L2083,876.8438 L1818,876.8438" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2083,876.8438 L2083,886.8438 L2093,886.8438 L2083,876.8438" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="79.1934" x="1824" y="893.9106">PDP Logik:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.2788" x="1824" y="909.0435">Abgleich der Ger&#228;te-Posture</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254.0967" x="1824" y="924.1763">(aus Attestierung) und anderer Signale</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237.4849" x="1824" y="939.3091">(User, Standort, etc.) mit definierten</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.541" x="1824" y="954.4419">Zero Trust Policies.</text><g class="message" data-participant-1="ZT" data-participant-2="ZT"><line style="stroke:#181818;stroke-width:1;" x1="1813.2246" x2="1855.2246" y1="993.6406" y2="993.6406"/><line style="stroke:#181818;stroke-width:1;" x1="1855.2246" x2="1855.2246" y1="993.6406" y2="1006.6406"/><line style="stroke:#181818;stroke-width:1;" x1="1808.2246" x2="1855.2246" y1="1006.6406" y2="1006.6406"/><polygon fill="#181818" points="1818.2246,1002.6406,1808.2246,1006.6406,1818.2246,1010.6406,1814.2246,1006.6406" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="337.1621" x="1820.2246" y="988.5747">Zugriffsentscheidung treffen (Erlauben/Verweigern)</text></g><g class="message" data-participant-1="ZT" data-participant-2="ZT"><line style="stroke:#181818;stroke-width:1;" x1="1808.2246" x2="1850.2246" y1="1030.7734" y2="1030.7734"/><line style="stroke:#181818;stroke-width:1;" x1="1850.2246" x2="1850.2246" y1="1030.7734" y2="1043.7734"/><line style="stroke:#181818;stroke-width:1;" x1="1809.2246" x2="1850.2246" y1="1043.7734" y2="1043.7734"/><polygon fill="#181818" points="1819.2246,1039.7734,1809.2246,1043.7734,1819.2246,1047.7734,1815.2246,1043.7734" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="326.8408" x="1815.2246" y="1025.7075">(PDP -&gt; PEP) Entscheidung (Erlauben/Verweigern)</text></g><path d="M1721.4268,1058.7734 L1785.8696,1058.7734 L1785.8696,1065.9063 L1775.8696,1075.9063 L1721.4268,1075.9063 L1721.4268,1058.7734" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="161.6016" style="stroke:#000000;stroke-width:1.5;" width="779.7314" x="1721.4268" y="1058.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="1736.4268" y="1071.8403">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="175.4199" x="1800.8696" y="1070.9839">[Entscheidung == Erlauben]</text><g class="message" data-participant-1="ZT" data-participant-2="ZT"><line style="stroke:#181818;stroke-width:1;" x1="1808.2246" x2="1850.2246" y1="1142.4375" y2="1142.4375"/><line style="stroke:#181818;stroke-width:1;" x1="1850.2246" x2="1850.2246" y1="1142.4375" y2="1155.4375"/><line style="stroke:#181818;stroke-width:1;" x1="1809.2246" x2="1850.2246" y1="1155.4375" y2="1155.4375"/><polygon fill="#181818" points="1819.2246,1151.4375,1809.2246,1155.4375,1819.2246,1159.4375,1815.2246,1155.4375" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.1348" x="1815.2246" y="1091.9731">(PEP) Entscheidung durchsetzen:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="337.8794" x="1815.2246" y="1107.106">- Ger&#228;t/Schl&#252;ssel registrieren (bei Erstregistrierung)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3677" x="1815.2246" y="1122.2388">- Sitzungstoken ausstellen</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.439" x="1815.2246" y="1137.3716">- Zugriff auf Ressource gew&#228;hren</text></g><path d="M2174.8794,1099.5391 L2174.8794,1139.5391 L2480.8794,1139.5391 L2480.8794,1109.5391 L2470.8794,1099.5391 L2174.8794,1099.5391" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2470.8794,1099.5391 L2470.8794,1109.5391 L2480.8794,1109.5391 L2470.8794,1099.5391" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232.6035" x="2180.8794" y="1116.606">Der attestierte `pubKey` ist nun als</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.0542" x="2180.8794" y="1131.7388">vertrauensw&#252;rdig f&#252;r dieses Ger&#228;t bekannt.</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1721.4268" x2="2501.1582" y1="1164.4375" y2="1164.4375"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="191.6729" x="1726.4268" y="1174.6479">[Entscheidung == Verweigern]</text><g class="message" data-participant-1="ZT" data-participant-2="ZT"><line style="stroke:#181818;stroke-width:1;" x1="1808.2246" x2="1850.2246" y1="1199.375" y2="1199.375"/><line style="stroke:#181818;stroke-width:1;" x1="1850.2246" x2="1850.2246" y1="1199.375" y2="1212.375"/><line style="stroke:#181818;stroke-width:1;" x1="1809.2246" x2="1850.2246" y1="1212.375" y2="1212.375"/><polygon fill="#181818" points="1819.2246,1208.375,1809.2246,1212.375,1819.2246,1216.375,1815.2246,1212.375" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.9199" x="1815.2246" y="1194.3091">(PEP) Zugriff verweigern</text></g><g class="message" data-participant-1="ZT" data-participant-2="App"><polygon fill="#181818" points="388.6753,1259.6406,378.6753,1263.6406,388.6753,1267.6406,384.6753,1263.6406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="382.6753" x2="1802.2246" y1="1263.6406" y2="1263.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.3867" x="394.6753" y="1243.4419">Registrierungs-/Zugriffsergebnis</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.6582" x="394.6753" y="1258.5747">(Erfolg/Fehler, [Sitzungstoken])</text></g><path d="M79,1278.6406 L143.4429,1278.6406 L143.4429,1285.7734 L133.4429,1295.7734 L79,1295.7734 L79,1278.6406" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="169.7344" style="stroke:#000000;stroke-width:1.5;" width="639.8691" x="79" y="1278.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="94" y="1291.7075">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="220.7412" x="158.4429" y="1290.8511">[Erfolgreiche Registrierung/Zugriff]</text><g class="message" data-participant-1="App" data-participant-2="App"><line style="stroke:#181818;stroke-width:1;" x1="377.6753" x2="419.6753" y1="1358.8047" y2="1358.8047"/><line style="stroke:#181818;stroke-width:1;" x1="419.6753" x2="419.6753" y1="1358.8047" y2="1371.8047"/><line style="stroke:#181818;stroke-width:1;" x1="378.6753" x2="419.6753" y1="1371.8047" y2="1371.8047"/><polygon fill="#181818" points="388.6753,1367.8047,378.6753,1371.8047,388.6753,1375.8047,384.6753,1371.8047" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="322.3213" x="384.6753" y="1323.4731">Aktion durchf&#252;hren (z.B. Registrierung speichern,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237.3198" x="384.6753" y="1338.606">auf gesch&#252;tzte Ressource zugreifen,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.7036" x="384.6753" y="1353.7388">Sitzungstoken verwenden)</text></g><path d="M89,1300.7734 L89,1385.7734 L362,1385.7734 L362,1310.7734 L352,1300.7734 L89,1300.7734" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M352,1300.7734 L352,1310.7734 L362,1310.7734 L352,1300.7734" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.0698" x="95" y="1317.8403">F&#252;r zuk&#252;nftige Anfragen kann die App</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.3301" x="95" y="1332.9731">den `privKey` (im TEE) zum Signieren</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235.3838" x="95" y="1348.106">von Challenges verwenden, um sich</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.793" x="95" y="1363.2388">authentifizieren, ohne die ganze</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252.5479" x="95" y="1378.3716">`certChain` erneut senden zu m&#252;ssen.</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="79" x2="718.8691" y1="1392.4375" y2="1392.4375"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="249.9761" x="84" y="1402.6479">[Fehlgeschlagene Registrierung/Zugriff]</text><g class="message" data-participant-1="App" data-participant-2="App"><line style="stroke:#181818;stroke-width:1;" x1="377.6753" x2="419.6753" y1="1427.375" y2="1427.375"/><line style="stroke:#181818;stroke-width:1;" x1="419.6753" x2="419.6753" y1="1427.375" y2="1440.375"/><line style="stroke:#181818;stroke-width:1;" x1="378.6753" x2="419.6753" y1="1440.375" y2="1440.375"/><polygon fill="#181818" points="388.6753,1436.375,378.6753,1440.375,388.6753,1444.375,384.6753,1440.375" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279.8301" x="384.6753" y="1422.3091">Fehlermeldung anzeigen / Aktion ablehnen</text></g><!--SRC=[fLVRRjj647tNLonIeBLiNPhcrXf802LMBeZH2h7R1yS1l1A7v4BKKjXTsh4-f5-GR-YJtlHZFRDBKgGi1GNwP8lSdPazS-QSvL8QfsPgARKJZqRBvICXhS3VphBrGaScLv7uIFVMvOR4QFB1hwmUu7TxH_LYY7yMqZeoultetE_1t_RQ2pLB2K7VInFTIVnpT3aU3o_6NRyS_xUNNv79nQKfh1CNI4ABQtqq6K-6axD9s75rsUdW2EBafDFvIJmUy7b4d9k8Z1EH8l6ED1b5fj298AN92aq5QN4nIxFDsbhAh5We9qREaNNbGgbzqFwhvg6HuxInRIcbwJUZIntoQjIuZIYTohLuayei8vsGk9bL_zvqEpft93AA7G8lQQLYjL9S-2XJqlR4rHtDvZtyIdAZNBeeREzQ5pgg3zWgcdCsegEU0MFoow3LIgHJZW8s8nqRYPgazZ_hdeocrXavyvMVotlqymYDx8extcewJKm04Lu16h6BZKXAR03sqKGQkI1ixhK1G7rF1Zx2uRBiBcNACdWNqeCp_oVzqu5umCbgAye1nTfnEvmlf3qLluDAzd1Y9gjHjv8dOhj8t2pn423UY5ioKnnyweJI7B7RYhxvEuv9kupBq-q0nTJlfw_eK-fpyLcUxJaB6OnDbeMZDFbYLpWW63UNhfNrm9eg439vrXgLf4xaSTZK5sytwyHjAqkLNXNNkdxUuENEgtTaDjySaG9k5ijYXyEMQuGuUftdhd-1CGBvnHyN_RzG1tZP4nFfPcd_d6ufw_5AWJSebIB1MqIr9SYBE2Cd5KQTt6pGvUHOVKSwelOGMRj5ULKi06UYQtYVVnTUCFMgHilE2L5RkEw-H7mh5miSEi0AihpEf7CDo4-W0CfozxSF2Ky_uO2Ul2_saPVfzD5dOAdO_7E0HAl2RDQpUQYn7ED-7tDKz_3a41VA0zpCy0JAflGD5_Dh66IVdz4OcuIcMY5PDSaj7QhoXxnjfTsjOoVJRpkIzfsKBEDLfdQ6L_xTzp8rr9cNfkW8r7Uxck5jh0SBxoW3p45CoSmB7Jk_AWBq9S-jvwMOKaOWl5VebozVYeRHVT3G2pdtwejNtjT-3iQcj7BA2zCdIXH4EhHcU5Kau7wCg6hH30Mhh8piwZAeP6kZxLTRhGoY2nRQC1RDapNdjoS-9qay47zQClrHuT8lBHyxKr14PC2PZPWKUkvwlXUqy4_UP0fiPE6pnInrmAogVLLWc925np_dfQpx_DJK5GElQtt6SSSJ4M- -wMJ7CAOUpyUu1l2Aqb8-i2yll0yZDCWW9Zd6uRu_rew7IqN1lNsNSB6e_0M8rRZzSCvozpehw5Jm1OJVy1saIZtFqRIlJlpe5KDcZEDX03rqN5Olw94l6ZxDoMzbfY9LtLvQ1izCMeBASQqsTP_zWUgAzuXD5TRhZA_H5VZH4-yswyofP8upzxomY3SZ5aSOIy7lSIyn9f2ssqZGlDoClw9dBChYJ7BtS8C3Xu25BvOpzbi6W7kC5Plr5DKeg9zY4UGrxGafDmS7o78PiNktDRuMymkQ5RWXtGjl1_MTibd0rZg63UVOPicNV1QPTNViZGzxVCoTESyJDJyzFhxMesa2Re6TJDEowluajmmfu9L5sscxldCIKsNu8b0JX6dGOwFIKMvSoGL_ZOieLkmxZclVxJC6BD3yIM2Cu_4fAL4ECpMOlUMnrxfzIn22Oe_2s6Ioc98UUdk49HiTsFaqv59-bZmzUGfy4uFoxil8it8MPcMCMMdDs-5KpyBqMd8hzo2sY0epIpkGYVPZI6WLi8ExW6YMy22tZy7nIPzkYJTic6DJSyGHP1NHyRkfdO5uogrOHrq-nq8qlZRpVeKqdiPGNMjpPEMxvTtcMshAChTSWt82IbdHXksryXbMKpOUcTbhVLkDfhtRh4sa4WZXslV0GdZ3IU03Swcr6tJmTKCFWDe2lXUggkxRxJ8uWc_DywertY7uHbavxZw_zPHhsEmXww4o1aPYRE8yIuPlASruDZwtyFqI-F4YUA4XcNWYChxDKW8vV233KqhxpTAVlJH7_86a1Slrv02cgM_zQl1wqDulxD97DHhcnRaJ0hgRDTXAZJwl2iwEeSAgDajkovidw5vJ87ZdM-xagfXlrhWu0FdANRJWTbRuNlFUnaV44JoVlntQ5rOmfVdTQRTfUmBhs5ovV8TReIk_E_bLdkfmVqaaBftNkc5Yi6TyEhlGVJPIiV3JeakQSTCy5XcN_5zH3wrUK5QwyCf_28XXrGw93oJKL78mSAdpBm00]--></g></svg>