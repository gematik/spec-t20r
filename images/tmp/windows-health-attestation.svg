<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1862px" preserveAspectRatio="none" style="width:1810px;height:1862px;background:#FFFFFF;" version="1.1" viewBox="0 0 1810 1862" width="1810px" zoomAndPan="magnify"><title>Dynamic Client Registration (RFC 7591) using WHA Attestation with Request/Response Details</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="748.4053" x="535.0444" y="27.9951">Dynamic Client Registration (RFC 7591) using WHA Attestation with Request/Response Details</text><rect fill="#F8F8FF" height="1812.8125" style="stroke:#181818;stroke-width:0.5;" width="884.894" x="17" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="119.6216" x="399.6362" y="55.3638">Windows Device</text><g><title>Client Application</title><rect fill="#FFFFFF" height="1643.8984" style="stroke:#181818;stroke-width:1;" width="10" x="84.6021" y="136.3203"/></g><g><title>Windows Health</title><rect fill="#FFFFFF" height="255.9297" style="stroke:#181818;stroke-width:1;" width="10" x="591.3066" y="373.5156"/></g><g><title>TPM</title><rect fill="#FFFFFF" height="71.2656" style="stroke:#181818;stroke-width:1;" width="10" x="871.3574" y="444.7813"/></g><g><title>Authorization Server (AuthS)</title><rect fill="#FFFFFF" height="136.6641" style="stroke:#181818;stroke-width:1;" width="10" x="1070.4355" y="192.5859"/></g><g><title>Authorization Server (AuthS)</title><rect fill="#FFFFFF" height="543.9844" style="stroke:#181818;stroke-width:1;" width="10" x="1070.4355" y="658.5781"/></g><rect fill="none" height="650.0547" style="stroke:#000000;stroke-width:1.5;" width="1449.0176" x="11" y="1122.1641"/><g><title>Client Application</title><rect fill="#000000" fill-opacity="0.00000" height="1662.8984" width="8" x="85.6021" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="89" x2="89" y1="126.3203" y2="1789.2188"/></g><g><title>Windows Health</title><rect fill="#000000" fill-opacity="0.00000" height="1662.8984" width="8" x="592.3066" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="595.876" x2="595.876" y1="126.3203" y2="1789.2188"/></g><g><title>TPM</title><rect fill="#000000" fill-opacity="0.00000" height="1662.8984" width="8" x="872.3574" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="875.8208" x2="875.8208" y1="126.3203" y2="1789.2188"/></g><g><title>Authorization Server (AuthS)</title><rect fill="#000000" fill-opacity="0.00000" height="1662.8984" width="8" x="1071.4355" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1074.8345" x2="1074.8345" y1="126.3203" y2="1789.2188"/></g><g class="participant participant-head" data-participant="Client"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137.2041" x="21" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123.2041" x="28" y="115.0186">Client Application</text></g><g class="participant participant-tail" data-participant="Client"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="137.2041" x="21" y="1788.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="123.2041" x="28" y="1808.2139">Client Application</text></g><g class="participant participant-head" data-participant="WHAService"><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="196.8613" x="497.876" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.2236" x="539.6948" y="82.4248">Windows Health</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="182.8613" x="504.876" y="98.7217">Attestation Service (WHA)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135.1396" x="528.7368" y="115.0186">(System Privileges)</text></g><g class="participant participant-tail" data-participant="WHAService"><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="196.8613" x="497.876" y="1788.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.2236" x="539.6948" y="1808.2139">Windows Health</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="182.8613" x="504.876" y="1824.5107">Attestation Service (WHA)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135.1396" x="528.7368" y="1840.8076">(System Privileges)</text></g><g class="participant participant-head" data-participant="TPM"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.0732" x="854.8208" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.0732" x="861.8208" y="115.0186">TPM</text></g><g class="participant participant-tail" data-participant="TPM"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.0732" x="854.8208" y="1788.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29.0732" x="861.8208" y="1808.2139">TPM</text></g><g class="participant participant-head" data-participant="AuthS"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="215.2021" x="967.8345" y="78.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="201.2021" x="974.8345" y="98.7217">Authorization Server (AuthS)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107.9668" x="1021.4521" y="115.0186">(DCR Endpoint)</text></g><g class="participant participant-tail" data-participant="AuthS"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="215.2021" x="967.8345" y="1788.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="201.2021" x="974.8345" y="1808.2139">Authorization Server (AuthS)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107.9668" x="1021.4521" y="1824.5107">(DCR Endpoint)</text></g><g><title>Client Application</title><rect fill="#FFFFFF" height="1643.8984" style="stroke:#181818;stroke-width:1;" width="10" x="84.6021" y="136.3203"/></g><g><title>Windows Health</title><rect fill="#FFFFFF" height="255.9297" style="stroke:#181818;stroke-width:1;" width="10" x="591.3066" y="373.5156"/></g><g><title>TPM</title><rect fill="#FFFFFF" height="71.2656" style="stroke:#181818;stroke-width:1;" width="10" x="871.3574" y="444.7813"/></g><g><title>Authorization Server (AuthS)</title><rect fill="#FFFFFF" height="136.6641" style="stroke:#181818;stroke-width:1;" width="10" x="1070.4355" y="192.5859"/></g><g><title>Authorization Server (AuthS)</title><rect fill="#FFFFFF" height="543.9844" style="stroke:#181818;stroke-width:1;" width="10" x="1070.4355" y="658.5781"/></g><path d="M5,141.3203 L5,166.3203 L1162,166.3203 L1162,151.3203 L1152,141.3203 L5,141.3203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1152,141.3203 L1152,151.3203 L1162,151.3203 L1152,141.3203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="326.6567" x="415.6899" y="158.3872">Dynamic Client Registration (RFC 7591) with WHA</text><g class="message" data-participant-1="Client" data-participant-2="AuthS"><polygon fill="#181818" points="1058.4355,188.5859,1068.4355,192.5859,1058.4355,196.5859,1062.4355,192.5859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="94.6021" x2="1064.4355" y1="192.5859" y2="192.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="101.6021" y="187.52">(01)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.5854" x="132.2876" y="187.52">Request Nonce</text></g><path d="M99,205.5859 L99,260.5859 L286,260.5859 L286,215.5859 L276,205.5859 L99,205.5859" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M276,205.5859 L276,215.5859 L286,215.5859 L276,205.5859" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.0015" x="105" y="222.6528">GET /nonce HTTP/1.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.6387" x="105" y="237.7856">Host: auths.example.com</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.7144" x="105" y="252.9185">Accept: application/json</text><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#181818;stroke-width:1;" x1="1080.4355" x2="1122.4355" y1="287.1172" y2="287.1172"/><line style="stroke:#181818;stroke-width:1;" x1="1122.4355" x2="1122.4355" y1="287.1172" y2="300.1172"/><line style="stroke:#181818;stroke-width:1;" x1="1081.4355" x2="1122.4355" y1="300.1172" y2="300.1172"/><polygon fill="#181818" points="1091.4355,296.1172,1081.4355,300.1172,1091.4355,304.1172,1087.4355,300.1172" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="1087.4355" y="282.0513">(02)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.9106" x="1118.1211" y="282.0513">Generate Nonce</text></g><g class="message" data-participant-1="AuthS" data-participant-2="Client"><polygon fill="#181818" points="105.6021,325.25,95.6021,329.25,105.6021,333.25,101.6021,329.25" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="99.6021" x2="1074.4355" y1="329.25" y2="329.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="111.6021" y="324.1841">(03)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89.1465" x="142.2876" y="324.1841">Return Nonce</text></g><g class="message" data-participant-1="Client" data-participant-2="WHAService"><polygon fill="#181818" points="579.3066,369.5156,589.3066,373.5156,579.3066,377.5156,583.3066,373.5156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="94.6021" x2="585.3066" y1="373.5156" y2="373.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="101.6021" y="360.8833">(04)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.1665" x="132.2876" y="353.3169">Request Health Attestation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.4336" x="132.2876" y="368.4497">(using Nonce")</text></g><g class="message" data-participant-1="WHAService" data-participant-2="WHAService"><line style="stroke:#181818;stroke-width:1;" x1="601.3066" x2="643.3066" y1="402.6484" y2="402.6484"/><line style="stroke:#181818;stroke-width:1;" x1="643.3066" x2="643.3066" y1="402.6484" y2="415.6484"/><line style="stroke:#181818;stroke-width:1;" x1="602.3066" x2="643.3066" y1="415.6484" y2="415.6484"/><polygon fill="#181818" points="612.3066,411.6484,602.3066,415.6484,612.3066,419.6484,608.3066,415.6484" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="608.3066" y="397.5825">(05)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.2505" x="638.9922" y="397.5825">Gather device health data</text></g><g class="message" data-participant-1="WHAService" data-participant-2="TPM"><polygon fill="#181818" points="859.3574,440.7813,869.3574,444.7813,859.3574,448.7813,863.3574,444.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="601.3066" x2="865.3574" y1="444.7813" y2="444.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="608.3066" y="439.7153">(06)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.3652" x="638.9922" y="439.7153">Request TPM Quote (incl. Nonce")</text></g><g class="message" data-participant-1="TPM" data-participant-2="TPM"><line style="stroke:#181818;stroke-width:1;" x1="881.3574" x2="923.3574" y1="473.9141" y2="473.9141"/><line style="stroke:#181818;stroke-width:1;" x1="923.3574" x2="923.3574" y1="473.9141" y2="486.9141"/><line style="stroke:#181818;stroke-width:1;" x1="882.3574" x2="923.3574" y1="486.9141" y2="486.9141"/><polygon fill="#181818" points="892.3574,482.9141,882.3574,486.9141,892.3574,490.9141,888.3574,486.9141" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="888.3574" y="468.8481">(07)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.3926" x="919.043" y="468.8481">Create signed Quote</text></g><g class="message" data-participant-1="TPM" data-participant-2="WHAService"><polygon fill="#181818" points="612.3066,512.0469,602.3066,516.0469,612.3066,520.0469,608.3066,516.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="606.3066" x2="875.3574" y1="516.0469" y2="516.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="618.3066" y="510.981">(08)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.604" x="648.9922" y="510.981">Return Quote</text></g><g class="message" data-participant-1="WHAService" data-participant-2="WHAService"><line style="stroke:#181818;stroke-width:1;" x1="601.3066" x2="643.3066" y1="545.1797" y2="545.1797"/><line style="stroke:#181818;stroke-width:1;" x1="643.3066" x2="643.3066" y1="545.1797" y2="558.1797"/><line style="stroke:#181818;stroke-width:1;" x1="602.3066" x2="643.3066" y1="558.1797" y2="558.1797"/><polygon fill="#181818" points="612.3066,554.1797,602.3066,558.1797,612.3066,562.1797,608.3066,558.1797" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="608.3066" y="540.1138">(09)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.2769" x="638.9922" y="540.1138">Get AIK Cert &amp; TCG Log</text></g><g class="message" data-participant-1="WHAService" data-participant-2="WHAService"><line style="stroke:#181818;stroke-width:1;" x1="601.3066" x2="643.3066" y1="587.3125" y2="587.3125"/><line style="stroke:#181818;stroke-width:1;" x1="643.3066" x2="643.3066" y1="587.3125" y2="600.3125"/><line style="stroke:#181818;stroke-width:1;" x1="602.3066" x2="643.3066" y1="600.3125" y2="600.3125"/><polygon fill="#181818" points="612.3066,596.3125,602.3066,600.3125,612.3066,604.3125,608.3066,600.3125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="608.3066" y="582.2466">(10)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.9604" x="638.9922" y="582.2466">Create WHA Attestation Blob</text></g><g class="message" data-participant-1="WHAService" data-participant-2="Client"><polygon fill="#181818" points="105.6021,625.4453,95.6021,629.4453,105.6021,633.4453,101.6021,629.4453" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="99.6021" x2="595.3066" y1="629.4453" y2="629.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="111.6021" y="624.3794">(11)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="277.2275" x="142.2876" y="624.3794">Return WHA Attestation Blob (binary data)</text></g><g class="message" data-participant-1="Client" data-participant-2="AuthS"><polygon fill="#181818" points="1058.4355,654.5781,1068.4355,658.5781,1058.4355,662.5781,1062.4355,658.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="94.6021" x2="1064.4355" y1="658.5781" y2="658.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="101.6021" y="653.5122">(12)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224.2754" x="132.2876" y="653.5122">POST DCR Request with WHA Blob</text></g><path d="M99,671.5781 L99,953.5781 L589,953.5781 L589,681.5781 L579,671.5781 L99,671.5781" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M579,671.5781 L579,681.5781 L589,681.5781 L579,671.5781" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.8794" x="105" y="688.645">POST /register HTTP/1.1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.6387" x="105" y="703.7778">Host: auths.example.com</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199.4561" x="105" y="718.9106">Content-Type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="105" y="734.0435">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="105" y="749.1763">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="360.0962" x="113.2646" y="764.3091">"redirect_uris": ["https://client.example.com/callback"],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.6343" x="113.2646" y="779.4419">"client_name": "My Secure Windows App",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="357.7285" x="113.2646" y="794.5747">"grant_types": ["authorization_code", "refresh_token"],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353.082" x="113.2646" y="809.7075">"token_endpoint_auth_method": "client_secret_basic",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.4839" x="113.2646" y="824.8403">"scope": "api:read api:write",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271.5273" x="113.2646" y="839.9731">"contacts": ["tech@client.example.com"],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.6943" x="113.2646" y="855.106">"policy_uri": "https://client.example.com/policy",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="408.605" x="113.2646" y="870.2388">"jwks_uri": "https://client.example.com/.well-known/jwks.json",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.9263" x="113.2646" y="885.3716">"software_id": "unique-software-guid",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0957" x="113.2646" y="900.5044">"software_version": "1.2.3",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="461.6523" x="113.2646" y="915.6372">"windows_attestation_blob": "AAEFAwoAAAAPQlpoOTFBWSZTWXhv...",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292.3032" x="113.2646" y="930.77">"attestation_nonce": "aFp40Nn7lYkLqXyW..."</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="105" y="945.9028">}</text><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#181818;stroke-width:1;" x1="1080.4355" x2="1122.4355" y1="1037.1328" y2="1037.1328"/><line style="stroke:#181818;stroke-width:1;" x1="1122.4355" x2="1122.4355" y1="1037.1328" y2="1050.1328"/><line style="stroke:#181818;stroke-width:1;" x1="1081.4355" x2="1122.4355" y1="1050.1328" y2="1050.1328"/><polygon fill="#181818" points="1091.4355,1046.1328,1081.4355,1050.1328,1091.4355,1054.1328,1087.4355,1050.1328" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="1087.4355" y="1032.0669">(13)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.0649" x="1118.1211" y="1032.0669">Verify DCR Request &amp; WHA Blob:</text></g><path d="M1354.7505,963.9688 L1354.7505,1109.9688 L1803.7505,1109.9688 L1803.7505,973.9688 L1793.7505,963.9688 L1354.7505,963.9688" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1793.7505,963.9688 L1793.7505,973.9688 L1803.7505,973.9688 L1793.7505,963.9688" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="266.7349" x="1360.7505" y="981.0356">- Parse DCR Metadata (redirect_uris etc.)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.9526" x="1360.7505" y="996.1685">- Extract `windows_attestation_blob` &amp; `attestation_nonce`</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.6909" x="1360.7505" y="1011.3013">-</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="126.0073" x="1369.5737" y="1011.3013">Verify WHA Blob:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="420.0435" x="1369.0151" y="1026.4341">- Nonce matches `attestation_nonce` ("aFp40Nn7lYkLqXyW...")?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.0298" x="1369.0151" y="1041.5669">- AIK Cert Chain &amp; Validity?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157.644" x="1369.0151" y="1056.6997">- Quote Signature valid?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298.4287" x="1369.0151" y="1071.8325">- Event Log Replay =&gt; PCRs == Quote PCRs?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.478" x="1369.0151" y="1086.9653">- OS Health Claims ok?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.6909" x="1360.7505" y="1102.0981">-</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="97.2397" x="1369.5737" y="1102.0981">Policy Check:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.5156" x="1470.9458" y="1102.0981">DCR Metadata valid &amp; Device compliant?</text><path d="M11,1122.1641 L75.4429,1122.1641 L75.4429,1129.2969 L65.4429,1139.2969 L11,1139.2969 L11,1122.1641" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="650.0547" style="stroke:#000000;stroke-width:1.5;" width="1449.0176" x="11" y="1122.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="26" y="1135.231">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="248.3594" x="90.4429" y="1134.3745">[DCR Request valid &amp; Device compliant]</text><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#181818;stroke-width:1;" x1="1080.4355" x2="1122.4355" y1="1160.4297" y2="1160.4297"/><line style="stroke:#181818;stroke-width:1;" x1="1122.4355" x2="1122.4355" y1="1160.4297" y2="1173.4297"/><line style="stroke:#181818;stroke-width:1;" x1="1081.4355" x2="1122.4355" y1="1173.4297" y2="1173.4297"/><polygon fill="#181818" points="1091.4355,1169.4297,1081.4355,1173.4297,1091.4355,1177.4297,1087.4355,1173.4297" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="1087.4355" y="1155.3638">(14)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="319.8965" x="1118.1211" y="1155.3638">Register Client (Generate client_id, client_secret)</text></g><g class="message" data-participant-1="AuthS" data-participant-2="Client"><polygon fill="#181818" points="105.6021,1198.5625,95.6021,1202.5625,105.6021,1206.5625,101.6021,1202.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="99.6021" x2="1074.4355" y1="1202.5625" y2="1202.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="111.6021" y="1197.4966">(15)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244.0229" x="142.2876" y="1197.4966">201 Created - Registration successful</text></g><path d="M550,1215.5625 L550,1497.5625 L1069,1497.5625 L1069,1225.5625 L1059,1215.5625 L550,1215.5625" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1059,1215.5625 L1059,1225.5625 L1069,1225.5625 L1059,1215.5625" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.3618" x="556" y="1232.6294">HTTP/1.1 201 Created</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199.4561" x="556" y="1247.7622">Content-Type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.959" x="556" y="1262.895">Cache-Control: no-store</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="556" y="1278.0278">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="556" y="1293.1606">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.2666" x="564.2646" y="1308.2935">"client_id": "s6BhdRkqt3",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268.9502" x="564.2646" y="1323.4263">"client_secret": "cf136dc3c1fc93f31185",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.1729" x="564.2646" y="1338.5591">"client_secret_expires_at": 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="298.0796" x="564.2646" y="1353.6919">"registration_access_token": "reg-token-123",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="490.6929" x="564.2646" y="1368.8247">"registration_client_uri": "https://auths.example.com/register/s6BhdRkqt3",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.0933" x="564.2646" y="1383.9575">"client_id_issued_at": 1678886400,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="360.0962" x="564.2646" y="1399.0903">"redirect_uris": ["https://client.example.com/callback"],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.6343" x="564.2646" y="1414.2231">"client_name": "My Secure Windows App",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="357.7285" x="564.2646" y="1429.356">"grant_types": ["authorization_code", "refresh_token"],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353.082" x="564.2646" y="1444.4888">"token_endpoint_auth_method": "client_secret_basic",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.4839" x="564.2646" y="1459.6216">"scope": "api:read api:write",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="359.7026" x="564.2646" y="1474.7544">// ... other registered parameters reflecting the request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="556" y="1489.8872">}</text><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#181818;stroke-width:1;" x1="94.6021" x2="136.6021" y1="1524.0859" y2="1524.0859"/><line style="stroke:#181818;stroke-width:1;" x1="136.6021" x2="136.6021" y1="1524.0859" y2="1537.0859"/><line style="stroke:#181818;stroke-width:1;" x1="95.6021" x2="136.6021" y1="1537.0859" y2="1537.0859"/><polygon fill="#181818" points="105.6021,1533.0859,95.6021,1537.0859,105.6021,1541.0859,101.6021,1537.0859" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="101.6021" y="1519.02">(16)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="442.019" x="132.2876" y="1519.02">Registration successful, store credentials ("s6BhdRkqt3", "cf136...")</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="11" x2="1460.0176" y1="1546.0859" y2="1546.0859"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="287.8262" x="16" y="1556.2964">[DCR Request invalid or Device not compliant]</text><g class="message" data-participant-1="AuthS" data-participant-2="Client"><polygon fill="#181818" points="105.6021,1577.0234,95.6021,1581.0234,105.6021,1585.0234,101.6021,1581.0234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="99.6021" x2="1074.4355" y1="1581.0234" y2="1581.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="111.6021" y="1575.9575">(17)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252.021" x="142.2876" y="1575.9575">400 Bad Request - Registration denied</text></g><path d="M521,1594.0234 L521,1725.0234 L1069,1725.0234 L1069,1604.0234 L1059,1594.0234 L521,1594.0234" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1059,1594.0234 L1059,1604.0234 L1069,1604.0234 L1059,1594.0234" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.2876" x="527" y="1611.0903">HTTP/1.1 400 Bad Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199.4561" x="527" y="1626.2231">Content-Type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.959" x="527" y="1641.356">Cache-Control: no-store</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="527" y="1656.4888">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="527" y="1671.6216">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="378.5552" x="535.2646" y="1686.7544">"error": "invalid_request", // or "unmet_attestation_policy"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="519.5049" x="535.2646" y="1701.8872">"error_description": "Device attestation failed policy checks: PCR[7] mismatch."</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="527" y="1717.02">}</text><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#181818;stroke-width:1;" x1="94.6021" x2="136.6021" y1="1751.2188" y2="1751.2188"/><line style="stroke:#181818;stroke-width:1;" x1="136.6021" x2="136.6021" y1="1751.2188" y2="1764.2188"/><line style="stroke:#181818;stroke-width:1;" x1="95.6021" x2="136.6021" y1="1764.2188" y2="1764.2188"/><polygon fill="#181818" points="105.6021,1760.2188,95.6021,1764.2188,105.6021,1768.2188,101.6021,1764.2188" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="101.6021" y="1746.1528">(18)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.1265" x="132.2876" y="1746.1528">Registration failed</text></g><!--SRC=[vLTRSzD657xNhpYZpb0x-18JI89dW3ec5wP0ZEqIMc2KjRIs5ijQiRkAutRwttls8bjo7A3Jn-ObblPSldFxpehaYgVvOa85-BNz_RhlAQOI2YzNALcm4Fe9ewc28PqngGHHZATG6vxruUZ9qquTSidI6LnTzA2d59NA2YoPYb7bQuvlsaCgCvvAD4aLOOdql0c_1V-AfH5VIdnxmqBgmq_dCPVgAcQAUe1_6H6AXImZwDrtA7fPbh3G-F21I0VkhdXX-uAIHCMVqZAs4HNQ8TGGTFrJMXkjfA8B60Xsmn8wex9kJEEfaxnhVZnuOsJmlqVJ230UhoBGorNC1Vjpun7JMzDlHzhbo_uGJjCeuonLrfivyhoKAmfS2zl86lQW-wFLC7b7v9xd11y-z7w6oqpBaQG1arp1ZFC8Ca52X4kxS4uLJ0MLCRpbAQPbGgTSK22RZ1Msciyj6ZJQBOfhbInkmMQn0Zujgd9-EePsQenUZCU3TgVLyIwmn5qWQ4Qsw2rPP0bjXNpXzSAGPlfaK-3s5uc-TNgrTS-plWiG6dXACGFKGN37U5x0RMgKAXUfay1CRDe8QYD5qeY827wJLDH1s81afO-dWYzCSnUji4d5fZyg-R0TLpQ2zRP3Ob3uTOsZP19S0zQ1Yp2cfgfKWeffsOXNSbTnZdaWA2iWCcC4iVKV4KMsTB1PAqZryxjS5wx6qZ1fhV7f0olVXRwWEiMIpL8QMN5xNir0ATTMvXjmiTzwhtw5FXKA7i2uVmwl-UmR2Wx2DiMS97nIqTfP-LrQK9kmb8YLIL9zgoqaDfo4Og90JsgHC9sbFDALrCNHbWs6NTCnk1oDAxh5O5gLdUDYTDh2J3RMyxiZq-UfGhtcU9NH7OFZ_OMyvGiQCK535UI2IRyB7_rOgKnss-tGU2rRR8SaIIOadFkV6rhNIWH8F1Gr_JShRDamHsues1NpvHl9cK3M2nG2iJv8cVw2a4VKRsWiXcS2nUSqTJxCxu0wBWoqOh2Wg1rfbmw1fA6WAfWGoKBhK8OyCw18nhhO7n7e7qk1kyCAX9WSP3WBHz4m_kLkl0v2nZ5nAvqWRV0RwR62rlwNvLp-W4fhIPEaEK_v4gk2AYrT6XS2dweb4JHW9jGyPTWfpU9jSvRZ-weWhWMf5nzATrgFMWVsU6cB4PG8EvXWascnNk_qhBVaFVmRl4ioVZa-ExaQ_J6- -X3Vj5ejQw2iQDZQvFKiUxp_DZrAVf-__lfXTQMblRzBR8nJOzlzXYGiMbDMkUUHNgkJiitWxwbWqrL5vy5QkbkQ4eJPX04HqZfuW_S8FRjGgxGtK1MswaRsz5Rf1GVNzsNd6ZrTtudysYZlxJbWQoXxU-OEq7GhSa6KPkfT1g2sCtNr5yx0cldwCM4fWdYlqyVKgX2mZ3n2lYLApvf9Rt5uUgEP1kaIyvKbP0NFdiEWFvJmx9bJr4-5zEMes4RzXB2513v_uG8Sc5P643ISOtJLh1gN2CrUp03x6Aa51_n5gVnejbAt-tGCbEsw3mkESzHPMwzoD_0iQa1bzkjbErMYVxJVSIiYmj0g5oEPuwr2occU67NJJmcT6jAr5ww2PCjMlaUiVOB5RseXmPCkMcrAXJScHxZh2FGKoSEJE1hEloetgvMO3C5DEmU7KNWGTgRXquFfGQTp_6I7Q41lC-nptSQejT-mpBw9D20cKCUiNNFOD0_DpYFdkoBlh6yHs9qTizv6xNiYOL70fCnfP95r3e-EZuyF7-yN4F-NowVT1fnvuEPQLcGGknE_430Q_2tnxJJ1n1Ht2NVtH8BLVRgUClsmkLtONztxMhm1fWq1qKOenqWYaOpATNFjPlZ8eucaMxSREyDS54EC67OFSdK0iTfmWaae36qD8O9XE5JV6y0jA_zj2AaGNEWAkQ02bs3C0HO78yHrYvMeR0MttTVgGKHbA9ZvTDAcN598-Ui0lsPrNIsPXffCPLTJyCUZpx1Wqkm9ipV_RLcjPSsttZy0]--></g></svg>