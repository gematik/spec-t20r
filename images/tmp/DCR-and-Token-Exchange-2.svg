<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1367px" preserveAspectRatio="none" style="width:1163px;height:1367px;background:#FFFFFF;" version="1.1" viewBox="0 0 1163 1367" width="1163px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="195.6016" style="stroke:#000000;stroke-width:1.5;" width="775.0142" x="9" y="440.7578"/><rect fill="none" height="195.6016" style="stroke:#000000;stroke-width:1.5;" width="705.0142" x="79" y="1077.0859"/><g><title>ZETA Client</title><rect fill="#000000" fill-opacity="0.00000" height="1222.3906" width="8" x="385.7729" y="67.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="389" x2="389" y1="67.2969" y2="1289.6875"/></g><g><title>ZETA Guard AS</title><rect fill="#000000" fill-opacity="0.00000" height="1222.3906" width="8" x="669.4302" y="67.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="672.8462" x2="672.8462" y1="67.2969" y2="1289.6875"/></g><g><title>PDP Client Registry</title><rect fill="#000000" fill-opacity="0.00000" height="1222.3906" width="8" x="869.584" y="67.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="873.0654" x2="873.0654" y1="67.2969" y2="1289.6875"/></g><g><title>Policy Engine</title><rect fill="#000000" fill-opacity="0.00000" height="1222.3906" width="8" x="1003.7031" y="67.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1007.1025" x2="1007.1025" y1="67.2969" y2="1289.6875"/></g><g class="participant participant-head" data-participant="Client"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95.5459" x="342" y="36"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.5459" x="349" y="55.9951">ZETA Client</text></g><g class="participant participant-tail" data-participant="Client"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95.5459" x="342" y="1288.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81.5459" x="349" y="1308.6826">ZETA Client</text></g><g class="participant participant-head" data-participant="AS"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="201.168" x="572.8462" y="19.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106.873" x="619.9937" y="39.6982">ZETA Guard AS</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="187.168" x="579.8462" y="55.9951">(PDP Authorization Server)</text></g><g class="participant participant-tail" data-participant="AS"><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="201.168" x="572.8462" y="1288.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106.873" x="619.9937" y="1308.6826">ZETA Guard AS</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="187.168" x="579.8462" y="1324.9795">(PDP Authorization Server)</text></g><g class="participant participant-head" data-participant="Registry"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135.0371" x="803.0654" y="63.9951">PDP Client Registry</text><path d="M855.584,15 C855.584,5 873.584,5 873.584,5 C873.584,5 891.584,5 891.584,15 L891.584,41 C891.584,51 873.584,51 873.584,51 C873.584,51 855.584,51 855.584,41 L855.584,15" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M855.584,15 C855.584,25 873.584,25 873.584,25 C873.584,25 891.584,25 891.584,15" fill="none" style="stroke:#181818;stroke-width:1.5;"/></g><g class="participant participant-tail" data-participant="Registry"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135.0371" x="803.0654" y="1301.6826">PDP Client Registry</text><path d="M855.584,1314.9844 C855.584,1304.9844 873.584,1304.9844 873.584,1304.9844 C873.584,1304.9844 891.584,1304.9844 891.584,1314.9844 L891.584,1340.9844 C891.584,1350.9844 873.584,1350.9844 873.584,1350.9844 C873.584,1350.9844 855.584,1350.9844 855.584,1340.9844 L855.584,1314.9844" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M855.584,1314.9844 C855.584,1324.9844 873.584,1324.9844 873.584,1324.9844 C873.584,1324.9844 891.584,1324.9844 891.584,1314.9844" fill="none" style="stroke:#181818;stroke-width:1.5;"/></g><g class="participant participant-head" data-participant="Policy Engine"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="107.2012" x="954.1025" y="36"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.2012" x="961.1025" y="55.9951">Policy Engine</text></g><g class="participant participant-tail" data-participant="Policy Engine"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="107.2012" x="954.1025" y="1288.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.2012" x="961.1025" y="1308.6826">Policy Engine</text></g><path d="M249,82.2969 L249,107.2969 L530,107.2969 L530,92.2969 L520,82.2969 L249,82.2969" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M520,82.2969 L520,92.2969 L530,92.2969 L520,82.2969" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.8682" x="255" y="99.3638">Generates:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="184.3296" x="331.0005" y="99.3638">TPM Attestation Key Pair</text><g class="message" data-participant-1="Client" data-participant-2="AS"><polygon fill="#181818" points="661.4302,129.5625,671.4302,133.5625,661.4302,137.5625,665.4302,133.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="389.7729" x2="667.4302" y1="133.5625" y2="133.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259.6572" x="396.7729" y="128.4966">POST /.well-known/openid-configuration</text></g><path d="M678,146.5625 L678,171.5625 L1060,171.5625 L1060,156.5625 L1050,146.5625 L678,146.5625" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1050,146.5625 L1050,156.5625 L1060,156.5625 L1050,146.5625" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="361.6069" x="684" y="163.6294">Retrieves AS Configuration (e.g., registration_endpoint)</text><g class="message" data-participant-1="AS" data-participant-2="Client"><polygon fill="#181818" points="400.7729,193.8281,390.7729,197.8281,400.7729,201.8281,396.7729,197.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="394.7729" x2="672.4302" y1="197.8281" y2="197.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.7026" x="406.7729" y="192.7622">200 OK</text></g><path d="M163,210.8281 L163,235.8281 L384,235.8281 L384,220.8281 L374,210.8281 L163,210.8281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M374,210.8281 L374,220.8281 L384,220.8281 L374,210.8281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.5225" x="169" y="227.895">Contains registration_endpoint</text><g class="message" data-participant-1="Client" data-participant-2="AS"><polygon fill="#181818" points="661.4302,258.0938,671.4302,262.0938,661.4302,266.0938,665.4302,262.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="389.7729" x2="667.4302" y1="262.0938" y2="262.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.3716" x="396.7729" y="257.0278">POST /reg</text></g><path d="M678,275.0938 L678,300.0938 L1015,300.0938 L1015,285.0938 L1005,275.0938 L678,275.0938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1005,275.0938 L1005,285.0938 L1015,285.0938 L1005,275.0938" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316.8115" x="684" y="292.1606">Dynamic Client Registration Request (RFC 7591)</text><path d="M678,310.2266 L678,335.2266 L1028,335.2266 L1028,320.2266 L1018,310.2266 L678,310.2266" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1018,310.2266 L1018,320.2266 L1028,320.2266 L1018,310.2266" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="329.4497" x="684" y="327.2935">Includes metadata and TPM Attestation Statement</text><path d="M678,345.3594 L678,370.3594 L1121,370.3594 L1121,355.3594 L1111,345.3594 L678,345.3594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1111,345.3594 L1111,355.3594 L1121,355.3594 L1111,345.3594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="422.7158" x="684" y="362.4263">The Attestation Statement proves the origin of the key from TPM</text><g class="message" data-participant-1="AS" data-participant-2="Registry"><polygon fill="#181818" points="861.584,392.625,871.584,396.625,861.584,400.625,865.584,396.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="673.4302" x2="867.584" y1="396.625" y2="396.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160.4814" x="680.4302" y="391.5591">Validate TPM Attestation</text></g><g class="message" data-participant-1="Registry" data-participant-2="AS"><polygon fill="#181818" points="684.4302,421.7578,674.4302,425.7578,684.4302,429.7578,680.4302,425.7578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="678.4302" x2="872.584" y1="425.7578" y2="425.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.5698" x="690.4302" y="420.6919">OK or Failure</text></g><path d="M9,440.7578 L73.4429,440.7578 L73.4429,447.8906 L63.4429,457.8906 L9,457.8906 L9,440.7578" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="195.6016" style="stroke:#000000;stroke-width:1.5;" width="775.0142" x="9" y="440.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="24" y="453.8247">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="156.2666" x="88.4429" y="452.9683">[Registration Successful]</text><g class="message" data-participant-1="AS" data-participant-2="Client"><polygon fill="#181818" points="400.7729,475.0234,390.7729,479.0234,400.7729,483.0234,396.7729,479.0234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="394.7729" x2="672.4302" y1="479.0234" y2="479.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.6787" x="406.7729" y="473.9575">201 Created</text></g><path d="M19,492.0234 L19,517.0234 L384,517.0234 L384,502.0234 L374,492.0234 L19,492.0234" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M374,492.0234 L374,502.0234 L384,502.0234 L374,492.0234" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56.9575" x="25" y="509.0903">Contains</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="62.8926" x="86.0898" y="509.0903">Client ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.4575" x="153.1147" y="509.0903">and</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.5928" x="181.7046" y="509.0903">Client Secret</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89.1338" x="280.4297" y="509.0903">(if applicable)</text><path d="M42,527.1563 L42,552.1563 L384,552.1563 L384,537.1563 L374,527.1563 L42,527.1563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M374,527.1563 L374,537.1563 L384,537.1563 L374,527.1563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.8682" x="48" y="544.2231">Generates:</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175.4429" x="124.0005" y="544.2231">Client Instance Key Pair</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.7935" x="303.5757" y="544.2231">(for DPoP)</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="9" x2="784.0142" y1="558.2891" y2="558.2891"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="128.3423" x="14" y="568.4995">[Registration Failed]</text><g class="message" data-participant-1="AS" data-participant-2="Client"><polygon fill="#181818" points="400.7729,589.2266,390.7729,593.2266,400.7729,597.2266,396.7729,593.2266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="394.7729" x2="672.4302" y1="593.2266" y2="593.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.6045" x="406.7729" y="588.1606">400 Bad Request</text></g><path d="M223,606.2266 L223,631.2266 L384,631.2266 L384,616.2266 L374,606.2266 L223,606.2266" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M374,606.2266 L374,616.2266 L384,616.2266 L374,606.2266" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.5181" x="229" y="623.2935">Contains error details</text><g class="message" data-participant-1="Client" data-participant-2="AS"><polygon fill="#181818" points="661.4302,660.4922,671.4302,664.4922,661.4302,668.4922,665.4302,664.4922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="389.7729" x2="667.4302" y1="664.4922" y2="664.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.5933" x="396.7729" y="659.4263">POST /token</text></g><path d="M678,677.4922 L678,702.4922 L1038,702.4922 L1038,687.4922 L1028,677.4922 L678,677.4922" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1028,677.4922 L1028,687.4922 L1038,687.4922 L1028,677.4922" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="339.5933" x="684" y="694.5591">Token Request (OAuth Token Exchange - RFC 8693)</text><path d="M678,712.625 L678,737.625 L1105,737.625 L1105,722.625 L1095,712.625 L678,712.625" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1095,712.625 L1095,722.625 L1105,722.625 L1095,712.625" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="406.4722" x="684" y="729.6919">grant_type=urn:ietf:params:oauth:grant-type:token-exchange</text><path d="M678,747.7578 L678,772.7578 L1156,772.7578 L1156,757.7578 L1146,747.7578 L678,747.7578" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1146,747.7578 L1146,757.7578 L1156,757.7578 L1146,747.7578" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.2202" x="684" y="764.8247">subject_token=&lt;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="334.02" x="796.2202" y="764.8247">SMC-B signed Access Token created by Client</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.8926" x="1130.2402" y="764.8247">&gt;</text><path d="M678,782.8906 L678,807.8906 L1145,807.8906 L1145,792.8906 L1135,782.8906 L678,782.8906" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1135,782.8906 L1135,792.8906 L1145,792.8906 L1135,782.8906" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="446.0054" x="684" y="799.9575">subject_token_type=urn:ietf:params:oauth:token-type:access_token</text><path d="M678,818.0234 L678,843.0234 L848,843.0234 L848,828.0234 L838,818.0234 L678,818.0234" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M838,818.0234 L838,828.0234 L848,828.0234 L838,818.0234" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.8545" x="684" y="835.0903">client_id=&lt;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="62.8926" x="759.8545" y="835.0903">Client ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.8926" x="822.7471" y="835.0903">&gt;</text><path d="M678,853.1563 L678,878.1563 L1117,878.1563 L1117,863.1563 L1107,853.1563 L678,853.1563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1107,853.1563 L1107,863.1563 L1117,863.1563 L1107,853.1563" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38.7778" x="684" y="870.2231">DPoP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.4048" x="722.7778" y="870.2231">: &lt;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="349.4702" x="742.1826" y="870.2231">DPoP Proof JWT (signed with DPoP Private Key)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="10.8926" x="1091.6528" y="870.2231">&gt;</text><path d="M678,888.2891 L678,913.2891 L1030,913.2891 L1030,898.2891 L1020,888.2891 L678,888.2891" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1020,888.2891 L1020,898.2891 L1030,898.2891 L1020,888.2891" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="22.6167" x="684" y="905.356">cnf</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56.5576" x="706.6167" y="905.356">: { jkt: &lt;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="229.4106" x="763.1743" y="905.356">Thumbprint of DPoP Public Key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23.2959" x="992.585" y="905.356">&gt; }</text><g class="message" data-participant-1="AS" data-participant-2="Registry"><polygon fill="#181818" points="861.584,935.5547,871.584,939.5547,861.584,943.5547,865.584,939.5547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="673.4302" x2="867.584" y1="939.5547" y2="939.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.1538" x="680.4302" y="934.4888">Retrieve Client Information</text></g><g class="message" data-participant-1="Registry" data-participant-2="AS"><polygon fill="#181818" points="684.4302,964.6875,674.4302,968.6875,684.4302,972.6875,680.4302,968.6875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="678.4302" x2="872.584" y1="968.6875" y2="968.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.8359" x="690.4302" y="963.6216">Client Details</text></g><g class="message" data-participant-1="AS" data-participant-2="Policy Engine"><polygon fill="#181818" points="995.7031,993.8203,1005.7031,997.8203,995.7031,1001.8203,999.7031,997.8203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="673.4302" x2="1001.7031" y1="997.8203" y2="997.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259.3145" x="680.4302" y="992.7544">Evaluate Access Token Exchange Policy</text></g><path d="M289,1010.8203 L289,1035.8203 L667,1035.8203 L667,1020.8203 L657,1010.8203 L289,1010.8203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M657,1010.8203 L657,1020.8203 L667,1020.8203 L657,1010.8203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="357.7095" x="295" y="1027.8872">Input: SMC-B signed token, Client ID, DPoP information</text><g class="message" data-participant-1="Policy Engine" data-participant-2="AS"><polygon fill="#181818" points="684.4302,1058.0859,674.4302,1062.0859,684.4302,1066.0859,680.4302,1062.0859" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="678.4302" x2="1006.7031" y1="1062.0859" y2="1062.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.4966" x="690.4302" y="1057.02">Decision (Permit/Deny)</text></g><path d="M79,1077.0859 L143.4429,1077.0859 L143.4429,1084.2188 L133.4429,1094.2188 L79,1094.2188 L79,1077.0859" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="195.6016" style="stroke:#000000;stroke-width:1.5;" width="705.0142" x="79" y="1077.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="94" y="1090.1528">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="180.6675" x="158.4429" y="1089.2964">[Token Exchange Successful]</text><g class="message" data-participant-1="AS" data-participant-2="Client"><polygon fill="#181818" points="400.7729,1111.3516,390.7729,1115.3516,400.7729,1119.3516,396.7729,1115.3516" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="394.7729" x2="672.4302" y1="1115.3516" y2="1115.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.7026" x="406.7729" y="1110.2856">200 OK</text></g><path d="M89,1128.3516 L89,1153.3516 L384,1153.3516 L384,1138.3516 L374,1128.3516 L89,1128.3516" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M374,1128.3516 L374,1138.3516 L384,1138.3516 L374,1128.3516" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56.9575" x="95" y="1145.4185">Contains</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="213.459" x="156.0898" y="1145.4185">ZETA Guard AS Access Token</text><path d="M129,1163.4844 L129,1188.4844 L383,1188.4844 L383,1173.4844 L373,1163.4844 L129,1163.4844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M373,1163.4844 L373,1173.4844 L383,1173.4844 L373,1163.4844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56.9575" x="135" y="1180.5513">Contains</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="105.7456" x="196.0898" y="1180.5513">Refresh Token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62.8291" x="305.9678" y="1180.5513">(optional)</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="79" x2="784.0142" y1="1194.6172" y2="1194.6172"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="152.7432" x="84" y="1204.8276">[Token Exchange Failed]</text><g class="message" data-participant-1="AS" data-participant-2="Client"><polygon fill="#181818" points="400.7729,1225.5547,390.7729,1229.5547,400.7729,1233.5547,396.7729,1229.5547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="394.7729" x2="672.4302" y1="1229.5547" y2="1229.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.3931" x="406.7729" y="1224.4888">400 Bad Request or 401 Unauthorized</text></g><path d="M223,1242.5547 L223,1267.5547 L384,1267.5547 L384,1252.5547 L374,1242.5547 L223,1242.5547" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M374,1242.5547 L374,1252.5547 L384,1252.5547 L374,1242.5547" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.5181" x="229" y="1259.6216">Contains error details</text><!--SRC=[ZLLhRzem5FsUNt759uXA7titQYjHqbPTLH41swHf4ZB93RW4EtCSEZRjl-_QIHYFqD8l9SxnkUTU7v-aJ6aUyfG93OtlDyCET1EEGZU0PULF9zt1tELCHT0P_13Dm0-Wa-kfLFmtqrmA6A1Qe6fPXix0YPXcOvOXD0oqe8G-JdYcrTA2gWV74L8ZIDfTuZouGu6AQSmySDrXy0WTJG-wgFI0ImWOLwxhbBpjAohfGT0R3E7a-1cJf3qJybcSo1G5ZzgX536VvChkByefFfbgaB7Ts4UjE2xGA8VkEXYQU3mvFW9LYBLh8nHHAhdGBOVWRIfUoNvpUWgzXw90Wh7bhzuHhMPSPFLKJcqh1ArHwoy5c_DmQwY5t3x-p6bGqEpVTk7Z-_EpLWt1lGYJFA9kvwYPEIXW8eBjCG_eFywD4tOPXbEinqAgf9cZ9W1vOyA5sMAUPdHgiP9pKyVExMhb00- -ieIJ4DmMuLGGEsPJkVT0l73BU98hT5YorVyW3qFCiZXF7A2_dVCvWwv2AXJProyVbEkM4xxtNTUEQBKom52XfjKcZu6bQS93DawmjPzrmz4Lhw0sHOXhZePcJEtvWGnQ3YPqVJQwCssNqhSwUqVEksPHTVu7T8TAKQM87C2Jp24VrbjGondMNPcXMVzljvu9WtBnvbSuPMA2q0RZmayVpj_MkN2YA5b6UfdYPQw4nr777cKEcsUUPCJcMK3R03oheeqbSGrPbe-VC2Gw0xoySDt1OxTz3HcV2AJ8igOevOM50M2yB8VYkbUlCRuaiz1cPJ9RPxHlPg4jD-AH4RZchRhohcjCuBeUN1G_8L2Itdt-DeHcsTOpfvcNx_Z2N1yoKciVNoXYG_S7dcRQiWwd-NoSAaeV0ofuyZ5PsT0G2_nrTYvgbPImiZ3vTRxdhfOOl_HOITO89DLOmesWTC261pSBbkH6_SOnhLnKm3T3jKYnDAT6DWxQJlve9Su_AjhYQogtog_4-XZop2P-W6hEzOcFOjboRCHiANejPEn7u91ysVYgRhHFtxP32FeOAyocrHveojGqoP8oFRQ47vmV9cFVKLX-4Qpyo1-KcBkPyWy0]--></g></svg>