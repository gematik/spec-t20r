<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="5225px" preserveAspectRatio="none" style="width:1774px;height:5225px;background:#FFFFFF;" version="1.1" viewBox="0 0 1774 5225" width="1774px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="5213.7344" style="stroke:#181818;stroke-width:0.5;" width="450.1865" x="44.3965" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="230.0708" y="15.2822">Mobile Device</text><rect fill="#C9FFC9" height="5213.7344" style="stroke:#181818;stroke-width:0.5;" width="443.0601" x="506.583" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="698.1423" y="15.2822">Anbieter A</text><rect fill="#F4A460" height="5197.0938" style="stroke:#181818;stroke-width:0.5;" width="324.7363" x="506.583" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="635.8066" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="5197.0938" style="stroke:#181818;stroke-width:0.5;" width="68.5283" x="881.1147" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="897.1978" y="31.9229">TI 2.0</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="897.1978" y="43.5635">Dienst</text><rect fill="#C9FFC9" height="5213.7344" style="stroke:#181818;stroke-width:0.5;" width="468.8657" x="961.6431" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1166.1638" y="15.2822">Anbieter B</text><rect fill="#F4A460" height="5197.0938" style="stroke:#181818;stroke-width:0.5;" width="350.542" x="961.6431" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1103.7695" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="5197.0938" style="stroke:#181818;stroke-width:0.5;" width="68.5283" x="1361.9805" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1378.0635" y="31.9229">TI 2.0</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1378.0635" y="43.5635">Dienst</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="24" x2="24" y1="121.5625" y2="5142.0938"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="83.1821" x2="83.1821" y1="121.5625" y2="5142.0938"/><rect fill="#F0F0F0" height="235.7656" style="stroke:#000000;stroke-width:1;" width="10" x="78.1821" y="1608.2031"/><rect fill="#F0F0F0" height="235.7656" style="stroke:#000000;stroke-width:1;" width="10" x="78.1821" y="4266.6719"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="162.7534" x2="162.7534" y1="121.5625" y2="5142.0938"/><rect fill="#F0F0F0" height="45.6406" style="stroke:#000000;stroke-width:1;" width="10" x="157.7534" y="794.1406"/><rect fill="#F0F0F0" height="45.6406" style="stroke:#000000;stroke-width:1;" width="10" x="157.7534" y="3563.375"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="289.9907" x2="289.9907" y1="121.5625" y2="5142.0938"/><rect fill="#F0F0F0" height="4937.25" style="stroke:#000000;stroke-width:1;" width="10" x="284.9907" y="186.8438"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="435.0405" x2="435.0405" y1="121.5625" y2="5142.0938"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="430.0405" y="224.125"/><rect fill="#F0F0F0" height="31.6406" style="stroke:#000000;stroke-width:1;" width="10" x="430.0405" y="338.3281"/><rect fill="#F0F0F0" height="31.6406" style="stroke:#000000;stroke-width:1;" width="10" x="430.0405" y="2542.5469"/><rect fill="#F0F0F0" height="31.6406" style="stroke:#000000;stroke-width:1;" width="10" x="430.0405" y="2662.75"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="532.4756" x2="532.4756" y1="121.5625" y2="5142.0938"/><rect fill="#F0F0F0" height="355.25" style="stroke:#000000;stroke-width:1;" width="10" x="527.4756" y="395.6094"/><rect fill="#F0F0F0" height="325.5313" style="stroke:#000000;stroke-width:1;" width="10" x="527.4756" y="839.7813"/><rect fill="#F0F0F0" height="212.7656" style="stroke:#000000;stroke-width:1;" width="10" x="527.4756" y="1369.7969"/><rect fill="#F0F0F0" height="3508.25" style="stroke:#000000;stroke-width:1;" width="10" x="527.4756" y="1633.8438"/><rect fill="#F0F0F0" height="324.9688" style="stroke:#000000;stroke-width:1;" width="10" x="532.4756" y="1908.25"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="532.4756" y="3188.4844"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="655.6846" x2="655.6846" y1="121.5625" y2="5142.0938"/><rect fill="#F0F0F0" height="138.8438" style="stroke:#000000;stroke-width:1;" width="10" x="650.6846" y="2326.7813"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="787.0332" x2="787.0332" y1="121.5625" y2="5142.0938"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="782.0332" y="569.7344"/><rect fill="#F0F0F0" height="87.5625" style="stroke:#000000;stroke-width:1;" width="10" x="782.0332" y="927.3438"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="782.0332" y="1463.3594"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="782.0332" y="2114.0156"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="915.3789" x2="915.3789" y1="121.5625" y2="5142.0938"/><rect fill="#F0F0F0" height="64.2813" style="stroke:#000000;stroke-width:1;" width="10" x="910.3789" y="2414.3438"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="987.5356" x2="987.5356" y1="121.5625" y2="5142.0938"/><rect fill="#F0F0F0" height="2422.0625" style="stroke:#000000;stroke-width:1;" width="10" x="982.5356" y="2720.0313"/><rect fill="#F0F0F0" height="227.7656" style="stroke:#000000;stroke-width:1;" width="10" x="987.5356" y="3609.0156"/><rect fill="#F0F0F0" height="212.7656" style="stroke:#000000;stroke-width:1;" width="10" x="987.5356" y="4028.2656"/><rect fill="#F0F0F0" height="849.7813" style="stroke:#000000;stroke-width:1;" width="10" x="987.5356" y="4292.3125"/><rect fill="#F0F0F0" height="324.9688" style="stroke:#000000;stroke-width:1;" width="10" x="992.5356" y="4566.7188"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1136.5503" x2="1136.5503" y1="121.5625" y2="5142.0938"/><rect fill="#F0F0F0" height="138.8438" style="stroke:#000000;stroke-width:1;" width="10" x="1131.5503" y="4985.25"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1267.8989" x2="1267.8989" y1="121.5625" y2="5142.0938"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1262.8989" y="2894.1563"/><rect fill="#F0F0F0" height="87.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1262.8989" y="3696.5781"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1262.8989" y="4121.8281"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1262.8989" y="4772.4844"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1396.2446" x2="1396.2446" y1="121.5625" y2="5142.0938"/><rect fill="#F0F0F0" height="64.2813" style="stroke:#000000;stroke-width:1;" width="10" x="1391.2446" y="5072.8125"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1481.1333" x2="1481.1333" y1="121.5625" y2="5142.0938"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="1476.1333" y="275.4063"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1476.1333" y="438.8906"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="1476.1333" y="2599.8281"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1476.1333" y="2763.3125"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1599.6353" x2="1599.6353" y1="121.5625" y2="5142.0938"/><rect fill="#F0F0F0" height="94.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1594.6353" y="1659.4844"/><rect fill="#F0F0F0" height="94.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1594.6353" y="4317.9531"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1660.4639" x2="1660.4639" y1="121.5625" y2="5142.0938"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="1655.4639" y="3013.3594"/><text fill="#000000" font-family="sans-serif" font-size="10" x="9.6035" y="119.2041">User</text><ellipse cx="24" cy="58.4219" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M24,66.4219 L24,93.4219 M11,74.4219 L37,74.4219 M24,93.4219 L11,108.4219 M24,93.4219 L37,108.4219 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="48.3965" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="55.3965" y="111.2041">User Agent</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="127.9678" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="152.5972" y="99.5635">Mail</text><text fill="#000000" font-family="sans-serif" font-size="10" x="134.9678" y="111.2041">User Agent</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="42.9502" x="268.5156" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="275.5156" y="111.2041">Client</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="111.085" x="379.498" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="397.9336" y="99.5635">Android TEE or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="386.498" y="111.2041">iOS Secure Enclave</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="510.583" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="522.5952" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="517.583" y="111.2041">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="620.1641" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="646.4951" y="99.5635">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="627.1641" y="111.2041">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="746.7471" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="777.1528" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="753.7471" y="111.2041">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="885.1147" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="892.1147" y="99.5635">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="898.9824" y="111.2041">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="965.6431" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="977.6553" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="972.6431" y="111.2041">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="1101.0298" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1127.3608" y="99.5635">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1108.0298" y="111.2041">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="1227.6128" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1258.0186" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1234.6128" y="111.2041">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="1365.9805" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1372.9805" y="99.5635">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1379.8481" y="111.2041">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.249" x="1446.5088" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1453.5088" y="99.5635">Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1462.6543" y="111.2041">Service</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="30.6797" x="1584.2954" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1591.2954" y="111.2041">IDP</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="70.9775" x="1624.9751" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1631.9751" y="99.5635">Federation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1643.3887" y="111.2041">Master</text><text fill="#000000" font-family="sans-serif" font-size="10" x="9.6035" y="5211.376">User</text><ellipse cx="24" cy="5150.5938" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M24,5158.5938 L24,5185.5938 M11,5166.5938 L37,5166.5938 M24,5185.5938 L11,5200.5938 M24,5185.5938 L37,5200.5938 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="48.3965" y="5142.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="55.3965" y="5158.376">User Agent</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="127.9678" y="5142.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="152.5972" y="5158.376">Mail</text><text fill="#000000" font-family="sans-serif" font-size="10" x="134.9678" y="5170.0166">User Agent</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="42.9502" x="268.5156" y="5142.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="275.5156" y="5158.376">Client</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="111.085" x="379.498" y="5142.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="397.9336" y="5158.376">Android TEE or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="386.498" y="5170.0166">iOS Secure Enclave</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="510.583" y="5142.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="522.5952" y="5158.376">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="517.583" y="5170.0166">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="620.1641" y="5142.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="646.4951" y="5158.376">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="627.1641" y="5170.0166">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="746.7471" y="5142.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="777.1528" y="5158.376">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="753.7471" y="5170.0166">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="885.1147" y="5142.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="892.1147" y="5158.376">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="898.9824" y="5170.0166">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="965.6431" y="5142.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="977.6553" y="5158.376">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="972.6431" y="5170.0166">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="1101.0298" y="5142.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1127.3608" y="5158.376">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1108.0298" y="5170.0166">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="1227.6128" y="5142.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1258.0186" y="5158.376">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1234.6128" y="5170.0166">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="1365.9805" y="5142.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1372.9805" y="5158.376">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1379.8481" y="5170.0166">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.249" x="1446.5088" y="5142.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1453.5088" y="5158.376">Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1462.6543" y="5170.0166">Service</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="30.6797" x="1584.2954" y="5142.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1591.2954" y="5158.376">IDP</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="70.9775" x="1624.9751" y="5142.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1631.9751" y="5158.376">Federation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1643.3887" y="5170.0166">Master</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1762.0415" x="5" y="148.3828"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1767.0415" y1="148.3828" y2="148.3828"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1767.0415" y1="151.3828" y2="151.3828"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="458.5898" x="656.7258" y="139.5625"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="662.7258" y="152.8447">Client Registration with Resource Server A (with Client Attestation and Email)</text><polygon fill="#000000" points="272.9907,182.8438,282.9907,186.8438,272.9907,190.8438,276.9907,186.8438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="278.9907" y1="186.8438" y2="186.8438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="31" y="182.4854">User Starts Registration</text><polygon fill="#000000" points="418.0405,220.125,428.0405,224.125,418.0405,228.125,422.0405,224.125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="424.0405" y1="224.125" y2="224.125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="208.126">Generate Key Pair</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="219.7666">for Attestation</text><path d="M445.0405,199.8438 L445.0405,220.8438 L671.0405,220.8438 L671.0405,209.8438 L661.0405,199.8438 L445.0405,199.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M661.0405,199.8438 L661.0405,209.8438 L671.0405,209.8438 L661.0405,199.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="451.0405" y="214.126">Using Android TEE or iOS Secure Enclave</text><polygon fill="#000000" points="305.9907,245.7656,295.9907,249.7656,305.9907,253.7656,301.9907,249.7656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="429.0405" y1="249.7656" y2="249.7656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="245.4072">Public Key</text><polygon fill="#000000" points="1464.1333,271.4063,1474.1333,275.4063,1464.1333,279.4063,1468.1333,275.4063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="1470.1333" y1="275.4063" y2="275.4063"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="271.0479">Request Attestation Challenge</text><polygon fill="#000000" points="305.9907,297.0469,295.9907,301.0469,305.9907,305.0469,301.9907,301.0469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="1475.1333" y1="301.0469" y2="301.0469"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="296.6885">Attestation Challenge</text><polygon fill="#000000" points="418.0405,334.3281,428.0405,338.3281,418.0405,342.3281,422.0405,338.3281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="424.0405" y1="338.3281" y2="338.3281"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="322.3291">Sign Challenge with</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="333.9697">Attestation Key</text><path d="M445.0405,314.0469 L445.0405,347.0469 L672.0405,347.0469 L672.0405,324.0469 L662.0405,314.0469 L445.0405,314.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M662.0405,314.0469 L662.0405,324.0469 L672.0405,324.0469 L662.0405,314.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="451.0405" y="328.3291">Using Android SafetyNet/Play Integrity or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="451.0405" y="339.9697">iOS DeviceCheck/App Attest API</text><polygon fill="#000000" points="305.9907,365.9688,295.9907,369.9688,305.9907,373.9688,301.9907,369.9688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="429.0405" y1="369.9688" y2="369.9688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="365.6104">Attestation Statement</text><polygon fill="#000000" points="515.4756,391.6094,525.4756,395.6094,515.4756,399.6094,519.4756,395.6094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="521.4756" y1="395.6094" y2="395.6094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="391.251">Client Registration Request</text><path d="M542.4756,382.9688 L542.4756,415.9688 L796.4756,415.9688 L796.4756,392.9688 L786.4756,382.9688 L542.4756,382.9688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M786.4756,382.9688 L786.4756,392.9688 L796.4756,392.9688 L786.4756,382.9688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="548.4756" y="397.251">Includes attestation statement, public key,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="548.4756" y="408.8916">User Email and potentially software statement</text><polygon fill="#000000" points="1464.1333,434.8906,1474.1333,438.8906,1464.1333,442.8906,1468.1333,438.8906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="1470.1333" y1="438.8906" y2="438.8906"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="434.5322">Verify Client Attestation</text><path d="M1491.1333,426.25 L1491.1333,459.25 L1665.1333,459.25 L1665.1333,436.25 L1655.1333,426.25 L1491.1333,426.25 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1655.1333,426.25 L1655.1333,436.25 L1665.1333,436.25 L1655.1333,426.25 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1497.1333" y="440.5322">AS A forwards attestation data</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1497.1333" y="452.1729">to Attestation Service</text><line style="stroke:#000000;stroke-width:1;" x1="1486.1333" x2="1528.1333" y1="493.8125" y2="493.8125"/><line style="stroke:#000000;stroke-width:1;" x1="1528.1333" x2="1528.1333" y1="493.8125" y2="506.8125"/><line style="stroke:#000000;stroke-width:1;" x1="1487.1333" x2="1528.1333" y1="506.8125" y2="506.8125"/><polygon fill="#000000" points="1497.1333,502.8125,1487.1333,506.8125,1497.1333,510.8125,1493.1333,506.8125" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1493.1333" y="477.8135">Validate Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1493.1333" y="489.4541">Statement</text><polygon fill="#000000" points="548.4756,528.4531,538.4756,532.4531,548.4756,536.4531,544.4756,532.4531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="542.4756" x2="1475.1333" y1="532.4531" y2="532.4531"/><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="528.0947">Attestation Verification Result</text><polygon fill="#000000" points="770.0332,565.7344,780.0332,569.7344,770.0332,573.7344,774.0332,569.7344" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="776.0332" y1="569.7344" y2="569.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="553.7354">Request Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="565.376">Registration Decision</text><path d="M797.0332,545.4531 L797.0332,578.4531 L1021.0332,578.4531 L1021.0332,555.4531 L1011.0332,545.4531 L797.0332,545.4531 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1011.0332,545.4531 L1011.0332,555.4531 L1021.0332,555.4531 L1011.0332,545.4531 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="803.0332" y="559.7354">AS A sends input data to Policy Engine A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="803.0332" y="571.376">for registration request</text><line style="stroke:#000000;stroke-width:1;" x1="792.0332" x2="834.0332" y1="613.0156" y2="613.0156"/><line style="stroke:#000000;stroke-width:1;" x1="834.0332" x2="834.0332" y1="613.0156" y2="626.0156"/><line style="stroke:#000000;stroke-width:1;" x1="793.0332" x2="834.0332" y1="626.0156" y2="626.0156"/><polygon fill="#000000" points="803.0332,622.0156,793.0332,626.0156,803.0332,630.0156,799.0332,626.0156" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="597.0166">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="608.6572">on Input Data</text><polygon fill="#000000" points="548.4756,659.2969,538.4756,663.2969,548.4756,667.2969,544.4756,663.2969" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="542.4756" x2="781.0332" y1="663.2969" y2="663.2969"/><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="647.2979">Client Registration</text><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="658.9385">Decision (Permit/Deny)</text><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="579.4756" y1="700.5781" y2="700.5781"/><line style="stroke:#000000;stroke-width:1;" x1="579.4756" x2="579.4756" y1="700.5781" y2="713.5781"/><line style="stroke:#000000;stroke-width:1;" x1="538.4756" x2="579.4756" y1="713.5781" y2="713.5781"/><polygon fill="#000000" points="548.4756,709.5781,538.4756,713.5781,548.4756,717.5781,544.4756,713.5781" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="684.5791">Generate Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="696.2197">Confirmation Token</text><polygon fill="#000000" points="305.9907,746.8594,295.9907,750.8594,305.9907,754.8594,301.9907,750.8594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="299.9907" x2="526.4756" y1="750.8594" y2="750.8594"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="734.8604">Client Registration Response</text><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="746.501">(with Email Confirmation Token)</text><path d="M542.4756,726.5781 L542.4756,759.5781 L798.4756,759.5781 L798.4756,736.5781 L788.4756,726.5781 L542.4756,726.5781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M788.4756,726.5781 L788.4756,736.5781 L798.4756,736.5781 L788.4756,726.5781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="548.4756" y="740.8604">AS A sends Email Confirmation Token to client,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="548.4756" y="752.501">which will be included in Email to User</text><polygon fill="#000000" points="178.7534,790.1406,168.7534,794.1406,178.7534,798.1406,174.7534,794.1406" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="172.7534" x2="283.9907" y1="794.1406" y2="794.1406"/><text fill="#000000" font-family="sans-serif" font-size="10" x="184.7534" y="778.1416">Send Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="184.7534" y="789.7822">Email</text><path d="M299.9907,769.8594 L299.9907,802.8594 L488.9907,802.8594 L488.9907,779.8594 L478.9907,769.8594 L299.9907,769.8594 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M478.9907,769.8594 L478.9907,779.8594 L488.9907,779.8594 L478.9907,769.8594 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="305.9907" y="784.1416">Client sends Email including</text><text fill="#000000" font-family="sans-serif" font-size="10" x="305.9907" y="795.7822">Email Confirmation Token to User</text><polygon fill="#000000" points="145.7534,810.1406,155.7534,814.1406,145.7534,818.1406,149.7534,814.1406" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="151.7534" y1="814.1406" y2="814.1406"/><polygon fill="#000000" points="515.4756,835.7813,525.4756,839.7813,515.4756,843.7813,519.4756,839.7813" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="167.7534" x2="521.4756" y1="839.7813" y2="839.7813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="174.7534" y="835.4229">User Clicks Confirmation Link in Email</text><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="579.4756" y1="877.0625" y2="877.0625"/><line style="stroke:#000000;stroke-width:1;" x1="579.4756" x2="579.4756" y1="877.0625" y2="890.0625"/><line style="stroke:#000000;stroke-width:1;" x1="538.4756" x2="579.4756" y1="890.0625" y2="890.0625"/><polygon fill="#000000" points="548.4756,886.0625,538.4756,890.0625,548.4756,894.0625,544.4756,890.0625" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="861.0635">Verify Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="872.7041">Confirmation Token</text><polygon fill="#000000" points="770.0332,923.3438,780.0332,927.3438,770.0332,931.3438,774.0332,927.3438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="776.0332" y1="927.3438" y2="927.3438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="911.3447">Request Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="922.9854">Confirmation Decision</text><line style="stroke:#000000;stroke-width:1;" x1="792.0332" x2="834.0332" y1="964.625" y2="964.625"/><line style="stroke:#000000;stroke-width:1;" x1="834.0332" x2="834.0332" y1="964.625" y2="977.625"/><line style="stroke:#000000;stroke-width:1;" x1="793.0332" x2="834.0332" y1="977.625" y2="977.625"/><polygon fill="#000000" points="803.0332,973.625,793.0332,977.625,803.0332,981.625,799.0332,977.625" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="948.626">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="960.2666">on Input Data</text><polygon fill="#000000" points="548.4756,1010.9063,538.4756,1014.9063,548.4756,1018.9063,544.4756,1014.9063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="542.4756" x2="781.0332" y1="1014.9063" y2="1014.9063"/><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="998.9072">Email Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="1010.5479">Decision (Permit/Deny)</text><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="579.4756" y1="1052.1875" y2="1052.1875"/><line style="stroke:#000000;stroke-width:1;" x1="579.4756" x2="579.4756" y1="1052.1875" y2="1065.1875"/><line style="stroke:#000000;stroke-width:1;" x1="538.4756" x2="579.4756" y1="1065.1875" y2="1065.1875"/><polygon fill="#000000" points="548.4756,1061.1875,538.4756,1065.1875,548.4756,1069.1875,544.4756,1065.1875" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="1036.1885">Generate Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="1047.8291">Confirmation JWT</text><path d="M648.4727,1027.9063 L648.4727,1130.9063 L828.4727,1130.9063 L828.4727,1037.9063 L818.4727,1027.9063 L648.4727,1027.9063 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M818.4727,1027.9063 L818.4727,1037.9063 L828.4727,1037.9063 L818.4727,1027.9063 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="654.4727" y="1042.1885">JWT Claims:</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.6514" y="1053.8291">- iss: AS_A_ID</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.6514" y="1065.4697">- sub: User_id</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.6514" y="1077.1104">- aud: AS_B_ID (or all AS)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.6514" y="1088.751">- exp: (short time)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.6514" y="1100.3916">- iat: (now)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.6514" y="1112.0322">- Email_verified: true</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.6514" y="1123.6729">- verification_timestamp: (now)</text><polygon fill="#000000" points="305.9907,1161.3125,295.9907,1165.3125,305.9907,1169.3125,301.9907,1165.3125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="299.9907" x2="526.4756" y1="1165.3125" y2="1165.3125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="1149.3135">Client Registration Response</text><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="1160.9541">(with Email Confirmation JWT)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1762.0415" x="5" y="1192.1328"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1767.0415" y1="1192.1328" y2="1192.1328"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1767.0415" y1="1195.1328" y2="1195.1328"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="480.8311" x="645.6052" y="1183.3125"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="651.6052" y="1196.5947">OAuth 2.0 Authorization Code Flow with PAR, PKCE and DPoP (Resource Server A)</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="1242.2344" y2="1242.2344"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="1242.2344" y2="1255.2344"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="1255.2344" y2="1255.2344"/><polygon fill="#000000" points="305.9907,1251.2344,295.9907,1255.2344,305.9907,1259.2344,301.9907,1255.2344" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1226.2354">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1237.876">Code Verifier</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="1292.5156" y2="1292.5156"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="1292.5156" y2="1305.5156"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="1305.5156" y2="1305.5156"/><polygon fill="#000000" points="305.9907,1301.5156,295.9907,1305.5156,305.9907,1309.5156,301.9907,1305.5156" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1276.5166">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1288.1572">Code Challenge</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="1331.1563" y2="1331.1563"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="1331.1563" y2="1344.1563"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="1344.1563" y2="1344.1563"/><polygon fill="#000000" points="305.9907,1340.1563,295.9907,1344.1563,305.9907,1348.1563,301.9907,1344.1563" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1326.7979">Generate DPoP Key Pair</text><polygon fill="#000000" points="515.4756,1365.7969,525.4756,1369.7969,515.4756,1373.7969,519.4756,1369.7969" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="521.4756" y1="1369.7969" y2="1369.7969"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1365.4385">PAR Request</text><path d="M542.4756,1357.1563 L542.4756,1390.1563 L925.4756,1390.1563 L925.4756,1367.1563 L915.4756,1357.1563 L542.4756,1357.1563 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M915.4756,1357.1563 L915.4756,1367.1563 L925.4756,1367.1563 L915.4756,1357.1563 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="548.4756" y="1371.4385">Authorization Code Request</text><text fill="#000000" font-family="sans-serif" font-size="10" x="548.4756" y="1383.0791">(inkl. DPoP Proof, code_challenge, code_challenge_method, redirect_uri)</text><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="579.4756" y1="1413.0781" y2="1413.0781"/><line style="stroke:#000000;stroke-width:1;" x1="579.4756" x2="579.4756" y1="1413.0781" y2="1426.0781"/><line style="stroke:#000000;stroke-width:1;" x1="538.4756" x2="579.4756" y1="1426.0781" y2="1426.0781"/><polygon fill="#000000" points="548.4756,1422.0781,538.4756,1426.0781,548.4756,1430.0781,544.4756,1426.0781" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="1408.7197">Validate DPoP Proof</text><polygon fill="#000000" points="770.0332,1459.3594,780.0332,1463.3594,770.0332,1467.3594,774.0332,1463.3594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="776.0332" y1="1463.3594" y2="1463.3594"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="1447.3604">Request Authorization</text><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="1459.001">Code Decision</text><path d="M797.0332,1439.0781 L797.0332,1472.0781 L1021.0332,1472.0781 L1021.0332,1449.0781 L1011.0332,1439.0781 L797.0332,1439.0781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1011.0332,1439.0781 L1011.0332,1449.0781 L1021.0332,1449.0781 L1011.0332,1439.0781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="803.0332" y="1453.3604">AS A sends input data to Policy Engine A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="803.0332" y="1465.001">for authorization code request</text><line style="stroke:#000000;stroke-width:1;" x1="792.0332" x2="834.0332" y1="1506.6406" y2="1506.6406"/><line style="stroke:#000000;stroke-width:1;" x1="834.0332" x2="834.0332" y1="1506.6406" y2="1519.6406"/><line style="stroke:#000000;stroke-width:1;" x1="793.0332" x2="834.0332" y1="1519.6406" y2="1519.6406"/><polygon fill="#000000" points="803.0332,1515.6406,793.0332,1519.6406,803.0332,1523.6406,799.0332,1519.6406" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="1490.6416">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="1502.2822">on Input Data</text><polygon fill="#000000" points="548.4756,1552.9219,538.4756,1556.9219,548.4756,1560.9219,544.4756,1556.9219" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="542.4756" x2="781.0332" y1="1556.9219" y2="1556.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="1540.9229">Authorization Code</text><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="1552.5635">Decision (Permit/Deny)</text><polygon fill="#000000" points="305.9907,1578.5625,295.9907,1582.5625,305.9907,1586.5625,301.9907,1582.5625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="526.4756" y1="1582.5625" y2="1582.5625"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="1578.2041">Request URI</text><polygon fill="#000000" points="99.1821,1604.2031,89.1821,1608.2031,99.1821,1612.2031,95.1821,1608.2031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="93.1821" x2="283.9907" y1="1608.2031" y2="1608.2031"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1603.8447">Navigate to Request URI</text><polygon fill="#000000" points="515.4756,1629.8438,525.4756,1633.8438,515.4756,1637.8438,519.4756,1633.8438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="521.4756" y1="1633.8438" y2="1633.8438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1629.4854">Authorization Request (with Request URI)</text><polygon fill="#000000" points="1582.6353,1655.4844,1592.6353,1659.4844,1582.6353,1663.4844,1586.6353,1659.4844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="1588.6353" y1="1659.4844" y2="1659.4844"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="1655.126">Authentication Request (OpenID Connect)</text><path d="M1609.6353,1646.8438 L1609.6353,1679.8438 L1761.6353,1679.8438 L1761.6353,1656.8438 L1751.6353,1646.8438 L1609.6353,1646.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1751.6353,1646.8438 L1751.6353,1656.8438 L1761.6353,1656.8438 L1751.6353,1646.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1615.6353" y="1661.126">AS A acts as Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1618.814" y="1672.7666">for the IDP</text><polygon fill="#000000" points="99.1821,1698.7656,89.1821,1702.7656,99.1821,1706.7656,95.1821,1702.7656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="1593.6353" y1="1702.7656" y2="1702.7656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1698.4072">Authentication Prompt</text><polygon fill="#000000" points="1582.6353,1724.4063,1592.6353,1728.4063,1582.6353,1732.4063,1586.6353,1728.4063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="1588.6353" y1="1728.4063" y2="1728.4063"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1724.0479">User Credentials</text><polygon fill="#000000" points="548.4756,1750.0469,538.4756,1754.0469,548.4756,1758.0469,544.4756,1754.0469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="542.4756" x2="1593.6353" y1="1754.0469" y2="1754.0469"/><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="1749.6885">Authentication Response (ID Token)</text><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="579.4756" y1="1779.6875" y2="1779.6875"/><line style="stroke:#000000;stroke-width:1;" x1="579.4756" x2="579.4756" y1="1779.6875" y2="1792.6875"/><line style="stroke:#000000;stroke-width:1;" x1="538.4756" x2="579.4756" y1="1792.6875" y2="1792.6875"/><polygon fill="#000000" points="548.4756,1788.6875,538.4756,1792.6875,548.4756,1796.6875,544.4756,1792.6875" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="1775.3291">Validate ID Token</text><polygon fill="#000000" points="99.1821,1814.3281,89.1821,1818.3281,99.1821,1822.3281,95.1821,1818.3281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="526.4756" y1="1818.3281" y2="1818.3281"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1813.9697">Authorization Code</text><polygon fill="#000000" points="272.9907,1839.9688,282.9907,1843.9688,272.9907,1847.9688,276.9907,1843.9688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="278.9907" y1="1843.9688" y2="1843.9688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1839.6104">Redirect with Authorization Code</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="1869.6094" y2="1869.6094"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="1869.6094" y2="1882.6094"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="1882.6094" y2="1882.6094"/><polygon fill="#000000" points="305.9907,1878.6094,295.9907,1882.6094,305.9907,1886.6094,301.9907,1882.6094" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1865.251">Generate DPoP Key Pair</text><polygon fill="#000000" points="520.4756,1904.25,530.4756,1908.25,520.4756,1912.25,524.4756,1908.25" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="526.4756" y1="1908.25" y2="1908.25"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1903.8916">Token Request (Authorization Code Grant)</text><path d="M547.4756,1895.6094 L547.4756,1939.6094 L767.4756,1939.6094 L767.4756,1905.6094 L757.4756,1895.6094 L547.4756,1895.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M757.4756,1895.6094 L757.4756,1905.6094 L767.4756,1905.6094 L757.4756,1895.6094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="553.4756" y="1909.8916">Enth&#228;lt Authorization Code, DPoP Proof,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="553.4756" y="1921.5322">Client Assertion (JWT, RFC7523),</text><text fill="#000000" font-family="sans-serif" font-size="10" x="553.4756" y="1933.1729">redirect_uri, code_verifier</text><line style="stroke:#000000;stroke-width:1;" x1="542.4756" x2="584.4756" y1="1974.8125" y2="1974.8125"/><line style="stroke:#000000;stroke-width:1;" x1="584.4756" x2="584.4756" y1="1974.8125" y2="1987.8125"/><line style="stroke:#000000;stroke-width:1;" x1="543.4756" x2="584.4756" y1="1987.8125" y2="1987.8125"/><polygon fill="#000000" points="553.4756,1983.8125,543.4756,1987.8125,553.4756,1991.8125,549.4756,1987.8125" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="1958.8135">Validate Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="1970.4541">Assertion (JWT)</text><line style="stroke:#000000;stroke-width:1;" x1="542.4756" x2="584.4756" y1="2013.4531" y2="2013.4531"/><line style="stroke:#000000;stroke-width:1;" x1="584.4756" x2="584.4756" y1="2013.4531" y2="2026.4531"/><line style="stroke:#000000;stroke-width:1;" x1="543.4756" x2="584.4756" y1="2026.4531" y2="2026.4531"/><polygon fill="#000000" points="553.4756,2022.4531,543.4756,2026.4531,553.4756,2030.4531,549.4756,2026.4531" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="2009.0947">Validate DPoP Proof</text><line style="stroke:#000000;stroke-width:1;" x1="542.4756" x2="584.4756" y1="2063.7344" y2="2063.7344"/><line style="stroke:#000000;stroke-width:1;" x1="584.4756" x2="584.4756" y1="2063.7344" y2="2076.7344"/><line style="stroke:#000000;stroke-width:1;" x1="543.4756" x2="584.4756" y1="2076.7344" y2="2076.7344"/><polygon fill="#000000" points="553.4756,2072.7344,543.4756,2076.7344,553.4756,2080.7344,549.4756,2076.7344" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="2047.7354">Validate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="2059.376">Code Verifier</text><polygon fill="#000000" points="770.0332,2110.0156,780.0332,2114.0156,770.0332,2118.0156,774.0332,2114.0156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="542.4756" x2="776.0332" y1="2114.0156" y2="2114.0156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="2098.0166">Request Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="2109.6572">Issuance Decision</text><path d="M797.0332,2089.7344 L797.0332,2122.7344 L1021.0332,2122.7344 L1021.0332,2099.7344 L1011.0332,2089.7344 L797.0332,2089.7344 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1011.0332,2089.7344 L1011.0332,2099.7344 L1021.0332,2099.7344 L1011.0332,2089.7344 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="803.0332" y="2104.0166">AS A sends input data to Policy Engine A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="803.0332" y="2115.6572">for token request</text><line style="stroke:#000000;stroke-width:1;" x1="792.0332" x2="834.0332" y1="2157.2969" y2="2157.2969"/><line style="stroke:#000000;stroke-width:1;" x1="834.0332" x2="834.0332" y1="2157.2969" y2="2170.2969"/><line style="stroke:#000000;stroke-width:1;" x1="793.0332" x2="834.0332" y1="2170.2969" y2="2170.2969"/><polygon fill="#000000" points="803.0332,2166.2969,793.0332,2170.2969,803.0332,2174.2969,799.0332,2170.2969" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="2141.2979">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="2152.9385">on Input Data</text><polygon fill="#000000" points="553.4756,2203.5781,543.4756,2207.5781,553.4756,2211.5781,549.4756,2207.5781" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="547.4756" x2="781.0332" y1="2207.5781" y2="2207.5781"/><text fill="#000000" font-family="sans-serif" font-size="10" x="559.4756" y="2191.5791">Token Issuance</text><text fill="#000000" font-family="sans-serif" font-size="10" x="559.4756" y="2203.2197">Decision (Permit/Deny)</text><polygon fill="#000000" points="305.9907,2229.2188,295.9907,2233.2188,305.9907,2237.2188,301.9907,2233.2188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="531.4756" y1="2233.2188" y2="2233.2188"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="2228.8604">Access Token (JWT), Refresh Token</text><path d="M145.2017,2220.5781 L145.2017,2253.5781 L284.2017,2253.5781 L284.2017,2230.5781 L274.2017,2220.5781 L145.2017,2220.5781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M274.2017,2220.5781 L274.2017,2230.5781 L284.2017,2230.5781 L274.2017,2220.5781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="151.2017" y="2234.8604">Access Token bound to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="151.2017" y="2246.501">client's DPoP public key</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="2276.5" y2="2276.5"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="2276.5" y2="2289.5"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="2289.5" y2="2289.5"/><polygon fill="#000000" points="305.9907,2285.5,295.9907,2289.5,305.9907,2293.5,301.9907,2289.5" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2272.1416">Generate DPoP Key Pair</text><polygon fill="#000000" points="638.6846,2322.7813,648.6846,2326.7813,638.6846,2330.7813,642.6846,2326.7813" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="644.6846" y1="2326.7813" y2="2326.7813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2310.7822">Access Protected Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2322.4229">(with Access Token and DPoP Proof)</text><line style="stroke:#000000;stroke-width:1;" x1="660.6846" x2="702.6846" y1="2364.0625" y2="2364.0625"/><line style="stroke:#000000;stroke-width:1;" x1="702.6846" x2="702.6846" y1="2364.0625" y2="2377.0625"/><line style="stroke:#000000;stroke-width:1;" x1="661.6846" x2="702.6846" y1="2377.0625" y2="2377.0625"/><polygon fill="#000000" points="671.6846,2373.0625,661.6846,2377.0625,671.6846,2381.0625,667.6846,2377.0625" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="667.6846" y="2348.0635">Validate Access Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="667.6846" y="2359.7041">and DPoP Proof</text><polygon fill="#000000" points="898.3789,2410.3438,908.3789,2414.3438,898.3789,2418.3438,902.3789,2414.3438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="660.6846" x2="904.3789" y1="2414.3438" y2="2414.3438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="667.6846" y="2398.3447">Forward Request to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="667.6846" y="2409.9854">Resource Server A</text><polygon fill="#000000" points="671.6846,2435.9844,661.6846,2439.9844,671.6846,2443.9844,667.6846,2439.9844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="665.6846" x2="909.3789" y1="2439.9844" y2="2439.9844"/><text fill="#000000" font-family="sans-serif" font-size="10" x="677.6846" y="2435.626">Resource Data</text><polygon fill="#000000" points="305.9907,2461.625,295.9907,2465.625,305.9907,2469.625,301.9907,2465.625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="649.6846" y1="2465.625" y2="2465.625"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="2461.2666">Resource Data</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1762.0415" x="5" y="2492.4453"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1767.0415" y1="2492.4453" y2="2492.4453"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1767.0415" y1="2495.4453" y2="2495.4453"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="449.1904" x="661.4255" y="2483.625"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="667.4255" y="2496.9072">Client Registration with Resource Server B (with Client Attestation and JWT)</text><polygon fill="#000000" points="418.0405,2538.5469,428.0405,2542.5469,418.0405,2546.5469,422.0405,2542.5469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="424.0405" y1="2542.5469" y2="2542.5469"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2526.5479">Generate Key Pair</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2538.1885">for Attestation</text><path d="M445.0405,2518.2656 L445.0405,2551.2656 L571.0405,2551.2656 L571.0405,2528.2656 L561.0405,2518.2656 L445.0405,2518.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M561.0405,2518.2656 L561.0405,2528.2656 L571.0405,2528.2656 L561.0405,2518.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="451.0405" y="2532.5479">Using Android TEE or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="451.0405" y="2544.1885">iOS Secure Enclave</text><polygon fill="#000000" points="305.9907,2570.1875,295.9907,2574.1875,305.9907,2578.1875,301.9907,2574.1875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="429.0405" y1="2574.1875" y2="2574.1875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="2569.8291">Public Key</text><polygon fill="#000000" points="1464.1333,2595.8281,1474.1333,2599.8281,1464.1333,2603.8281,1468.1333,2599.8281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="1470.1333" y1="2599.8281" y2="2599.8281"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2595.4697">Request Attestation Challenge</text><polygon fill="#000000" points="305.9907,2621.4688,295.9907,2625.4688,305.9907,2629.4688,301.9907,2625.4688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="1475.1333" y1="2625.4688" y2="2625.4688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="2621.1104">Attestation Challenge</text><polygon fill="#000000" points="418.0405,2658.75,428.0405,2662.75,418.0405,2666.75,422.0405,2662.75" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="424.0405" y1="2662.75" y2="2662.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2646.751">Sign Challenge with</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2658.3916">Attestation Key</text><path d="M445.0405,2638.4688 L445.0405,2671.4688 L672.0405,2671.4688 L672.0405,2648.4688 L662.0405,2638.4688 L445.0405,2638.4688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M662.0405,2638.4688 L662.0405,2648.4688 L672.0405,2648.4688 L662.0405,2638.4688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="451.0405" y="2652.751">Using Android SafetyNet/Play Integrity or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="451.0405" y="2664.3916">iOS DeviceCheck/App Attest API</text><polygon fill="#000000" points="305.9907,2690.3906,295.9907,2694.3906,305.9907,2698.3906,301.9907,2694.3906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="429.0405" y1="2694.3906" y2="2694.3906"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="2690.0322">Attestation Statement</text><polygon fill="#000000" points="970.5356,2716.0313,980.5356,2720.0313,970.5356,2724.0313,974.5356,2720.0313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="976.5356" y1="2720.0313" y2="2720.0313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2715.6729">Client Registration Request (Resource Server B, with Email Confirmation JWT)</text><path d="M997.5356,2707.3906 L997.5356,2740.3906 L1251.5356,2740.3906 L1251.5356,2717.3906 L1241.5356,2707.3906 L997.5356,2707.3906 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1241.5356,2707.3906 L1241.5356,2717.3906 L1251.5356,2717.3906 L1241.5356,2707.3906 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1003.5356" y="2721.6729">Includes attestation statement, public key,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1003.5356" y="2733.3135">User Email and potentially software statement</text><polygon fill="#000000" points="1464.1333,2759.3125,1474.1333,2763.3125,1464.1333,2767.3125,1468.1333,2763.3125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1470.1333" y1="2763.3125" y2="2763.3125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="2758.9541">Verify Client Attestation</text><path d="M1491.1333,2750.6719 L1491.1333,2783.6719 L1665.1333,2783.6719 L1665.1333,2760.6719 L1655.1333,2750.6719 L1491.1333,2750.6719 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1655.1333,2750.6719 L1655.1333,2760.6719 L1665.1333,2760.6719 L1655.1333,2750.6719 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1497.1333" y="2764.9541">AS B forwards attestation data</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1497.1333" y="2776.5947">to Attestation Service</text><line style="stroke:#000000;stroke-width:1;" x1="1486.1333" x2="1528.1333" y1="2818.2344" y2="2818.2344"/><line style="stroke:#000000;stroke-width:1;" x1="1528.1333" x2="1528.1333" y1="2818.2344" y2="2831.2344"/><line style="stroke:#000000;stroke-width:1;" x1="1487.1333" x2="1528.1333" y1="2831.2344" y2="2831.2344"/><polygon fill="#000000" points="1497.1333,2827.2344,1487.1333,2831.2344,1497.1333,2835.2344,1493.1333,2831.2344" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1493.1333" y="2802.2354">Validate Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1493.1333" y="2813.876">Statement</text><polygon fill="#000000" points="1003.5356,2852.875,993.5356,2856.875,1003.5356,2860.875,999.5356,2856.875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="997.5356" x2="1475.1333" y1="2856.875" y2="2856.875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="2852.5166">Attestation Verification Result</text><polygon fill="#000000" points="1250.8989,2890.1563,1260.8989,2894.1563,1250.8989,2898.1563,1254.8989,2894.1563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1256.8989" y1="2894.1563" y2="2894.1563"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="2878.1572">Request Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="2889.7979">Registration Decision</text><path d="M1277.8989,2869.875 L1277.8989,2902.875 L1501.8989,2902.875 L1501.8989,2879.875 L1491.8989,2869.875 L1277.8989,2869.875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1491.8989,2869.875 L1491.8989,2879.875 L1501.8989,2879.875 L1491.8989,2869.875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1283.8989" y="2884.1572">AS B sends input data to Policy Engine B</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1283.8989" y="2895.7979">for registration request</text><line style="stroke:#000000;stroke-width:1;" x1="1272.8989" x2="1314.8989" y1="2937.4375" y2="2937.4375"/><line style="stroke:#000000;stroke-width:1;" x1="1314.8989" x2="1314.8989" y1="2937.4375" y2="2950.4375"/><line style="stroke:#000000;stroke-width:1;" x1="1273.8989" x2="1314.8989" y1="2950.4375" y2="2950.4375"/><polygon fill="#000000" points="1283.8989,2946.4375,1273.8989,2950.4375,1283.8989,2954.4375,1279.8989,2950.4375" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="2921.4385">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="2933.0791">on Input Data</text><polygon fill="#000000" points="1003.5356,2983.7188,993.5356,2987.7188,1003.5356,2991.7188,999.5356,2987.7188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="997.5356" x2="1261.8989" y1="2987.7188" y2="2987.7188"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="2971.7197">Client Registration</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="2983.3604">Decision (Permit/Deny)</text><polygon fill="#000000" points="1643.4639,3009.3594,1653.4639,3013.3594,1643.4639,3017.3594,1647.4639,3013.3594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1649.4639" y1="3013.3594" y2="3013.3594"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3009.001">Get Entity Statement from Federation Master</text><polygon fill="#000000" points="1003.5356,3035,993.5356,3039,1003.5356,3043,999.5356,3039" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="997.5356" x2="1654.4639" y1="3039" y2="3039"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="3034.6416">Entity Statement from Federation Master</text><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1034.5356" y1="3076.2813" y2="3076.2813"/><line style="stroke:#000000;stroke-width:1;" x1="1034.5356" x2="1034.5356" y1="3076.2813" y2="3089.2813"/><line style="stroke:#000000;stroke-width:1;" x1="993.5356" x2="1034.5356" y1="3089.2813" y2="3089.2813"/><polygon fill="#000000" points="1003.5356,3085.2813,993.5356,3089.2813,1003.5356,3093.2813,999.5356,3089.2813" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3060.2822">Extract "iss" (AS_A_ID)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3071.9229">and "aud" from JWT</text><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1034.5356" y1="3149.8438" y2="3149.8438"/><line style="stroke:#000000;stroke-width:1;" x1="1034.5356" x2="1034.5356" y1="3149.8438" y2="3162.8438"/><line style="stroke:#000000;stroke-width:1;" x1="993.5356" x2="1034.5356" y1="3162.8438" y2="3162.8438"/><polygon fill="#000000" points="1003.5356,3158.8438,993.5356,3162.8438,1003.5356,3166.8438,999.5356,3162.8438" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3110.5635">Get Entity Statement</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3122.2041">URL for AS A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3133.8447">from Federation Master</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3145.4854">Entity Statement</text><polygon fill="#000000" points="553.4756,3184.4844,543.4756,3188.4844,553.4756,3192.4844,549.4756,3188.4844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="547.4756" x2="981.5356" y1="3188.4844" y2="3188.4844"/><text fill="#000000" font-family="sans-serif" font-size="10" x="559.4756" y="3184.126">Get AS A's Entity Statement</text><polygon fill="#000000" points="970.5356,3210.125,980.5356,3214.125,970.5356,3218.125,974.5356,3214.125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="542.4756" x2="976.5356" y1="3214.125" y2="3214.125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="3209.7666">AS A's Entity Statement</text><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1034.5356" y1="3263.0469" y2="3263.0469"/><line style="stroke:#000000;stroke-width:1;" x1="1034.5356" x2="1034.5356" y1="3263.0469" y2="3276.0469"/><line style="stroke:#000000;stroke-width:1;" x1="993.5356" x2="1034.5356" y1="3276.0469" y2="3276.0469"/><polygon fill="#000000" points="1003.5356,3272.0469,993.5356,3276.0469,1003.5356,3280.0469,999.5356,3276.0469" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3235.4072">Verify JWT Signature</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3247.0479">(using AS A's Public Key</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3258.6885">from Entity Statement)</text><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1034.5356" y1="3324.9688" y2="3324.9688"/><line style="stroke:#000000;stroke-width:1;" x1="1034.5356" x2="1034.5356" y1="3324.9688" y2="3337.9688"/><line style="stroke:#000000;stroke-width:1;" x1="993.5356" x2="1034.5356" y1="3337.9688" y2="3337.9688"/><polygon fill="#000000" points="1003.5356,3333.9688,993.5356,3337.9688,1003.5356,3341.9688,999.5356,3337.9688" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3297.3291">Validate JWT Claims</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3308.9697">(iss, aud, exp,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3320.6104">iat, Email_verified)</text><path d="M8,3349.9688 L67.9561,3349.9688 L67.9561,3353.6094 L57.9561,3363.6094 L8,3363.6094 L8,3349.9688 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="467.8125" style="stroke:#000000;stroke-width:1.5;" width="1404.2446" x="8" y="3349.9688"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="23" y="3360.251">alt</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="82.9561" y="3361.251">[JWT Valid]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="8" x2="1412.2446" y1="3421.8906" y2="3421.8906"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="13" y="3433.1729">[JWT Invalid or Expired]</text><polygon fill="#000000" points="305.9907,3398.8906,295.9907,3402.8906,305.9907,3406.8906,301.9907,3402.8906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="299.9907" x2="981.5356" y1="3402.8906" y2="3402.8906"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="3386.8916">Client Registration Response</text><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="3398.5322">(without Email Confirmation JWT)</text><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1034.5356" y1="3469.8125" y2="3469.8125"/><line style="stroke:#000000;stroke-width:1;" x1="1034.5356" x2="1034.5356" y1="3469.8125" y2="3482.8125"/><line style="stroke:#000000;stroke-width:1;" x1="993.5356" x2="1034.5356" y1="3482.8125" y2="3482.8125"/><polygon fill="#000000" points="1003.5356,3478.8125,993.5356,3482.8125,1003.5356,3486.8125,999.5356,3482.8125" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3453.8135">Generate Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3465.4541">Confirmation Token</text><polygon fill="#000000" points="305.9907,3504.4531,295.9907,3508.4531,305.9907,3512.4531,301.9907,3508.4531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="299.9907" x2="981.5356" y1="3508.4531" y2="3508.4531"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="3504.0947">Client Registration Response (with Email Confirmation Token)</text><path d="M997.5356,3495.8125 L997.5356,3528.8125 L1253.5356,3528.8125 L1253.5356,3505.8125 L1243.5356,3495.8125 L997.5356,3495.8125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1243.5356,3495.8125 L1243.5356,3505.8125 L1253.5356,3505.8125 L1243.5356,3495.8125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1003.5356" y="3510.0947">AS B sends Email Confirmation Token to client,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1003.5356" y="3521.7354">which will be included in Email to User</text><polygon fill="#000000" points="178.7534,3559.375,168.7534,3563.375,178.7534,3567.375,174.7534,3563.375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="172.7534" x2="283.9907" y1="3563.375" y2="3563.375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="184.7534" y="3547.376">Send Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="184.7534" y="3559.0166">Email</text><path d="M299.9907,3539.0938 L299.9907,3572.0938 L488.9907,3572.0938 L488.9907,3549.0938 L478.9907,3539.0938 L299.9907,3539.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M478.9907,3539.0938 L478.9907,3549.0938 L488.9907,3549.0938 L478.9907,3539.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="305.9907" y="3553.376">Client sends Email including</text><text fill="#000000" font-family="sans-serif" font-size="10" x="305.9907" y="3565.0166">Email Confirmation Token to User</text><polygon fill="#000000" points="145.7534,3579.375,155.7534,3583.375,145.7534,3587.375,149.7534,3583.375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="151.7534" y1="3583.375" y2="3583.375"/><polygon fill="#000000" points="975.5356,3605.0156,985.5356,3609.0156,975.5356,3613.0156,979.5356,3609.0156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="167.7534" x2="981.5356" y1="3609.0156" y2="3609.0156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="174.7534" y="3604.6572">User Clicks Confirmation Link in Email</text><line style="stroke:#000000;stroke-width:1;" x1="997.5356" x2="1039.5356" y1="3646.2969" y2="3646.2969"/><line style="stroke:#000000;stroke-width:1;" x1="1039.5356" x2="1039.5356" y1="3646.2969" y2="3659.2969"/><line style="stroke:#000000;stroke-width:1;" x1="998.5356" x2="1039.5356" y1="3659.2969" y2="3659.2969"/><polygon fill="#000000" points="1008.5356,3655.2969,998.5356,3659.2969,1008.5356,3663.2969,1004.5356,3659.2969" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="3630.2979">Verify Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="3641.9385">Confirmation Token</text><polygon fill="#000000" points="1250.8989,3692.5781,1260.8989,3696.5781,1250.8989,3700.5781,1254.8989,3696.5781" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="997.5356" x2="1256.8989" y1="3696.5781" y2="3696.5781"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="3680.5791">Request Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="3692.2197">Confirmation Decision</text><line style="stroke:#000000;stroke-width:1;" x1="1272.8989" x2="1314.8989" y1="3733.8594" y2="3733.8594"/><line style="stroke:#000000;stroke-width:1;" x1="1314.8989" x2="1314.8989" y1="3733.8594" y2="3746.8594"/><line style="stroke:#000000;stroke-width:1;" x1="1273.8989" x2="1314.8989" y1="3746.8594" y2="3746.8594"/><polygon fill="#000000" points="1283.8989,3742.8594,1273.8989,3746.8594,1283.8989,3750.8594,1279.8989,3746.8594" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="3717.8604">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="3729.501">on Input Data</text><polygon fill="#000000" points="1008.5356,3780.1406,998.5356,3784.1406,1008.5356,3788.1406,1004.5356,3784.1406" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1002.5356" x2="1261.8989" y1="3784.1406" y2="3784.1406"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1014.5356" y="3768.1416">Email Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1014.5356" y="3779.7822">Decision (Permit/Deny)</text><polygon fill="#000000" points="305.9907,3805.7813,295.9907,3809.7813,305.9907,3813.7813,301.9907,3809.7813" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="299.9907" x2="986.5356" y1="3809.7813" y2="3809.7813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="3805.4229">Client Registration Response (with Email Confirmation JWT)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1762.0415" x="5" y="3850.6016"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1767.0415" y1="3850.6016" y2="3850.6016"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1767.0415" y1="3853.6016" y2="3853.6016"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="480.7139" x="645.6638" y="3841.7813"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="651.6638" y="3855.0635">OAuth 2.0 Authorization Code Flow with PAR, PKCE and DPoP (Resource Server B)</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="3900.7031" y2="3900.7031"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="3900.7031" y2="3913.7031"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="3913.7031" y2="3913.7031"/><polygon fill="#000000" points="305.9907,3909.7031,295.9907,3913.7031,305.9907,3917.7031,301.9907,3913.7031" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="3884.7041">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="3896.3447">Code Verifier</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="3950.9844" y2="3950.9844"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="3950.9844" y2="3963.9844"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="3963.9844" y2="3963.9844"/><polygon fill="#000000" points="305.9907,3959.9844,295.9907,3963.9844,305.9907,3967.9844,301.9907,3963.9844" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="3934.9854">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="3946.626">Code Challenge</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="3989.625" y2="3989.625"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="3989.625" y2="4002.625"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="4002.625" y2="4002.625"/><polygon fill="#000000" points="305.9907,3998.625,295.9907,4002.625,305.9907,4006.625,301.9907,4002.625" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="3985.2666">Generate DPoP Key Pair</text><polygon fill="#000000" points="975.5356,4024.2656,985.5356,4028.2656,975.5356,4032.2656,979.5356,4028.2656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="981.5356" y1="4028.2656" y2="4028.2656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="4023.9072">PAR Request</text><path d="M1002.5356,4015.625 L1002.5356,4048.625 L1385.5356,4048.625 L1385.5356,4025.625 L1375.5356,4015.625 L1002.5356,4015.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1375.5356,4015.625 L1375.5356,4025.625 L1385.5356,4025.625 L1375.5356,4015.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1008.5356" y="4029.9072">Authorization Code Request</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1008.5356" y="4041.5479">(inkl. DPoP Proof, code_challenge, code_challenge_method, redirect_uri)</text><line style="stroke:#000000;stroke-width:1;" x1="997.5356" x2="1039.5356" y1="4071.5469" y2="4071.5469"/><line style="stroke:#000000;stroke-width:1;" x1="1039.5356" x2="1039.5356" y1="4071.5469" y2="4084.5469"/><line style="stroke:#000000;stroke-width:1;" x1="998.5356" x2="1039.5356" y1="4084.5469" y2="4084.5469"/><polygon fill="#000000" points="1008.5356,4080.5469,998.5356,4084.5469,1008.5356,4088.5469,1004.5356,4084.5469" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="4067.1885">Validate DPoP Proof</text><polygon fill="#000000" points="1250.8989,4117.8281,1260.8989,4121.8281,1250.8989,4125.8281,1254.8989,4121.8281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="997.5356" x2="1256.8989" y1="4121.8281" y2="4121.8281"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="4105.8291">Request Authorization</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="4117.4697">Code Decision</text><path d="M1277.8989,4097.5469 L1277.8989,4130.5469 L1501.8989,4130.5469 L1501.8989,4107.5469 L1491.8989,4097.5469 L1277.8989,4097.5469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1491.8989,4097.5469 L1491.8989,4107.5469 L1501.8989,4107.5469 L1491.8989,4097.5469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1283.8989" y="4111.8291">AS B sends input data to Policy Engine B</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1283.8989" y="4123.4697">for authorization code request</text><line style="stroke:#000000;stroke-width:1;" x1="1272.8989" x2="1314.8989" y1="4165.1094" y2="4165.1094"/><line style="stroke:#000000;stroke-width:1;" x1="1314.8989" x2="1314.8989" y1="4165.1094" y2="4178.1094"/><line style="stroke:#000000;stroke-width:1;" x1="1273.8989" x2="1314.8989" y1="4178.1094" y2="4178.1094"/><polygon fill="#000000" points="1283.8989,4174.1094,1273.8989,4178.1094,1283.8989,4182.1094,1279.8989,4178.1094" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="4149.1104">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="4160.751">on Input Data</text><polygon fill="#000000" points="1008.5356,4211.3906,998.5356,4215.3906,1008.5356,4219.3906,1004.5356,4215.3906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1002.5356" x2="1261.8989" y1="4215.3906" y2="4215.3906"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1014.5356" y="4199.3916">Authorization Code</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1014.5356" y="4211.0322">Decision (Permit/Deny)</text><polygon fill="#000000" points="305.9907,4237.0313,295.9907,4241.0313,305.9907,4245.0313,301.9907,4241.0313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="986.5356" y1="4241.0313" y2="4241.0313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="4236.6729">Request URI</text><polygon fill="#000000" points="99.1821,4262.6719,89.1821,4266.6719,99.1821,4270.6719,95.1821,4266.6719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="93.1821" x2="283.9907" y1="4266.6719" y2="4266.6719"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="4262.3135">Navigate to Request URI</text><polygon fill="#000000" points="975.5356,4288.3125,985.5356,4292.3125,975.5356,4296.3125,979.5356,4292.3125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="981.5356" y1="4292.3125" y2="4292.3125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="4287.9541">Authorization Request (with Request URI)</text><polygon fill="#000000" points="1582.6353,4313.9531,1592.6353,4317.9531,1582.6353,4321.9531,1586.6353,4317.9531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="997.5356" x2="1588.6353" y1="4317.9531" y2="4317.9531"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="4313.5947">Authentication Request (OpenID Connect)</text><path d="M1609.6353,4305.3125 L1609.6353,4338.3125 L1761.6353,4338.3125 L1761.6353,4315.3125 L1751.6353,4305.3125 L1609.6353,4305.3125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1751.6353,4305.3125 L1751.6353,4315.3125 L1761.6353,4315.3125 L1751.6353,4305.3125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1615.6353" y="4319.5947">AS B acts as Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1618.814" y="4331.2354">for the IDP</text><polygon fill="#000000" points="99.1821,4357.2344,89.1821,4361.2344,99.1821,4365.2344,95.1821,4361.2344" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="1593.6353" y1="4361.2344" y2="4361.2344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="4356.876">Authentication Prompt</text><polygon fill="#000000" points="1582.6353,4382.875,1592.6353,4386.875,1582.6353,4390.875,1586.6353,4386.875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="1588.6353" y1="4386.875" y2="4386.875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="4382.5166">User Credentials</text><polygon fill="#000000" points="1008.5356,4408.5156,998.5356,4412.5156,1008.5356,4416.5156,1004.5356,4412.5156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1002.5356" x2="1593.6353" y1="4412.5156" y2="4412.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1014.5356" y="4408.1572">Authentication Response (ID Token)</text><line style="stroke:#000000;stroke-width:1;" x1="997.5356" x2="1039.5356" y1="4438.1563" y2="4438.1563"/><line style="stroke:#000000;stroke-width:1;" x1="1039.5356" x2="1039.5356" y1="4438.1563" y2="4451.1563"/><line style="stroke:#000000;stroke-width:1;" x1="998.5356" x2="1039.5356" y1="4451.1563" y2="4451.1563"/><polygon fill="#000000" points="1008.5356,4447.1563,998.5356,4451.1563,1008.5356,4455.1563,1004.5356,4451.1563" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="4433.7979">Validate ID Token</text><polygon fill="#000000" points="99.1821,4472.7969,89.1821,4476.7969,99.1821,4480.7969,95.1821,4476.7969" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="986.5356" y1="4476.7969" y2="4476.7969"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="4472.4385">Authorization Code</text><polygon fill="#000000" points="272.9907,4498.4375,282.9907,4502.4375,272.9907,4506.4375,276.9907,4502.4375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="278.9907" y1="4502.4375" y2="4502.4375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="4498.0791">Redirect with Authorization Code</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="4528.0781" y2="4528.0781"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="4528.0781" y2="4541.0781"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="4541.0781" y2="4541.0781"/><polygon fill="#000000" points="305.9907,4537.0781,295.9907,4541.0781,305.9907,4545.0781,301.9907,4541.0781" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="4523.7197">Generate DPoP Key Pair</text><polygon fill="#000000" points="980.5356,4562.7188,990.5356,4566.7188,980.5356,4570.7188,984.5356,4566.7188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="986.5356" y1="4566.7188" y2="4566.7188"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="4562.3604">Token Request (Authorization Code Grant)</text><path d="M1007.5356,4554.0781 L1007.5356,4598.0781 L1227.5356,4598.0781 L1227.5356,4564.0781 L1217.5356,4554.0781 L1007.5356,4554.0781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1217.5356,4554.0781 L1217.5356,4564.0781 L1227.5356,4564.0781 L1217.5356,4554.0781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1013.5356" y="4568.3604">Enth&#228;lt Authorization Code, DPoP Proof,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1013.5356" y="4580.001">Client Assertion (JWT, RFC7523),</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1013.5356" y="4591.6416">redirect_uri, code_verifier</text><line style="stroke:#000000;stroke-width:1;" x1="1002.5356" x2="1044.5356" y1="4633.2813" y2="4633.2813"/><line style="stroke:#000000;stroke-width:1;" x1="1044.5356" x2="1044.5356" y1="4633.2813" y2="4646.2813"/><line style="stroke:#000000;stroke-width:1;" x1="1003.5356" x2="1044.5356" y1="4646.2813" y2="4646.2813"/><polygon fill="#000000" points="1013.5356,4642.2813,1003.5356,4646.2813,1013.5356,4650.2813,1009.5356,4646.2813" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="4617.2822">Validate Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="4628.9229">Assertion (JWT)</text><line style="stroke:#000000;stroke-width:1;" x1="1002.5356" x2="1044.5356" y1="4671.9219" y2="4671.9219"/><line style="stroke:#000000;stroke-width:1;" x1="1044.5356" x2="1044.5356" y1="4671.9219" y2="4684.9219"/><line style="stroke:#000000;stroke-width:1;" x1="1003.5356" x2="1044.5356" y1="4684.9219" y2="4684.9219"/><polygon fill="#000000" points="1013.5356,4680.9219,1003.5356,4684.9219,1013.5356,4688.9219,1009.5356,4684.9219" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="4667.5635">Validate DPoP Proof</text><line style="stroke:#000000;stroke-width:1;" x1="1002.5356" x2="1044.5356" y1="4722.2031" y2="4722.2031"/><line style="stroke:#000000;stroke-width:1;" x1="1044.5356" x2="1044.5356" y1="4722.2031" y2="4735.2031"/><line style="stroke:#000000;stroke-width:1;" x1="1003.5356" x2="1044.5356" y1="4735.2031" y2="4735.2031"/><polygon fill="#000000" points="1013.5356,4731.2031,1003.5356,4735.2031,1013.5356,4739.2031,1009.5356,4735.2031" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="4706.2041">Validate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="4717.8447">Code Verifier</text><polygon fill="#000000" points="1250.8989,4768.4844,1260.8989,4772.4844,1250.8989,4776.4844,1254.8989,4772.4844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1002.5356" x2="1256.8989" y1="4772.4844" y2="4772.4844"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="4756.4854">Request Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="4768.126">Issuance Decision</text><path d="M1277.8989,4748.2031 L1277.8989,4781.2031 L1501.8989,4781.2031 L1501.8989,4758.2031 L1491.8989,4748.2031 L1277.8989,4748.2031 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1491.8989,4748.2031 L1491.8989,4758.2031 L1501.8989,4758.2031 L1491.8989,4748.2031 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1283.8989" y="4762.4854">AS B sends input data to Policy Engine B</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1283.8989" y="4774.126">for token request</text><line style="stroke:#000000;stroke-width:1;" x1="1272.8989" x2="1314.8989" y1="4815.7656" y2="4815.7656"/><line style="stroke:#000000;stroke-width:1;" x1="1314.8989" x2="1314.8989" y1="4815.7656" y2="4828.7656"/><line style="stroke:#000000;stroke-width:1;" x1="1273.8989" x2="1314.8989" y1="4828.7656" y2="4828.7656"/><polygon fill="#000000" points="1283.8989,4824.7656,1273.8989,4828.7656,1283.8989,4832.7656,1279.8989,4828.7656" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="4799.7666">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="4811.4072">on Input Data</text><polygon fill="#000000" points="1013.5356,4862.0469,1003.5356,4866.0469,1013.5356,4870.0469,1009.5356,4866.0469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1007.5356" x2="1261.8989" y1="4866.0469" y2="4866.0469"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1019.5356" y="4850.0479">Token Issuance</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1019.5356" y="4861.6885">Decision (Permit/Deny)</text><polygon fill="#000000" points="305.9907,4887.6875,295.9907,4891.6875,305.9907,4895.6875,301.9907,4891.6875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="991.5356" y1="4891.6875" y2="4891.6875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="4887.3291">Access Token (JWT), Refresh Token</text><path d="M145.2017,4879.0469 L145.2017,4912.0469 L284.2017,4912.0469 L284.2017,4889.0469 L274.2017,4879.0469 L145.2017,4879.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M274.2017,4879.0469 L274.2017,4889.0469 L284.2017,4889.0469 L274.2017,4879.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="151.2017" y="4893.3291">Access Token bound to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="151.2017" y="4904.9697">client's DPoP public key</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="4934.9688" y2="4934.9688"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="4934.9688" y2="4947.9688"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="4947.9688" y2="4947.9688"/><polygon fill="#000000" points="305.9907,4943.9688,295.9907,4947.9688,305.9907,4951.9688,301.9907,4947.9688" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="4930.6104">Generate DPoP Key Pair</text><polygon fill="#000000" points="1119.5503,4981.25,1129.5503,4985.25,1119.5503,4989.25,1123.5503,4985.25" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="1125.5503" y1="4985.25" y2="4985.25"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="4969.251">Access Protected Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="4980.8916">(with Access Token and DPoP Proof)</text><line style="stroke:#000000;stroke-width:1;" x1="1141.5503" x2="1183.5503" y1="5022.5313" y2="5022.5313"/><line style="stroke:#000000;stroke-width:1;" x1="1183.5503" x2="1183.5503" y1="5022.5313" y2="5035.5313"/><line style="stroke:#000000;stroke-width:1;" x1="1142.5503" x2="1183.5503" y1="5035.5313" y2="5035.5313"/><polygon fill="#000000" points="1152.5503,5031.5313,1142.5503,5035.5313,1152.5503,5039.5313,1148.5503,5035.5313" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1148.5503" y="5006.5322">Validate Access Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1148.5503" y="5018.1729">and DPoP Proof</text><polygon fill="#000000" points="1379.2446,5068.8125,1389.2446,5072.8125,1379.2446,5076.8125,1383.2446,5072.8125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1141.5503" x2="1385.2446" y1="5072.8125" y2="5072.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1148.5503" y="5056.8135">Forward Request to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1148.5503" y="5068.4541">Resource Server B</text><polygon fill="#000000" points="1152.5503,5094.4531,1142.5503,5098.4531,1152.5503,5102.4531,1148.5503,5098.4531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1146.5503" x2="1390.2446" y1="5098.4531" y2="5098.4531"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1158.5503" y="5094.0947">Resource Data</text><polygon fill="#000000" points="305.9907,5120.0938,295.9907,5124.0938,305.9907,5128.0938,301.9907,5124.0938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="1130.5503" y1="5124.0938" y2="5124.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="5119.7354">Resource Data</text><!--SRC=[xLhhRkEu5Vwlfs2zFse3dftf5aM105D0j9sikvF4i3DTj30GC19jiv4fhqWvyHHzcxv9Nwo75qca93kEuywqHJ4OZ2sUStXk_7ZqUSGZunkIaJMAwOBaYRnCkPonBnJzvaCWoiMXMRnEUIes9AAn4hiXQue6QPuncZco2ULBkGhZl-P28fvo6ZYBWlwIKnvHzBS0eGd998lOXd29qoocsI1DqWmz92Hwh2t3asMMvZms8ayh9Yc8X95CipPTix1FAylI9r_-4rlGJupJDblbMitSTvSVr1-Gk4bbgwP-tj0QNOu6e-3lGV2hJKQMQu8aJRyWcUMGAUqt-YmWem_fC-fSfmyieP3_BOje1trtjKg5_Dd6WT2cIf5M2fSKFX61EkeRqbyx3Sdhpw6MkIOicVD3aeE45GRDnwR8Z4PvHaSyIiYMQicGnrdAOdGt6g4qctDsExDIo8fr0ifZ10469igGFp0gbHiGujreyEFDxQVRgp_hlRJ0NqPt8RhAIHQ3m8pmU8UXX5mBr1qAPoQwoN0ovs4kLxDEgznaDBctaYEG_F7kRe8cMVgysoVkc9sa2Ojs4CuI-iB85n6LFj-DqG_VVvZp8UHDIF1xIBB76ILN6QNjda-jvrCgu5H5TCvdDDlIpDzWJ-hmMLA7ZquTVatgyBy_TVWLgNCrEw6KL4WYMSgDbZvfO0mMx5TVOJoSw7Nurr-uf800sX2QysiYe2nQ49wRRq7myMDnfgPqoOIquazChb3XEpAken1rzNEhuFY9e8nej8RZsqCVFmQ1FiBl_c0bBpGKe9a4tuItJq0YoRP4KYiPMDEWwXtZ2tH5kGg5ef_e3e2OmJ5U030vFbIsFDM00-QXZ2rNsW_6byZ70zI4Wy37a7TE99Fy0Tf5UH74TC-ELH1LnIuWRhXfX9-smOeawdgYbVDEaQkFdWlj1Xnl71DxypbZIqTRrnjEc6DPHVZgZCx8WihT3PNl9mdPeJ6NT9ankIjXrzmRWnMD7j-7cusD1OMJyO6Sksv14qcwLgroJFfduKLhUzjQE5cVXLvOOx2LnrGWukmjYhtxQ6FQu97k-lR2qjslpy46x7398BKx9DA5V2BGMQLkeAw3MclyYMPiiMivLwrjuVePpk1Kma60FMBVsPX8CkSozRFNqbarLqZ2OhkXWqALztvFwWoxE-XGM5IaMS2GjgSrRHxW6glEXid0d7l56jA82IyPeDFCWW0m5GZckbpgu174xc4x2WrcPAxnp7Q2kaqBRqPRakHw7wF-G0IDvp0vGbiewqEmRXGEz1XS5jPlr9tGRCta-o7bkvwR3HL7qGxAJ0bokfdcV93o1SlMnjExz17k6YjU78tsvXQRb0kuSWnScyviskhjo-4-1PNHI6y8JG-pQxG2t4WIz40XxVgynF31geEidXhTuiCXgmud37q0G-e6T7UQSwrUrHh4F3-j0TTJipdWa5NUuxfsfxYPrEw1cZkBtEi5C1uz2byV9kt7CYmt7EMP5vjRIdkaNooar_vjqktT_xPsRMRfxDtwnv_llBB1TyWkOMjnCUVe7M92g9wx3-_7G_r0v0-c2FSirWz87ci931Ae2-SM01M-z_GYVTvSeAvOfPb4agsfUSe8xDJbwPFvglswtsf4ec1ClT7eXQq3KlTA7T1hlR6gPpfY472ltlngshfLOwoQ9f7wa6RiYxt9qvYYooHzChFN99psqUIdmKXVASD9Ea7TnZocXwtgH1KUbuLH-gekODdWCXo0uyIhkUA0lFQgcCVgrou4yF8rsv82gmEPXNENV6ysWLa-NVHH10BtKU5Q_VlzceArk0-O7hECHl8-prZFFvN5xLPPRJs8dbys9UU-XeWNkmhbJ9THCwclEjrEfOjqV9wE6wrSbRjypxz0DsJBbae4WdQLIzLIDgZOWNQ_2_MkVHKfZVLQGHVUVOm5DNf5DHEt6ye1HE1yScWBnu1wOsfK45Q5UakQqcIdXbj5- -m0DrJHmBvMWhywKqxijSsXkTQRMfZQINFHG8-Q8L6KjieaU24Oe45TyD_Usaubb2kj_Lr8boMjEUhtX-zbLNrpZ0mWjMWvZbHrFHamp3rTrgm56guoUAljxKUJ4PUhV_uZaIs-zbqSWGDj9sq1RckPBi1r7qql1x__tG-_xO64Yo4MQBO5XBPcl1XTVPj7mu-_tWRSRJYbSpRdOo5oeaZCSsEKr3Kv3ooP-XQkdWf9OHHH8QmndM4e6rraLAnin-je4xge2pyeoXCYcdCpm_vQc39Kht87CExeLjOaNhapb5X24y5SNF501j0yryehNhT4pwqUM0iCCLWPhzxH72DpxbkfjAOg-vVc7R7i79M7nZnHRGmwmTIctkvQIjlIQkiUNBZhNXbL4Cw3gHs5ZYQUy67YINM1FmbzDVAeZKp-Ftlqly8UuOFiKNCWntrqy7N0GHVyzUWcV5Qw2NzRkWcVJZTX0w7u1Be9DxFmyXsA3z9DbJT7NgMuoi39T1Ckqb3-0g30KQh9IPspCkze0TChSdu-i3yNbAQgNn3AJvLxnrfpNAli5Vsg3Jr3T320TfWG7HW93LtGCrTTX-HnnvXMP8EhrnOId9lf9pt3gn48IjFgqvpNzIh3eJ6ir65sQCWrtqhAXjsZKHitt0Zi4LMiYS9Q8W6XO7J83LuQUzLbOgEfRz3pJHP7hQ9Yr4ks47r5jVGLfGBWmWZ0ZK-S06x1JAsqj0dz0vOr_0gE9CtbNboaYJ1kZVbMRQ5-bHazRs00ztQpjNsH8tsbW-WbcbJPstF-pqgLgdsEvKULhCT4rfry8q-gp7bSgNfGygNuQBvKgTKuKyzrTHFMI_mYT-eeU7X-a3_rjbLGg1wy6eTBfHAZZkTIQxaeV3XBgvfpn6CVLF2vAKVy7qivuhsK8_u6b6CBx7hl_CtUFPPoVCieSf1oVCj0SYhbQEUHOoX7V7RA4Pz6EPOprDaeH_mDAKTy6kNOqjyEvOZ_6oX7V1hbYByHvTYIyVsKur7muw-tKuvDd3g6SdmBHjKfnxV0qYcKOnEIlXxbY4-c7F5PAKSScFzGLna_ddB4XdB4nr6EsAKSSJ2rgRUxDYb7V3pbY7tAqVjg_xVPlm00]--></g></svg>