<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="5202px" preserveAspectRatio="none" style="width:1834px;height:5202px;background:#FFFFFF;" version="1.1" viewBox="0 0 1834 5202" width="1834px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="5190.4531" style="stroke:#181818;stroke-width:0.5;" width="450.1865" x="44.3965" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="230.0708" y="15.2822">Mobile Device</text><rect fill="#C9FFC9" height="5190.4531" style="stroke:#181818;stroke-width:0.5;" width="443.0601" x="506.583" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="698.1423" y="15.2822">Anbieter A</text><rect fill="#F4A460" height="5173.8125" style="stroke:#181818;stroke-width:0.5;" width="324.7363" x="506.583" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="635.8066" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="5173.8125" style="stroke:#181818;stroke-width:0.5;" width="68.5283" x="881.1147" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="897.1978" y="31.9229">TI 2.0</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="897.1978" y="43.5635">Dienst</text><rect fill="#C9FFC9" height="5190.4531" style="stroke:#181818;stroke-width:0.5;" width="468.8657" x="961.6431" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1166.1638" y="15.2822">Anbieter B</text><rect fill="#F4A460" height="5173.8125" style="stroke:#181818;stroke-width:0.5;" width="350.542" x="961.6431" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1103.7695" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="5173.8125" style="stroke:#181818;stroke-width:0.5;" width="68.5283" x="1361.9805" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1378.0635" y="31.9229">TI 2.0</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1378.0635" y="43.5635">Dienst</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="24" x2="24" y1="121.5625" y2="5118.8125"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="83.1821" x2="83.1821" y1="121.5625" y2="5118.8125"/><rect fill="#F0F0F0" height="235.7656" style="stroke:#000000;stroke-width:1;" width="10" x="78.1821" y="1596.5625"/><rect fill="#F0F0F0" height="235.7656" style="stroke:#000000;stroke-width:1;" width="10" x="78.1821" y="4243.3906"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="162.7534" x2="162.7534" y1="121.5625" y2="5118.8125"/><rect fill="#F0F0F0" height="45.6406" style="stroke:#000000;stroke-width:1;" width="10" x="157.7534" y="782.5"/><rect fill="#F0F0F0" height="45.6406" style="stroke:#000000;stroke-width:1;" width="10" x="157.7534" y="3540.0938"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="289.9907" x2="289.9907" y1="121.5625" y2="5118.8125"/><rect fill="#F0F0F0" height="4913.9688" style="stroke:#000000;stroke-width:1;" width="10" x="284.9907" y="186.8438"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="435.0405" x2="435.0405" y1="121.5625" y2="5118.8125"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="430.0405" y="224.125"/><rect fill="#F0F0F0" height="31.6406" style="stroke:#000000;stroke-width:1;" width="10" x="430.0405" y="338.3281"/><rect fill="#F0F0F0" height="31.6406" style="stroke:#000000;stroke-width:1;" width="10" x="430.0405" y="2530.9063"/><rect fill="#F0F0F0" height="31.6406" style="stroke:#000000;stroke-width:1;" width="10" x="430.0405" y="2651.1094"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="532.4756" x2="532.4756" y1="121.5625" y2="5118.8125"/><rect fill="#F0F0F0" height="343.6094" style="stroke:#000000;stroke-width:1;" width="10" x="527.4756" y="395.6094"/><rect fill="#F0F0F0" height="325.5313" style="stroke:#000000;stroke-width:1;" width="10" x="527.4756" y="828.1406"/><rect fill="#F0F0F0" height="212.7656" style="stroke:#000000;stroke-width:1;" width="10" x="527.4756" y="1358.1563"/><rect fill="#F0F0F0" height="3496.6094" style="stroke:#000000;stroke-width:1;" width="10" x="527.4756" y="1622.2031"/><rect fill="#F0F0F0" height="324.9688" style="stroke:#000000;stroke-width:1;" width="10" x="532.4756" y="1896.6094"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="532.4756" y="3165.2031"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="655.6846" x2="655.6846" y1="121.5625" y2="5118.8125"/><rect fill="#F0F0F0" height="138.8438" style="stroke:#000000;stroke-width:1;" width="10" x="650.6846" y="2315.1406"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="787.0332" x2="787.0332" y1="121.5625" y2="5118.8125"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="782.0332" y="558.0938"/><rect fill="#F0F0F0" height="87.5625" style="stroke:#000000;stroke-width:1;" width="10" x="782.0332" y="915.7031"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="782.0332" y="1451.7188"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="782.0332" y="2102.375"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="915.3789" x2="915.3789" y1="121.5625" y2="5118.8125"/><rect fill="#F0F0F0" height="64.2813" style="stroke:#000000;stroke-width:1;" width="10" x="910.3789" y="2402.7031"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="987.5356" x2="987.5356" y1="121.5625" y2="5118.8125"/><rect fill="#F0F0F0" height="2410.4219" style="stroke:#000000;stroke-width:1;" width="10" x="982.5356" y="2708.3906"/><rect fill="#F0F0F0" height="227.7656" style="stroke:#000000;stroke-width:1;" width="10" x="987.5356" y="3585.7344"/><rect fill="#F0F0F0" height="212.7656" style="stroke:#000000;stroke-width:1;" width="10" x="987.5356" y="4004.9844"/><rect fill="#F0F0F0" height="849.7813" style="stroke:#000000;stroke-width:1;" width="10" x="987.5356" y="4269.0313"/><rect fill="#F0F0F0" height="324.9688" style="stroke:#000000;stroke-width:1;" width="10" x="992.5356" y="4543.4375"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1136.5503" x2="1136.5503" y1="121.5625" y2="5118.8125"/><rect fill="#F0F0F0" height="138.8438" style="stroke:#000000;stroke-width:1;" width="10" x="1131.5503" y="4961.9688"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1267.8989" x2="1267.8989" y1="121.5625" y2="5118.8125"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1262.8989" y="2870.875"/><rect fill="#F0F0F0" height="87.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1262.8989" y="3673.2969"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1262.8989" y="4098.5469"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1262.8989" y="4749.2031"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1396.2446" x2="1396.2446" y1="121.5625" y2="5118.8125"/><rect fill="#F0F0F0" height="64.2813" style="stroke:#000000;stroke-width:1;" width="10" x="1391.2446" y="5049.5313"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1481.1333" x2="1481.1333" y1="121.5625" y2="5118.8125"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="1476.1333" y="275.4063"/><rect fill="#F0F0F0" height="81.9219" style="stroke:#000000;stroke-width:1;" width="10" x="1476.1333" y="438.8906"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="1476.1333" y="2588.1875"/><rect fill="#F0F0F0" height="81.9219" style="stroke:#000000;stroke-width:1;" width="10" x="1476.1333" y="2751.6719"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1599.6353" x2="1599.6353" y1="121.5625" y2="5118.8125"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="1594.6353" y="2990.0781"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1660.4639" x2="1660.4639" y1="121.5625" y2="5118.8125"/><rect fill="#F0F0F0" height="94.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1655.4639" y="1647.8438"/><rect fill="#F0F0F0" height="94.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1655.4639" y="4294.6719"/><text fill="#000000" font-family="sans-serif" font-size="10" x="9.6035" y="119.2041">User</text><ellipse cx="24" cy="58.4219" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M24,66.4219 L24,93.4219 M11,74.4219 L37,74.4219 M24,93.4219 L11,108.4219 M24,93.4219 L37,108.4219 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="48.3965" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="55.3965" y="111.2041">User Agent</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="127.9678" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="152.5972" y="99.5635">Mail</text><text fill="#000000" font-family="sans-serif" font-size="10" x="134.9678" y="111.2041">User Agent</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="42.9502" x="268.5156" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="275.5156" y="111.2041">Client</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="111.085" x="379.498" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="397.9336" y="99.5635">Android TEE or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="386.498" y="111.2041">iOS Secure Enclave</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="510.583" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="522.5952" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="517.583" y="111.2041">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="620.1641" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="646.4951" y="99.5635">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="627.1641" y="111.2041">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="746.7471" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="777.1528" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="753.7471" y="111.2041">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="885.1147" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="892.1147" y="99.5635">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="898.9824" y="111.2041">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="965.6431" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="977.6553" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="972.6431" y="111.2041">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="1101.0298" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1127.3608" y="99.5635">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1108.0298" y="111.2041">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="1227.6128" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1258.0186" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1234.6128" y="111.2041">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="1365.9805" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1372.9805" y="99.5635">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1379.8481" y="111.2041">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.249" x="1446.5088" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1453.5088" y="99.5635">Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1462.6543" y="111.2041">Service</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="70.9775" x="1564.1465" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1571.1465" y="99.5635">Federation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1582.5601" y="111.2041">Master</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="30.6797" x="1645.124" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1652.124" y="111.2041">IDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="9.6035" y="5188.0947">User</text><ellipse cx="24" cy="5127.3125" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M24,5135.3125 L24,5162.3125 M11,5143.3125 L37,5143.3125 M24,5162.3125 L11,5177.3125 M24,5162.3125 L37,5177.3125 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="48.3965" y="5118.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="55.3965" y="5135.0947">User Agent</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="127.9678" y="5118.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="152.5972" y="5135.0947">Mail</text><text fill="#000000" font-family="sans-serif" font-size="10" x="134.9678" y="5146.7354">User Agent</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="42.9502" x="268.5156" y="5118.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="275.5156" y="5135.0947">Client</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="111.085" x="379.498" y="5118.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="397.9336" y="5135.0947">Android TEE or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="386.498" y="5146.7354">iOS Secure Enclave</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="510.583" y="5118.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="522.5952" y="5135.0947">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="517.583" y="5146.7354">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="620.1641" y="5118.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="646.4951" y="5135.0947">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="627.1641" y="5146.7354">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="746.7471" y="5118.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="777.1528" y="5135.0947">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="753.7471" y="5146.7354">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="885.1147" y="5118.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="892.1147" y="5135.0947">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="898.9824" y="5146.7354">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="965.6431" y="5118.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="977.6553" y="5135.0947">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="972.6431" y="5146.7354">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="1101.0298" y="5118.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1127.3608" y="5135.0947">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1108.0298" y="5146.7354">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="1227.6128" y="5118.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1258.0186" y="5135.0947">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1234.6128" y="5146.7354">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="1365.9805" y="5118.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1372.9805" y="5135.0947">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1379.8481" y="5146.7354">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.249" x="1446.5088" y="5118.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1453.5088" y="5135.0947">Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1462.6543" y="5146.7354">Service</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="70.9775" x="1564.1465" y="5118.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1571.1465" y="5135.0947">Federation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1582.5601" y="5146.7354">Master</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="30.6797" x="1645.124" y="5118.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1652.124" y="5135.0947">IDP</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1822.8701" x="5" y="148.3828"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1827.8701" y1="148.3828" y2="148.3828"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1827.8701" y1="151.3828" y2="151.3828"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="458.5898" x="687.1401" y="139.5625"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="693.1401" y="152.8447">Client Registration with Resource Server A (with Client Attestation and Email)</text><polygon fill="#000000" points="272.9907,182.8438,282.9907,186.8438,272.9907,190.8438,276.9907,186.8438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="278.9907" y1="186.8438" y2="186.8438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="31" y="182.4854">User Starts Registration</text><polygon fill="#000000" points="418.0405,220.125,428.0405,224.125,418.0405,228.125,422.0405,224.125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="424.0405" y1="224.125" y2="224.125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="208.126">Generate Key Pair</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="219.7666">for Attestation</text><path d="M445.0405,199.8438 L445.0405,220.8438 L671.0405,220.8438 L671.0405,209.8438 L661.0405,199.8438 L445.0405,199.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M661.0405,199.8438 L661.0405,209.8438 L671.0405,209.8438 L661.0405,199.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="451.0405" y="214.126">Using Android TEE or iOS Secure Enclave</text><polygon fill="#000000" points="305.9907,245.7656,295.9907,249.7656,305.9907,253.7656,301.9907,249.7656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="429.0405" y1="249.7656" y2="249.7656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="245.4072">Public Key</text><polygon fill="#000000" points="1464.1333,271.4063,1474.1333,275.4063,1464.1333,279.4063,1468.1333,275.4063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="1470.1333" y1="275.4063" y2="275.4063"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="271.0479">Request Attestation Challenge</text><polygon fill="#000000" points="305.9907,297.0469,295.9907,301.0469,305.9907,305.0469,301.9907,301.0469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="1475.1333" y1="301.0469" y2="301.0469"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="296.6885">Attestation Challenge</text><polygon fill="#000000" points="418.0405,334.3281,428.0405,338.3281,418.0405,342.3281,422.0405,338.3281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="424.0405" y1="338.3281" y2="338.3281"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="322.3291">Sign Challenge with</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="333.9697">Attestation Key</text><path d="M445.0405,314.0469 L445.0405,347.0469 L672.0405,347.0469 L672.0405,324.0469 L662.0405,314.0469 L445.0405,314.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M662.0405,314.0469 L662.0405,324.0469 L672.0405,324.0469 L662.0405,314.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="451.0405" y="328.3291">Using Android SafetyNet/Play Integrity or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="451.0405" y="339.9697">iOS DeviceCheck/App Attest API</text><polygon fill="#000000" points="305.9907,365.9688,295.9907,369.9688,305.9907,373.9688,301.9907,369.9688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="429.0405" y1="369.9688" y2="369.9688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="365.6104">Attestation Statement</text><polygon fill="#000000" points="515.4756,391.6094,525.4756,395.6094,515.4756,399.6094,519.4756,395.6094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="521.4756" y1="395.6094" y2="395.6094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="391.251">Client Registration Request</text><path d="M542.4756,382.9688 L542.4756,415.9688 L796.4756,415.9688 L796.4756,392.9688 L786.4756,382.9688 L542.4756,382.9688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M786.4756,382.9688 L786.4756,392.9688 L796.4756,392.9688 L786.4756,382.9688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="548.4756" y="397.251">Includes attestation statement, public key,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="548.4756" y="408.8916">User Email and potentially software statement</text><polygon fill="#000000" points="1464.1333,434.8906,1474.1333,438.8906,1464.1333,442.8906,1468.1333,438.8906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="1470.1333" y1="438.8906" y2="438.8906"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="434.5322">Verify Client Attestation</text><path d="M1491.1333,426.25 L1491.1333,447.25 L1777.1333,447.25 L1777.1333,436.25 L1767.1333,426.25 L1491.1333,426.25 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1767.1333,426.25 L1767.1333,436.25 L1777.1333,436.25 L1767.1333,426.25 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1497.1333" y="440.5322">AS A forwards attestation data to Attestation Service</text><line style="stroke:#000000;stroke-width:1;" x1="1486.1333" x2="1528.1333" y1="482.1719" y2="482.1719"/><line style="stroke:#000000;stroke-width:1;" x1="1528.1333" x2="1528.1333" y1="482.1719" y2="495.1719"/><line style="stroke:#000000;stroke-width:1;" x1="1487.1333" x2="1528.1333" y1="495.1719" y2="495.1719"/><polygon fill="#000000" points="1497.1333,491.1719,1487.1333,495.1719,1497.1333,499.1719,1493.1333,495.1719" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1493.1333" y="466.1729">Validate Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1493.1333" y="477.8135">Statement</text><path d="M1604.6353,457.8906 L1604.6353,490.8906 L1809.6353,490.8906 L1809.6353,467.8906 L1799.6353,457.8906 L1604.6353,457.8906 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1799.6353,457.8906 L1799.6353,467.8906 L1809.6353,467.8906 L1799.6353,457.8906 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1610.6353" y="472.1729">e.g. Check signature, validity period,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1610.6353" y="483.8135">and device/app integrity status</text><polygon fill="#000000" points="548.4756,516.8125,538.4756,520.8125,548.4756,524.8125,544.4756,520.8125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="542.4756" x2="1475.1333" y1="520.8125" y2="520.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="516.4541">Attestation Verification Result</text><polygon fill="#000000" points="770.0332,554.0938,780.0332,558.0938,770.0332,562.0938,774.0332,558.0938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="776.0332" y1="558.0938" y2="558.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="542.0947">Request Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="553.7354">Registration Decision</text><path d="M797.0332,533.8125 L797.0332,566.8125 L1021.0332,566.8125 L1021.0332,543.8125 L1011.0332,533.8125 L797.0332,533.8125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1011.0332,533.8125 L1011.0332,543.8125 L1021.0332,543.8125 L1011.0332,533.8125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="803.0332" y="548.0947">AS A sends input data to Policy Engine A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="803.0332" y="559.7354">for registration request</text><line style="stroke:#000000;stroke-width:1;" x1="792.0332" x2="834.0332" y1="601.375" y2="601.375"/><line style="stroke:#000000;stroke-width:1;" x1="834.0332" x2="834.0332" y1="601.375" y2="614.375"/><line style="stroke:#000000;stroke-width:1;" x1="793.0332" x2="834.0332" y1="614.375" y2="614.375"/><polygon fill="#000000" points="803.0332,610.375,793.0332,614.375,803.0332,618.375,799.0332,614.375" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="585.376">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="597.0166">on Input Data</text><polygon fill="#000000" points="548.4756,647.6563,538.4756,651.6563,548.4756,655.6563,544.4756,651.6563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="542.4756" x2="781.0332" y1="651.6563" y2="651.6563"/><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="635.6572">Client Registration</text><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="647.2979">Decision (Permit/Deny)</text><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="579.4756" y1="688.9375" y2="688.9375"/><line style="stroke:#000000;stroke-width:1;" x1="579.4756" x2="579.4756" y1="688.9375" y2="701.9375"/><line style="stroke:#000000;stroke-width:1;" x1="538.4756" x2="579.4756" y1="701.9375" y2="701.9375"/><polygon fill="#000000" points="548.4756,697.9375,538.4756,701.9375,548.4756,705.9375,544.4756,701.9375" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="672.9385">Generate Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="684.5791">Confirmation Token</text><polygon fill="#000000" points="305.9907,735.2188,295.9907,739.2188,305.9907,743.2188,301.9907,739.2188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="299.9907" x2="526.4756" y1="739.2188" y2="739.2188"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="723.2197">Client Registration Response</text><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="734.8604">(with Email Confirmation Token)</text><path d="M542.4756,714.9375 L542.4756,747.9375 L798.4756,747.9375 L798.4756,724.9375 L788.4756,714.9375 L542.4756,714.9375 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M788.4756,714.9375 L788.4756,724.9375 L798.4756,724.9375 L788.4756,714.9375 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="548.4756" y="729.2197">AS A sends Email Confirmation Token to client,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="548.4756" y="740.8604">which will be included in Email to User</text><polygon fill="#000000" points="178.7534,778.5,168.7534,782.5,178.7534,786.5,174.7534,782.5" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="172.7534" x2="283.9907" y1="782.5" y2="782.5"/><text fill="#000000" font-family="sans-serif" font-size="10" x="184.7534" y="766.501">Send Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="184.7534" y="778.1416">Email</text><path d="M299.9907,758.2188 L299.9907,791.2188 L488.9907,791.2188 L488.9907,768.2188 L478.9907,758.2188 L299.9907,758.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M478.9907,758.2188 L478.9907,768.2188 L488.9907,768.2188 L478.9907,758.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="305.9907" y="772.501">Client sends Email including</text><text fill="#000000" font-family="sans-serif" font-size="10" x="305.9907" y="784.1416">Email Confirmation Token to User</text><polygon fill="#000000" points="145.7534,798.5,155.7534,802.5,145.7534,806.5,149.7534,802.5" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="151.7534" y1="802.5" y2="802.5"/><polygon fill="#000000" points="515.4756,824.1406,525.4756,828.1406,515.4756,832.1406,519.4756,828.1406" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="167.7534" x2="521.4756" y1="828.1406" y2="828.1406"/><text fill="#000000" font-family="sans-serif" font-size="10" x="174.7534" y="823.7822">User Clicks Confirmation Link in Email</text><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="579.4756" y1="865.4219" y2="865.4219"/><line style="stroke:#000000;stroke-width:1;" x1="579.4756" x2="579.4756" y1="865.4219" y2="878.4219"/><line style="stroke:#000000;stroke-width:1;" x1="538.4756" x2="579.4756" y1="878.4219" y2="878.4219"/><polygon fill="#000000" points="548.4756,874.4219,538.4756,878.4219,548.4756,882.4219,544.4756,878.4219" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="849.4229">Verify Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="861.0635">Confirmation Token</text><polygon fill="#000000" points="770.0332,911.7031,780.0332,915.7031,770.0332,919.7031,774.0332,915.7031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="776.0332" y1="915.7031" y2="915.7031"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="899.7041">Request Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="911.3447">Confirmation Decision</text><line style="stroke:#000000;stroke-width:1;" x1="792.0332" x2="834.0332" y1="952.9844" y2="952.9844"/><line style="stroke:#000000;stroke-width:1;" x1="834.0332" x2="834.0332" y1="952.9844" y2="965.9844"/><line style="stroke:#000000;stroke-width:1;" x1="793.0332" x2="834.0332" y1="965.9844" y2="965.9844"/><polygon fill="#000000" points="803.0332,961.9844,793.0332,965.9844,803.0332,969.9844,799.0332,965.9844" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="936.9854">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="948.626">on Input Data</text><polygon fill="#000000" points="548.4756,999.2656,538.4756,1003.2656,548.4756,1007.2656,544.4756,1003.2656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="542.4756" x2="781.0332" y1="1003.2656" y2="1003.2656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="987.2666">Email Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="998.9072">Decision (Permit/Deny)</text><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="579.4756" y1="1040.5469" y2="1040.5469"/><line style="stroke:#000000;stroke-width:1;" x1="579.4756" x2="579.4756" y1="1040.5469" y2="1053.5469"/><line style="stroke:#000000;stroke-width:1;" x1="538.4756" x2="579.4756" y1="1053.5469" y2="1053.5469"/><polygon fill="#000000" points="548.4756,1049.5469,538.4756,1053.5469,548.4756,1057.5469,544.4756,1053.5469" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="1024.5479">Generate Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="1036.1885">Confirmation JWT</text><path d="M648.4727,1016.2656 L648.4727,1119.2656 L828.4727,1119.2656 L828.4727,1026.2656 L818.4727,1016.2656 L648.4727,1016.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M818.4727,1016.2656 L818.4727,1026.2656 L828.4727,1026.2656 L818.4727,1016.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="654.4727" y="1030.5479">JWT Claims:</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.6514" y="1042.1885">- iss: AS_A_ID</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.6514" y="1053.8291">- sub: User_id</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.6514" y="1065.4697">- aud: AS_B_ID (or all AS)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.6514" y="1077.1104">- exp: (short time)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.6514" y="1088.751">- iat: (now)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.6514" y="1100.3916">- Email_verified: true</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.6514" y="1112.0322">- verification_timestamp: (now)</text><polygon fill="#000000" points="305.9907,1149.6719,295.9907,1153.6719,305.9907,1157.6719,301.9907,1153.6719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="299.9907" x2="526.4756" y1="1153.6719" y2="1153.6719"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="1137.6729">Client Registration Response</text><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="1149.3135">(with Email Confirmation JWT)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1822.8701" x="5" y="1180.4922"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1827.8701" y1="1180.4922" y2="1180.4922"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1827.8701" y1="1183.4922" y2="1183.4922"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="480.8311" x="676.0195" y="1171.6719"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="682.0195" y="1184.9541">OAuth 2.0 Authorization Code Flow with PAR, PKCE and DPoP (Resource Server A)</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="1230.5938" y2="1230.5938"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="1230.5938" y2="1243.5938"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="1243.5938" y2="1243.5938"/><polygon fill="#000000" points="305.9907,1239.5938,295.9907,1243.5938,305.9907,1247.5938,301.9907,1243.5938" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1214.5947">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1226.2354">Code Verifier</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="1280.875" y2="1280.875"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="1280.875" y2="1293.875"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="1293.875" y2="1293.875"/><polygon fill="#000000" points="305.9907,1289.875,295.9907,1293.875,305.9907,1297.875,301.9907,1293.875" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1264.876">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1276.5166">Code Challenge</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="1319.5156" y2="1319.5156"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="1319.5156" y2="1332.5156"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="1332.5156" y2="1332.5156"/><polygon fill="#000000" points="305.9907,1328.5156,295.9907,1332.5156,305.9907,1336.5156,301.9907,1332.5156" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1315.1572">Generate DPoP Key Pair</text><polygon fill="#000000" points="515.4756,1354.1563,525.4756,1358.1563,515.4756,1362.1563,519.4756,1358.1563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="521.4756" y1="1358.1563" y2="1358.1563"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1353.7979">PAR Request</text><path d="M542.4756,1345.5156 L542.4756,1378.5156 L925.4756,1378.5156 L925.4756,1355.5156 L915.4756,1345.5156 L542.4756,1345.5156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M915.4756,1345.5156 L915.4756,1355.5156 L925.4756,1355.5156 L915.4756,1345.5156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="548.4756" y="1359.7979">Authorization Code Request</text><text fill="#000000" font-family="sans-serif" font-size="10" x="548.4756" y="1371.4385">(inkl. DPoP Proof, code_challenge, code_challenge_method, redirect_uri)</text><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="579.4756" y1="1401.4375" y2="1401.4375"/><line style="stroke:#000000;stroke-width:1;" x1="579.4756" x2="579.4756" y1="1401.4375" y2="1414.4375"/><line style="stroke:#000000;stroke-width:1;" x1="538.4756" x2="579.4756" y1="1414.4375" y2="1414.4375"/><polygon fill="#000000" points="548.4756,1410.4375,538.4756,1414.4375,548.4756,1418.4375,544.4756,1414.4375" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="1397.0791">Validate DPoP Proof</text><polygon fill="#000000" points="770.0332,1447.7188,780.0332,1451.7188,770.0332,1455.7188,774.0332,1451.7188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="776.0332" y1="1451.7188" y2="1451.7188"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="1435.7197">Request Authorization</text><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="1447.3604">Code Decision</text><path d="M797.0332,1427.4375 L797.0332,1460.4375 L1021.0332,1460.4375 L1021.0332,1437.4375 L1011.0332,1427.4375 L797.0332,1427.4375 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1011.0332,1427.4375 L1011.0332,1437.4375 L1021.0332,1437.4375 L1011.0332,1427.4375 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="803.0332" y="1441.7197">AS A sends input data to Policy Engine A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="803.0332" y="1453.3604">for authorization code request</text><line style="stroke:#000000;stroke-width:1;" x1="792.0332" x2="834.0332" y1="1495" y2="1495"/><line style="stroke:#000000;stroke-width:1;" x1="834.0332" x2="834.0332" y1="1495" y2="1508"/><line style="stroke:#000000;stroke-width:1;" x1="793.0332" x2="834.0332" y1="1508" y2="1508"/><polygon fill="#000000" points="803.0332,1504,793.0332,1508,803.0332,1512,799.0332,1508" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="1479.001">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="1490.6416">on Input Data</text><polygon fill="#000000" points="548.4756,1541.2813,538.4756,1545.2813,548.4756,1549.2813,544.4756,1545.2813" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="542.4756" x2="781.0332" y1="1545.2813" y2="1545.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="1529.2822">Authorization Code</text><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="1540.9229">Decision (Permit/Deny)</text><polygon fill="#000000" points="305.9907,1566.9219,295.9907,1570.9219,305.9907,1574.9219,301.9907,1570.9219" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="526.4756" y1="1570.9219" y2="1570.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="1566.5635">Request URI</text><polygon fill="#000000" points="99.1821,1592.5625,89.1821,1596.5625,99.1821,1600.5625,95.1821,1596.5625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="93.1821" x2="283.9907" y1="1596.5625" y2="1596.5625"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1592.2041">Navigate to Request URI</text><polygon fill="#000000" points="515.4756,1618.2031,525.4756,1622.2031,515.4756,1626.2031,519.4756,1622.2031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="521.4756" y1="1622.2031" y2="1622.2031"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1617.8447">Authorization Request (with Request URI)</text><polygon fill="#000000" points="1643.4639,1643.8438,1653.4639,1647.8438,1643.4639,1651.8438,1647.4639,1647.8438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="1649.4639" y1="1647.8438" y2="1647.8438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="1643.4854">Authentication Request (OpenID Connect)</text><path d="M1670.4639,1635.2031 L1670.4639,1668.2031 L1822.4639,1668.2031 L1822.4639,1645.2031 L1812.4639,1635.2031 L1670.4639,1635.2031 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1812.4639,1635.2031 L1812.4639,1645.2031 L1822.4639,1645.2031 L1812.4639,1635.2031 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1676.4639" y="1649.4854">AS A acts as Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1679.6426" y="1661.126">for the IDP</text><polygon fill="#000000" points="99.1821,1687.125,89.1821,1691.125,99.1821,1695.125,95.1821,1691.125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="1654.4639" y1="1691.125" y2="1691.125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1686.7666">Authentication Prompt</text><polygon fill="#000000" points="1643.4639,1712.7656,1653.4639,1716.7656,1643.4639,1720.7656,1647.4639,1716.7656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="1649.4639" y1="1716.7656" y2="1716.7656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1712.4072">User Credentials</text><polygon fill="#000000" points="548.4756,1738.4063,538.4756,1742.4063,548.4756,1746.4063,544.4756,1742.4063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="542.4756" x2="1654.4639" y1="1742.4063" y2="1742.4063"/><text fill="#000000" font-family="sans-serif" font-size="10" x="554.4756" y="1738.0479">Authentication Response (ID Token)</text><line style="stroke:#000000;stroke-width:1;" x1="537.4756" x2="579.4756" y1="1768.0469" y2="1768.0469"/><line style="stroke:#000000;stroke-width:1;" x1="579.4756" x2="579.4756" y1="1768.0469" y2="1781.0469"/><line style="stroke:#000000;stroke-width:1;" x1="538.4756" x2="579.4756" y1="1781.0469" y2="1781.0469"/><polygon fill="#000000" points="548.4756,1777.0469,538.4756,1781.0469,548.4756,1785.0469,544.4756,1781.0469" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="544.4756" y="1763.6885">Validate ID Token</text><polygon fill="#000000" points="99.1821,1802.6875,89.1821,1806.6875,99.1821,1810.6875,95.1821,1806.6875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="526.4756" y1="1806.6875" y2="1806.6875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1802.3291">Authorization Code</text><polygon fill="#000000" points="272.9907,1828.3281,282.9907,1832.3281,272.9907,1836.3281,276.9907,1832.3281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="278.9907" y1="1832.3281" y2="1832.3281"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1827.9697">Redirect with Authorization Code</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="1857.9688" y2="1857.9688"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="1857.9688" y2="1870.9688"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="1870.9688" y2="1870.9688"/><polygon fill="#000000" points="305.9907,1866.9688,295.9907,1870.9688,305.9907,1874.9688,301.9907,1870.9688" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1853.6104">Generate DPoP Key Pair</text><polygon fill="#000000" points="520.4756,1892.6094,530.4756,1896.6094,520.4756,1900.6094,524.4756,1896.6094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="526.4756" y1="1896.6094" y2="1896.6094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="1892.251">Token Request (Authorization Code Grant)</text><path d="M547.4756,1883.9688 L547.4756,1927.9688 L767.4756,1927.9688 L767.4756,1893.9688 L757.4756,1883.9688 L547.4756,1883.9688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M757.4756,1883.9688 L757.4756,1893.9688 L767.4756,1893.9688 L757.4756,1883.9688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="553.4756" y="1898.251">Enth&#228;lt Authorization Code, DPoP Proof,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="553.4756" y="1909.8916">Client Assertion (JWT, RFC7523),</text><text fill="#000000" font-family="sans-serif" font-size="10" x="553.4756" y="1921.5322">redirect_uri, code_verifier</text><line style="stroke:#000000;stroke-width:1;" x1="542.4756" x2="584.4756" y1="1963.1719" y2="1963.1719"/><line style="stroke:#000000;stroke-width:1;" x1="584.4756" x2="584.4756" y1="1963.1719" y2="1976.1719"/><line style="stroke:#000000;stroke-width:1;" x1="543.4756" x2="584.4756" y1="1976.1719" y2="1976.1719"/><polygon fill="#000000" points="553.4756,1972.1719,543.4756,1976.1719,553.4756,1980.1719,549.4756,1976.1719" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="1947.1729">Validate Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="1958.8135">Assertion (JWT)</text><line style="stroke:#000000;stroke-width:1;" x1="542.4756" x2="584.4756" y1="2001.8125" y2="2001.8125"/><line style="stroke:#000000;stroke-width:1;" x1="584.4756" x2="584.4756" y1="2001.8125" y2="2014.8125"/><line style="stroke:#000000;stroke-width:1;" x1="543.4756" x2="584.4756" y1="2014.8125" y2="2014.8125"/><polygon fill="#000000" points="553.4756,2010.8125,543.4756,2014.8125,553.4756,2018.8125,549.4756,2014.8125" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="1997.4541">Validate DPoP Proof</text><line style="stroke:#000000;stroke-width:1;" x1="542.4756" x2="584.4756" y1="2052.0938" y2="2052.0938"/><line style="stroke:#000000;stroke-width:1;" x1="584.4756" x2="584.4756" y1="2052.0938" y2="2065.0938"/><line style="stroke:#000000;stroke-width:1;" x1="543.4756" x2="584.4756" y1="2065.0938" y2="2065.0938"/><polygon fill="#000000" points="553.4756,2061.0938,543.4756,2065.0938,553.4756,2069.0938,549.4756,2065.0938" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="2036.0947">Validate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="2047.7354">Code Verifier</text><polygon fill="#000000" points="770.0332,2098.375,780.0332,2102.375,770.0332,2106.375,774.0332,2102.375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="542.4756" x2="776.0332" y1="2102.375" y2="2102.375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="2086.376">Request Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="2098.0166">Issuance Decision</text><path d="M797.0332,2078.0938 L797.0332,2111.0938 L1021.0332,2111.0938 L1021.0332,2088.0938 L1011.0332,2078.0938 L797.0332,2078.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1011.0332,2078.0938 L1011.0332,2088.0938 L1021.0332,2088.0938 L1011.0332,2078.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="803.0332" y="2092.376">AS A sends input data to Policy Engine A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="803.0332" y="2104.0166">for token request</text><line style="stroke:#000000;stroke-width:1;" x1="792.0332" x2="834.0332" y1="2145.6563" y2="2145.6563"/><line style="stroke:#000000;stroke-width:1;" x1="834.0332" x2="834.0332" y1="2145.6563" y2="2158.6563"/><line style="stroke:#000000;stroke-width:1;" x1="793.0332" x2="834.0332" y1="2158.6563" y2="2158.6563"/><polygon fill="#000000" points="803.0332,2154.6563,793.0332,2158.6563,803.0332,2162.6563,799.0332,2158.6563" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="2129.6572">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="799.0332" y="2141.2979">on Input Data</text><polygon fill="#000000" points="553.4756,2191.9375,543.4756,2195.9375,553.4756,2199.9375,549.4756,2195.9375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="547.4756" x2="781.0332" y1="2195.9375" y2="2195.9375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="559.4756" y="2179.9385">Token Issuance</text><text fill="#000000" font-family="sans-serif" font-size="10" x="559.4756" y="2191.5791">Decision (Permit/Deny)</text><polygon fill="#000000" points="305.9907,2217.5781,295.9907,2221.5781,305.9907,2225.5781,301.9907,2221.5781" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="531.4756" y1="2221.5781" y2="2221.5781"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="2217.2197">Access Token (JWT), Refresh Token</text><path d="M145.2017,2208.9375 L145.2017,2241.9375 L284.2017,2241.9375 L284.2017,2218.9375 L274.2017,2208.9375 L145.2017,2208.9375 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M274.2017,2208.9375 L274.2017,2218.9375 L284.2017,2218.9375 L274.2017,2208.9375 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="151.2017" y="2223.2197">Access Token bound to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="151.2017" y="2234.8604">client's DPoP public key</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="2264.8594" y2="2264.8594"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="2264.8594" y2="2277.8594"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="2277.8594" y2="2277.8594"/><polygon fill="#000000" points="305.9907,2273.8594,295.9907,2277.8594,305.9907,2281.8594,301.9907,2277.8594" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2260.501">Generate DPoP Key Pair</text><polygon fill="#000000" points="638.6846,2311.1406,648.6846,2315.1406,638.6846,2319.1406,642.6846,2315.1406" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="644.6846" y1="2315.1406" y2="2315.1406"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2299.1416">Access Protected Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2310.7822">(with Access Token and DPoP Proof)</text><line style="stroke:#000000;stroke-width:1;" x1="660.6846" x2="702.6846" y1="2352.4219" y2="2352.4219"/><line style="stroke:#000000;stroke-width:1;" x1="702.6846" x2="702.6846" y1="2352.4219" y2="2365.4219"/><line style="stroke:#000000;stroke-width:1;" x1="661.6846" x2="702.6846" y1="2365.4219" y2="2365.4219"/><polygon fill="#000000" points="671.6846,2361.4219,661.6846,2365.4219,671.6846,2369.4219,667.6846,2365.4219" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="667.6846" y="2336.4229">Validate Access Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="667.6846" y="2348.0635">and DPoP Proof</text><polygon fill="#000000" points="898.3789,2398.7031,908.3789,2402.7031,898.3789,2406.7031,902.3789,2402.7031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="660.6846" x2="904.3789" y1="2402.7031" y2="2402.7031"/><text fill="#000000" font-family="sans-serif" font-size="10" x="667.6846" y="2386.7041">Forward Request to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="667.6846" y="2398.3447">Resource Server A</text><polygon fill="#000000" points="671.6846,2424.3438,661.6846,2428.3438,671.6846,2432.3438,667.6846,2428.3438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="665.6846" x2="909.3789" y1="2428.3438" y2="2428.3438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="677.6846" y="2423.9854">Resource Data</text><polygon fill="#000000" points="305.9907,2449.9844,295.9907,2453.9844,305.9907,2457.9844,301.9907,2453.9844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="649.6846" y1="2453.9844" y2="2453.9844"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="2449.626">Resource Data</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1822.8701" x="5" y="2480.8047"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1827.8701" y1="2480.8047" y2="2480.8047"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1827.8701" y1="2483.8047" y2="2483.8047"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="449.1904" x="691.8398" y="2471.9844"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="697.8398" y="2485.2666">Client Registration with Resource Server B (with Client Attestation and JWT)</text><polygon fill="#000000" points="418.0405,2526.9063,428.0405,2530.9063,418.0405,2534.9063,422.0405,2530.9063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="424.0405" y1="2530.9063" y2="2530.9063"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2514.9072">Generate Key Pair</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2526.5479">for Attestation</text><path d="M445.0405,2506.625 L445.0405,2539.625 L571.0405,2539.625 L571.0405,2516.625 L561.0405,2506.625 L445.0405,2506.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M561.0405,2506.625 L561.0405,2516.625 L571.0405,2516.625 L561.0405,2506.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="451.0405" y="2520.9072">Using Android TEE or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="451.0405" y="2532.5479">iOS Secure Enclave</text><polygon fill="#000000" points="305.9907,2558.5469,295.9907,2562.5469,305.9907,2566.5469,301.9907,2562.5469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="429.0405" y1="2562.5469" y2="2562.5469"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="2558.1885">Public Key</text><polygon fill="#000000" points="1464.1333,2584.1875,1474.1333,2588.1875,1464.1333,2592.1875,1468.1333,2588.1875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="1470.1333" y1="2588.1875" y2="2588.1875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2583.8291">Request Attestation Challenge</text><polygon fill="#000000" points="305.9907,2609.8281,295.9907,2613.8281,305.9907,2617.8281,301.9907,2613.8281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="1475.1333" y1="2613.8281" y2="2613.8281"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="2609.4697">Attestation Challenge</text><polygon fill="#000000" points="418.0405,2647.1094,428.0405,2651.1094,418.0405,2655.1094,422.0405,2651.1094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="424.0405" y1="2651.1094" y2="2651.1094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2635.1104">Sign Challenge with</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2646.751">Attestation Key</text><path d="M445.0405,2626.8281 L445.0405,2659.8281 L672.0405,2659.8281 L672.0405,2636.8281 L662.0405,2626.8281 L445.0405,2626.8281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M662.0405,2626.8281 L662.0405,2636.8281 L672.0405,2636.8281 L662.0405,2626.8281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="451.0405" y="2641.1104">Using Android SafetyNet/Play Integrity or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="451.0405" y="2652.751">iOS DeviceCheck/App Attest API</text><polygon fill="#000000" points="305.9907,2678.75,295.9907,2682.75,305.9907,2686.75,301.9907,2682.75" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="429.0405" y1="2682.75" y2="2682.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="2678.3916">Attestation Statement</text><polygon fill="#000000" points="970.5356,2704.3906,980.5356,2708.3906,970.5356,2712.3906,974.5356,2708.3906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="976.5356" y1="2708.3906" y2="2708.3906"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="2704.0322">Client Registration Request (Resource Server B, with Email Confirmation JWT)</text><path d="M997.5356,2695.75 L997.5356,2728.75 L1251.5356,2728.75 L1251.5356,2705.75 L1241.5356,2695.75 L997.5356,2695.75 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1241.5356,2695.75 L1241.5356,2705.75 L1251.5356,2705.75 L1241.5356,2695.75 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1003.5356" y="2710.0322">Includes attestation statement, public key,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1003.5356" y="2721.6729">User Email and potentially software statement</text><polygon fill="#000000" points="1464.1333,2747.6719,1474.1333,2751.6719,1464.1333,2755.6719,1468.1333,2751.6719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1470.1333" y1="2751.6719" y2="2751.6719"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="2747.3135">Verify Client Attestation</text><path d="M1491.1333,2739.0313 L1491.1333,2760.0313 L1777.1333,2760.0313 L1777.1333,2749.0313 L1767.1333,2739.0313 L1491.1333,2739.0313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1767.1333,2739.0313 L1767.1333,2749.0313 L1777.1333,2749.0313 L1767.1333,2739.0313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1497.1333" y="2753.3135">AS B forwards attestation data to Attestation Service</text><line style="stroke:#000000;stroke-width:1;" x1="1486.1333" x2="1528.1333" y1="2794.9531" y2="2794.9531"/><line style="stroke:#000000;stroke-width:1;" x1="1528.1333" x2="1528.1333" y1="2794.9531" y2="2807.9531"/><line style="stroke:#000000;stroke-width:1;" x1="1487.1333" x2="1528.1333" y1="2807.9531" y2="2807.9531"/><polygon fill="#000000" points="1497.1333,2803.9531,1487.1333,2807.9531,1497.1333,2811.9531,1493.1333,2807.9531" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1493.1333" y="2778.9541">Validate Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1493.1333" y="2790.5947">Statement</text><polygon fill="#000000" points="1003.5356,2829.5938,993.5356,2833.5938,1003.5356,2837.5938,999.5356,2833.5938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="997.5356" x2="1475.1333" y1="2833.5938" y2="2833.5938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="2829.2354">Attestation Verification Result</text><polygon fill="#000000" points="1250.8989,2866.875,1260.8989,2870.875,1250.8989,2874.875,1254.8989,2870.875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1256.8989" y1="2870.875" y2="2870.875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="2854.876">Request Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="2866.5166">Registration Decision</text><path d="M1277.8989,2846.5938 L1277.8989,2879.5938 L1501.8989,2879.5938 L1501.8989,2856.5938 L1491.8989,2846.5938 L1277.8989,2846.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1491.8989,2846.5938 L1491.8989,2856.5938 L1501.8989,2856.5938 L1491.8989,2846.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1283.8989" y="2860.876">AS B sends input data to Policy Engine B</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1283.8989" y="2872.5166">for registration request</text><line style="stroke:#000000;stroke-width:1;" x1="1272.8989" x2="1314.8989" y1="2914.1563" y2="2914.1563"/><line style="stroke:#000000;stroke-width:1;" x1="1314.8989" x2="1314.8989" y1="2914.1563" y2="2927.1563"/><line style="stroke:#000000;stroke-width:1;" x1="1273.8989" x2="1314.8989" y1="2927.1563" y2="2927.1563"/><polygon fill="#000000" points="1283.8989,2923.1563,1273.8989,2927.1563,1283.8989,2931.1563,1279.8989,2927.1563" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="2898.1572">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="2909.7979">on Input Data</text><polygon fill="#000000" points="1003.5356,2960.4375,993.5356,2964.4375,1003.5356,2968.4375,999.5356,2964.4375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="997.5356" x2="1261.8989" y1="2964.4375" y2="2964.4375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="2948.4385">Client Registration</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="2960.0791">Decision (Permit/Deny)</text><polygon fill="#000000" points="1582.6353,2986.0781,1592.6353,2990.0781,1582.6353,2994.0781,1586.6353,2990.0781" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1588.6353" y1="2990.0781" y2="2990.0781"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="2985.7197">Get Entity Statement from Federation Master</text><polygon fill="#000000" points="1003.5356,3011.7188,993.5356,3015.7188,1003.5356,3019.7188,999.5356,3015.7188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="997.5356" x2="1593.6353" y1="3015.7188" y2="3015.7188"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="3011.3604">Entity Statement from Federation Master</text><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1034.5356" y1="3053" y2="3053"/><line style="stroke:#000000;stroke-width:1;" x1="1034.5356" x2="1034.5356" y1="3053" y2="3066"/><line style="stroke:#000000;stroke-width:1;" x1="993.5356" x2="1034.5356" y1="3066" y2="3066"/><polygon fill="#000000" points="1003.5356,3062,993.5356,3066,1003.5356,3070,999.5356,3066" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3037.001">Extract "iss" (AS_A_ID)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3048.6416">and "aud" from JWT</text><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1034.5356" y1="3126.5625" y2="3126.5625"/><line style="stroke:#000000;stroke-width:1;" x1="1034.5356" x2="1034.5356" y1="3126.5625" y2="3139.5625"/><line style="stroke:#000000;stroke-width:1;" x1="993.5356" x2="1034.5356" y1="3139.5625" y2="3139.5625"/><polygon fill="#000000" points="1003.5356,3135.5625,993.5356,3139.5625,1003.5356,3143.5625,999.5356,3139.5625" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3087.2822">Get Entity Statement</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3098.9229">URL for AS A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3110.5635">from Federation Master</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3122.2041">Entity Statement</text><polygon fill="#000000" points="553.4756,3161.2031,543.4756,3165.2031,553.4756,3169.2031,549.4756,3165.2031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="547.4756" x2="981.5356" y1="3165.2031" y2="3165.2031"/><text fill="#000000" font-family="sans-serif" font-size="10" x="559.4756" y="3160.8447">Get AS A's Entity Statement</text><polygon fill="#000000" points="970.5356,3186.8438,980.5356,3190.8438,970.5356,3194.8438,974.5356,3190.8438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="542.4756" x2="976.5356" y1="3190.8438" y2="3190.8438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="549.4756" y="3186.4854">AS A's Entity Statement</text><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1034.5356" y1="3239.7656" y2="3239.7656"/><line style="stroke:#000000;stroke-width:1;" x1="1034.5356" x2="1034.5356" y1="3239.7656" y2="3252.7656"/><line style="stroke:#000000;stroke-width:1;" x1="993.5356" x2="1034.5356" y1="3252.7656" y2="3252.7656"/><polygon fill="#000000" points="1003.5356,3248.7656,993.5356,3252.7656,1003.5356,3256.7656,999.5356,3252.7656" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3212.126">Verify JWT Signature</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3223.7666">(using AS A's Public Key</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3235.4072">from Entity Statement)</text><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1034.5356" y1="3301.6875" y2="3301.6875"/><line style="stroke:#000000;stroke-width:1;" x1="1034.5356" x2="1034.5356" y1="3301.6875" y2="3314.6875"/><line style="stroke:#000000;stroke-width:1;" x1="993.5356" x2="1034.5356" y1="3314.6875" y2="3314.6875"/><polygon fill="#000000" points="1003.5356,3310.6875,993.5356,3314.6875,1003.5356,3318.6875,999.5356,3314.6875" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3274.0479">Validate JWT Claims</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3285.6885">(iss, aud, exp,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3297.3291">iat, Email_verified)</text><path d="M8,3326.6875 L67.9561,3326.6875 L67.9561,3330.3281 L57.9561,3340.3281 L8,3340.3281 L8,3326.6875 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="467.8125" style="stroke:#000000;stroke-width:1.5;" width="1404.2446" x="8" y="3326.6875"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="23" y="3336.9697">alt</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="82.9561" y="3337.9697">[JWT Valid]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="8" x2="1412.2446" y1="3398.6094" y2="3398.6094"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="13" y="3409.8916">[JWT Invalid or Expired]</text><polygon fill="#000000" points="305.9907,3375.6094,295.9907,3379.6094,305.9907,3383.6094,301.9907,3379.6094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="299.9907" x2="981.5356" y1="3379.6094" y2="3379.6094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="3363.6104">Client Registration Response</text><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="3375.251">(without Email Confirmation JWT)</text><line style="stroke:#000000;stroke-width:1;" x1="992.5356" x2="1034.5356" y1="3446.5313" y2="3446.5313"/><line style="stroke:#000000;stroke-width:1;" x1="1034.5356" x2="1034.5356" y1="3446.5313" y2="3459.5313"/><line style="stroke:#000000;stroke-width:1;" x1="993.5356" x2="1034.5356" y1="3459.5313" y2="3459.5313"/><polygon fill="#000000" points="1003.5356,3455.5313,993.5356,3459.5313,1003.5356,3463.5313,999.5356,3459.5313" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3430.5322">Generate Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="999.5356" y="3442.1729">Confirmation Token</text><polygon fill="#000000" points="305.9907,3481.1719,295.9907,3485.1719,305.9907,3489.1719,301.9907,3485.1719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="299.9907" x2="981.5356" y1="3485.1719" y2="3485.1719"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="3480.8135">Client Registration Response (with Email Confirmation Token)</text><path d="M997.5356,3472.5313 L997.5356,3505.5313 L1253.5356,3505.5313 L1253.5356,3482.5313 L1243.5356,3472.5313 L997.5356,3472.5313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1243.5356,3472.5313 L1243.5356,3482.5313 L1253.5356,3482.5313 L1243.5356,3472.5313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1003.5356" y="3486.8135">AS B sends Email Confirmation Token to client,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1003.5356" y="3498.4541">which will be included in Email to User</text><polygon fill="#000000" points="178.7534,3536.0938,168.7534,3540.0938,178.7534,3544.0938,174.7534,3540.0938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="172.7534" x2="283.9907" y1="3540.0938" y2="3540.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="184.7534" y="3524.0947">Send Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="184.7534" y="3535.7354">Email</text><path d="M299.9907,3515.8125 L299.9907,3548.8125 L488.9907,3548.8125 L488.9907,3525.8125 L478.9907,3515.8125 L299.9907,3515.8125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M478.9907,3515.8125 L478.9907,3525.8125 L488.9907,3525.8125 L478.9907,3515.8125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="305.9907" y="3530.0947">Client sends Email including</text><text fill="#000000" font-family="sans-serif" font-size="10" x="305.9907" y="3541.7354">Email Confirmation Token to User</text><polygon fill="#000000" points="145.7534,3556.0938,155.7534,3560.0938,145.7534,3564.0938,149.7534,3560.0938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="151.7534" y1="3560.0938" y2="3560.0938"/><polygon fill="#000000" points="975.5356,3581.7344,985.5356,3585.7344,975.5356,3589.7344,979.5356,3585.7344" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="167.7534" x2="981.5356" y1="3585.7344" y2="3585.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="174.7534" y="3581.376">User Clicks Confirmation Link in Email</text><line style="stroke:#000000;stroke-width:1;" x1="997.5356" x2="1039.5356" y1="3623.0156" y2="3623.0156"/><line style="stroke:#000000;stroke-width:1;" x1="1039.5356" x2="1039.5356" y1="3623.0156" y2="3636.0156"/><line style="stroke:#000000;stroke-width:1;" x1="998.5356" x2="1039.5356" y1="3636.0156" y2="3636.0156"/><polygon fill="#000000" points="1008.5356,3632.0156,998.5356,3636.0156,1008.5356,3640.0156,1004.5356,3636.0156" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="3607.0166">Verify Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="3618.6572">Confirmation Token</text><polygon fill="#000000" points="1250.8989,3669.2969,1260.8989,3673.2969,1250.8989,3677.2969,1254.8989,3673.2969" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="997.5356" x2="1256.8989" y1="3673.2969" y2="3673.2969"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="3657.2979">Request Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="3668.9385">Confirmation Decision</text><line style="stroke:#000000;stroke-width:1;" x1="1272.8989" x2="1314.8989" y1="3710.5781" y2="3710.5781"/><line style="stroke:#000000;stroke-width:1;" x1="1314.8989" x2="1314.8989" y1="3710.5781" y2="3723.5781"/><line style="stroke:#000000;stroke-width:1;" x1="1273.8989" x2="1314.8989" y1="3723.5781" y2="3723.5781"/><polygon fill="#000000" points="1283.8989,3719.5781,1273.8989,3723.5781,1283.8989,3727.5781,1279.8989,3723.5781" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="3694.5791">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="3706.2197">on Input Data</text><polygon fill="#000000" points="1008.5356,3756.8594,998.5356,3760.8594,1008.5356,3764.8594,1004.5356,3760.8594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1002.5356" x2="1261.8989" y1="3760.8594" y2="3760.8594"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1014.5356" y="3744.8604">Email Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1014.5356" y="3756.501">Decision (Permit/Deny)</text><polygon fill="#000000" points="305.9907,3782.5,295.9907,3786.5,305.9907,3790.5,301.9907,3786.5" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="299.9907" x2="986.5356" y1="3786.5" y2="3786.5"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="3782.1416">Client Registration Response (with Email Confirmation JWT)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1822.8701" x="5" y="3827.3203"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1827.8701" y1="3827.3203" y2="3827.3203"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1827.8701" y1="3830.3203" y2="3830.3203"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="480.7139" x="676.0781" y="3818.5"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="682.0781" y="3831.7822">OAuth 2.0 Authorization Code Flow with PAR, PKCE and DPoP (Resource Server B)</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="3877.4219" y2="3877.4219"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="3877.4219" y2="3890.4219"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="3890.4219" y2="3890.4219"/><polygon fill="#000000" points="305.9907,3886.4219,295.9907,3890.4219,305.9907,3894.4219,301.9907,3890.4219" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="3861.4229">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="3873.0635">Code Verifier</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="3927.7031" y2="3927.7031"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="3927.7031" y2="3940.7031"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="3940.7031" y2="3940.7031"/><polygon fill="#000000" points="305.9907,3936.7031,295.9907,3940.7031,305.9907,3944.7031,301.9907,3940.7031" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="3911.7041">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="3923.3447">Code Challenge</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="3966.3438" y2="3966.3438"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="3966.3438" y2="3979.3438"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="3979.3438" y2="3979.3438"/><polygon fill="#000000" points="305.9907,3975.3438,295.9907,3979.3438,305.9907,3983.3438,301.9907,3979.3438" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="3961.9854">Generate DPoP Key Pair</text><polygon fill="#000000" points="975.5356,4000.9844,985.5356,4004.9844,975.5356,4008.9844,979.5356,4004.9844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="981.5356" y1="4004.9844" y2="4004.9844"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="4000.626">PAR Request</text><path d="M1002.5356,3992.3438 L1002.5356,4025.3438 L1385.5356,4025.3438 L1385.5356,4002.3438 L1375.5356,3992.3438 L1002.5356,3992.3438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1375.5356,3992.3438 L1375.5356,4002.3438 L1385.5356,4002.3438 L1375.5356,3992.3438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1008.5356" y="4006.626">Authorization Code Request</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1008.5356" y="4018.2666">(inkl. DPoP Proof, code_challenge, code_challenge_method, redirect_uri)</text><line style="stroke:#000000;stroke-width:1;" x1="997.5356" x2="1039.5356" y1="4048.2656" y2="4048.2656"/><line style="stroke:#000000;stroke-width:1;" x1="1039.5356" x2="1039.5356" y1="4048.2656" y2="4061.2656"/><line style="stroke:#000000;stroke-width:1;" x1="998.5356" x2="1039.5356" y1="4061.2656" y2="4061.2656"/><polygon fill="#000000" points="1008.5356,4057.2656,998.5356,4061.2656,1008.5356,4065.2656,1004.5356,4061.2656" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="4043.9072">Validate DPoP Proof</text><polygon fill="#000000" points="1250.8989,4094.5469,1260.8989,4098.5469,1250.8989,4102.5469,1254.8989,4098.5469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="997.5356" x2="1256.8989" y1="4098.5469" y2="4098.5469"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="4082.5479">Request Authorization</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="4094.1885">Code Decision</text><path d="M1277.8989,4074.2656 L1277.8989,4107.2656 L1501.8989,4107.2656 L1501.8989,4084.2656 L1491.8989,4074.2656 L1277.8989,4074.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1491.8989,4074.2656 L1491.8989,4084.2656 L1501.8989,4084.2656 L1491.8989,4074.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1283.8989" y="4088.5479">AS B sends input data to Policy Engine B</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1283.8989" y="4100.1885">for authorization code request</text><line style="stroke:#000000;stroke-width:1;" x1="1272.8989" x2="1314.8989" y1="4141.8281" y2="4141.8281"/><line style="stroke:#000000;stroke-width:1;" x1="1314.8989" x2="1314.8989" y1="4141.8281" y2="4154.8281"/><line style="stroke:#000000;stroke-width:1;" x1="1273.8989" x2="1314.8989" y1="4154.8281" y2="4154.8281"/><polygon fill="#000000" points="1283.8989,4150.8281,1273.8989,4154.8281,1283.8989,4158.8281,1279.8989,4154.8281" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="4125.8291">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="4137.4697">on Input Data</text><polygon fill="#000000" points="1008.5356,4188.1094,998.5356,4192.1094,1008.5356,4196.1094,1004.5356,4192.1094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1002.5356" x2="1261.8989" y1="4192.1094" y2="4192.1094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1014.5356" y="4176.1104">Authorization Code</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1014.5356" y="4187.751">Decision (Permit/Deny)</text><polygon fill="#000000" points="305.9907,4213.75,295.9907,4217.75,305.9907,4221.75,301.9907,4217.75" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="986.5356" y1="4217.75" y2="4217.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="4213.3916">Request URI</text><polygon fill="#000000" points="99.1821,4239.3906,89.1821,4243.3906,99.1821,4247.3906,95.1821,4243.3906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="93.1821" x2="283.9907" y1="4243.3906" y2="4243.3906"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="4239.0322">Navigate to Request URI</text><polygon fill="#000000" points="975.5356,4265.0313,985.5356,4269.0313,975.5356,4273.0313,979.5356,4269.0313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="981.5356" y1="4269.0313" y2="4269.0313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="4264.6729">Authorization Request (with Request URI)</text><polygon fill="#000000" points="1643.4639,4290.6719,1653.4639,4294.6719,1643.4639,4298.6719,1647.4639,4294.6719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="997.5356" x2="1649.4639" y1="4294.6719" y2="4294.6719"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="4290.3135">Authentication Request (OpenID Connect)</text><path d="M1670.4639,4282.0313 L1670.4639,4315.0313 L1822.4639,4315.0313 L1822.4639,4292.0313 L1812.4639,4282.0313 L1670.4639,4282.0313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1812.4639,4282.0313 L1812.4639,4292.0313 L1822.4639,4292.0313 L1812.4639,4282.0313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1676.4639" y="4296.3135">AS B acts as Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1679.6426" y="4307.9541">for the IDP</text><polygon fill="#000000" points="99.1821,4333.9531,89.1821,4337.9531,99.1821,4341.9531,95.1821,4337.9531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="1654.4639" y1="4337.9531" y2="4337.9531"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="4333.5947">Authentication Prompt</text><polygon fill="#000000" points="1643.4639,4359.5938,1653.4639,4363.5938,1643.4639,4367.5938,1647.4639,4363.5938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="1649.4639" y1="4363.5938" y2="4363.5938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="4359.2354">User Credentials</text><polygon fill="#000000" points="1008.5356,4385.2344,998.5356,4389.2344,1008.5356,4393.2344,1004.5356,4389.2344" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1002.5356" x2="1654.4639" y1="4389.2344" y2="4389.2344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1014.5356" y="4384.876">Authentication Response (ID Token)</text><line style="stroke:#000000;stroke-width:1;" x1="997.5356" x2="1039.5356" y1="4414.875" y2="4414.875"/><line style="stroke:#000000;stroke-width:1;" x1="1039.5356" x2="1039.5356" y1="4414.875" y2="4427.875"/><line style="stroke:#000000;stroke-width:1;" x1="998.5356" x2="1039.5356" y1="4427.875" y2="4427.875"/><polygon fill="#000000" points="1008.5356,4423.875,998.5356,4427.875,1008.5356,4431.875,1004.5356,4427.875" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1004.5356" y="4410.5166">Validate ID Token</text><polygon fill="#000000" points="99.1821,4449.5156,89.1821,4453.5156,99.1821,4457.5156,95.1821,4453.5156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="986.5356" y1="4453.5156" y2="4453.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="4449.1572">Authorization Code</text><polygon fill="#000000" points="272.9907,4475.1563,282.9907,4479.1563,272.9907,4483.1563,276.9907,4479.1563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="278.9907" y1="4479.1563" y2="4479.1563"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="4474.7979">Redirect with Authorization Code</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="4504.7969" y2="4504.7969"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="4504.7969" y2="4517.7969"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="4517.7969" y2="4517.7969"/><polygon fill="#000000" points="305.9907,4513.7969,295.9907,4517.7969,305.9907,4521.7969,301.9907,4517.7969" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="4500.4385">Generate DPoP Key Pair</text><polygon fill="#000000" points="980.5356,4539.4375,990.5356,4543.4375,980.5356,4547.4375,984.5356,4543.4375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="986.5356" y1="4543.4375" y2="4543.4375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="4539.0791">Token Request (Authorization Code Grant)</text><path d="M1007.5356,4530.7969 L1007.5356,4574.7969 L1227.5356,4574.7969 L1227.5356,4540.7969 L1217.5356,4530.7969 L1007.5356,4530.7969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1217.5356,4530.7969 L1217.5356,4540.7969 L1227.5356,4540.7969 L1217.5356,4530.7969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1013.5356" y="4545.0791">Enth&#228;lt Authorization Code, DPoP Proof,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1013.5356" y="4556.7197">Client Assertion (JWT, RFC7523),</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1013.5356" y="4568.3604">redirect_uri, code_verifier</text><line style="stroke:#000000;stroke-width:1;" x1="1002.5356" x2="1044.5356" y1="4610" y2="4610"/><line style="stroke:#000000;stroke-width:1;" x1="1044.5356" x2="1044.5356" y1="4610" y2="4623"/><line style="stroke:#000000;stroke-width:1;" x1="1003.5356" x2="1044.5356" y1="4623" y2="4623"/><polygon fill="#000000" points="1013.5356,4619,1003.5356,4623,1013.5356,4627,1009.5356,4623" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="4594.001">Validate Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="4605.6416">Assertion (JWT)</text><line style="stroke:#000000;stroke-width:1;" x1="1002.5356" x2="1044.5356" y1="4648.6406" y2="4648.6406"/><line style="stroke:#000000;stroke-width:1;" x1="1044.5356" x2="1044.5356" y1="4648.6406" y2="4661.6406"/><line style="stroke:#000000;stroke-width:1;" x1="1003.5356" x2="1044.5356" y1="4661.6406" y2="4661.6406"/><polygon fill="#000000" points="1013.5356,4657.6406,1003.5356,4661.6406,1013.5356,4665.6406,1009.5356,4661.6406" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="4644.2822">Validate DPoP Proof</text><line style="stroke:#000000;stroke-width:1;" x1="1002.5356" x2="1044.5356" y1="4698.9219" y2="4698.9219"/><line style="stroke:#000000;stroke-width:1;" x1="1044.5356" x2="1044.5356" y1="4698.9219" y2="4711.9219"/><line style="stroke:#000000;stroke-width:1;" x1="1003.5356" x2="1044.5356" y1="4711.9219" y2="4711.9219"/><polygon fill="#000000" points="1013.5356,4707.9219,1003.5356,4711.9219,1013.5356,4715.9219,1009.5356,4711.9219" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="4682.9229">Validate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="4694.5635">Code Verifier</text><polygon fill="#000000" points="1250.8989,4745.2031,1260.8989,4749.2031,1250.8989,4753.2031,1254.8989,4749.2031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1002.5356" x2="1256.8989" y1="4749.2031" y2="4749.2031"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="4733.2041">Request Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1009.5356" y="4744.8447">Issuance Decision</text><path d="M1277.8989,4724.9219 L1277.8989,4757.9219 L1501.8989,4757.9219 L1501.8989,4734.9219 L1491.8989,4724.9219 L1277.8989,4724.9219 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1491.8989,4724.9219 L1491.8989,4734.9219 L1501.8989,4734.9219 L1491.8989,4724.9219 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1283.8989" y="4739.2041">AS B sends input data to Policy Engine B</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1283.8989" y="4750.8447">for token request</text><line style="stroke:#000000;stroke-width:1;" x1="1272.8989" x2="1314.8989" y1="4792.4844" y2="4792.4844"/><line style="stroke:#000000;stroke-width:1;" x1="1314.8989" x2="1314.8989" y1="4792.4844" y2="4805.4844"/><line style="stroke:#000000;stroke-width:1;" x1="1273.8989" x2="1314.8989" y1="4805.4844" y2="4805.4844"/><polygon fill="#000000" points="1283.8989,4801.4844,1273.8989,4805.4844,1283.8989,4809.4844,1279.8989,4805.4844" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="4776.4854">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1279.8989" y="4788.126">on Input Data</text><polygon fill="#000000" points="1013.5356,4838.7656,1003.5356,4842.7656,1013.5356,4846.7656,1009.5356,4842.7656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1007.5356" x2="1261.8989" y1="4842.7656" y2="4842.7656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1019.5356" y="4826.7666">Token Issuance</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1019.5356" y="4838.4072">Decision (Permit/Deny)</text><polygon fill="#000000" points="305.9907,4864.4063,295.9907,4868.4063,305.9907,4872.4063,301.9907,4868.4063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="991.5356" y1="4868.4063" y2="4868.4063"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="4864.0479">Access Token (JWT), Refresh Token</text><path d="M145.2017,4855.7656 L145.2017,4888.7656 L284.2017,4888.7656 L284.2017,4865.7656 L274.2017,4855.7656 L145.2017,4855.7656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M274.2017,4855.7656 L274.2017,4865.7656 L284.2017,4865.7656 L274.2017,4855.7656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="151.2017" y="4870.0479">Access Token bound to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="151.2017" y="4881.6885">client's DPoP public key</text><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="336.9907" y1="4911.6875" y2="4911.6875"/><line style="stroke:#000000;stroke-width:1;" x1="336.9907" x2="336.9907" y1="4911.6875" y2="4924.6875"/><line style="stroke:#000000;stroke-width:1;" x1="295.9907" x2="336.9907" y1="4924.6875" y2="4924.6875"/><polygon fill="#000000" points="305.9907,4920.6875,295.9907,4924.6875,305.9907,4928.6875,301.9907,4924.6875" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="4907.3291">Generate DPoP Key Pair</text><polygon fill="#000000" points="1119.5503,4957.9688,1129.5503,4961.9688,1119.5503,4965.9688,1123.5503,4961.9688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="294.9907" x2="1125.5503" y1="4961.9688" y2="4961.9688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="4945.9697">Access Protected Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="301.9907" y="4957.6104">(with Access Token and DPoP Proof)</text><line style="stroke:#000000;stroke-width:1;" x1="1141.5503" x2="1183.5503" y1="4999.25" y2="4999.25"/><line style="stroke:#000000;stroke-width:1;" x1="1183.5503" x2="1183.5503" y1="4999.25" y2="5012.25"/><line style="stroke:#000000;stroke-width:1;" x1="1142.5503" x2="1183.5503" y1="5012.25" y2="5012.25"/><polygon fill="#000000" points="1152.5503,5008.25,1142.5503,5012.25,1152.5503,5016.25,1148.5503,5012.25" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1148.5503" y="4983.251">Validate Access Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1148.5503" y="4994.8916">and DPoP Proof</text><polygon fill="#000000" points="1379.2446,5045.5313,1389.2446,5049.5313,1379.2446,5053.5313,1383.2446,5049.5313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1141.5503" x2="1385.2446" y1="5049.5313" y2="5049.5313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1148.5503" y="5033.5322">Forward Request to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1148.5503" y="5045.1729">Resource Server B</text><polygon fill="#000000" points="1152.5503,5071.1719,1142.5503,5075.1719,1152.5503,5079.1719,1148.5503,5075.1719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1146.5503" x2="1390.2446" y1="5075.1719" y2="5075.1719"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1158.5503" y="5070.8135">Resource Data</text><polygon fill="#000000" points="305.9907,5096.8125,295.9907,5100.8125,305.9907,5104.8125,301.9907,5100.8125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="299.9907" x2="1130.5503" y1="5100.8125" y2="5100.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="311.9907" y="5096.4541">Resource Data</text><!--SRC=[xLhhRkEu5Vwlfs2zFne3daktA1O8C0L4sycwEqaCEzD52mC1BT4s6vdoYbGIJz6tsJVP5zl3YoHIaXt7ySviYs8m64ayv_3SUVXvn3tZ6vAHDOhfWkI9l4YvdBBF5FtfVI3AnO5Pl4fvAZOaeh4YkoPhYlffdZ6QERG9vKkv2kD_vK8Ydd8QE8k2_fHJ7b7qxm2XCSaaYzY6S8dJBAPPFqtI3CqJ4jtNbk7BCajp7XkInnMJ54Z2IAPP6wzPsCMLPUcZJ_-HBUX7nccRh7Aj9kwRY_Vg3r1SfxALKtzlS0qlXlrXy9yW-CCc8yirGPAcdv7CSl2KrXjz4k3HUVg4EbVfd2KK_F_08jf1trokKY5_j7OWjAbSf9d29OKd8b17lI7zscbGNdqADSqLOScCxwFi9wmGQ1wR95CQvHaTyYWX3rHJXZpEKXQZs-4GfTcCivkffKAMh1DG7YCmC31MXdpEg5HgW8ctm_xtrpSVRox_eVVI1FySteReCYTP30HJmkCjXX1oJL1NA9mQwyQ3yOo7kLnDEwrqu-7upb8EWVBxszin6cVfqtONkIDsd2Oise8vIyWBGrzOLEfyEqBVldq_umFmcv2Wzu1azrDABZDAspMVMCqdL41LHNJ6fpHxe9c_mGxNuPEu3X_iElmIr-7VtdNu1QvpEJkXb5H88bdA3PUkD1062_RLPxYWKEYQ7itu5H7WVKqFtysRJpuQZFKo_1i47puKDJMXIoQabVF8v0eLkYEZEWhHcVvk6Hmz4OGH3TTGlbtquKCGw19-yrTBUQvR0PfAq49u-mGaako1I6ef0oiQMBqoFaUNb2iRAVg1Rg4HCoZZ1JGcHuTAbiSQSEXvA6FBbTQ3yINo-m5gjeF0xo5l74l6-HpIHMaHn7J7ZfKHLSJEmMuuQOJljlwA9EfuefNoJf2hHq-5TW6EDew8dVwSigN3hUCD5UP8LXQ-sADJig1oUqtbkt52jcZ49LrcJ6xBjclEZVwAHlVlmit6seB2yMYFprsr88aaNQjKESJzq_2yDRrjB1olJqFFh178ocCg477s5iNUFRGnQN1FjprxOEdirtMm0JbSCd3j5ebq8Hy9P5R96wZZe9OQVwSPMsnRwgerBLmzmobK9HG2x17xoiP4ma6U-ivhIQoQ9YHXiTtFQKAbykxUzEtoBTAXH0AoYKY8GGyzA0agv1imAet1FSediOxxEm8XPsLIAFcvgAUv3fghjVOEYuh82PZxTcIxTIsSZ5Mv6QVEk1V_0OsOyFmBF4t72kZF0XJUvBBqftTSeD2qeSmLdjdaKWTqeSqGt9BhVGpxd0WQps0OXKnJqWSWtJ3iILiuVwpUw6nCipMJxmQKRxkkDvGTHOOfCMNVrFavu_sKBrYsDfhUflTmV5doejhQwqLiKYxW53CdW4dsfgpkBX_kOb0UZVI6a2Wm3aShQ4L9WkOKtAvBC8O7omwqUX1rWmzrMzKxp97GsTIXwkuquvgzYZMGUNfQ0QwcPdDeRPPvX-fQdUAmKxi7QfGjVAyNG7XqBtn-6DxlIxDSSvHcdcrkA6sNU3QGNlgtKRTd_-lIjUcbasVhttwyzS86x-1TmjRYVCRH6yI4K3bt5zwD1lg3oESc27SirXz87ciA31Je3EeMUZIyT_KYVTgSepEnIZE995jJyvKHsEcCfu_cLUjrzw0x4WLXwfAa5nwS9dMdsA5xhJUMzKGb1WPtwycl1hWRDHch0HMfXpHZd-rmaCOKNIJfenddnk6aXyO_z8Vwb1gCqp4wQunuUdwhAghGk0oCubTn0SccBqC174PUZIfxwBLMnOXNFyd1WETFxXONM1xmBDHTyjPi0jU3TD534H3SHOLgzVUxDGLfSGzwUimo6icxF6DTlogB4xEIsbg8dbxM9QS-XeXdkpBbH8THqwalgcudqeKxFar6ZLIkmbr21-VecZomfI81ertcahMa3Ih0eLtlWltCtcvAOTtMfWlt8oD1JNDHJSJDXd9e8b2V7DB24Q1kLOq8mgfGLwu9JRPgNbP8qXRwXWeQoDTCy5Txoh6zjZaartfJCrChQGuQo54pTufILka4pmJJQD0Pw6zFRISIIfNM_2weov3M5FNpmzUoYhuf8zEGMhWSHQgu7jqmp3bTngobDLncS2NkxkucGovNl_oSo1PTUsuVWOAsmxi0jJND6RJh7ffSzB_xoxT_xWA5sqDietaeMcYhnulHrPTvSFlnrziQTrkVqZwRyP4GEL6uwAbxbDGnEKrRCl4jL3ss9OLHH8MmmhI78MnqaL6niXclhKteeauyLoWgM3JZPeRzep1Xg6w7UthSmQciSS5oPmYnX2I2kRY2ban3yrGhZtYT4bqtUY0jC5XZ9Rowzpb2pDNDIQoIQwAyVs6kdMNcA3yqvebgO-099jRrTjUIsePMI_VQXRlkXL4PuNoOs57eO2mBxyUoL1Ruaz0NmwFQyEd_0rB_Au0KtWj8DGTot4DxhmDETy5V3i729qMmy9T4i1fe4puURSAcW-8Zq2RSTCBpHoZUYpPLsXnuakBA0qUZJRXmG_bZW-gDKWrEginAlwC53A_8-QN2_Z9HYgf-h2YVAlKEbUQeLiahqbKBUWBhOFxiC24wC14QjA1hJheEoUEE4Qsm1fUlpIGecyb7FSAh2GX2qwhJZDVvAi6X4QpOONHeq3Kl9MN2xk2eJHkk1RP25MWoBT1Qc1noqowDlEeiiTRKD-Zw8ejIgv0OTSSMegUGbfv2LA2tC0BTniTDe6t1IAsuj0ZzavWL_0A89CtbphP84s7K6d4DIAlVUOPF6vY_lTriR9-5I5-e87eE9LNoTjJ_IP5IjS-XyAYYzO38kfAlX4cLE0ygLHzAk1GV39SgjXfawgck3i9wY9-5JXq6hv_lXK-zRLKhL1zUt8TBfh977GwbrdnHw72IL3Lrn6E_gU1J8uxuTuiuufs88_uAY6DBs_Mk_CtSFHHnVCqeiXTnVCr0SYpYQEUHGn17V7B44H-7E9OprCaGH_mL4KTy7EBOajyEueZ_6n17V1pYYByIujZYyTs8uq7jnrzlHnoRVUeGnF4rFQgEEBwcBHs3E3PRqfT37F7HY2C-AUA80_DVz2hXXoEEs22E-3344Rk88mucrlLsroRYY0z77B6FE7glzl-l_Ge0]--></g></svg>