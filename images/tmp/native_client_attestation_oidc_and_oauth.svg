<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="5233px" preserveAspectRatio="none" style="width:1813px;height:5233px;background:#FFFFFF;" version="1.1" viewBox="0 0 1813 5233" width="1813px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="5221.375" style="stroke:#181818;stroke-width:0.5;" width="469.4883" x="44.3965" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="239.7217" y="15.2822">Mobile Device</text><rect fill="#C9FFC9" height="5221.375" style="stroke:#181818;stroke-width:0.5;" width="453.6069" x="535.2515" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="732.0842" y="15.2822">Anbieter A</text><rect fill="#F4A460" height="5204.7344" style="stroke:#181818;stroke-width:0.5;" width="335.2832" x="535.2515" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="669.7485" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="5204.7344" style="stroke:#181818;stroke-width:0.5;" width="68.5283" x="920.3301" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="936.4131" y="31.9229">TI 2.0</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="936.4131" y="43.5635">Dienst</text><rect fill="#C9FFC9" height="5221.375" style="stroke:#181818;stroke-width:0.5;" width="468.8657" x="1000.8584" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1205.3792" y="15.2822">Anbieter B</text><rect fill="#F4A460" height="5204.7344" style="stroke:#181818;stroke-width:0.5;" width="350.542" x="1000.8584" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1142.9849" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="5204.7344" style="stroke:#181818;stroke-width:0.5;" width="68.5283" x="1401.1958" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1417.2788" y="31.9229">TI 2.0</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1417.2788" y="43.5635">Dienst</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="24" x2="24" y1="121.5625" y2="5149.7344"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="83.1821" x2="83.1821" y1="121.5625" y2="5149.7344"/><rect fill="#F0F0F0" height="37.2813" style="stroke:#000000;stroke-width:1;" width="10" x="78.1821" y="850.0625"/><rect fill="#F0F0F0" height="463.1719" style="stroke:#000000;stroke-width:1;" width="10" x="78.1821" y="1400.0781"/><rect fill="#F0F0F0" height="235.7656" style="stroke:#000000;stroke-width:1;" width="10" x="78.1821" y="4274.3125"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="182.0552" x2="182.0552" y1="121.5625" y2="5149.7344"/><rect fill="#F0F0F0" height="116.8438" style="stroke:#000000;stroke-width:1;" width="10" x="177.0552" y="733.2188"/><rect fill="#F0F0F0" height="45.6406" style="stroke:#000000;stroke-width:1;" width="10" x="177.0552" y="3571.0156"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="309.2925" x2="309.2925" y1="121.5625" y2="5149.7344"/><rect fill="#F0F0F0" height="4944.8906" style="stroke:#000000;stroke-width:1;" width="10" x="304.2925" y="186.8438"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="454.3423" x2="454.3423" y1="121.5625" y2="5149.7344"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="449.3423" y="224.125"/><rect fill="#F0F0F0" height="31.6406" style="stroke:#000000;stroke-width:1;" width="10" x="449.3423" y="338.3281"/><rect fill="#F0F0F0" height="31.6406" style="stroke:#000000;stroke-width:1;" width="10" x="449.3423" y="2550.1875"/><rect fill="#F0F0F0" height="31.6406" style="stroke:#000000;stroke-width:1;" width="10" x="449.3423" y="2670.3906"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="561.144" x2="561.144" y1="121.5625" y2="5149.7344"/><rect fill="#F0F0F0" height="692.4219" style="stroke:#000000;stroke-width:1;" width="10" x="556.144" y="395.6094"/><rect fill="#F0F0F0" height="70.2813" style="stroke:#000000;stroke-width:1;" width="10" x="556.144" y="1304.1563"/><rect fill="#F0F0F0" height="815.1406" style="stroke:#000000;stroke-width:1;" width="10" x="556.144" y="1425.7188"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="556.144" y="3196.125"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="694.8999" x2="694.8999" y1="121.5625" y2="5149.7344"/><rect fill="#F0F0F0" height="138.8438" style="stroke:#000000;stroke-width:1;" width="10" x="689.8999" y="2334.4219"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="826.2485" x2="826.2485" y1="121.5625" y2="5149.7344"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="821.2485" y="581.375"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="821.2485" y="2121.6563"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="954.5942" x2="954.5942" y1="121.5625" y2="5149.7344"/><rect fill="#F0F0F0" height="64.2813" style="stroke:#000000;stroke-width:1;" width="10" x="949.5942" y="2421.9844"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1026.751" x2="1026.751" y1="121.5625" y2="5149.7344"/><rect fill="#F0F0F0" height="2422.0625" style="stroke:#000000;stroke-width:1;" width="10" x="1021.751" y="2727.6719"/><rect fill="#F0F0F0" height="227.7656" style="stroke:#000000;stroke-width:1;" width="10" x="1026.751" y="3616.6563"/><rect fill="#F0F0F0" height="212.7656" style="stroke:#000000;stroke-width:1;" width="10" x="1026.751" y="4035.9063"/><rect fill="#F0F0F0" height="849.7813" style="stroke:#000000;stroke-width:1;" width="10" x="1026.751" y="4299.9531"/><rect fill="#F0F0F0" height="324.9688" style="stroke:#000000;stroke-width:1;" width="10" x="1031.751" y="4574.3594"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1175.7656" x2="1175.7656" y1="121.5625" y2="5149.7344"/><rect fill="#F0F0F0" height="138.8438" style="stroke:#000000;stroke-width:1;" width="10" x="1170.7656" y="4992.8906"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1307.1143" x2="1307.1143" y1="121.5625" y2="5149.7344"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1302.1143" y="2901.7969"/><rect fill="#F0F0F0" height="87.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1302.1143" y="3704.2188"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1302.1143" y="4129.4688"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1302.1143" y="4780.125"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1435.46" x2="1435.46" y1="121.5625" y2="5149.7344"/><rect fill="#F0F0F0" height="64.2813" style="stroke:#000000;stroke-width:1;" width="10" x="1430.46" y="5080.4531"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1520.3486" x2="1520.3486" y1="121.5625" y2="5149.7344"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="1515.3486" y="275.4063"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1515.3486" y="450.5313"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="1515.3486" y="2607.4688"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1515.3486" y="2770.9531"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1638.8506" x2="1638.8506" y1="121.5625" y2="5149.7344"/><rect fill="#F0F0F0" height="310.3281" style="stroke:#000000;stroke-width:1;" width="10" x="1633.8506" y="1451.3594"/><rect fill="#F0F0F0" height="94.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1633.8506" y="4325.5938"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1724.8281" x2="1724.8281" y1="121.5625" y2="5149.7344"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="1719.8281" y="3021"/><text fill="#000000" font-family="sans-serif" font-size="10" x="9.6035" y="119.2041">User</text><ellipse cx="24" cy="58.4219" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M24,66.4219 L24,93.4219 M11,74.4219 L37,74.4219 M24,93.4219 L11,108.4219 M24,93.4219 L37,108.4219 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="48.3965" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="55.3965" y="111.2041">User Agent</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="147.2695" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="171.8989" y="99.5635">Mail</text><text fill="#000000" font-family="sans-serif" font-size="10" x="154.2695" y="111.2041">User Agent</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="42.9502" x="287.8174" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="294.8174" y="111.2041">Client</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="111.085" x="398.7998" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="417.2354" y="99.5635">Android TEE or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="405.7998" y="111.2041">iOS Secure Enclave</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="539.2515" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="551.2637" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="546.2515" y="111.2041">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="659.3794" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="685.7104" y="99.5635">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="666.3794" y="111.2041">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="785.9624" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="816.3682" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="792.9624" y="111.2041">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="924.3301" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="931.3301" y="99.5635">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="938.1978" y="111.2041">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="1004.8584" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1016.8706" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1011.8584" y="111.2041">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="1140.2451" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1166.5762" y="99.5635">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1147.2451" y="111.2041">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="1266.8281" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1297.2339" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1273.8281" y="111.2041">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="1405.1958" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1412.1958" y="99.5635">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1419.0635" y="111.2041">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.249" x="1485.7241" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1492.7241" y="99.5635">Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1501.8696" y="111.2041">Service</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="30.6797" x="1623.5107" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1630.5107" y="111.2041">IDP</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="70.9775" x="1689.3394" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1696.3394" y="99.5635">Federation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1707.7529" y="111.2041">Master</text><text fill="#000000" font-family="sans-serif" font-size="10" x="9.6035" y="5219.0166">User</text><ellipse cx="24" cy="5158.2344" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M24,5166.2344 L24,5193.2344 M11,5174.2344 L37,5174.2344 M24,5193.2344 L11,5208.2344 M24,5193.2344 L37,5208.2344 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="48.3965" y="5149.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="55.3965" y="5166.0166">User Agent</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="147.2695" y="5149.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="171.8989" y="5166.0166">Mail</text><text fill="#000000" font-family="sans-serif" font-size="10" x="154.2695" y="5177.6572">User Agent</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="42.9502" x="287.8174" y="5149.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="294.8174" y="5166.0166">Client</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="111.085" x="398.7998" y="5149.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="417.2354" y="5166.0166">Android TEE or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="405.7998" y="5177.6572">iOS Secure Enclave</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="539.2515" y="5149.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="551.2637" y="5166.0166">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="546.2515" y="5177.6572">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="659.3794" y="5149.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="685.7104" y="5166.0166">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="666.3794" y="5177.6572">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="785.9624" y="5149.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="816.3682" y="5166.0166">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="792.9624" y="5177.6572">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="924.3301" y="5149.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="931.3301" y="5166.0166">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="938.1978" y="5177.6572">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="1004.8584" y="5149.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1016.8706" y="5166.0166">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1011.8584" y="5177.6572">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="1140.2451" y="5149.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1166.5762" y="5166.0166">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1147.2451" y="5177.6572">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="1266.8281" y="5149.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1297.2339" y="5166.0166">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1273.8281" y="5177.6572">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="1405.1958" y="5149.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1412.1958" y="5166.0166">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1419.0635" y="5177.6572">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.249" x="1485.7241" y="5149.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1492.7241" y="5166.0166">Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1501.8696" y="5177.6572">Service</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="30.6797" x="1623.5107" y="5149.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1630.5107" y="5166.0166">IDP</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="70.9775" x="1689.3394" y="5149.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1696.3394" y="5166.0166">Federation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1707.7529" y="5177.6572">Master</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1801.2568" x="5" y="148.3828"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1806.2568" y1="148.3828" y2="148.3828"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1806.2568" y1="151.3828" y2="151.3828"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="458.5898" x="676.3335" y="139.5625"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="682.3335" y="152.8447">Client Registration with Resource Server A (with Client Attestation and Email)</text><polygon fill="#000000" points="292.2925,182.8438,302.2925,186.8438,292.2925,190.8438,296.2925,186.8438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="298.2925" y1="186.8438" y2="186.8438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="31" y="182.4854">User Starts Registration</text><polygon fill="#000000" points="437.3423,220.125,447.3423,224.125,437.3423,228.125,441.3423,224.125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="443.3423" y1="224.125" y2="224.125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="208.126">Generate Key Pair</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="219.7666">for Attestation</text><path d="M464.3423,199.8438 L464.3423,220.8438 L690.3423,220.8438 L690.3423,209.8438 L680.3423,199.8438 L464.3423,199.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M680.3423,199.8438 L680.3423,209.8438 L690.3423,209.8438 L680.3423,199.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="470.3423" y="214.126">Using Android TEE or iOS Secure Enclave</text><polygon fill="#000000" points="325.2925,245.7656,315.2925,249.7656,325.2925,253.7656,321.2925,249.7656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="448.3423" y1="249.7656" y2="249.7656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="245.4072">Public Key</text><polygon fill="#000000" points="1503.3486,271.4063,1513.3486,275.4063,1503.3486,279.4063,1507.3486,275.4063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="1509.3486" y1="275.4063" y2="275.4063"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="271.0479">Request Attestation Challenge</text><polygon fill="#000000" points="325.2925,297.0469,315.2925,301.0469,325.2925,305.0469,321.2925,301.0469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="1514.3486" y1="301.0469" y2="301.0469"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="296.6885">Attestation Challenge</text><polygon fill="#000000" points="437.3423,334.3281,447.3423,338.3281,437.3423,342.3281,441.3423,338.3281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="443.3423" y1="338.3281" y2="338.3281"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="322.3291">Sign Challenge with</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="333.9697">Attestation Key</text><path d="M464.3423,314.0469 L464.3423,347.0469 L691.3423,347.0469 L691.3423,324.0469 L681.3423,314.0469 L464.3423,314.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M681.3423,314.0469 L681.3423,324.0469 L691.3423,324.0469 L681.3423,314.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="470.3423" y="328.3291">Using Android SafetyNet/Play Integrity or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="470.3423" y="339.9697">iOS DeviceCheck/App Attest API</text><polygon fill="#000000" points="325.2925,365.9688,315.2925,369.9688,325.2925,373.9688,321.2925,369.9688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="448.3423" y1="369.9688" y2="369.9688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="365.6104">Attestation Statement</text><polygon fill="#000000" points="544.144,391.6094,554.144,395.6094,544.144,399.6094,548.144,395.6094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="550.144" y1="395.6094" y2="395.6094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="391.251">Client Registration Request</text><path d="M571.144,382.9688 L571.144,426.9688 L806.144,426.9688 L806.144,392.9688 L796.144,382.9688 L571.144,382.9688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M796.144,382.9688 L796.144,392.9688 L806.144,392.9688 L796.144,382.9688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="577.144" y="397.251">client_instance.yaml</text><text fill="#000000" font-family="sans-serif" font-size="10" x="577.144" y="408.8916">Includes attestation statement, public key,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="577.144" y="420.5322">User Email and software statement</text><polygon fill="#000000" points="1503.3486,446.5313,1513.3486,450.5313,1503.3486,454.5313,1507.3486,450.5313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="566.144" x2="1509.3486" y1="450.5313" y2="450.5313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="446.1729">Verify Client Attestation</text><path d="M1530.3486,437.8906 L1530.3486,470.8906 L1704.3486,470.8906 L1704.3486,447.8906 L1694.3486,437.8906 L1530.3486,437.8906 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1694.3486,437.8906 L1694.3486,447.8906 L1704.3486,447.8906 L1694.3486,437.8906 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1536.3486" y="452.1729">AS A forwards attestation data</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1536.3486" y="463.8135">to Attestation Service</text><line style="stroke:#000000;stroke-width:1;" x1="1525.3486" x2="1567.3486" y1="505.4531" y2="505.4531"/><line style="stroke:#000000;stroke-width:1;" x1="1567.3486" x2="1567.3486" y1="505.4531" y2="518.4531"/><line style="stroke:#000000;stroke-width:1;" x1="1526.3486" x2="1567.3486" y1="518.4531" y2="518.4531"/><polygon fill="#000000" points="1536.3486,514.4531,1526.3486,518.4531,1536.3486,522.4531,1532.3486,518.4531" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1532.3486" y="489.4541">Validate Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1532.3486" y="501.0947">Statement</text><polygon fill="#000000" points="577.144,540.0938,567.144,544.0938,577.144,548.0938,573.144,544.0938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="571.144" x2="1514.3486" y1="544.0938" y2="544.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="583.144" y="539.7354">Attestation Verification Result</text><polygon fill="#000000" points="809.2485,577.375,819.2485,581.375,809.2485,585.375,813.2485,581.375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="566.144" x2="815.2485" y1="581.375" y2="581.375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="565.376">Request Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="577.0166">Registration Decision</text><path d="M836.2485,557.0938 L836.2485,590.0938 L1060.2485,590.0938 L1060.2485,567.0938 L1050.2485,557.0938 L836.2485,557.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1050.2485,557.0938 L1050.2485,567.0938 L1060.2485,567.0938 L1050.2485,557.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="842.2485" y="571.376">AS A sends input data to Policy Engine A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="842.2485" y="583.0166">for registration request</text><line style="stroke:#000000;stroke-width:1;" x1="831.2485" x2="873.2485" y1="624.6563" y2="624.6563"/><line style="stroke:#000000;stroke-width:1;" x1="873.2485" x2="873.2485" y1="624.6563" y2="637.6563"/><line style="stroke:#000000;stroke-width:1;" x1="832.2485" x2="873.2485" y1="637.6563" y2="637.6563"/><polygon fill="#000000" points="842.2485,633.6563,832.2485,637.6563,842.2485,641.6563,838.2485,637.6563" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="838.2485" y="608.6572">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="838.2485" y="620.2979">on Input Data</text><polygon fill="#000000" points="577.144,670.9375,567.144,674.9375,577.144,678.9375,573.144,674.9375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="571.144" x2="820.2485" y1="674.9375" y2="674.9375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="583.144" y="658.9385">Client Registration</text><text fill="#000000" font-family="sans-serif" font-size="10" x="583.144" y="670.5791">Decision (Permit/Deny)</text><line style="stroke:#000000;stroke-width:1;" x1="566.144" x2="608.144" y1="712.2188" y2="712.2188"/><line style="stroke:#000000;stroke-width:1;" x1="608.144" x2="608.144" y1="712.2188" y2="725.2188"/><line style="stroke:#000000;stroke-width:1;" x1="567.144" x2="608.144" y1="725.2188" y2="725.2188"/><polygon fill="#000000" points="577.144,721.2188,567.144,725.2188,577.144,729.2188,573.144,725.2188" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="696.2197">Generate Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="707.8604">Link and send Email</text><line style="stroke:#000000;stroke-width:1;" x1="187.0552" x2="229.0552" y1="750.8594" y2="750.8594"/><line style="stroke:#000000;stroke-width:1;" x1="229.0552" x2="229.0552" y1="750.8594" y2="763.8594"/><line style="stroke:#000000;stroke-width:1;" x1="188.0552" x2="229.0552" y1="763.8594" y2="763.8594"/><polygon fill="#000000" points="198.0552,759.8594,188.0552,763.8594,198.0552,767.8594,194.0552,763.8594" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="194.0552" y="746.501">Receive Email</text><polygon fill="#000000" points="165.0552,797.1406,175.0552,801.1406,165.0552,805.1406,169.0552,801.1406" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="171.0552" y1="801.1406" y2="801.1406"/><text fill="#000000" font-family="sans-serif" font-size="10" x="31" y="785.1416">Click Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="31" y="796.7822">Link in Email</text><polygon fill="#000000" points="99.1821,846.0625,89.1821,850.0625,99.1821,854.0625,95.1821,850.0625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="93.1821" x2="176.0552" y1="850.0625" y2="850.0625"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="822.4229">Open</text><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="834.0635">Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="845.7041">Link</text><polygon fill="#000000" points="544.144,883.3438,554.144,887.3438,544.144,891.3438,548.144,887.3438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="550.144" y1="887.3438" y2="887.3438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="871.3447">Email Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="882.9854">Request</text><line style="stroke:#000000;stroke-width:1;" x1="566.144" x2="608.144" y1="936.2656" y2="936.2656"/><line style="stroke:#000000;stroke-width:1;" x1="608.144" x2="608.144" y1="936.2656" y2="949.2656"/><line style="stroke:#000000;stroke-width:1;" x1="567.144" x2="608.144" y1="949.2656" y2="949.2656"/><polygon fill="#000000" points="577.144,945.2656,567.144,949.2656,577.144,953.2656,573.144,949.2656" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="908.626">Verify Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="920.2666">Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="931.9072">Request</text><line style="stroke:#000000;stroke-width:1;" x1="566.144" x2="608.144" y1="986.5469" y2="986.5469"/><line style="stroke:#000000;stroke-width:1;" x1="608.144" x2="608.144" y1="986.5469" y2="999.5469"/><line style="stroke:#000000;stroke-width:1;" x1="567.144" x2="608.144" y1="999.5469" y2="999.5469"/><polygon fill="#000000" points="577.144,995.5469,567.144,999.5469,577.144,1003.5469,573.144,999.5469" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="970.5479">Generate Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="982.1885">Confirmation JWT</text><path d="M672.1411,962.2656 L672.1411,1053.2656 L846.1411,1053.2656 L846.1411,972.2656 L836.1411,962.2656 L672.1411,962.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M836.1411,962.2656 L836.1411,972.2656 L846.1411,972.2656 L836.1411,962.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="678.1411" y="976.5479">JWT Claims:</text><text fill="#000000" font-family="sans-serif" font-size="10" x="681.3198" y="988.1885">- iss: AS_A_ID</text><text fill="#000000" font-family="sans-serif" font-size="10" x="681.3198" y="999.8291">- sub: User_id</text><text fill="#000000" font-family="sans-serif" font-size="10" x="681.3198" y="1011.4697">- aud: (all AS)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="681.3198" y="1023.1104">- exp: (Policy Engine decision)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="681.3198" y="1034.751">- iat: (now)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="681.3198" y="1046.3916">- Email_verified: true</text><polygon fill="#000000" points="325.2925,1084.0313,315.2925,1088.0313,325.2925,1092.0313,321.2925,1088.0313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="555.144" y1="1088.0313" y2="1088.0313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="1072.0322">Client Registration Response</text><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="1083.6729">(client_id, Email Confirmation JWT)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1801.2568" x="5" y="1114.8516"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1806.2568" y1="1114.8516" y2="1114.8516"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1806.2568" y1="1117.8516" y2="1117.8516"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="480.8311" x="665.2129" y="1106.0313"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="671.2129" y="1119.3135">OAuth 2.0 Authorization Code Flow with PAR, PKCE and DPoP (Resource Server A)</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="1164.9531" y2="1164.9531"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="1164.9531" y2="1177.9531"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="1177.9531" y2="1177.9531"/><polygon fill="#000000" points="325.2925,1173.9531,315.2925,1177.9531,325.2925,1181.9531,321.2925,1177.9531" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1148.9541">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1160.5947">Code Verifier</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="1215.2344" y2="1215.2344"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="1215.2344" y2="1228.2344"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="1228.2344" y2="1228.2344"/><polygon fill="#000000" points="325.2925,1224.2344,315.2925,1228.2344,325.2925,1232.2344,321.2925,1228.2344" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1199.2354">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1210.876">Code Challenge</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="1253.875" y2="1253.875"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="1253.875" y2="1266.875"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="1266.875" y2="1266.875"/><polygon fill="#000000" points="325.2925,1262.875,315.2925,1266.875,325.2925,1270.875,321.2925,1266.875" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1249.5166">Generate DPoP Key Pair</text><polygon fill="#000000" points="544.144,1300.1563,554.144,1304.1563,544.144,1308.1563,548.144,1304.1563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="550.144" y1="1304.1563" y2="1304.1563"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1288.1572">PAR Request</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1299.7979">(client_id, redirect_uri, scope, etc., dpop_jkt)</text><path d="M571.144,1279.875 L571.144,1312.875 L954.144,1312.875 L954.144,1289.875 L944.144,1279.875 L571.144,1279.875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M944.144,1279.875 L944.144,1289.875 L954.144,1289.875 L944.144,1279.875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="577.144" y="1294.1572">Authorization Code Request</text><text fill="#000000" font-family="sans-serif" font-size="10" x="577.144" y="1305.7979">(inkl. DPoP Proof, code_challenge, code_challenge_method, redirect_uri)</text><line style="stroke:#000000;stroke-width:1;" x1="566.144" x2="608.144" y1="1335.7969" y2="1335.7969"/><line style="stroke:#000000;stroke-width:1;" x1="608.144" x2="608.144" y1="1335.7969" y2="1348.7969"/><line style="stroke:#000000;stroke-width:1;" x1="567.144" x2="608.144" y1="1348.7969" y2="1348.7969"/><polygon fill="#000000" points="577.144,1344.7969,567.144,1348.7969,577.144,1352.7969,573.144,1348.7969" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="1331.4385">Validate DPoP Proof</text><polygon fill="#000000" points="325.2925,1370.4375,315.2925,1374.4375,325.2925,1378.4375,321.2925,1374.4375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="555.144" y1="1374.4375" y2="1374.4375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="1370.0791">Request URI</text><polygon fill="#000000" points="99.1821,1396.0781,89.1821,1400.0781,99.1821,1404.0781,95.1821,1400.0781" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="93.1821" x2="303.2925" y1="1400.0781" y2="1400.0781"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1395.7197">Navigate to Request URI</text><polygon fill="#000000" points="544.144,1421.7188,554.144,1425.7188,544.144,1429.7188,548.144,1425.7188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="550.144" y1="1425.7188" y2="1425.7188"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1421.3604">Authorization Request (with Request URI)</text><polygon fill="#000000" points="1621.8506,1447.3594,1631.8506,1451.3594,1621.8506,1455.3594,1625.8506,1451.3594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="566.144" x2="1627.8506" y1="1451.3594" y2="1451.3594"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="1447.001">PAR Request (OpenID Connect), redirect_uri</text><path d="M1648.8506,1438.7188 L1648.8506,1471.7188 L1800.8506,1471.7188 L1800.8506,1448.7188 L1790.8506,1438.7188 L1648.8506,1438.7188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1790.8506,1438.7188 L1790.8506,1448.7188 L1800.8506,1448.7188 L1790.8506,1438.7188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1654.8506" y="1453.001">AS A acts as Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1658.0293" y="1464.6416">for the IDP</text><polygon fill="#000000" points="577.144,1490.6406,567.144,1494.6406,577.144,1498.6406,573.144,1494.6406" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="571.144" x2="1632.8506" y1="1494.6406" y2="1494.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" x="583.144" y="1490.2822">PAR Response, request_uri, expires_in</text><polygon fill="#000000" points="99.1821,1516.2813,89.1821,1520.2813,99.1821,1524.2813,95.1821,1520.2813" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="555.144" y1="1520.2813" y2="1520.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1515.9229">Redirect to IDP, request_uri</text><polygon fill="#000000" points="1621.8506,1541.9219,1631.8506,1545.9219,1621.8506,1549.9219,1625.8506,1545.9219" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="1627.8506" y1="1545.9219" y2="1545.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1541.5635">Navigate to request_uri</text><polygon fill="#000000" points="99.1821,1567.5625,89.1821,1571.5625,99.1821,1575.5625,95.1821,1571.5625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="1632.8506" y1="1571.5625" y2="1571.5625"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1567.2041">Authentication Prompt, consent</text><polygon fill="#000000" points="1621.8506,1593.2031,1631.8506,1597.2031,1621.8506,1601.2031,1625.8506,1597.2031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="1627.8506" y1="1597.2031" y2="1597.2031"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1592.8447">User Credentials, consent</text><polygon fill="#000000" points="99.1821,1618.8438,89.1821,1622.8438,99.1821,1626.8438,95.1821,1622.8438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="1632.8506" y1="1622.8438" y2="1622.8438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1618.4854">Redirect to ASA, auth_code, redirect_uri</text><polygon fill="#000000" points="544.144,1644.4844,554.144,1648.4844,544.144,1652.4844,548.144,1648.4844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="550.144" y1="1648.4844" y2="1648.4844"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1644.126">Redirect to ASA, auth_code, redirect_uri</text><polygon fill="#000000" points="1621.8506,1670.125,1631.8506,1674.125,1621.8506,1678.125,1625.8506,1674.125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="566.144" x2="1627.8506" y1="1674.125" y2="1674.125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="1669.7666">Token Request (Authorization Code Grant), auth_code</text><line style="stroke:#000000;stroke-width:1;" x1="1643.8506" x2="1685.8506" y1="1723.0469" y2="1723.0469"/><line style="stroke:#000000;stroke-width:1;" x1="1685.8506" x2="1685.8506" y1="1723.0469" y2="1736.0469"/><line style="stroke:#000000;stroke-width:1;" x1="1644.8506" x2="1685.8506" y1="1736.0469" y2="1736.0469"/><polygon fill="#000000" points="1654.8506,1732.0469,1644.8506,1736.0469,1654.8506,1740.0469,1650.8506,1736.0469" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1650.8506" y="1695.4072">Validate</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1650.8506" y="1707.0479">Authorization</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1650.8506" y="1718.6885">Code</text><polygon fill="#000000" points="577.144,1757.6875,567.144,1761.6875,577.144,1765.6875,573.144,1761.6875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="571.144" x2="1632.8506" y1="1761.6875" y2="1761.6875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="583.144" y="1757.3291">Authentication Response (ID Token)</text><line style="stroke:#000000;stroke-width:1;" x1="566.144" x2="608.144" y1="1798.9688" y2="1798.9688"/><line style="stroke:#000000;stroke-width:1;" x1="608.144" x2="608.144" y1="1798.9688" y2="1811.9688"/><line style="stroke:#000000;stroke-width:1;" x1="567.144" x2="608.144" y1="1811.9688" y2="1811.9688"/><polygon fill="#000000" points="577.144,1807.9688,567.144,1811.9688,577.144,1815.9688,573.144,1811.9688" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="1782.9697">Validate</text><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="1794.6104">ID Token</text><polygon fill="#000000" points="99.1821,1833.6094,89.1821,1837.6094,99.1821,1841.6094,95.1821,1837.6094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="555.144" y1="1837.6094" y2="1837.6094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1833.251">Authorization Code</text><polygon fill="#000000" points="292.2925,1859.25,302.2925,1863.25,292.2925,1867.25,296.2925,1863.25" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="298.2925" y1="1863.25" y2="1863.25"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1858.8916">Redirect with Authorization Code</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="1900.5313" y2="1900.5313"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="1900.5313" y2="1913.5313"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="1913.5313" y2="1913.5313"/><polygon fill="#000000" points="325.2925,1909.5313,315.2925,1913.5313,325.2925,1917.5313,321.2925,1913.5313" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1884.5322">Generate</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1896.1729">DPoP Proof JWT</text><polygon fill="#000000" points="544.144,1935.1719,554.144,1939.1719,544.144,1943.1719,548.144,1939.1719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="550.144" y1="1939.1719" y2="1939.1719"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1934.8135">Token Request (Authorization Code Grant)</text><path d="M571.144,1926.5313 L571.144,1959.5313 L791.144,1959.5313 L791.144,1936.5313 L781.144,1926.5313 L571.144,1926.5313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M781.144,1926.5313 L781.144,1936.5313 L791.144,1936.5313 L781.144,1926.5313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="577.144" y="1940.8135">Enth&#228;lt Authorization Code, DPoP Proof,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="577.144" y="1952.4541">client_id, redirect_uri, code_verifier</text><line style="stroke:#000000;stroke-width:1;" x1="566.144" x2="608.144" y1="1994.0938" y2="1994.0938"/><line style="stroke:#000000;stroke-width:1;" x1="608.144" x2="608.144" y1="1994.0938" y2="2007.0938"/><line style="stroke:#000000;stroke-width:1;" x1="567.144" x2="608.144" y1="2007.0938" y2="2007.0938"/><polygon fill="#000000" points="577.144,2003.0938,567.144,2007.0938,577.144,2011.0938,573.144,2007.0938" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="1978.0947">Validate</text><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="1989.7354">Authorization Code</text><line style="stroke:#000000;stroke-width:1;" x1="566.144" x2="608.144" y1="2032.7344" y2="2032.7344"/><line style="stroke:#000000;stroke-width:1;" x1="608.144" x2="608.144" y1="2032.7344" y2="2045.7344"/><line style="stroke:#000000;stroke-width:1;" x1="567.144" x2="608.144" y1="2045.7344" y2="2045.7344"/><polygon fill="#000000" points="577.144,2041.7344,567.144,2045.7344,577.144,2049.7344,573.144,2045.7344" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="2028.376">Validate DPoP Proof</text><line style="stroke:#000000;stroke-width:1;" x1="566.144" x2="608.144" y1="2083.0156" y2="2083.0156"/><line style="stroke:#000000;stroke-width:1;" x1="608.144" x2="608.144" y1="2083.0156" y2="2096.0156"/><line style="stroke:#000000;stroke-width:1;" x1="567.144" x2="608.144" y1="2096.0156" y2="2096.0156"/><polygon fill="#000000" points="577.144,2092.0156,567.144,2096.0156,577.144,2100.0156,573.144,2096.0156" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="2067.0166">Validate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="2078.6572">Code Verifier</text><polygon fill="#000000" points="809.2485,2117.6563,819.2485,2121.6563,809.2485,2125.6563,813.2485,2121.6563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="566.144" x2="815.2485" y1="2121.6563" y2="2121.6563"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="2117.2979">Request Token Issuance Decision</text><path d="M836.2485,2109.0156 L836.2485,2142.0156 L1060.2485,2142.0156 L1060.2485,2119.0156 L1050.2485,2109.0156 L836.2485,2109.0156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1050.2485,2109.0156 L1050.2485,2119.0156 L1060.2485,2119.0156 L1050.2485,2109.0156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="842.2485" y="2123.2979">AS A sends input data to Policy Engine A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="842.2485" y="2134.9385">for token request</text><line style="stroke:#000000;stroke-width:1;" x1="831.2485" x2="873.2485" y1="2176.5781" y2="2176.5781"/><line style="stroke:#000000;stroke-width:1;" x1="873.2485" x2="873.2485" y1="2176.5781" y2="2189.5781"/><line style="stroke:#000000;stroke-width:1;" x1="832.2485" x2="873.2485" y1="2189.5781" y2="2189.5781"/><polygon fill="#000000" points="842.2485,2185.5781,832.2485,2189.5781,842.2485,2193.5781,838.2485,2189.5781" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="838.2485" y="2160.5791">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="838.2485" y="2172.2197">on Input Data</text><polygon fill="#000000" points="577.144,2211.2188,567.144,2215.2188,577.144,2219.2188,573.144,2215.2188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="571.144" x2="820.2485" y1="2215.2188" y2="2215.2188"/><text fill="#000000" font-family="sans-serif" font-size="10" x="583.144" y="2210.8604">Token Issuance Decision (Permit/Deny)</text><polygon fill="#000000" points="325.2925,2236.8594,315.2925,2240.8594,325.2925,2244.8594,321.2925,2240.8594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="555.144" y1="2240.8594" y2="2240.8594"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="2236.501">Access Token, Refresh Token</text><path d="M164.5034,2228.2188 L164.5034,2261.2188 L303.5034,2261.2188 L303.5034,2238.2188 L293.5034,2228.2188 L164.5034,2228.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M293.5034,2228.2188 L293.5034,2238.2188 L303.5034,2238.2188 L293.5034,2228.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="170.5034" y="2242.501">Access Token bound to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="170.5034" y="2254.1416">client's DPoP public key</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="2284.1406" y2="2284.1406"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="2284.1406" y2="2297.1406"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="2297.1406" y2="2297.1406"/><polygon fill="#000000" points="325.2925,2293.1406,315.2925,2297.1406,325.2925,2301.1406,321.2925,2297.1406" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2279.7822">Generate DPoP Token</text><polygon fill="#000000" points="677.8999,2330.4219,687.8999,2334.4219,677.8999,2338.4219,681.8999,2334.4219" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="683.8999" y1="2334.4219" y2="2334.4219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2318.4229">Access Protected Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2330.0635">(with Access Token and DPoP Proof)</text><line style="stroke:#000000;stroke-width:1;" x1="699.8999" x2="741.8999" y1="2371.7031" y2="2371.7031"/><line style="stroke:#000000;stroke-width:1;" x1="741.8999" x2="741.8999" y1="2371.7031" y2="2384.7031"/><line style="stroke:#000000;stroke-width:1;" x1="700.8999" x2="741.8999" y1="2384.7031" y2="2384.7031"/><polygon fill="#000000" points="710.8999,2380.7031,700.8999,2384.7031,710.8999,2388.7031,706.8999,2384.7031" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="706.8999" y="2355.7041">Validate Access Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="706.8999" y="2367.3447">and DPoP Proof</text><polygon fill="#000000" points="937.5942,2417.9844,947.5942,2421.9844,937.5942,2425.9844,941.5942,2421.9844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="699.8999" x2="943.5942" y1="2421.9844" y2="2421.9844"/><text fill="#000000" font-family="sans-serif" font-size="10" x="706.8999" y="2405.9854">Forward Request to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="706.8999" y="2417.626">Resource Server A</text><polygon fill="#000000" points="710.8999,2443.625,700.8999,2447.625,710.8999,2451.625,706.8999,2447.625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="704.8999" x2="948.5942" y1="2447.625" y2="2447.625"/><text fill="#000000" font-family="sans-serif" font-size="10" x="716.8999" y="2443.2666">Resource Data</text><polygon fill="#000000" points="325.2925,2469.2656,315.2925,2473.2656,325.2925,2477.2656,321.2925,2473.2656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="688.8999" y1="2473.2656" y2="2473.2656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="2468.9072">Resource Data</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1801.2568" x="5" y="2500.0859"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1806.2568" y1="2500.0859" y2="2500.0859"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1806.2568" y1="2503.0859" y2="2503.0859"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="449.1904" x="681.0332" y="2491.2656"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="687.0332" y="2504.5479">Client Registration with Resource Server B (with Client Attestation and JWT)</text><polygon fill="#000000" points="437.3423,2546.1875,447.3423,2550.1875,437.3423,2554.1875,441.3423,2550.1875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="443.3423" y1="2550.1875" y2="2550.1875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2534.1885">Generate Key Pair</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2545.8291">for Attestation</text><path d="M464.3423,2525.9063 L464.3423,2558.9063 L590.3423,2558.9063 L590.3423,2535.9063 L580.3423,2525.9063 L464.3423,2525.9063 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M580.3423,2525.9063 L580.3423,2535.9063 L590.3423,2535.9063 L580.3423,2525.9063 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="470.3423" y="2540.1885">Using Android TEE or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="470.3423" y="2551.8291">iOS Secure Enclave</text><polygon fill="#000000" points="325.2925,2577.8281,315.2925,2581.8281,325.2925,2585.8281,321.2925,2581.8281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="448.3423" y1="2581.8281" y2="2581.8281"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="2577.4697">Public Key</text><polygon fill="#000000" points="1503.3486,2603.4688,1513.3486,2607.4688,1503.3486,2611.4688,1507.3486,2607.4688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="1509.3486" y1="2607.4688" y2="2607.4688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2603.1104">Request Attestation Challenge</text><polygon fill="#000000" points="325.2925,2629.1094,315.2925,2633.1094,325.2925,2637.1094,321.2925,2633.1094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="1514.3486" y1="2633.1094" y2="2633.1094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="2628.751">Attestation Challenge</text><polygon fill="#000000" points="437.3423,2666.3906,447.3423,2670.3906,437.3423,2674.3906,441.3423,2670.3906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="443.3423" y1="2670.3906" y2="2670.3906"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2654.3916">Sign Challenge with</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2666.0322">Attestation Key</text><path d="M464.3423,2646.1094 L464.3423,2679.1094 L691.3423,2679.1094 L691.3423,2656.1094 L681.3423,2646.1094 L464.3423,2646.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M681.3423,2646.1094 L681.3423,2656.1094 L691.3423,2656.1094 L681.3423,2646.1094 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="470.3423" y="2660.3916">Using Android SafetyNet/Play Integrity or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="470.3423" y="2672.0322">iOS DeviceCheck/App Attest API</text><polygon fill="#000000" points="325.2925,2698.0313,315.2925,2702.0313,325.2925,2706.0313,321.2925,2702.0313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="448.3423" y1="2702.0313" y2="2702.0313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="2697.6729">Attestation Statement</text><polygon fill="#000000" points="1009.751,2723.6719,1019.751,2727.6719,1009.751,2731.6719,1013.751,2727.6719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="1015.751" y1="2727.6719" y2="2727.6719"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2723.3135">Client Registration Request (Resource Server B, with Email Confirmation JWT)</text><path d="M1036.751,2715.0313 L1036.751,2748.0313 L1290.751,2748.0313 L1290.751,2725.0313 L1280.751,2715.0313 L1036.751,2715.0313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1280.751,2715.0313 L1280.751,2725.0313 L1290.751,2725.0313 L1280.751,2715.0313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1042.751" y="2729.3135">Includes attestation statement, public key,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1042.751" y="2740.9541">User Email and potentially software statement</text><polygon fill="#000000" points="1503.3486,2766.9531,1513.3486,2770.9531,1503.3486,2774.9531,1507.3486,2770.9531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1031.751" x2="1509.3486" y1="2770.9531" y2="2770.9531"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="2766.5947">Verify Client Attestation</text><path d="M1530.3486,2758.3125 L1530.3486,2791.3125 L1704.3486,2791.3125 L1704.3486,2768.3125 L1694.3486,2758.3125 L1530.3486,2758.3125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1694.3486,2758.3125 L1694.3486,2768.3125 L1704.3486,2768.3125 L1694.3486,2758.3125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1536.3486" y="2772.5947">AS B forwards attestation data</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1536.3486" y="2784.2354">to Attestation Service</text><line style="stroke:#000000;stroke-width:1;" x1="1525.3486" x2="1567.3486" y1="2825.875" y2="2825.875"/><line style="stroke:#000000;stroke-width:1;" x1="1567.3486" x2="1567.3486" y1="2825.875" y2="2838.875"/><line style="stroke:#000000;stroke-width:1;" x1="1526.3486" x2="1567.3486" y1="2838.875" y2="2838.875"/><polygon fill="#000000" points="1536.3486,2834.875,1526.3486,2838.875,1536.3486,2842.875,1532.3486,2838.875" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1532.3486" y="2809.876">Validate Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1532.3486" y="2821.5166">Statement</text><polygon fill="#000000" points="1042.751,2860.5156,1032.751,2864.5156,1042.751,2868.5156,1038.751,2864.5156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1036.751" x2="1514.3486" y1="2864.5156" y2="2864.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1048.751" y="2860.1572">Attestation Verification Result</text><polygon fill="#000000" points="1290.1143,2897.7969,1300.1143,2901.7969,1290.1143,2905.7969,1294.1143,2901.7969" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1031.751" x2="1296.1143" y1="2901.7969" y2="2901.7969"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="2885.7979">Request Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="2897.4385">Registration Decision</text><path d="M1317.1143,2877.5156 L1317.1143,2910.5156 L1541.1143,2910.5156 L1541.1143,2887.5156 L1531.1143,2877.5156 L1317.1143,2877.5156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1531.1143,2877.5156 L1531.1143,2887.5156 L1541.1143,2887.5156 L1531.1143,2877.5156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1323.1143" y="2891.7979">AS B sends input data to Policy Engine B</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1323.1143" y="2903.4385">for registration request</text><line style="stroke:#000000;stroke-width:1;" x1="1312.1143" x2="1354.1143" y1="2945.0781" y2="2945.0781"/><line style="stroke:#000000;stroke-width:1;" x1="1354.1143" x2="1354.1143" y1="2945.0781" y2="2958.0781"/><line style="stroke:#000000;stroke-width:1;" x1="1313.1143" x2="1354.1143" y1="2958.0781" y2="2958.0781"/><polygon fill="#000000" points="1323.1143,2954.0781,1313.1143,2958.0781,1323.1143,2962.0781,1319.1143,2958.0781" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1319.1143" y="2929.0791">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1319.1143" y="2940.7197">on Input Data</text><polygon fill="#000000" points="1042.751,2991.3594,1032.751,2995.3594,1042.751,2999.3594,1038.751,2995.3594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1036.751" x2="1301.1143" y1="2995.3594" y2="2995.3594"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1048.751" y="2979.3604">Client Registration</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1048.751" y="2991.001">Decision (Permit/Deny)</text><polygon fill="#000000" points="1707.8281,3017,1717.8281,3021,1707.8281,3025,1711.8281,3021" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1031.751" x2="1713.8281" y1="3021" y2="3021"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="3016.6416">Get Entity Statement from Federation Master</text><polygon fill="#000000" points="1042.751,3042.6406,1032.751,3046.6406,1042.751,3050.6406,1038.751,3046.6406" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1036.751" x2="1718.8281" y1="3046.6406" y2="3046.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1048.751" y="3042.2822">Entity Statement from Federation Master</text><line style="stroke:#000000;stroke-width:1;" x1="1031.751" x2="1073.751" y1="3083.9219" y2="3083.9219"/><line style="stroke:#000000;stroke-width:1;" x1="1073.751" x2="1073.751" y1="3083.9219" y2="3096.9219"/><line style="stroke:#000000;stroke-width:1;" x1="1032.751" x2="1073.751" y1="3096.9219" y2="3096.9219"/><polygon fill="#000000" points="1042.751,3092.9219,1032.751,3096.9219,1042.751,3100.9219,1038.751,3096.9219" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="3067.9229">Extract "iss" (AS_A_ID)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="3079.5635">and "aud" from JWT</text><line style="stroke:#000000;stroke-width:1;" x1="1031.751" x2="1073.751" y1="3157.4844" y2="3157.4844"/><line style="stroke:#000000;stroke-width:1;" x1="1073.751" x2="1073.751" y1="3157.4844" y2="3170.4844"/><line style="stroke:#000000;stroke-width:1;" x1="1032.751" x2="1073.751" y1="3170.4844" y2="3170.4844"/><polygon fill="#000000" points="1042.751,3166.4844,1032.751,3170.4844,1042.751,3174.4844,1038.751,3170.4844" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="3118.2041">Get Entity Statement</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="3129.8447">URL for AS A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="3141.4854">from Federation Master</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="3153.126">Entity Statement</text><polygon fill="#000000" points="577.144,3192.125,567.144,3196.125,577.144,3200.125,573.144,3196.125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="571.144" x2="1020.751" y1="3196.125" y2="3196.125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="583.144" y="3191.7666">Get AS A's Entity Statement</text><polygon fill="#000000" points="1009.751,3217.7656,1019.751,3221.7656,1009.751,3225.7656,1013.751,3221.7656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="566.144" x2="1015.751" y1="3221.7656" y2="3221.7656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.144" y="3217.4072">AS A's Entity Statement</text><line style="stroke:#000000;stroke-width:1;" x1="1031.751" x2="1073.751" y1="3270.6875" y2="3270.6875"/><line style="stroke:#000000;stroke-width:1;" x1="1073.751" x2="1073.751" y1="3270.6875" y2="3283.6875"/><line style="stroke:#000000;stroke-width:1;" x1="1032.751" x2="1073.751" y1="3283.6875" y2="3283.6875"/><polygon fill="#000000" points="1042.751,3279.6875,1032.751,3283.6875,1042.751,3287.6875,1038.751,3283.6875" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="3243.0479">Verify JWT Signature</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="3254.6885">(using AS A's Public Key</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="3266.3291">from Entity Statement)</text><line style="stroke:#000000;stroke-width:1;" x1="1031.751" x2="1073.751" y1="3332.6094" y2="3332.6094"/><line style="stroke:#000000;stroke-width:1;" x1="1073.751" x2="1073.751" y1="3332.6094" y2="3345.6094"/><line style="stroke:#000000;stroke-width:1;" x1="1032.751" x2="1073.751" y1="3345.6094" y2="3345.6094"/><polygon fill="#000000" points="1042.751,3341.6094,1032.751,3345.6094,1042.751,3349.6094,1038.751,3345.6094" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="3304.9697">Validate JWT Claims</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="3316.6104">(iss, aud, exp,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="3328.251">iat, Email_verified)</text><path d="M8,3357.6094 L67.9561,3357.6094 L67.9561,3361.25 L57.9561,3371.25 L8,3371.25 L8,3357.6094 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="467.8125" style="stroke:#000000;stroke-width:1.5;" width="1443.46" x="8" y="3357.6094"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="23" y="3367.8916">alt</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="82.9561" y="3368.8916">[JWT Valid]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="8" x2="1451.46" y1="3429.5313" y2="3429.5313"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="13" y="3440.8135">[JWT Invalid or Expired]</text><polygon fill="#000000" points="325.2925,3406.5313,315.2925,3410.5313,325.2925,3414.5313,321.2925,3410.5313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="319.2925" x2="1020.751" y1="3410.5313" y2="3410.5313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="3394.5322">Client Registration Response</text><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="3406.1729">(without Email Confirmation JWT)</text><line style="stroke:#000000;stroke-width:1;" x1="1031.751" x2="1073.751" y1="3477.4531" y2="3477.4531"/><line style="stroke:#000000;stroke-width:1;" x1="1073.751" x2="1073.751" y1="3477.4531" y2="3490.4531"/><line style="stroke:#000000;stroke-width:1;" x1="1032.751" x2="1073.751" y1="3490.4531" y2="3490.4531"/><polygon fill="#000000" points="1042.751,3486.4531,1032.751,3490.4531,1042.751,3494.4531,1038.751,3490.4531" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="3461.4541">Generate Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.751" y="3473.0947">Confirmation Token</text><polygon fill="#000000" points="325.2925,3512.0938,315.2925,3516.0938,325.2925,3520.0938,321.2925,3516.0938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="319.2925" x2="1020.751" y1="3516.0938" y2="3516.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="3511.7354">Client Registration Response (with Email Confirmation Token)</text><path d="M1036.751,3503.4531 L1036.751,3536.4531 L1292.751,3536.4531 L1292.751,3513.4531 L1282.751,3503.4531 L1036.751,3503.4531 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1282.751,3503.4531 L1282.751,3513.4531 L1292.751,3513.4531 L1282.751,3503.4531 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1042.751" y="3517.7354">AS B sends Email Confirmation Token to client,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1042.751" y="3529.376">which will be included in Email to User</text><polygon fill="#000000" points="198.0552,3567.0156,188.0552,3571.0156,198.0552,3575.0156,194.0552,3571.0156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="192.0552" x2="303.2925" y1="3571.0156" y2="3571.0156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="204.0552" y="3555.0166">Send Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="204.0552" y="3566.6572">Email</text><path d="M319.2925,3546.7344 L319.2925,3579.7344 L508.2925,3579.7344 L508.2925,3556.7344 L498.2925,3546.7344 L319.2925,3546.7344 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M498.2925,3546.7344 L498.2925,3556.7344 L508.2925,3556.7344 L498.2925,3546.7344 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="325.2925" y="3561.0166">Client sends Email including</text><text fill="#000000" font-family="sans-serif" font-size="10" x="325.2925" y="3572.6572">Email Confirmation Token to User</text><polygon fill="#000000" points="165.0552,3587.0156,175.0552,3591.0156,165.0552,3595.0156,169.0552,3591.0156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="171.0552" y1="3591.0156" y2="3591.0156"/><polygon fill="#000000" points="1014.751,3612.6563,1024.751,3616.6563,1014.751,3620.6563,1018.751,3616.6563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="187.0552" x2="1020.751" y1="3616.6563" y2="3616.6563"/><text fill="#000000" font-family="sans-serif" font-size="10" x="194.0552" y="3612.2979">User Clicks Confirmation Link in Email</text><line style="stroke:#000000;stroke-width:1;" x1="1036.751" x2="1078.751" y1="3653.9375" y2="3653.9375"/><line style="stroke:#000000;stroke-width:1;" x1="1078.751" x2="1078.751" y1="3653.9375" y2="3666.9375"/><line style="stroke:#000000;stroke-width:1;" x1="1037.751" x2="1078.751" y1="3666.9375" y2="3666.9375"/><polygon fill="#000000" points="1047.751,3662.9375,1037.751,3666.9375,1047.751,3670.9375,1043.751,3666.9375" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1043.751" y="3637.9385">Verify Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1043.751" y="3649.5791">Confirmation Token</text><polygon fill="#000000" points="1290.1143,3700.2188,1300.1143,3704.2188,1290.1143,3708.2188,1294.1143,3704.2188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1036.751" x2="1296.1143" y1="3704.2188" y2="3704.2188"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1043.751" y="3688.2197">Request Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1043.751" y="3699.8604">Confirmation Decision</text><line style="stroke:#000000;stroke-width:1;" x1="1312.1143" x2="1354.1143" y1="3741.5" y2="3741.5"/><line style="stroke:#000000;stroke-width:1;" x1="1354.1143" x2="1354.1143" y1="3741.5" y2="3754.5"/><line style="stroke:#000000;stroke-width:1;" x1="1313.1143" x2="1354.1143" y1="3754.5" y2="3754.5"/><polygon fill="#000000" points="1323.1143,3750.5,1313.1143,3754.5,1323.1143,3758.5,1319.1143,3754.5" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1319.1143" y="3725.501">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1319.1143" y="3737.1416">on Input Data</text><polygon fill="#000000" points="1047.751,3787.7813,1037.751,3791.7813,1047.751,3795.7813,1043.751,3791.7813" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1041.751" x2="1301.1143" y1="3791.7813" y2="3791.7813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1053.751" y="3775.7822">Email Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1053.751" y="3787.4229">Decision (Permit/Deny)</text><polygon fill="#000000" points="325.2925,3813.4219,315.2925,3817.4219,325.2925,3821.4219,321.2925,3817.4219" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="319.2925" x2="1025.751" y1="3817.4219" y2="3817.4219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="3813.0635">Client Registration Response (with Email Confirmation JWT)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1801.2568" x="5" y="3858.2422"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1806.2568" y1="3858.2422" y2="3858.2422"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1806.2568" y1="3861.2422" y2="3861.2422"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="480.7139" x="665.2715" y="3849.4219"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="671.2715" y="3862.7041">OAuth 2.0 Authorization Code Flow with PAR, PKCE and DPoP (Resource Server B)</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="3908.3438" y2="3908.3438"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="3908.3438" y2="3921.3438"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="3921.3438" y2="3921.3438"/><polygon fill="#000000" points="325.2925,3917.3438,315.2925,3921.3438,325.2925,3925.3438,321.2925,3921.3438" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="3892.3447">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="3903.9854">Code Verifier</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="3958.625" y2="3958.625"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="3958.625" y2="3971.625"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="3971.625" y2="3971.625"/><polygon fill="#000000" points="325.2925,3967.625,315.2925,3971.625,325.2925,3975.625,321.2925,3971.625" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="3942.626">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="3954.2666">Code Challenge</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="3997.2656" y2="3997.2656"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="3997.2656" y2="4010.2656"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="4010.2656" y2="4010.2656"/><polygon fill="#000000" points="325.2925,4006.2656,315.2925,4010.2656,325.2925,4014.2656,321.2925,4010.2656" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="3992.9072">Generate DPoP Key Pair</text><polygon fill="#000000" points="1014.751,4031.9063,1024.751,4035.9063,1014.751,4039.9063,1018.751,4035.9063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="1020.751" y1="4035.9063" y2="4035.9063"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="4031.5479">PAR Request</text><path d="M1041.751,4023.2656 L1041.751,4056.2656 L1424.751,4056.2656 L1424.751,4033.2656 L1414.751,4023.2656 L1041.751,4023.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1414.751,4023.2656 L1414.751,4033.2656 L1424.751,4033.2656 L1414.751,4023.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1047.751" y="4037.5479">Authorization Code Request</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1047.751" y="4049.1885">(inkl. DPoP Proof, code_challenge, code_challenge_method, redirect_uri)</text><line style="stroke:#000000;stroke-width:1;" x1="1036.751" x2="1078.751" y1="4079.1875" y2="4079.1875"/><line style="stroke:#000000;stroke-width:1;" x1="1078.751" x2="1078.751" y1="4079.1875" y2="4092.1875"/><line style="stroke:#000000;stroke-width:1;" x1="1037.751" x2="1078.751" y1="4092.1875" y2="4092.1875"/><polygon fill="#000000" points="1047.751,4088.1875,1037.751,4092.1875,1047.751,4096.1875,1043.751,4092.1875" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1043.751" y="4074.8291">Validate DPoP Proof</text><polygon fill="#000000" points="1290.1143,4125.4688,1300.1143,4129.4688,1290.1143,4133.4688,1294.1143,4129.4688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1036.751" x2="1296.1143" y1="4129.4688" y2="4129.4688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1043.751" y="4113.4697">Request Authorization</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1043.751" y="4125.1104">Code Decision</text><path d="M1317.1143,4105.1875 L1317.1143,4138.1875 L1541.1143,4138.1875 L1541.1143,4115.1875 L1531.1143,4105.1875 L1317.1143,4105.1875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1531.1143,4105.1875 L1531.1143,4115.1875 L1541.1143,4115.1875 L1531.1143,4105.1875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1323.1143" y="4119.4697">AS B sends input data to Policy Engine B</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1323.1143" y="4131.1104">for authorization code request</text><line style="stroke:#000000;stroke-width:1;" x1="1312.1143" x2="1354.1143" y1="4172.75" y2="4172.75"/><line style="stroke:#000000;stroke-width:1;" x1="1354.1143" x2="1354.1143" y1="4172.75" y2="4185.75"/><line style="stroke:#000000;stroke-width:1;" x1="1313.1143" x2="1354.1143" y1="4185.75" y2="4185.75"/><polygon fill="#000000" points="1323.1143,4181.75,1313.1143,4185.75,1323.1143,4189.75,1319.1143,4185.75" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1319.1143" y="4156.751">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1319.1143" y="4168.3916">on Input Data</text><polygon fill="#000000" points="1047.751,4219.0313,1037.751,4223.0313,1047.751,4227.0313,1043.751,4223.0313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1041.751" x2="1301.1143" y1="4223.0313" y2="4223.0313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1053.751" y="4207.0322">Authorization Code</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1053.751" y="4218.6729">Decision (Permit/Deny)</text><polygon fill="#000000" points="325.2925,4244.6719,315.2925,4248.6719,325.2925,4252.6719,321.2925,4248.6719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="1025.751" y1="4248.6719" y2="4248.6719"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="4244.3135">Request URI</text><polygon fill="#000000" points="99.1821,4270.3125,89.1821,4274.3125,99.1821,4278.3125,95.1821,4274.3125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="93.1821" x2="303.2925" y1="4274.3125" y2="4274.3125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="4269.9541">Navigate to Request URI</text><polygon fill="#000000" points="1014.751,4295.9531,1024.751,4299.9531,1014.751,4303.9531,1018.751,4299.9531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="1020.751" y1="4299.9531" y2="4299.9531"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="4295.5947">Authorization Request (with Request URI)</text><polygon fill="#000000" points="1621.8506,4321.5938,1631.8506,4325.5938,1621.8506,4329.5938,1625.8506,4325.5938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1036.751" x2="1627.8506" y1="4325.5938" y2="4325.5938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1043.751" y="4321.2354">Authentication Request (OpenID Connect)</text><path d="M1648.8506,4312.9531 L1648.8506,4345.9531 L1800.8506,4345.9531 L1800.8506,4322.9531 L1790.8506,4312.9531 L1648.8506,4312.9531 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1790.8506,4312.9531 L1790.8506,4322.9531 L1800.8506,4322.9531 L1790.8506,4312.9531 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1654.8506" y="4327.2354">AS B acts as Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1658.0293" y="4338.876">for the IDP</text><polygon fill="#000000" points="99.1821,4364.875,89.1821,4368.875,99.1821,4372.875,95.1821,4368.875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="1632.8506" y1="4368.875" y2="4368.875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="4364.5166">Authentication Prompt</text><polygon fill="#000000" points="1621.8506,4390.5156,1631.8506,4394.5156,1621.8506,4398.5156,1625.8506,4394.5156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="1627.8506" y1="4394.5156" y2="4394.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="4390.1572">User Credentials</text><polygon fill="#000000" points="1047.751,4416.1563,1037.751,4420.1563,1047.751,4424.1563,1043.751,4420.1563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1041.751" x2="1632.8506" y1="4420.1563" y2="4420.1563"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1053.751" y="4415.7979">Authentication Response (ID Token)</text><line style="stroke:#000000;stroke-width:1;" x1="1036.751" x2="1078.751" y1="4445.7969" y2="4445.7969"/><line style="stroke:#000000;stroke-width:1;" x1="1078.751" x2="1078.751" y1="4445.7969" y2="4458.7969"/><line style="stroke:#000000;stroke-width:1;" x1="1037.751" x2="1078.751" y1="4458.7969" y2="4458.7969"/><polygon fill="#000000" points="1047.751,4454.7969,1037.751,4458.7969,1047.751,4462.7969,1043.751,4458.7969" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1043.751" y="4441.4385">Validate ID Token</text><polygon fill="#000000" points="99.1821,4480.4375,89.1821,4484.4375,99.1821,4488.4375,95.1821,4484.4375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="1025.751" y1="4484.4375" y2="4484.4375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="4480.0791">Authorization Code</text><polygon fill="#000000" points="292.2925,4506.0781,302.2925,4510.0781,292.2925,4514.0781,296.2925,4510.0781" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="298.2925" y1="4510.0781" y2="4510.0781"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="4505.7197">Redirect with Authorization Code</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="4535.7188" y2="4535.7188"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="4535.7188" y2="4548.7188"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="4548.7188" y2="4548.7188"/><polygon fill="#000000" points="325.2925,4544.7188,315.2925,4548.7188,325.2925,4552.7188,321.2925,4548.7188" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="4531.3604">Generate DPoP Key Pair</text><polygon fill="#000000" points="1019.751,4570.3594,1029.751,4574.3594,1019.751,4578.3594,1023.751,4574.3594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="1025.751" y1="4574.3594" y2="4574.3594"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="4570.001">Token Request (Authorization Code Grant)</text><path d="M1046.751,4561.7188 L1046.751,4605.7188 L1266.751,4605.7188 L1266.751,4571.7188 L1256.751,4561.7188 L1046.751,4561.7188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1256.751,4561.7188 L1256.751,4571.7188 L1266.751,4571.7188 L1256.751,4561.7188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1052.751" y="4576.001">Enth&#228;lt Authorization Code, DPoP Proof,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1052.751" y="4587.6416">Client Assertion (JWT, RFC7523),</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1052.751" y="4599.2822">redirect_uri, code_verifier</text><line style="stroke:#000000;stroke-width:1;" x1="1041.751" x2="1083.751" y1="4640.9219" y2="4640.9219"/><line style="stroke:#000000;stroke-width:1;" x1="1083.751" x2="1083.751" y1="4640.9219" y2="4653.9219"/><line style="stroke:#000000;stroke-width:1;" x1="1042.751" x2="1083.751" y1="4653.9219" y2="4653.9219"/><polygon fill="#000000" points="1052.751,4649.9219,1042.751,4653.9219,1052.751,4657.9219,1048.751,4653.9219" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1048.751" y="4624.9229">Validate Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1048.751" y="4636.5635">Assertion (JWT)</text><line style="stroke:#000000;stroke-width:1;" x1="1041.751" x2="1083.751" y1="4679.5625" y2="4679.5625"/><line style="stroke:#000000;stroke-width:1;" x1="1083.751" x2="1083.751" y1="4679.5625" y2="4692.5625"/><line style="stroke:#000000;stroke-width:1;" x1="1042.751" x2="1083.751" y1="4692.5625" y2="4692.5625"/><polygon fill="#000000" points="1052.751,4688.5625,1042.751,4692.5625,1052.751,4696.5625,1048.751,4692.5625" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1048.751" y="4675.2041">Validate DPoP Proof</text><line style="stroke:#000000;stroke-width:1;" x1="1041.751" x2="1083.751" y1="4729.8438" y2="4729.8438"/><line style="stroke:#000000;stroke-width:1;" x1="1083.751" x2="1083.751" y1="4729.8438" y2="4742.8438"/><line style="stroke:#000000;stroke-width:1;" x1="1042.751" x2="1083.751" y1="4742.8438" y2="4742.8438"/><polygon fill="#000000" points="1052.751,4738.8438,1042.751,4742.8438,1052.751,4746.8438,1048.751,4742.8438" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1048.751" y="4713.8447">Validate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1048.751" y="4725.4854">Code Verifier</text><polygon fill="#000000" points="1290.1143,4776.125,1300.1143,4780.125,1290.1143,4784.125,1294.1143,4780.125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1041.751" x2="1296.1143" y1="4780.125" y2="4780.125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1048.751" y="4764.126">Request Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1048.751" y="4775.7666">Issuance Decision</text><path d="M1317.1143,4755.8438 L1317.1143,4788.8438 L1541.1143,4788.8438 L1541.1143,4765.8438 L1531.1143,4755.8438 L1317.1143,4755.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1531.1143,4755.8438 L1531.1143,4765.8438 L1541.1143,4765.8438 L1531.1143,4755.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1323.1143" y="4770.126">AS B sends input data to Policy Engine B</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1323.1143" y="4781.7666">for token request</text><line style="stroke:#000000;stroke-width:1;" x1="1312.1143" x2="1354.1143" y1="4823.4063" y2="4823.4063"/><line style="stroke:#000000;stroke-width:1;" x1="1354.1143" x2="1354.1143" y1="4823.4063" y2="4836.4063"/><line style="stroke:#000000;stroke-width:1;" x1="1313.1143" x2="1354.1143" y1="4836.4063" y2="4836.4063"/><polygon fill="#000000" points="1323.1143,4832.4063,1313.1143,4836.4063,1323.1143,4840.4063,1319.1143,4836.4063" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1319.1143" y="4807.4072">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1319.1143" y="4819.0479">on Input Data</text><polygon fill="#000000" points="1052.751,4869.6875,1042.751,4873.6875,1052.751,4877.6875,1048.751,4873.6875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1046.751" x2="1301.1143" y1="4873.6875" y2="4873.6875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1058.751" y="4857.6885">Token Issuance</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1058.751" y="4869.3291">Decision (Permit/Deny)</text><polygon fill="#000000" points="325.2925,4895.3281,315.2925,4899.3281,325.2925,4903.3281,321.2925,4899.3281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="1030.751" y1="4899.3281" y2="4899.3281"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="4894.9697">Access Token (JWT), Refresh Token</text><path d="M164.5034,4886.6875 L164.5034,4919.6875 L303.5034,4919.6875 L303.5034,4896.6875 L293.5034,4886.6875 L164.5034,4886.6875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M293.5034,4886.6875 L293.5034,4896.6875 L303.5034,4896.6875 L293.5034,4886.6875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="170.5034" y="4900.9697">Access Token bound to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="170.5034" y="4912.6104">client's DPoP public key</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="4942.6094" y2="4942.6094"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="4942.6094" y2="4955.6094"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="4955.6094" y2="4955.6094"/><polygon fill="#000000" points="325.2925,4951.6094,315.2925,4955.6094,325.2925,4959.6094,321.2925,4955.6094" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="4938.251">Generate DPoP Key Pair</text><polygon fill="#000000" points="1158.7656,4988.8906,1168.7656,4992.8906,1158.7656,4996.8906,1162.7656,4992.8906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="1164.7656" y1="4992.8906" y2="4992.8906"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="4976.8916">Access Protected Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="4988.5322">(with Access Token and DPoP Proof)</text><line style="stroke:#000000;stroke-width:1;" x1="1180.7656" x2="1222.7656" y1="5030.1719" y2="5030.1719"/><line style="stroke:#000000;stroke-width:1;" x1="1222.7656" x2="1222.7656" y1="5030.1719" y2="5043.1719"/><line style="stroke:#000000;stroke-width:1;" x1="1181.7656" x2="1222.7656" y1="5043.1719" y2="5043.1719"/><polygon fill="#000000" points="1191.7656,5039.1719,1181.7656,5043.1719,1191.7656,5047.1719,1187.7656,5043.1719" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1187.7656" y="5014.1729">Validate Access Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1187.7656" y="5025.8135">and DPoP Proof</text><polygon fill="#000000" points="1418.46,5076.4531,1428.46,5080.4531,1418.46,5084.4531,1422.46,5080.4531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1180.7656" x2="1424.46" y1="5080.4531" y2="5080.4531"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1187.7656" y="5064.4541">Forward Request to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1187.7656" y="5076.0947">Resource Server B</text><polygon fill="#000000" points="1191.7656,5102.0938,1181.7656,5106.0938,1191.7656,5110.0938,1187.7656,5106.0938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1185.7656" x2="1429.46" y1="5106.0938" y2="5106.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1197.7656" y="5101.7354">Resource Data</text><polygon fill="#000000" points="325.2925,5127.7344,315.2925,5131.7344,325.2925,5135.7344,321.2925,5131.7344" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="1169.7656" y1="5131.7344" y2="5131.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="5127.376">Resource Data</text><!--SRC=[xLfjRoEt4Vw-lu9LFbG2T2zDKGGmS0Ls9TbHSxO5oTUWXG21tgKanYkkigJiqnNzD_ad-MCPlkoItAKKsQTSWgBm1qkxCyEPuSp3uMFp1ygskCGRb94btkNYic1YHZyHz9Ut4QzV3lNBwu8LV8jJaacn6xmXQ53iIafAHpOdR2NMSVR3ZWl42aOYvoKdF-u8ImdwJuJG19U2fdIBcKYACYFbeCYB4jtdE7rel8OdgxBOiKoBFAsf820Ifw8eGxhwnI6jiYoUVFdtT4dUKqP2jkft3NDVNRwLFo1nKuYWfdhUqXfTZWQZwBzHzATjYLSRZ0GfFY5HxY1Joc_qWKD6xukFg7DTtDESGFuVQKewwAkhTS75zoOEXBOsHKefNX7uX3dgo6z8VUsq9Ay_n4hc6jDypev93d9Q6TGVso8pakvACc9fZX-9aenPLXOqGtUZ4IhAEQEtCoE5Z5Wd8Yn3462aeupPFIL2kW4Xteq6tzxSlh-z-fTQImdyUtGNewiTBZCGc66MxHFOGgO4cWx5CntTP3YPitWdrhDEK6uocYoCv0Walxsxcw19MNpS7n9tp4wAdAPx26S5TQ7bguXgd-_6wElNR-Ti27dZ0lmUul9XHl1LIKZOywdnV4euT5LAvcn6oaTI-WiSI5robjGb9wSkUKxgajy-TSapKkTgTc8X21TOq89fBTLfO0nUcA- -mdWuKU_Xj__YaW02A4DepgunXsrHWl1SVukYT- -gdfgI5UN2Y3zHiKQLxqYxZcBKLS-DWkCdWcr4emsqRm-zUnT5geLV_Tr8NYWeG3C1ld5ldGYdWZvYGOnaP4o3gjV65-YAC1aAGT-HFG0nXJPU0Z0vFbXRdch40FDGILThvGTbA-JZ0Mh3GUHZo2idaidk7if5UX5bvC2ADWYxOnSGDvmqt4_RO8rpUJmHwxopoVQZvqBOWEEDO-9WFcTqvMYh_OOESopB29-TqHbU4h6_8UBD9CTxD6Q2h4egzZNiwdDZi2RfmvjukpMne7WoFf9proqe8a4sibHEIVyilWYMjzaBBv9KoIqeD3Y6WU3r7c_WC1g3qLr6ECAE4xnoee-skXuUoBvlJYxL1geXUB4KJnZAgfPtjdaMH_9WQ1J9Fqb9b_j0XmKBn7K_da5_Gal0WfdlROO5dZDH-7aCr5Z35PpJp2peu54TIgCwLQxT5LGeDAqIpc5SEr2a9WzmeDakqHcOCs_RXYIbt4i6wBIpm05MEO89RoTKy0XYzr0UnHezIjTuQMf2dgkLDwD7dE_KEbhz7dEIpM66XDAMreTWNIiSgJOuDepVg3iXvOQADqF2zZqt6pAEgXoacHhk1WLRqd9Z3C7Kzw1BYrI0QtC1KrGa9ocm0RzaAbD2ePMqM0N9wXLucJw4R5DcwhUoL0zn5-XsIq2ihMGzg8NTqAHRTXIi0jIh-CQghdIKhKKtEwPBb8scHvMHO3O36kWVtzzv9GJV8J-ORlZ5dA5NY78kwseHByP3zO3lxlM9jg2PUe1tsGNg0fI2M4yz8H-tyCIlkSmKWPQW69Rgik99VrMEBHvLon2mfePl5OA3Ws4auzk2SPWlkXM0PVr0TcLONiL909Ad_wqSg-HqW-I7egIVpCbIP0HTviMJdWKcyRIF9jyDHghyXfDYWhgj-K0T_XP-Ax_hz4jzcNsmhD419f3JnEqvTqHUULND1yrZ00AemCNFLKaoMf9KBE3Us4SyBRQaZuX8N_THjYssYnyUHC_7RGzmsacpgq1pvA-rMp2D5ii-Ia5WaLR1DBylDWIiDNpg-QLVeRArsggJ2aC_JCUj7RTPSJhx1Z_IbHG1e7IL0stOxcG_0vLwrqoGjR563kKKREA2iTNR7jILI3CUolfba8IUdmzhHywxBV27jrpEk5EIx-Le8Y_jU-WnYVTYhPNaul3RehPUNNTIlpe9T450AyFI7EO2wxEVlQbnJcOFh7hwIiVBcOhMJNXJkdBCMK6c63vKXodi-cOhPF60kx0duJKKu0yWSr8JvzoN3wpYnW5XzW7Nn7eXAxIn0QtrL0wVfUvk_LtnG9p22NJKLGdNcPvZqOPWR5HjeM-9jRf6ZyZRwqOogsr7NQWuvOe7arMvX7fmpYgLGwNHZgMTFDkr9d-gSmAQmMFn21x2t55ZX3hb6eXuQjwz7XiniVxvfrm47EoxI3Td1o5MOTvZXV_Xn0R2Fma5c-z39qvetDIv67E-axF_sGTDeSoVPy8yuEhnsTAjp_fQbQQ4Sssl3vbO0iojJJshK7EoR8YXUyaRGZZLzlwPwosmrw0Z9qxumDOBMYb5WzNBmjuAg1oI8SkawBF5ywiUIbGjzDnz0skHfjQiSNktSOpCcM_5QarbtY_rtQek6Pc4rWHa5mQTQ6eoRbQjfSscAkiU0hZllHsKGJWFfcPuEvcwIOvJDt8uz6UtBqQ_XEZO__Cl_olyItAKVsbV8PA-hjz35nW7MX8l3v_3qsp1ZfgHyds8iv4az3bfckJtfMcIbzCqYORGv0KqJTBEmg-VdibHciPwS-8XcjWCl9YcIQeqr1ow14SXvoBPPtNUqHA6TEGGy8PmhqrP3hx-PDqxrPhZchLNrQioz16YWvcoGpdlm8odQOoUFkewU9Trj6av7hfweP2WRwRlrJrA3Z-mDK6VvgofPmt7sh1KXy6X9TScH-k2FQ3Hc3NS24oBIZP7OYqMW50mEkmqNcfxzZ0nqJGNwFacgrQp596yv7CkRoQPkYe2k50i-Wq-1t0B9cQffKoOQIn1ftCx4XGBgEH3k4XohjqQiqUvXFoxnaZTNBtLpDuUOSFSwyp93fhX8k2SkL19UmVw_v2IH0CzOq9EdzOqNSF9aEVedW1aAApFB5i9ikfFr78TU_megdCccLAV8jI4g9JrICgcayQGwwPU6Ih863dWT-sBIxgg1uPLLVkWB-YIYUM-7O-9LMeDEjLpNPw4pIq-J92sDzZ3yv163UVUiX8AvODdut2jL6DKW0e-0CMDN5G-dALKTH-np0ULvDmaQVA79KaJZuKxF6fz6Sep0BlUPRzTkm7cv-oZ2FPYbw6SQI1f9_LPyyWfx6zoTlOtUHdxMyzGYhfhyN5X4lWexPkSHFkUogn6lqwcEfHYyX9ACLZVDPjORUbn9l7Bi8Z70UDa3l4WcfnEA5QtBGvkAvakG7OVJIy7t_pjwx_sGE8upnZ8U7LzyMsU33_- -p3NsCOfGpOT9Hi_1wEQPEFdm99FDhuKaZogJcNuj-8RanULilhtiRDIZaca_oND6Z-TSamqvPYSHZacBkMOH5EJUhDgct9CJgSS4vzozBwQ_zVw1G00]--></g></svg>