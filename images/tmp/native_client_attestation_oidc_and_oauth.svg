<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="4023px" preserveAspectRatio="none" style="width:2232px;height:4023px;background:#FFFFFF;" version="1.1" viewBox="0 0 2232 4023" width="2232px" zoomAndPan="magnify"><defs/><g><rect fill="#F0F0F0" height="3501.5469" style="stroke:#000000;stroke-width:1;" width="10" x="60.8999" y="477.2891"/><rect fill="#F0F0F0" height="267.1953" style="stroke:#000000;stroke-width:1;" width="10" x="65.8999" y="1110.2109"/><rect fill="#F0F0F0" height="1346.4453" style="stroke:#000000;stroke-width:1;" width="10" x="65.8999" y="2632.3906"/><rect fill="#F0F0F0" height="267.1953" style="stroke:#000000;stroke-width:1;" width="10" x="70.8999" y="3189.5156"/><rect fill="#F0F0F0" height="2601.4297" style="stroke:#000000;stroke-width:1;" width="10" x="319.7109" y="1377.4063"/><rect fill="#F0F0F0" height="522.125" style="stroke:#000000;stroke-width:1;" width="10" x="324.7109" y="3456.7109"/><rect fill="#F0F0F0" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="582.2095" y="113.5625"/><rect fill="#F0F0F0" height="39.6992" style="stroke:#000000;stroke-width:1;" width="10" x="582.2095" y="243.6602"/><rect fill="#F0F0F0" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="582.2095" y="1965.7969"/><rect fill="#F0F0F0" height="39.6992" style="stroke:#000000;stroke-width:1;" width="10" x="582.2095" y="2095.8945"/><rect fill="#F0F0F0" height="466.957" style="stroke:#000000;stroke-width:1;" width="10" x="735.3369" y="323.0586"/><rect fill="#F0F0F0" height="81.832" style="stroke:#000000;stroke-width:1;" width="10" x="735.3369" y="999.2461"/><rect fill="#F0F0F0" height="2839.4922" style="stroke:#000000;stroke-width:1;" width="10" x="735.3369" y="1139.3438"/><rect fill="#F0F0F0" height="242.4961" style="stroke:#000000;stroke-width:1;" width="10" x="740.3369" y="1466.8047"/><rect fill="#F0F0F0" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="740.3369" y="1829.2656"/><rect fill="#F0F0F0" height="702.0273" style="stroke:#000000;stroke-width:1;" width="10" x="991.4287" y="2175.293"/><rect fill="#F0F0F0" height="81.832" style="stroke:#000000;stroke-width:1;" width="10" x="991.4287" y="3078.5508"/><rect fill="#F0F0F0" height="760.1875" style="stroke:#000000;stroke-width:1;" width="10" x="991.4287" y="3218.6484"/><rect fill="#F0F0F0" height="242.4961" style="stroke:#000000;stroke-width:1;" width="10" x="996.4287" y="3546.1094"/><rect fill="#F0F0F0" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="996.4287" y="3908.5703"/><rect fill="#F0F0F0" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1376.4287" y="174.8281"/><rect fill="#F0F0F0" height="82.3984" style="stroke:#000000;stroke-width:1;" width="10" x="1376.4287" y="365.7578"/><rect fill="#F0F0F0" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1376.4287" y="2027.0625"/><rect fill="#F0F0F0" height="74.2656" style="stroke:#000000;stroke-width:1;" width="10" x="1376.4287" y="2217.9922"/><rect fill="#F0F0F0" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1612.3223" y="2363.5234"/><rect fill="#F0F0F0" height="96.3984" style="stroke:#000000;stroke-width:1;" width="10" x="1764.8755" y="1794.1328"/><rect fill="#F0F0F0" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1918.4165" y="2530.1875"/><rect fill="#F0F0F0" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1918.4165" y="2804.0547"/><rect fill="#F0F0F0" height="96.3984" style="stroke:#000000;stroke-width:1;" width="10" x="1918.4165" y="3873.4375"/><rect fill="#F0F0F0" height="97.9648" style="stroke:#000000;stroke-width:1;" width="10" x="2018.8696" y="1179.043"/><rect fill="#F0F0F0" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="2018.8696" y="1640.4688"/><rect fill="#F0F0F0" height="97.9648" style="stroke:#000000;stroke-width:1;" width="10" x="2018.8696" y="3258.3477"/><rect fill="#F0F0F0" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="2018.8696" y="3719.7734"/><rect fill="none" height="378.3984" style="stroke:#000000;stroke-width:1.5;" width="1995.1938" x="10" y="2491.9219"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="65" x2="65" y1="36.2969" y2="3987.8359"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="324.4458" x2="324.4458" y1="36.2969" y2="3987.8359"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="586.3276" x2="586.3276" y1="36.2969" y2="3987.8359"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="740.0913" x2="740.0913" y1="36.2969" y2="3987.8359"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="996.1694" x2="996.1694" y1="36.2969" y2="3987.8359"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1380.6587" x2="1380.6587" y1="36.2969" y2="3987.8359"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1616.5327" x2="1616.5327" y1="36.2969" y2="3987.8359"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1769.1118" x2="1769.1118" y1="36.2969" y2="3987.8359"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1922.6392" x2="1922.6392" y1="36.2969" y2="3987.8359"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2023.1938" x2="2023.1938" y1="36.2969" y2="3987.8359"/><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="91.7998" x="20" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.7998" x="27" y="24.9951">User Agent</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="91.7998" x="20" y="3986.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77.7998" x="27" y="4006.8311">User Agent</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="54.5303" x="297.4458" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="304.4458" y="24.9951">Client</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="54.5303" x="297.4458" y="3986.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="304.4458" y="4006.8311">Client</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="239.7637" x="467.3276" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="225.7637" x="474.3276" y="24.9951">Android TEE/iOS Secure Enclave</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="239.7637" x="467.3276" y="3986.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="225.7637" x="474.3276" y="4006.8311">Android TEE/iOS Secure Enclave</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="46.4912" x="717.0913" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.4912" x="724.0913" y="24.9951">AS A</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="46.4912" x="717.0913" y="3986.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.4912" x="724.0913" y="4006.8311">AS A</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="46.5186" x="973.1694" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.5186" x="980.1694" y="24.9951">AS B</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="46.5186" x="973.1694" y="3986.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.5186" x="980.1694" y="4006.8311">AS B</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="147.54" x="1307.6587" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133.54" x="1314.6587" y="24.9951">Attestation Service</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="147.54" x="1307.6587" y="3986.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133.54" x="1314.6587" y="4006.8311">Attestation Service</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="141.5791" x="1546.5327" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127.5791" x="1553.5327" y="24.9951">Federation Master</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="141.5791" x="1546.5327" y="3986.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="127.5791" x="1553.5327" y="4006.8311">Federation Master</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="143.5273" x="1698.1118" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129.5273" x="1705.1118" y="24.9951">Resource Server A</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="143.5273" x="1698.1118" y="3986.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129.5273" x="1705.1118" y="4006.8311">Resource Server A</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="143.5547" x="1851.6392" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129.5547" x="1858.6392" y="24.9951">Resource Server B</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="143.5547" x="1851.6392" y="3986.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129.5547" x="1858.6392" y="4006.8311">Resource Server B</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="37.3516" x="2005.1938" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23.3516" x="2012.1938" y="24.9951">IDP</text><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="37.3516" x="2005.1938" y="3986.8359"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23.3516" x="2012.1938" y="4006.8311">IDP</text><rect fill="#F0F0F0" height="3501.5469" style="stroke:#000000;stroke-width:1;" width="10" x="60.8999" y="477.2891"/><rect fill="#F0F0F0" height="267.1953" style="stroke:#000000;stroke-width:1;" width="10" x="65.8999" y="1110.2109"/><rect fill="#F0F0F0" height="1346.4453" style="stroke:#000000;stroke-width:1;" width="10" x="65.8999" y="2632.3906"/><rect fill="#F0F0F0" height="267.1953" style="stroke:#000000;stroke-width:1;" width="10" x="70.8999" y="3189.5156"/><rect fill="#F0F0F0" height="2601.4297" style="stroke:#000000;stroke-width:1;" width="10" x="319.7109" y="1377.4063"/><rect fill="#F0F0F0" height="522.125" style="stroke:#000000;stroke-width:1;" width="10" x="324.7109" y="3456.7109"/><rect fill="#F0F0F0" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="582.2095" y="113.5625"/><rect fill="#F0F0F0" height="39.6992" style="stroke:#000000;stroke-width:1;" width="10" x="582.2095" y="243.6602"/><rect fill="#F0F0F0" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="582.2095" y="1965.7969"/><rect fill="#F0F0F0" height="39.6992" style="stroke:#000000;stroke-width:1;" width="10" x="582.2095" y="2095.8945"/><rect fill="#F0F0F0" height="466.957" style="stroke:#000000;stroke-width:1;" width="10" x="735.3369" y="323.0586"/><rect fill="#F0F0F0" height="81.832" style="stroke:#000000;stroke-width:1;" width="10" x="735.3369" y="999.2461"/><rect fill="#F0F0F0" height="2839.4922" style="stroke:#000000;stroke-width:1;" width="10" x="735.3369" y="1139.3438"/><rect fill="#F0F0F0" height="242.4961" style="stroke:#000000;stroke-width:1;" width="10" x="740.3369" y="1466.8047"/><rect fill="#F0F0F0" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="740.3369" y="1829.2656"/><rect fill="#F0F0F0" height="702.0273" style="stroke:#000000;stroke-width:1;" width="10" x="991.4287" y="2175.293"/><rect fill="#F0F0F0" height="81.832" style="stroke:#000000;stroke-width:1;" width="10" x="991.4287" y="3078.5508"/><rect fill="#F0F0F0" height="760.1875" style="stroke:#000000;stroke-width:1;" width="10" x="991.4287" y="3218.6484"/><rect fill="#F0F0F0" height="242.4961" style="stroke:#000000;stroke-width:1;" width="10" x="996.4287" y="3546.1094"/><rect fill="#F0F0F0" height="32.1328" style="stroke:#000000;stroke-width:1;" width="10" x="996.4287" y="3908.5703"/><rect fill="#F0F0F0" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1376.4287" y="174.8281"/><rect fill="#F0F0F0" height="82.3984" style="stroke:#000000;stroke-width:1;" width="10" x="1376.4287" y="365.7578"/><rect fill="#F0F0F0" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1376.4287" y="2027.0625"/><rect fill="#F0F0F0" height="74.2656" style="stroke:#000000;stroke-width:1;" width="10" x="1376.4287" y="2217.9922"/><rect fill="#F0F0F0" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1612.3223" y="2363.5234"/><rect fill="#F0F0F0" height="96.3984" style="stroke:#000000;stroke-width:1;" width="10" x="1764.8755" y="1794.1328"/><rect fill="#F0F0F0" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1918.4165" y="2530.1875"/><rect fill="#F0F0F0" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="1918.4165" y="2804.0547"/><rect fill="#F0F0F0" height="96.3984" style="stroke:#000000;stroke-width:1;" width="10" x="1918.4165" y="3873.4375"/><rect fill="#F0F0F0" height="97.9648" style="stroke:#000000;stroke-width:1;" width="10" x="2018.8696" y="1179.043"/><rect fill="#F0F0F0" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="2018.8696" y="1640.4688"/><rect fill="#F0F0F0" height="97.9648" style="stroke:#000000;stroke-width:1;" width="10" x="2018.8696" y="3258.3477"/><rect fill="#F0F0F0" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="2018.8696" y="3719.7734"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2225.6978" x="0" y="66.8633"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2225.6978" y1="66.8633" y2="66.8633"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2225.6978" y1="69.8633" y2="69.8633"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="515.4712" x="855.1133" y="56.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="496.9453" x="861.1133" y="72.3638">Client Registration with Resource Server A (with Client Attestation)</text><polygon fill="#000000" points="570.2095,109.5625,580.2095,113.5625,570.2095,117.5625,574.2095,113.5625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="324.7109" x2="576.2095" y1="113.5625" y2="113.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.9219" x="331.7109" y="108.4966">Generate Key Pair for Attestation</text><path d="M597,94.4297 L597,119.4297 L885,119.4297 L885,104.4297 L875,94.4297 L597,94.4297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M875,94.4297 L875,104.4297 L885,104.4297 L875,94.4297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.3442" x="603" y="111.4966">Using Android TEE or iOS Secure Enclave</text><polygon fill="#000000" points="335.7109,141.6953,325.7109,145.6953,335.7109,149.6953,331.7109,145.6953" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="329.7109" x2="586.2095" y1="145.6953" y2="145.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.0503" x="341.7109" y="140.6294">Public Key</text><polygon fill="#000000" points="1364.4287,170.8281,1374.4287,174.8281,1364.4287,178.8281,1368.4287,174.8281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="324.7109" x2="1370.4287" y1="174.8281" y2="174.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.4722" x="331.7109" y="169.7622">Request Attestation Challenge</text><polygon fill="#000000" points="335.7109,199.9609,325.7109,203.9609,335.7109,207.9609,331.7109,203.9609" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="329.7109" x2="1380.4287" y1="203.9609" y2="203.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.9497" x="341.7109" y="198.895">Attestation Challenge</text><polygon fill="#000000" points="570.2095,239.6602,580.2095,243.6602,570.2095,247.6602,574.2095,243.6602" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="324.7109" x2="576.2095" y1="243.6602" y2="243.6602"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233.4985" x="331.7109" y="238.5942">Sign Challenge with Attestation Key</text><path d="M597,216.9609 L597,256.9609 L885,256.9609 L885,226.9609 L875,216.9609 L597,216.9609 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M875,216.9609 L875,226.9609 L885,226.9609 L875,216.9609 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.8267" x="603" y="234.0278">Using Android SafetyNet/Play Integrity or</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.2412" x="603" y="249.1606">iOS DeviceCheck/App Attest API</text><polygon fill="#000000" points="335.7109,279.3594,325.7109,283.3594,335.7109,287.3594,331.7109,283.3594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="329.7109" x2="586.2095" y1="283.3594" y2="283.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.3647" x="341.7109" y="278.2935">Attestation Statement</text><polygon fill="#000000" points="723.3369,319.0586,733.3369,323.0586,723.3369,327.0586,727.3369,323.0586" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="324.7109" x2="729.3369" y1="323.0586" y2="323.0586"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="312.8188" x="331.7109" y="317.9927">Client Registration Request (Resource Server A)</text><path d="M750,296.3594 L750,336.3594 L1050,336.3594 L1050,306.3594 L1040,296.3594 L750,296.3594 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1040,296.3594 L1040,306.3594 L1050,306.3594 L1040,296.3594 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279.0493" x="756" y="313.4263">Includes attestation statement, public key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.2583" x="756" y="328.5591">and potentially software statement</text><polygon fill="#000000" points="1364.4287,361.7578,1374.4287,365.7578,1364.4287,369.7578,1368.4287,365.7578" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="745.3369" x2="1370.4287" y1="365.7578" y2="365.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.8413" x="752.3369" y="360.6919">Verify Client Attestation</text><path d="M1391,346.625 L1391,371.625 L1756,371.625 L1756,356.625 L1746,346.625 L1391,346.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1746,346.625 L1746,356.625 L1756,356.625 L1746,346.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="344.9063" x="1397" y="363.6919">AS A forwards attestation data to Attestation Service</text><line style="stroke:#000000;stroke-width:1;" x1="1386.4287" x2="1428.4287" y1="401.957" y2="401.957"/><line style="stroke:#000000;stroke-width:1;" x1="1428.4287" x2="1428.4287" y1="401.957" y2="414.957"/><line style="stroke:#000000;stroke-width:1;" x1="1387.4287" x2="1428.4287" y1="414.957" y2="414.957"/><polygon fill="#000000" points="1397.4287,410.957,1387.4287,414.957,1397.4287,418.957,1393.4287,414.957" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.8936" x="1393.4287" y="396.8911">Validate Attestation Statement</text><path d="M1616.8936,381.7578 L1616.8936,421.7578 L1876.8936,421.7578 L1876.8936,391.7578 L1866.8936,381.7578 L1616.8936,381.7578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1866.8936,381.7578 L1866.8936,391.7578 L1876.8936,391.7578 L1866.8936,381.7578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.77" x="1622.8936" y="398.8247">e.g. Check signature, validity period,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.2964" x="1622.8936" y="413.9575">and device/app integrity status</text><polygon fill="#000000" points="756.3369,444.1563,746.3369,448.1563,756.3369,452.1563,752.3369,448.1563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="750.3369" x2="1380.4287" y1="448.1563" y2="448.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.8921" x="762.3369" y="443.0903">Attestation Verification Result</text><polygon fill="#000000" points="81.8999,473.2891,71.8999,477.2891,81.8999,481.2891,77.8999,477.2891" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="75.8999" x2="734.3369" y1="477.2891" y2="477.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.0571" x="87.8999" y="472.2231">Request Email Confirmation</text><polygon fill="#000000" points="723.3369,502.4219,733.3369,506.4219,723.3369,510.4219,727.3369,506.4219" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="70.8999" x2="729.3369" y1="506.4219" y2="506.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.8306" x="77.8999" y="501.356">User Email</text><line style="stroke:#000000;stroke-width:1;" x1="745.3369" x2="787.3369" y1="535.5547" y2="535.5547"/><line style="stroke:#000000;stroke-width:1;" x1="787.3369" x2="787.3369" y1="535.5547" y2="548.5547"/><line style="stroke:#000000;stroke-width:1;" x1="746.3369" x2="787.3369" y1="548.5547" y2="548.5547"/><polygon fill="#000000" points="756.3369,544.5547,746.3369,548.5547,756.3369,552.5547,752.3369,548.5547" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.4082" x="752.3369" y="530.4888">Send Confirmation Email</text><polygon fill="#000000" points="723.3369,573.6875,733.3369,577.6875,723.3369,581.6875,727.3369,577.6875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="70.8999" x2="729.3369" y1="577.6875" y2="577.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.7344" x="77.8999" y="572.6216">User Clicks Confirmation Link</text><line style="stroke:#000000;stroke-width:1;" x1="745.3369" x2="787.3369" y1="606.8203" y2="606.8203"/><line style="stroke:#000000;stroke-width:1;" x1="787.3369" x2="787.3369" y1="606.8203" y2="619.8203"/><line style="stroke:#000000;stroke-width:1;" x1="746.3369" x2="787.3369" y1="619.8203" y2="619.8203"/><polygon fill="#000000" points="756.3369,615.8203,746.3369,619.8203,756.3369,623.8203,752.3369,619.8203" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.7847" x="752.3369" y="601.7544">Verify Email Confirmation</text><line style="stroke:#000000;stroke-width:1;" x1="745.3369" x2="787.3369" y1="721.1172" y2="721.1172"/><line style="stroke:#000000;stroke-width:1;" x1="787.3369" x2="787.3369" y1="721.1172" y2="734.1172"/><line style="stroke:#000000;stroke-width:1;" x1="746.3369" x2="787.3369" y1="734.1172" y2="734.1172"/><polygon fill="#000000" points="756.3369,730.1172,746.3369,734.1172,756.3369,738.1172,752.3369,734.1172" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.1436" x="752.3369" y="670.6528">Generate Email Confirmation JWT</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211.6436" x="752.3369" y="685.7856">and sign with AS_A's private key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.4971" x="752.3369" y="700.9185">(used for single confirmation</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.5151" x="752.3369" y="716.0513">on multiple client registrations)</text><path d="M992.1436,632.8203 L992.1436,763.8203 L1220.1436,763.8203 L1220.1436,642.8203 L1210.1436,632.8203 L992.1436,632.8203 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1210.1436,632.8203 L1210.1436,642.8203 L1220.1436,642.8203 L1210.1436,632.8203 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.8447" x="998.1436" y="649.8872">JWT Claims:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.3755" x="1002.2759" y="665.02">- iss: AS_A_ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.3184" x="1002.2759" y="680.1528">- sub: user_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.8745" x="1002.2759" y="695.2856">- aud: AS_B_ID (or all AS)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.333" x="1002.2759" y="710.4185">- exp: (short time)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70.9795" x="1002.2759" y="725.5513">- iat: (now)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.4526" x="1002.2759" y="740.6841">- email_verified: true</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.7788" x="1002.2759" y="755.8169">- verification_timestamp: (now)</text><polygon fill="#000000" points="335.7109,786.0156,325.7109,790.0156,335.7109,794.0156,331.7109,790.0156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="329.7109" x2="739.3369" y1="790.0156" y2="790.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.5146" x="341.7109" y="784.9497">Client Registration Response (with JWT)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2225.6978" x="0" y="818.582"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2225.6978" y1="818.582" y2="818.582"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2225.6978" y1="821.582" y2="821.582"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="620.8804" x="802.4087" y="808.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="602.3545" x="808.4087" y="824.0825">OAuth 2.0 Authorization Code Flow with PAR, PKCE and DPoP (Resource Server A)</text><line style="stroke:#000000;stroke-width:1;" x1="324.7109" x2="366.7109" y1="862.2813" y2="862.2813"/><line style="stroke:#000000;stroke-width:1;" x1="366.7109" x2="366.7109" y1="862.2813" y2="875.2813"/><line style="stroke:#000000;stroke-width:1;" x1="325.7109" x2="366.7109" y1="875.2813" y2="875.2813"/><polygon fill="#000000" points="335.7109,871.2813,325.7109,875.2813,335.7109,879.2813,331.7109,875.2813" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.4272" x="331.7109" y="857.2153">Generate PKCE Code Verifier</text><line style="stroke:#000000;stroke-width:1;" x1="324.7109" x2="366.7109" y1="904.4141" y2="904.4141"/><line style="stroke:#000000;stroke-width:1;" x1="366.7109" x2="366.7109" y1="904.4141" y2="917.4141"/><line style="stroke:#000000;stroke-width:1;" x1="325.7109" x2="366.7109" y1="917.4141" y2="917.4141"/><polygon fill="#000000" points="335.7109,913.4141,325.7109,917.4141,335.7109,921.4141,331.7109,917.4141" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.042" x="331.7109" y="899.3481">Generate PKCE Code Challenge</text><line style="stroke:#000000;stroke-width:1;" x1="324.7109" x2="366.7109" y1="946.5469" y2="946.5469"/><line style="stroke:#000000;stroke-width:1;" x1="366.7109" x2="366.7109" y1="946.5469" y2="959.5469"/><line style="stroke:#000000;stroke-width:1;" x1="325.7109" x2="366.7109" y1="959.5469" y2="959.5469"/><polygon fill="#000000" points="335.7109,955.5469,325.7109,959.5469,335.7109,963.5469,331.7109,959.5469" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.7334" x="331.7109" y="941.481">Generate DPoP Key Pair</text><polygon fill="#000000" points="723.3369,995.2461,733.3369,999.2461,723.3369,1003.2461,727.3369,999.2461" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="324.7109" x2="729.3369" y1="999.2461" y2="999.2461"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.2876" x="331.7109" y="994.1802">PAR Request</text><path d="M750,972.5469 L750,1012.5469 L1241,1012.5469 L1241,982.5469 L1231,972.5469 L750,972.5469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1231,972.5469 L1231,982.5469 L1241,982.5469 L1231,972.5469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.0063" x="756" y="989.6138">Authorization Code Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="470.6597" x="756" y="1004.7466">(inkl. DPoP Proof, code_challenge, code_challenge_method, redirect_uri)</text><line style="stroke:#000000;stroke-width:1;" x1="745.3369" x2="787.3369" y1="1038.9453" y2="1038.9453"/><line style="stroke:#000000;stroke-width:1;" x1="787.3369" x2="787.3369" y1="1038.9453" y2="1051.9453"/><line style="stroke:#000000;stroke-width:1;" x1="746.3369" x2="787.3369" y1="1051.9453" y2="1051.9453"/><polygon fill="#000000" points="756.3369,1047.9453,746.3369,1051.9453,756.3369,1055.9453,752.3369,1051.9453" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.9717" x="752.3369" y="1033.8794">Validate DPoP Proof</text><polygon fill="#000000" points="335.7109,1077.0781,325.7109,1081.0781,335.7109,1085.0781,331.7109,1081.0781" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="329.7109" x2="739.3369" y1="1081.0781" y2="1081.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.9043" x="341.7109" y="1076.0122">Request URI</text><polygon fill="#000000" points="86.8999,1106.2109,76.8999,1110.2109,86.8999,1114.2109,82.8999,1110.2109" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="80.8999" x2="323.7109" y1="1110.2109" y2="1110.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.5293" x="92.8999" y="1105.145">Navigate to Request URI</text><polygon fill="#000000" points="723.3369,1135.3438,733.3369,1139.3438,723.3369,1143.3438,727.3369,1139.3438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="75.8999" x2="729.3369" y1="1139.3438" y2="1139.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270.4863" x="82.8999" y="1134.2778">Authorization Request (with Request URI)</text><polygon fill="#000000" points="2006.8696,1175.043,2016.8696,1179.043,2006.8696,1183.043,2010.8696,1179.043" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="745.3369" x2="2012.8696" y1="1179.043" y2="1179.043"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.6792" x="752.3369" y="1173.9771">Authentication Request (OpenID Connect)</text><path d="M2033,1152.3438 L2033,1192.3438 L2224,1192.3438 L2224,1162.3438 L2214,1152.3438 L2033,1152.3438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2214,1152.3438 L2214,1162.3438 L2224,1162.3438 L2214,1152.3438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.8027" x="2039" y="1169.4106">AS A acts as Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.1577" x="2043.1323" y="1184.5435">for the IDP</text><polygon fill="#000000" points="86.8999,1214.7422,76.8999,1218.7422,86.8999,1222.7422,82.8999,1218.7422" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="80.8999" x2="2017.8696" y1="1218.7422" y2="1218.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.7134" x="92.8999" y="1213.6763">Authentication Prompt</text><polygon fill="#000000" points="2006.8696,1243.875,2016.8696,1247.875,2006.8696,1251.875,2010.8696,1247.875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="75.8999" x2="2012.8696" y1="1247.875" y2="1247.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.7324" x="82.8999" y="1242.8091">User Credentials</text><polygon fill="#000000" points="756.3369,1273.0078,746.3369,1277.0078,756.3369,1281.0078,752.3369,1277.0078" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="750.3369" x2="2022.8696" y1="1277.0078" y2="1277.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331.2842" x="762.3369" y="1271.9419">Authentication Response (ID Token, Access Token)</text><line style="stroke:#000000;stroke-width:1;" x1="745.3369" x2="787.3369" y1="1306.1406" y2="1306.1406"/><line style="stroke:#000000;stroke-width:1;" x1="787.3369" x2="787.3369" y1="1306.1406" y2="1319.1406"/><line style="stroke:#000000;stroke-width:1;" x1="746.3369" x2="787.3369" y1="1319.1406" y2="1319.1406"/><polygon fill="#000000" points="756.3369,1315.1406,746.3369,1319.1406,756.3369,1323.1406,752.3369,1319.1406" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.0918" x="752.3369" y="1301.0747">Validate ID Token &amp; Access Token</text><polygon fill="#000000" points="86.8999,1344.2734,76.8999,1348.2734,86.8999,1352.2734,82.8999,1348.2734" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="80.8999" x2="734.3369" y1="1348.2734" y2="1348.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.4839" x="92.8999" y="1343.2075">Authorization Code</text><polygon fill="#000000" points="307.7109,1373.4063,317.7109,1377.4063,307.7109,1381.4063,311.7109,1377.4063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="70.8999" x2="313.7109" y1="1377.4063" y2="1377.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.811" x="77.8999" y="1372.3403">Redirect with Authorization Code</text><line style="stroke:#000000;stroke-width:1;" x1="329.7109" x2="371.7109" y1="1406.5391" y2="1406.5391"/><line style="stroke:#000000;stroke-width:1;" x1="371.7109" x2="371.7109" y1="1406.5391" y2="1419.5391"/><line style="stroke:#000000;stroke-width:1;" x1="330.7109" x2="371.7109" y1="1419.5391" y2="1419.5391"/><polygon fill="#000000" points="340.7109,1415.5391,330.7109,1419.5391,340.7109,1423.5391,336.7109,1419.5391" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.7334" x="336.7109" y="1401.4731">Generate DPoP Key Pair</text><polygon fill="#000000" points="728.3369,1462.8047,738.3369,1466.8047,728.3369,1470.8047,732.3369,1466.8047" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="329.7109" x2="734.3369" y1="1466.8047" y2="1466.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.7959" x="336.7109" y="1461.7388">Token Request (Authorization Code Grant)</text><path d="M755,1432.5391 L755,1487.5391 L1034,1487.5391 L1034,1442.5391 L1024,1432.5391 L755,1432.5391 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1024,1432.5391 L1024,1442.5391 L1034,1442.5391 L1024,1432.5391 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.9209" x="761" y="1449.606">Enth&#228;lt Authorization Code, DPoP Proof,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.4243" x="761" y="1464.7388">Client Assertion (JWT, RFC7523),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.7847" x="761" y="1479.8716">redirect_uri, code_verifier</text><line style="stroke:#000000;stroke-width:1;" x1="750.3369" x2="792.3369" y1="1514.0703" y2="1514.0703"/><line style="stroke:#000000;stroke-width:1;" x1="792.3369" x2="792.3369" y1="1514.0703" y2="1527.0703"/><line style="stroke:#000000;stroke-width:1;" x1="751.3369" x2="792.3369" y1="1527.0703" y2="1527.0703"/><polygon fill="#000000" points="761.3369,1523.0703,751.3369,1527.0703,761.3369,1531.0703,757.3369,1527.0703" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.8848" x="757.3369" y="1509.0044">Validate Client Assertion (JWT)</text><line style="stroke:#000000;stroke-width:1;" x1="750.3369" x2="792.3369" y1="1556.2031" y2="1556.2031"/><line style="stroke:#000000;stroke-width:1;" x1="792.3369" x2="792.3369" y1="1556.2031" y2="1569.2031"/><line style="stroke:#000000;stroke-width:1;" x1="751.3369" x2="792.3369" y1="1569.2031" y2="1569.2031"/><polygon fill="#000000" points="761.3369,1565.2031,751.3369,1569.2031,761.3369,1573.2031,757.3369,1569.2031" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.9717" x="757.3369" y="1551.1372">Validate DPoP Proof</text><line style="stroke:#000000;stroke-width:1;" x1="750.3369" x2="792.3369" y1="1598.3359" y2="1598.3359"/><line style="stroke:#000000;stroke-width:1;" x1="792.3369" x2="792.3369" y1="1598.3359" y2="1611.3359"/><line style="stroke:#000000;stroke-width:1;" x1="751.3369" x2="792.3369" y1="1611.3359" y2="1611.3359"/><polygon fill="#000000" points="761.3369,1607.3359,751.3369,1611.3359,761.3369,1615.3359,757.3369,1611.3359" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.1084" x="757.3369" y="1593.27">Validate PKCE Code Verifier</text><polygon fill="#000000" points="2006.8696,1636.4688,2016.8696,1640.4688,2006.8696,1644.4688,2010.8696,1640.4688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="750.3369" x2="2012.8696" y1="1640.4688" y2="1640.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.4292" x="757.3369" y="1635.4028">Validate Token (Optional)</text><polygon fill="#000000" points="761.3369,1665.6016,751.3369,1669.6016,761.3369,1673.6016,757.3369,1669.6016" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="755.3369" x2="2022.8696" y1="1669.6016" y2="1669.6016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.0874" x="767.3369" y="1664.5356">Validation Result</text><polygon fill="#000000" points="340.7109,1705.3008,330.7109,1709.3008,340.7109,1713.3008,336.7109,1709.3008" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="334.7109" x2="734.3369" y1="1709.3008" y2="1709.3008"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295.3501" x="346.7109" y="1704.2349">Access Token (JWT), Refresh Token, ID Token</text><path d="M139,1682.6016 L139,1722.6016 L314,1722.6016 L314,1692.6016 L304,1682.6016 L139,1682.6016 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M304,1682.6016 L304,1692.6016 L314,1692.6016 L304,1682.6016 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.7759" x="145" y="1699.6685">Access Token bound to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.4258" x="145" y="1714.8013">client's DPoP public key</text><line style="stroke:#000000;stroke-width:1;" x1="329.7109" x2="371.7109" y1="1749" y2="1749"/><line style="stroke:#000000;stroke-width:1;" x1="371.7109" x2="371.7109" y1="1749" y2="1762"/><line style="stroke:#000000;stroke-width:1;" x1="330.7109" x2="371.7109" y1="1762" y2="1762"/><polygon fill="#000000" points="340.7109,1758,330.7109,1762,340.7109,1766,336.7109,1762" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.7334" x="336.7109" y="1743.9341">Generate DPoP Key Pair</text><polygon fill="#000000" points="1752.8755,1790.1328,1762.8755,1794.1328,1752.8755,1798.1328,1756.8755,1794.1328" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="329.7109" x2="1758.8755" y1="1794.1328" y2="1794.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310.7241" x="336.7109" y="1789.0669">Access Protected Resource (with Access Token)</text><path d="M1779,1775 L1779,1800 L1968,1800 L1968,1785 L1958,1775 L1779,1775 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1958,1775 L1958,1785 L1968,1785 L1958,1775 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.2319" x="1785" y="1792.0669">Access Token, DPoP Proof</text><polygon fill="#000000" points="761.3369,1825.2656,751.3369,1829.2656,761.3369,1833.2656,757.3369,1829.2656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="755.3369" x2="1763.8755" y1="1829.2656" y2="1829.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.0532" x="767.3369" y="1824.1997">Validate Access Token</text><path d="M1779,1810.1328 L1779,1835.1328 L1997,1835.1328 L1997,1820.1328 L1987,1810.1328 L1779,1810.1328 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1987,1810.1328 L1987,1820.1328 L1997,1820.1328 L1987,1810.1328 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.5835" x="1785" y="1827.1997">includes DPoP Proof validation</text><polygon fill="#000000" points="1752.8755,1857.3984,1762.8755,1861.3984,1752.8755,1865.3984,1756.8755,1861.3984" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="745.3369" x2="1758.8755" y1="1861.3984" y2="1861.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.0874" x="752.3369" y="1856.3325">Validation Result</text><polygon fill="#000000" points="340.7109,1886.5313,330.7109,1890.5313,340.7109,1894.5313,336.7109,1890.5313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="334.7109" x2="1768.8755" y1="1890.5313" y2="1890.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.6592" x="346.7109" y="1885.4653">Resource Data</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2225.6978" x="0" y="1919.0977"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2225.6978" y1="1919.0977" y2="1919.0977"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2225.6978" y1="1922.0977" y2="1922.0977"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="579.7476" x="822.9751" y="1908.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="561.2217" x="828.9751" y="1924.5981">Client Registration with Resource Server B (with Client Attestation and JWT)</text><polygon fill="#000000" points="570.2095,1961.7969,580.2095,1965.7969,570.2095,1969.7969,574.2095,1965.7969" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="329.7109" x2="576.2095" y1="1965.7969" y2="1965.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.9219" x="336.7109" y="1960.731">Generate Key Pair for Attestation</text><path d="M597,1946.6641 L597,1971.6641 L885,1971.6641 L885,1956.6641 L875,1946.6641 L597,1946.6641 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M875,1946.6641 L875,1956.6641 L885,1956.6641 L875,1946.6641 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.3442" x="603" y="1963.731">Using Android TEE or iOS Secure Enclave</text><polygon fill="#000000" points="340.7109,1993.9297,330.7109,1997.9297,340.7109,2001.9297,336.7109,1997.9297" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="334.7109" x2="586.2095" y1="1997.9297" y2="1997.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.0503" x="346.7109" y="1992.8638">Public Key</text><polygon fill="#000000" points="1364.4287,2023.0625,1374.4287,2027.0625,1364.4287,2031.0625,1368.4287,2027.0625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="329.7109" x2="1370.4287" y1="2027.0625" y2="2027.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.4722" x="336.7109" y="2021.9966">Request Attestation Challenge</text><polygon fill="#000000" points="340.7109,2052.1953,330.7109,2056.1953,340.7109,2060.1953,336.7109,2056.1953" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="334.7109" x2="1380.4287" y1="2056.1953" y2="2056.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.9497" x="346.7109" y="2051.1294">Attestation Challenge</text><polygon fill="#000000" points="570.2095,2091.8945,580.2095,2095.8945,570.2095,2099.8945,574.2095,2095.8945" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="329.7109" x2="576.2095" y1="2095.8945" y2="2095.8945"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233.4985" x="336.7109" y="2090.8286">Sign Challenge with Attestation Key</text><path d="M597,2069.1953 L597,2109.1953 L885,2109.1953 L885,2079.1953 L875,2069.1953 L597,2069.1953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M875,2069.1953 L875,2079.1953 L885,2079.1953 L875,2069.1953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267.8267" x="603" y="2086.2622">Using Android SafetyNet/Play Integrity or</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.2412" x="603" y="2101.395">iOS DeviceCheck/App Attest API</text><polygon fill="#000000" points="340.7109,2131.5938,330.7109,2135.5938,340.7109,2139.5938,336.7109,2135.5938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="334.7109" x2="586.2095" y1="2135.5938" y2="2135.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.3647" x="346.7109" y="2130.5278">Attestation Statement</text><polygon fill="#000000" points="979.4287,2171.293,989.4287,2175.293,979.4287,2179.293,983.4287,2175.293" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="329.7109" x2="985.4287" y1="2175.293" y2="2175.293"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="377.4507" x="336.7109" y="2170.2271">Client Registration Request (Resource Server B, with JWT)</text><path d="M1006,2148.5938 L1006,2188.5938 L1306,2188.5938 L1306,2158.5938 L1296,2148.5938 L1006,2148.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1296,2148.5938 L1296,2158.5938 L1306,2158.5938 L1296,2148.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279.0493" x="1012" y="2165.6606">Includes attestation statement, public key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229.2583" x="1012" y="2180.7935">and potentially software statement</text><polygon fill="#000000" points="1364.4287,2213.9922,1374.4287,2217.9922,1364.4287,2221.9922,1368.4287,2217.9922" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1001.4287" x2="1370.4287" y1="2217.9922" y2="2217.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.8413" x="1008.4287" y="2212.9263">Verify Client Attestation</text><path d="M1391,2198.8594 L1391,2223.8594 L1756,2223.8594 L1756,2208.8594 L1746,2198.8594 L1391,2198.8594 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1746,2198.8594 L1746,2208.8594 L1756,2208.8594 L1746,2198.8594 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="344.9316" x="1397" y="2215.9263">AS B forwards attestation data to Attestation Service</text><line style="stroke:#000000;stroke-width:1;" x1="1386.4287" x2="1428.4287" y1="2250.125" y2="2250.125"/><line style="stroke:#000000;stroke-width:1;" x1="1428.4287" x2="1428.4287" y1="2250.125" y2="2263.125"/><line style="stroke:#000000;stroke-width:1;" x1="1387.4287" x2="1428.4287" y1="2263.125" y2="2263.125"/><polygon fill="#000000" points="1397.4287,2259.125,1387.4287,2263.125,1397.4287,2267.125,1393.4287,2263.125" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.8936" x="1393.4287" y="2245.0591">Validate Attestation Statement</text><polygon fill="#000000" points="1012.4287,2288.2578,1002.4287,2292.2578,1012.4287,2296.2578,1008.4287,2292.2578" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1006.4287" x2="1380.4287" y1="2292.2578" y2="2292.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.8921" x="1018.4287" y="2287.1919">Attestation Verification Result</text><line style="stroke:#000000;stroke-width:1;" x1="1001.4287" x2="1043.4287" y1="2321.3906" y2="2321.3906"/><line style="stroke:#000000;stroke-width:1;" x1="1043.4287" x2="1043.4287" y1="2321.3906" y2="2334.3906"/><line style="stroke:#000000;stroke-width:1;" x1="1002.4287" x2="1043.4287" y1="2334.3906" y2="2334.3906"/><polygon fill="#000000" points="1012.4287,2330.3906,1002.4287,2334.3906,1012.4287,2338.3906,1008.4287,2334.3906" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.3994" x="1008.4287" y="2316.3247">Extract "iss" from JWT (AS_A_ID)</text><polygon fill="#000000" points="1600.3223,2359.5234,1610.3223,2363.5234,1600.3223,2367.5234,1604.3223,2363.5234" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1001.4287" x2="1606.3223" y1="2363.5234" y2="2363.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="194.105" x="1008.4287" y="2358.4575">Get Entity Statement for AS A</text><polygon fill="#000000" points="1012.4287,2388.6563,1002.4287,2392.6563,1012.4287,2396.6563,1008.4287,2392.6563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1006.4287" x2="1616.3223" y1="2392.6563" y2="2392.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="318.2397" x="1018.4287" y="2387.5903">Entity Statement for AS A (including Public Keys)</text><line style="stroke:#000000;stroke-width:1;" x1="1001.4287" x2="1043.4287" y1="2421.7891" y2="2421.7891"/><line style="stroke:#000000;stroke-width:1;" x1="1043.4287" x2="1043.4287" y1="2421.7891" y2="2434.7891"/><line style="stroke:#000000;stroke-width:1;" x1="1002.4287" x2="1043.4287" y1="2434.7891" y2="2434.7891"/><polygon fill="#000000" points="1012.4287,2430.7891,1002.4287,2434.7891,1012.4287,2438.7891,1008.4287,2434.7891" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="299.2349" x="1008.4287" y="2416.7231">Verify JWT Signature (using AS A's Public Key)</text><line style="stroke:#000000;stroke-width:1;" x1="1001.4287" x2="1043.4287" y1="2463.9219" y2="2463.9219"/><line style="stroke:#000000;stroke-width:1;" x1="1043.4287" x2="1043.4287" y1="2463.9219" y2="2476.9219"/><line style="stroke:#000000;stroke-width:1;" x1="1002.4287" x2="1043.4287" y1="2476.9219" y2="2476.9219"/><polygon fill="#000000" points="1012.4287,2472.9219,1002.4287,2476.9219,1012.4287,2480.9219,1008.4287,2476.9219" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351" x="1008.4287" y="2458.856">Validate JWT Claims (iss, aud, exp, iat, email_verified)</text><path d="M10,2491.9219 L74.4429,2491.9219 L74.4429,2499.0547 L64.4429,2509.0547 L10,2509.0547 L10,2491.9219 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="378.3984" style="stroke:#000000;stroke-width:1.5;" width="1995.1938" x="10" y="2491.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="2504.9888">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="68.9648" x="89.4429" y="2504.1323">[JWT Valid]</text><polygon fill="#000000" points="1906.4165,2526.1875,1916.4165,2530.1875,1906.4165,2534.1875,1910.4165,2530.1875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1001.4287" x2="1912.4165" y1="2530.1875" y2="2530.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.5288" x="1008.4287" y="2525.1216">Complete Client Registration</text><polygon fill="#000000" points="1012.4287,2555.3203,1002.4287,2559.3203,1012.4287,2563.3203,1008.4287,2559.3203" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1006.4287" x2="1922.4165" y1="2559.3203" y2="2559.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.335" x="1018.4287" y="2554.2544">Confirmation</text><polygon fill="#000000" points="340.7109,2584.4531,330.7109,2588.4531,340.7109,2592.4531,336.7109,2588.4531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="334.7109" x2="990.4287" y1="2588.4531" y2="2588.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.2075" x="346.7109" y="2583.3872">Client Registration Success</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="10" x2="2005.1938" y1="2597.4531" y2="2597.4531"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="147.2002" x="15" y="2607.6636">[JWT Invalid or Expired]</text><polygon fill="#000000" points="86.8999,2628.3906,76.8999,2632.3906,86.8999,2636.3906,82.8999,2632.3906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="80.8999" x2="990.4287" y1="2632.3906" y2="2632.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.0571" x="92.8999" y="2627.3247">Request Email Confirmation</text><polygon fill="#000000" points="979.4287,2657.5234,989.4287,2661.5234,979.4287,2665.5234,983.4287,2661.5234" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="75.8999" x2="985.4287" y1="2661.5234" y2="2661.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.8306" x="82.8999" y="2656.4575">User Email</text><line style="stroke:#000000;stroke-width:1;" x1="1001.4287" x2="1043.4287" y1="2690.6563" y2="2690.6563"/><line style="stroke:#000000;stroke-width:1;" x1="1043.4287" x2="1043.4287" y1="2690.6563" y2="2703.6563"/><line style="stroke:#000000;stroke-width:1;" x1="1002.4287" x2="1043.4287" y1="2703.6563" y2="2703.6563"/><polygon fill="#000000" points="1012.4287,2699.6563,1002.4287,2703.6563,1012.4287,2707.6563,1008.4287,2703.6563" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161.4082" x="1008.4287" y="2685.5903">Send Confirmation Email</text><polygon fill="#000000" points="979.4287,2728.7891,989.4287,2732.7891,979.4287,2736.7891,983.4287,2732.7891" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="75.8999" x2="985.4287" y1="2732.7891" y2="2732.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.7344" x="82.8999" y="2727.7231">User Clicks Confirmation Link</text><line style="stroke:#000000;stroke-width:1;" x1="1001.4287" x2="1043.4287" y1="2761.9219" y2="2761.9219"/><line style="stroke:#000000;stroke-width:1;" x1="1043.4287" x2="1043.4287" y1="2761.9219" y2="2774.9219"/><line style="stroke:#000000;stroke-width:1;" x1="1002.4287" x2="1043.4287" y1="2774.9219" y2="2774.9219"/><polygon fill="#000000" points="1012.4287,2770.9219,1002.4287,2774.9219,1012.4287,2778.9219,1008.4287,2774.9219" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.7847" x="1008.4287" y="2756.856">Verify Email Confirmation</text><polygon fill="#000000" points="1906.4165,2800.0547,1916.4165,2804.0547,1906.4165,2808.0547,1910.4165,2804.0547" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1001.4287" x2="1912.4165" y1="2804.0547" y2="2804.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.5288" x="1008.4287" y="2798.9888">Complete Client Registration</text><polygon fill="#000000" points="1012.4287,2829.1875,1002.4287,2833.1875,1012.4287,2837.1875,1008.4287,2833.1875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1006.4287" x2="1922.4165" y1="2833.1875" y2="2833.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.335" x="1018.4287" y="2828.1216">Confirmation</text><polygon fill="#000000" points="340.7109,2858.3203,330.7109,2862.3203,340.7109,2866.3203,336.7109,2862.3203" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="334.7109" x2="990.4287" y1="2862.3203" y2="2862.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.2075" x="346.7109" y="2857.2544">Client Registration Success</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2225.6978" x="0" y="2897.8867"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2225.6978" y1="2897.8867" y2="2897.8867"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="2225.6978" y1="2900.8867" y2="2900.8867"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="620.728" x="802.4849" y="2887.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="602.2021" x="808.4849" y="2903.3872">OAuth 2.0 Authorization Code Flow with PAR, PKCE and DPoP (Resource Server B)</text><line style="stroke:#000000;stroke-width:1;" x1="329.7109" x2="371.7109" y1="2941.5859" y2="2941.5859"/><line style="stroke:#000000;stroke-width:1;" x1="371.7109" x2="371.7109" y1="2941.5859" y2="2954.5859"/><line style="stroke:#000000;stroke-width:1;" x1="330.7109" x2="371.7109" y1="2954.5859" y2="2954.5859"/><polygon fill="#000000" points="340.7109,2950.5859,330.7109,2954.5859,340.7109,2958.5859,336.7109,2954.5859" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.4272" x="336.7109" y="2936.52">Generate PKCE Code Verifier</text><line style="stroke:#000000;stroke-width:1;" x1="329.7109" x2="371.7109" y1="2983.7188" y2="2983.7188"/><line style="stroke:#000000;stroke-width:1;" x1="371.7109" x2="371.7109" y1="2983.7188" y2="2996.7188"/><line style="stroke:#000000;stroke-width:1;" x1="330.7109" x2="371.7109" y1="2996.7188" y2="2996.7188"/><polygon fill="#000000" points="340.7109,2992.7188,330.7109,2996.7188,340.7109,3000.7188,336.7109,2996.7188" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.042" x="336.7109" y="2978.6528">Generate PKCE Code Challenge</text><line style="stroke:#000000;stroke-width:1;" x1="329.7109" x2="371.7109" y1="3025.8516" y2="3025.8516"/><line style="stroke:#000000;stroke-width:1;" x1="371.7109" x2="371.7109" y1="3025.8516" y2="3038.8516"/><line style="stroke:#000000;stroke-width:1;" x1="330.7109" x2="371.7109" y1="3038.8516" y2="3038.8516"/><polygon fill="#000000" points="340.7109,3034.8516,330.7109,3038.8516,340.7109,3042.8516,336.7109,3038.8516" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.7334" x="336.7109" y="3020.7856">Generate DPoP Key Pair</text><polygon fill="#000000" points="979.4287,3074.5508,989.4287,3078.5508,979.4287,3082.5508,983.4287,3078.5508" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="329.7109" x2="985.4287" y1="3078.5508" y2="3078.5508"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.2876" x="336.7109" y="3073.4849">PAR Request</text><path d="M1006,3051.8516 L1006,3091.8516 L1497,3091.8516 L1497,3061.8516 L1487,3051.8516 L1006,3051.8516 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1487,3051.8516 L1487,3061.8516 L1497,3061.8516 L1487,3051.8516 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.0063" x="1012" y="3068.9185">Authorization Code Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="470.6597" x="1012" y="3084.0513">(inkl. DPoP Proof, code_challenge, code_challenge_method, redirect_uri)</text><line style="stroke:#000000;stroke-width:1;" x1="1001.4287" x2="1043.4287" y1="3118.25" y2="3118.25"/><line style="stroke:#000000;stroke-width:1;" x1="1043.4287" x2="1043.4287" y1="3118.25" y2="3131.25"/><line style="stroke:#000000;stroke-width:1;" x1="1002.4287" x2="1043.4287" y1="3131.25" y2="3131.25"/><polygon fill="#000000" points="1012.4287,3127.25,1002.4287,3131.25,1012.4287,3135.25,1008.4287,3131.25" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.9717" x="1008.4287" y="3113.1841">Validate DPoP Proof</text><polygon fill="#000000" points="340.7109,3156.3828,330.7109,3160.3828,340.7109,3164.3828,336.7109,3160.3828" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="334.7109" x2="995.4287" y1="3160.3828" y2="3160.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.9043" x="346.7109" y="3155.3169">Request URI</text><polygon fill="#000000" points="91.8999,3185.5156,81.8999,3189.5156,91.8999,3193.5156,87.8999,3189.5156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="85.8999" x2="318.7109" y1="3189.5156" y2="3189.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.5293" x="97.8999" y="3184.4497">Navigate to Request URI</text><polygon fill="#000000" points="979.4287,3214.6484,989.4287,3218.6484,979.4287,3222.6484,983.4287,3218.6484" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="80.8999" x2="985.4287" y1="3218.6484" y2="3218.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270.4863" x="87.8999" y="3213.5825">Authorization Request (with Request URI)</text><polygon fill="#000000" points="2006.8696,3254.3477,2016.8696,3258.3477,2006.8696,3262.3477,2010.8696,3258.3477" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1001.4287" x2="2012.8696" y1="3258.3477" y2="3258.3477"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.6792" x="1008.4287" y="3253.2817">Authentication Request (OpenID Connect)</text><path d="M2033,3231.6484 L2033,3271.6484 L2224,3271.6484 L2224,3241.6484 L2214,3231.6484 L2033,3231.6484 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2214,3231.6484 L2214,3241.6484 L2224,3241.6484 L2214,3231.6484 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.8281" x="2039" y="3248.7153">AS B acts as Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.1577" x="2043.1323" y="3263.8481">for the IDP</text><polygon fill="#000000" points="91.8999,3294.0469,81.8999,3298.0469,91.8999,3302.0469,87.8999,3298.0469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="85.8999" x2="2017.8696" y1="3298.0469" y2="3298.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.7134" x="97.8999" y="3292.981">Authentication Prompt</text><polygon fill="#000000" points="2006.8696,3323.1797,2016.8696,3327.1797,2006.8696,3331.1797,2010.8696,3327.1797" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="80.8999" x2="2012.8696" y1="3327.1797" y2="3327.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.7324" x="87.8999" y="3322.1138">User Credentials</text><polygon fill="#000000" points="1012.4287,3352.3125,1002.4287,3356.3125,1012.4287,3360.3125,1008.4287,3356.3125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1006.4287" x2="2022.8696" y1="3356.3125" y2="3356.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331.2842" x="1018.4287" y="3351.2466">Authentication Response (ID Token, Access Token)</text><line style="stroke:#000000;stroke-width:1;" x1="1001.4287" x2="1043.4287" y1="3385.4453" y2="3385.4453"/><line style="stroke:#000000;stroke-width:1;" x1="1043.4287" x2="1043.4287" y1="3385.4453" y2="3398.4453"/><line style="stroke:#000000;stroke-width:1;" x1="1002.4287" x2="1043.4287" y1="3398.4453" y2="3398.4453"/><polygon fill="#000000" points="1012.4287,3394.4453,1002.4287,3398.4453,1012.4287,3402.4453,1008.4287,3398.4453" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.0918" x="1008.4287" y="3380.3794">Validate ID Token &amp; Access Token</text><polygon fill="#000000" points="91.8999,3423.5781,81.8999,3427.5781,91.8999,3431.5781,87.8999,3427.5781" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="85.8999" x2="990.4287" y1="3427.5781" y2="3427.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.4839" x="97.8999" y="3422.5122">Authorization Code</text><polygon fill="#000000" points="312.7109,3452.7109,322.7109,3456.7109,312.7109,3460.7109,316.7109,3456.7109" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="75.8999" x2="318.7109" y1="3456.7109" y2="3456.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.811" x="82.8999" y="3451.645">Redirect with Authorization Code</text><line style="stroke:#000000;stroke-width:1;" x1="334.7109" x2="376.7109" y1="3485.8438" y2="3485.8438"/><line style="stroke:#000000;stroke-width:1;" x1="376.7109" x2="376.7109" y1="3485.8438" y2="3498.8438"/><line style="stroke:#000000;stroke-width:1;" x1="335.7109" x2="376.7109" y1="3498.8438" y2="3498.8438"/><polygon fill="#000000" points="345.7109,3494.8438,335.7109,3498.8438,345.7109,3502.8438,341.7109,3498.8438" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.7334" x="341.7109" y="3480.7778">Generate DPoP Key Pair</text><polygon fill="#000000" points="984.4287,3542.1094,994.4287,3546.1094,984.4287,3550.1094,988.4287,3546.1094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="334.7109" x2="990.4287" y1="3546.1094" y2="3546.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.7959" x="341.7109" y="3541.0435">Token Request (Authorization Code Grant)</text><path d="M1011,3511.8438 L1011,3566.8438 L1290,3566.8438 L1290,3521.8438 L1280,3511.8438 L1011,3511.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1280,3511.8438 L1280,3521.8438 L1290,3521.8438 L1280,3511.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.9209" x="1017" y="3528.9106">Enth&#228;lt Authorization Code, DPoP Proof,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.4243" x="1017" y="3544.0435">Client Assertion (JWT, RFC7523),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.7847" x="1017" y="3559.1763">redirect_uri, code_verifier</text><line style="stroke:#000000;stroke-width:1;" x1="1006.4287" x2="1048.4287" y1="3593.375" y2="3593.375"/><line style="stroke:#000000;stroke-width:1;" x1="1048.4287" x2="1048.4287" y1="3593.375" y2="3606.375"/><line style="stroke:#000000;stroke-width:1;" x1="1007.4287" x2="1048.4287" y1="3606.375" y2="3606.375"/><polygon fill="#000000" points="1017.4287,3602.375,1007.4287,3606.375,1017.4287,3610.375,1013.4287,3606.375" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.8848" x="1013.4287" y="3588.3091">Validate Client Assertion (JWT)</text><line style="stroke:#000000;stroke-width:1;" x1="1006.4287" x2="1048.4287" y1="3635.5078" y2="3635.5078"/><line style="stroke:#000000;stroke-width:1;" x1="1048.4287" x2="1048.4287" y1="3635.5078" y2="3648.5078"/><line style="stroke:#000000;stroke-width:1;" x1="1007.4287" x2="1048.4287" y1="3648.5078" y2="3648.5078"/><polygon fill="#000000" points="1017.4287,3644.5078,1007.4287,3648.5078,1017.4287,3652.5078,1013.4287,3648.5078" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.9717" x="1013.4287" y="3630.4419">Validate DPoP Proof</text><line style="stroke:#000000;stroke-width:1;" x1="1006.4287" x2="1048.4287" y1="3677.6406" y2="3677.6406"/><line style="stroke:#000000;stroke-width:1;" x1="1048.4287" x2="1048.4287" y1="3677.6406" y2="3690.6406"/><line style="stroke:#000000;stroke-width:1;" x1="1007.4287" x2="1048.4287" y1="3690.6406" y2="3690.6406"/><polygon fill="#000000" points="1017.4287,3686.6406,1007.4287,3690.6406,1017.4287,3694.6406,1013.4287,3690.6406" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.1084" x="1013.4287" y="3672.5747">Validate PKCE Code Verifier</text><polygon fill="#000000" points="2006.8696,3715.7734,2016.8696,3719.7734,2006.8696,3723.7734,2010.8696,3719.7734" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1006.4287" x2="2012.8696" y1="3719.7734" y2="3719.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.4292" x="1013.4287" y="3714.7075">Validate Token (Optional)</text><polygon fill="#000000" points="1017.4287,3744.9063,1007.4287,3748.9063,1017.4287,3752.9063,1013.4287,3748.9063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1011.4287" x2="2022.8696" y1="3748.9063" y2="3748.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.0874" x="1023.4287" y="3743.8403">Validation Result</text><polygon fill="#000000" points="345.7109,3784.6055,335.7109,3788.6055,345.7109,3792.6055,341.7109,3788.6055" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="339.7109" x2="990.4287" y1="3788.6055" y2="3788.6055"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295.3501" x="351.7109" y="3783.5396">Access Token (JWT), Refresh Token, ID Token</text><path d="M139,3761.9063 L139,3801.9063 L314,3801.9063 L314,3771.9063 L304,3761.9063 L139,3761.9063 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M304,3761.9063 L304,3771.9063 L314,3771.9063 L304,3761.9063 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.7759" x="145" y="3778.9731">Access Token bound to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.4258" x="145" y="3794.106">client's DPoP public key</text><line style="stroke:#000000;stroke-width:1;" x1="334.7109" x2="376.7109" y1="3828.3047" y2="3828.3047"/><line style="stroke:#000000;stroke-width:1;" x1="376.7109" x2="376.7109" y1="3828.3047" y2="3841.3047"/><line style="stroke:#000000;stroke-width:1;" x1="335.7109" x2="376.7109" y1="3841.3047" y2="3841.3047"/><polygon fill="#000000" points="345.7109,3837.3047,335.7109,3841.3047,345.7109,3845.3047,341.7109,3841.3047" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.7334" x="341.7109" y="3823.2388">Generate DPoP Key Pair</text><polygon fill="#000000" points="1906.4165,3869.4375,1916.4165,3873.4375,1906.4165,3877.4375,1910.4165,3873.4375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="334.7109" x2="1912.4165" y1="3873.4375" y2="3873.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310.7241" x="341.7109" y="3868.3716">Access Protected Resource (with Access Token)</text><path d="M1933,3854.3047 L1933,3879.3047 L2122,3879.3047 L2122,3864.3047 L2112,3854.3047 L1933,3854.3047 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2112,3854.3047 L2112,3864.3047 L2122,3864.3047 L2112,3854.3047 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.2319" x="1939" y="3871.3716">Access Token, DPoP Proof</text><polygon fill="#000000" points="1017.4287,3904.5703,1007.4287,3908.5703,1017.4287,3912.5703,1013.4287,3908.5703" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1011.4287" x2="1917.4165" y1="3908.5703" y2="3908.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.0532" x="1023.4287" y="3903.5044">Validate Access Token</text><path d="M1933,3889.4375 L1933,3914.4375 L2151,3914.4375 L2151,3899.4375 L2141,3889.4375 L1933,3889.4375 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2141,3889.4375 L2141,3899.4375 L2151,3899.4375 L2141,3889.4375 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.5835" x="1939" y="3906.5044">includes DPoP Proof validation</text><polygon fill="#000000" points="1906.4165,3936.7031,1916.4165,3940.7031,1906.4165,3944.7031,1910.4165,3940.7031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1001.4287" x2="1912.4165" y1="3940.7031" y2="3940.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.0874" x="1008.4287" y="3935.6372">Validation Result</text><polygon fill="#000000" points="345.7109,3965.8359,335.7109,3969.8359,345.7109,3973.8359,341.7109,3969.8359" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="339.7109" x2="1922.4165" y1="3969.8359" y2="3969.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.6592" x="351.7109" y="3964.77">Resource Data</text><!--SRC=[xLZzRjis4FzVJt78WCq6tAJeC0mma06cunHPkzQms-sV08OYqJOHcT98sgatx6ts9dkn7JyaaRAKkbcs54DR5BN9k-Dzt_qiRnalOX5lGD9VjvGd57wF0AQnK2nXHSmLoKLAnJZFSW4tMPpSDgxnP2NoBKyjoTsQAOeaeqJbeetNNdHn2P7VXVIlsPA-PfosoQhk6kA-kdok_oB5crorSfhp0wx9vMGyYVw8eg8s44xUIofWjA9SdK0iGNyrtqAgSSPA2linl1xnLEGiXNUJoHbxEuSvJRQ2meGdMRoZXiqUkPC6znn6XcOq7ntS47T36ZTAKQbYnNAEeiME9VOPF7TVG_fBYbwov3_5Kb5XgF7KVWk9PrJcMu7PeaLfznZYMLEx9XbnP0rLhowcvWB_ZwBpS-T0cD4LayhfTCVK6WwUXPuvTmoUoNquFuyYT_xiXz2vGtX9kJQMmYkwntHc0fQO0Hv_52UAxJH561QEYGE2hTPgY9d0-0gyo0BAE0nk54Y0PwYDrMi8q-rDnXAjH9JIZXTh6-h83T4JMAuoC1d6wpZBA5_HMdalsFN7G8Ls0PusdeXETyxPokEsiV85QmC_sQ7pU4dL_WrLPzCitiCLLtGbcDgZbw-vTlC5rLgDrpIvFHiLXNiHHjEhUrmUb0N-JpUwLe_n_dmqRCtCCXIzW-piUu70ql1DlKBvsvHAY3rzPAdF00gR6RTqFxZcCK-XG6Qk6Bfu3p9VghiOCwnYY51-CqL-fe8jzosrqPeUldAwtUY2m3VIKCCqLZ6e75gQIv1W3KtYZANklHRd-q_JqzKfc922nAIA5SPY03ijG8U-G9lorBaaDV4_Yp7qh4eEBNuhczbkWkU_Rfp3aZA2SfkfZgHtdgtQVbrxaqtCCXZdVCd4fk7PUafKdweaCWF5C5TXqyTpYZRvqXnDXm2CQt8hGmOSXhU1J9S3BPhwL5KtFAI37tzvPxsjm-4gUxuOVIEX4DPKpD5htjjAcfecgciuev1uGguv2jgWYrcXRsn22g-6P3z80dmJpOlPHWwlEJm39kNGlBgukZ07Sdip17nHB5Xg3k9jQYW8Ka0FjS0wmUzzSqa_54FeoNKk52YseVQKnVXIZ-TtZaYRljYPjA0eJ8ajDHSxBrCMcXrJQ5CurjADPNTfxm-oG1EfcrLeN3z8DUmCUkYz7MtnziNfSz0VSi5-SqqvJobSPlcTTVvqD1l0zDLu0Zee5zDysjPuzFIhMrUfNHLdmsy4sph0yNuKTJqWxY4tEfLpjTb0KVsoVhgROui370yc6gPuTceVcOeyNmumrLAwI4hLcjyN6uhIqW4cNCe4JTHYArW_h9AoFzLIxRrdNbdqxsTN1z6hRVIwn9junrQQ1DkbptnKYmWzK4qOjmHLmXe3njc4QvILe0T6qX3njg0SQmHhdAClF05w-JeO0dWhpSf6ixsUpNhpnsetXOxo3HF-CvxoR6yyZXxT50qpZPAsaM5Wx6YJbQpA2O49PHsX_k_oMye7Y2OIAgNz5bILLgmrn2KlV1qmL_5kM16cOMX2dHesiLntFEJozAg3NXqvkE0HkPC75vari0fvIpcz5BXutxEUJBXQ__Ldfbgi6VYrTytBzKAYOOQcXmrk0BFByVVVlVYsZnH-tRdYt9LTfpL4hIAFhDZcVKkdywkaehCkm-hG3yPPeow2j7GyxOj3bNV-okdbcRK5_KENWifrcSTbLjeWP7JPPBlHE1LRoJMtunFdhp6ztXFlwKf7Py_Cb9rz5vsgC6eurQlnOljFM7FLcxDc4_V8_9o9Pcrn2cgnCorPkJNNuknkwEqqfHdtXaaBdXrqU6Vc1IwvFl7CJUYZOIdfXALcQEiC-09Fly3JHuQdv1FXAHb0lP1wbK7-PQ1A7XMealyGg1w0Il9mK4cge4q-OAXmUpX1c7C2IzoL303gES3JBuchd-9qVr1wHEjigxIpBGANjjfhzOztrQTQyKv-wDasQ_QzgWF8OBsg9VkMk41gxUSbU0T4XgPiK38EhLfWFsGjFLzZFzH3oe66TWCDuGOQiGqQE0qJ5vSKpMC4H81_dDYPAGXSF3DQxnH-PHXYhyaJSp3Jt5Kz-OXPtmPJWTJFVGG2phTcl4KqazR2Asx6bkx8amy5haU1wiVzrX2eN- -L-hW1A4ZmcuFtaBdg-jtX7a6TlpqqPNV__l2PHof2fuGB0tbib4u-KvHEEb4wUGAKtj8YWfsV78VIoQEZTF8mb4vAcnuDfPCdHEdaCL1wIuYxKJhvVw1qyZ2KJfu8fRU4g1Eb7r6npVjMb4uUZjB9KIYTF3bA9mz4wUGVe7HoB4flYLCNIYUVXjA9G-daeoYTHBE33j-9qadqDm00]--></g></svg>