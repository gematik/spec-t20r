<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="5194px" preserveAspectRatio="none" style="width:1803px;height:5194px;background:#FFFFFF;" version="1.1" viewBox="0 0 1803 5194" width="1803px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="5182.7344" style="stroke:#181818;stroke-width:0.5;" width="469.4883" x="44.3965" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="239.7217" y="15.2822">Mobile Device</text><rect fill="#C9FFC9" height="5182.7344" style="stroke:#181818;stroke-width:0.5;" width="453.6069" x="525.8848" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="722.7175" y="15.2822">Anbieter A</text><rect fill="#F4A460" height="5166.0938" style="stroke:#181818;stroke-width:0.5;" width="335.2832" x="525.8848" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="660.3818" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="5166.0938" style="stroke:#181818;stroke-width:0.5;" width="68.5283" x="910.9634" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="927.0464" y="31.9229">TI 2.0</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="927.0464" y="43.5635">Dienst</text><rect fill="#C9FFC9" height="5182.7344" style="stroke:#181818;stroke-width:0.5;" width="468.8657" x="991.4917" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1196.0125" y="15.2822">Anbieter B</text><rect fill="#F4A460" height="5166.0938" style="stroke:#181818;stroke-width:0.5;" width="350.542" x="991.4917" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1133.6182" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="5166.0938" style="stroke:#181818;stroke-width:0.5;" width="68.5283" x="1391.8291" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1407.9121" y="31.9229">TI 2.0</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="1407.9121" y="43.5635">Dienst</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="24" x2="24" y1="121.5625" y2="5111.0938"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="83.1821" x2="83.1821" y1="121.5625" y2="5111.0938"/><rect fill="#F0F0F0" height="37.2813" style="stroke:#000000;stroke-width:1;" width="10" x="78.1821" y="850.0625"/><rect fill="#F0F0F0" height="463.1719" style="stroke:#000000;stroke-width:1;" width="10" x="78.1821" y="1400.0781"/><rect fill="#F0F0F0" height="235.7656" style="stroke:#000000;stroke-width:1;" width="10" x="78.1821" y="4235.6719"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="182.0552" x2="182.0552" y1="121.5625" y2="5111.0938"/><rect fill="#F0F0F0" height="116.8438" style="stroke:#000000;stroke-width:1;" width="10" x="177.0552" y="733.2188"/><rect fill="#F0F0F0" height="45.6406" style="stroke:#000000;stroke-width:1;" width="10" x="177.0552" y="3532.375"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="309.2925" x2="309.2925" y1="121.5625" y2="5111.0938"/><rect fill="#F0F0F0" height="4906.25" style="stroke:#000000;stroke-width:1;" width="10" x="304.2925" y="186.8438"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="454.3423" x2="454.3423" y1="121.5625" y2="5111.0938"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="449.3423" y="224.125"/><rect fill="#F0F0F0" height="31.6406" style="stroke:#000000;stroke-width:1;" width="10" x="449.3423" y="338.3281"/><rect fill="#F0F0F0" height="31.6406" style="stroke:#000000;stroke-width:1;" width="10" x="449.3423" y="2511.5469"/><rect fill="#F0F0F0" height="31.6406" style="stroke:#000000;stroke-width:1;" width="10" x="449.3423" y="2631.75"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="551.7773" x2="551.7773" y1="121.5625" y2="5111.0938"/><rect fill="#F0F0F0" height="692.4219" style="stroke:#000000;stroke-width:1;" width="10" x="546.7773" y="395.6094"/><rect fill="#F0F0F0" height="81.9219" style="stroke:#000000;stroke-width:1;" width="10" x="546.7773" y="1292.5156"/><rect fill="#F0F0F0" height="776.5" style="stroke:#000000;stroke-width:1;" width="10" x="546.7773" y="1425.7188"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="546.7773" y="3157.4844"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="685.5332" x2="685.5332" y1="121.5625" y2="5111.0938"/><rect fill="#F0F0F0" height="138.8438" style="stroke:#000000;stroke-width:1;" width="10" x="680.5332" y="2295.7813"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="816.8818" x2="816.8818" y1="121.5625" y2="5111.0938"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="811.8818" y="581.375"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="811.8818" y="2083.0156"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="945.2275" x2="945.2275" y1="121.5625" y2="5111.0938"/><rect fill="#F0F0F0" height="64.2813" style="stroke:#000000;stroke-width:1;" width="10" x="940.2275" y="2383.3438"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1017.3843" x2="1017.3843" y1="121.5625" y2="5111.0938"/><rect fill="#F0F0F0" height="2422.0625" style="stroke:#000000;stroke-width:1;" width="10" x="1012.3843" y="2689.0313"/><rect fill="#F0F0F0" height="227.7656" style="stroke:#000000;stroke-width:1;" width="10" x="1017.3843" y="3578.0156"/><rect fill="#F0F0F0" height="212.7656" style="stroke:#000000;stroke-width:1;" width="10" x="1017.3843" y="3997.2656"/><rect fill="#F0F0F0" height="849.7813" style="stroke:#000000;stroke-width:1;" width="10" x="1017.3843" y="4261.3125"/><rect fill="#F0F0F0" height="324.9688" style="stroke:#000000;stroke-width:1;" width="10" x="1022.3843" y="4535.7188"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1166.3989" x2="1166.3989" y1="121.5625" y2="5111.0938"/><rect fill="#F0F0F0" height="138.8438" style="stroke:#000000;stroke-width:1;" width="10" x="1161.3989" y="4954.25"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1297.7476" x2="1297.7476" y1="121.5625" y2="5111.0938"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1292.7476" y="2863.1563"/><rect fill="#F0F0F0" height="87.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1292.7476" y="3665.5781"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1292.7476" y="4090.8281"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1292.7476" y="4741.4844"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1426.0933" x2="1426.0933" y1="121.5625" y2="5111.0938"/><rect fill="#F0F0F0" height="64.2813" style="stroke:#000000;stroke-width:1;" width="10" x="1421.0933" y="5041.8125"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1510.9819" x2="1510.9819" y1="121.5625" y2="5111.0938"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="1505.9819" y="275.4063"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1505.9819" y="450.5313"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="1505.9819" y="2568.8281"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1505.9819" y="2732.3125"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1629.4839" x2="1629.4839" y1="121.5625" y2="5111.0938"/><rect fill="#F0F0F0" height="310.3281" style="stroke:#000000;stroke-width:1;" width="10" x="1624.4839" y="1451.3594"/><rect fill="#F0F0F0" height="94.5625" style="stroke:#000000;stroke-width:1;" width="10" x="1624.4839" y="4286.9531"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1715.4614" x2="1715.4614" y1="121.5625" y2="5111.0938"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="1710.4614" y="2982.3594"/><text fill="#000000" font-family="sans-serif" font-size="10" x="9.6035" y="119.2041">User</text><ellipse cx="24" cy="58.4219" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M24,66.4219 L24,93.4219 M11,74.4219 L37,74.4219 M24,93.4219 L11,108.4219 M24,93.4219 L37,108.4219 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="48.3965" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="55.3965" y="111.2041">User Agent</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="147.2695" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="171.8989" y="99.5635">Mail</text><text fill="#000000" font-family="sans-serif" font-size="10" x="154.2695" y="111.2041">User Agent</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="42.9502" x="287.8174" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="294.8174" y="111.2041">Client</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="111.085" x="398.7998" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="417.2354" y="99.5635">Android TEE or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="405.7998" y="111.2041">iOS Secure Enclave</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="529.8848" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.897" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="536.8848" y="111.2041">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="650.0127" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="676.3438" y="99.5635">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.0127" y="111.2041">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="776.5957" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="807.0015" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="783.5957" y="111.2041">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="914.9634" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="921.9634" y="99.5635">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="928.8311" y="111.2041">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="995.4917" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1007.5039" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1002.4917" y="111.2041">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="1130.8784" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1157.2095" y="99.5635">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1137.8784" y="111.2041">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="1257.4614" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1287.8672" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1264.4614" y="111.2041">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="1395.8291" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1402.8291" y="99.5635">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1409.6968" y="111.2041">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.249" x="1476.3574" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1483.3574" y="99.5635">Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1492.5029" y="111.2041">Service</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="30.6797" x="1614.144" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1621.144" y="111.2041">IDP</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="70.9775" x="1679.9727" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1686.9727" y="99.5635">Federation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1698.3862" y="111.2041">Master</text><text fill="#000000" font-family="sans-serif" font-size="10" x="9.6035" y="5180.376">User</text><ellipse cx="24" cy="5119.5938" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M24,5127.5938 L24,5154.5938 M11,5135.5938 L37,5135.5938 M24,5154.5938 L11,5169.5938 M24,5154.5938 L37,5169.5938 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="48.3965" y="5111.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="55.3965" y="5127.376">User Agent</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="147.2695" y="5111.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="171.8989" y="5127.376">Mail</text><text fill="#000000" font-family="sans-serif" font-size="10" x="154.2695" y="5139.0166">User Agent</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="42.9502" x="287.8174" y="5111.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="294.8174" y="5127.376">Client</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="111.085" x="398.7998" y="5111.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="417.2354" y="5127.376">Android TEE or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="405.7998" y="5139.0166">iOS Secure Enclave</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="529.8848" y="5111.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.897" y="5127.376">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="536.8848" y="5139.0166">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="650.0127" y="5111.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="676.3438" y="5127.376">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="657.0127" y="5139.0166">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="776.5957" y="5111.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="807.0015" y="5127.376">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="783.5957" y="5139.0166">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="914.9634" y="5111.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="921.9634" y="5127.376">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="928.8311" y="5139.0166">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="995.4917" y="5111.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1007.5039" y="5127.376">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1002.4917" y="5139.0166">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="1130.8784" y="5111.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1157.2095" y="5127.376">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1137.8784" y="5139.0166">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="1257.4614" y="5111.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1287.8672" y="5127.376">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1264.4614" y="5139.0166">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="1395.8291" y="5111.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1402.8291" y="5127.376">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1409.6968" y="5139.0166">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.249" x="1476.3574" y="5111.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1483.3574" y="5127.376">Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1492.5029" y="5139.0166">Service</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="30.6797" x="1614.144" y="5111.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1621.144" y="5127.376">IDP</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="70.9775" x="1679.9727" y="5111.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1686.9727" y="5127.376">Federation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1698.3862" y="5139.0166">Master</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1791.8901" x="5" y="148.3828"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1796.8901" y1="148.3828" y2="148.3828"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1796.8901" y1="151.3828" y2="151.3828"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="458.5898" x="671.6501" y="139.5625"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="677.6501" y="152.8447">Client Registration with Resource Server A (with Client Attestation and Email)</text><polygon fill="#000000" points="292.2925,182.8438,302.2925,186.8438,292.2925,190.8438,296.2925,186.8438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="298.2925" y1="186.8438" y2="186.8438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="31" y="182.4854">User Starts Registration</text><polygon fill="#000000" points="437.3423,220.125,447.3423,224.125,437.3423,228.125,441.3423,224.125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="443.3423" y1="224.125" y2="224.125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="208.126">Generate Key Pair</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="219.7666">for Attestation</text><path d="M464.3423,199.8438 L464.3423,220.8438 L690.3423,220.8438 L690.3423,209.8438 L680.3423,199.8438 L464.3423,199.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M680.3423,199.8438 L680.3423,209.8438 L690.3423,209.8438 L680.3423,199.8438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="470.3423" y="214.126">Using Android TEE or iOS Secure Enclave</text><polygon fill="#000000" points="325.2925,245.7656,315.2925,249.7656,325.2925,253.7656,321.2925,249.7656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="448.3423" y1="249.7656" y2="249.7656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="245.4072">Public Key</text><polygon fill="#000000" points="1493.9819,271.4063,1503.9819,275.4063,1493.9819,279.4063,1497.9819,275.4063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="1499.9819" y1="275.4063" y2="275.4063"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="271.0479">Request Attestation Challenge</text><polygon fill="#000000" points="325.2925,297.0469,315.2925,301.0469,325.2925,305.0469,321.2925,301.0469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="1504.9819" y1="301.0469" y2="301.0469"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="296.6885">Attestation Challenge</text><polygon fill="#000000" points="437.3423,334.3281,447.3423,338.3281,437.3423,342.3281,441.3423,338.3281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="443.3423" y1="338.3281" y2="338.3281"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="322.3291">Sign Challenge with</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="333.9697">Attestation Key</text><path d="M464.3423,314.0469 L464.3423,347.0469 L691.3423,347.0469 L691.3423,324.0469 L681.3423,314.0469 L464.3423,314.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M681.3423,314.0469 L681.3423,324.0469 L691.3423,324.0469 L681.3423,314.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="470.3423" y="328.3291">Using Android SafetyNet/Play Integrity or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="470.3423" y="339.9697">iOS DeviceCheck/App Attest API</text><polygon fill="#000000" points="325.2925,365.9688,315.2925,369.9688,325.2925,373.9688,321.2925,369.9688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="448.3423" y1="369.9688" y2="369.9688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="365.6104">Attestation Statement</text><polygon fill="#000000" points="534.7773,391.6094,544.7773,395.6094,534.7773,399.6094,538.7773,395.6094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="540.7773" y1="395.6094" y2="395.6094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="391.251">Client Registration Request</text><path d="M561.7773,382.9688 L561.7773,426.9688 L796.7773,426.9688 L796.7773,392.9688 L786.7773,382.9688 L561.7773,382.9688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M786.7773,382.9688 L786.7773,392.9688 L796.7773,392.9688 L786.7773,382.9688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="567.7773" y="397.251">client_instance.yaml</text><text fill="#000000" font-family="sans-serif" font-size="10" x="567.7773" y="408.8916">Includes attestation statement, public key,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="567.7773" y="420.5322">User Email and software statement</text><polygon fill="#000000" points="1493.9819,446.5313,1503.9819,450.5313,1493.9819,454.5313,1497.9819,450.5313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="556.7773" x2="1499.9819" y1="450.5313" y2="450.5313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="446.1729">Verify Client Attestation</text><path d="M1520.9819,437.8906 L1520.9819,470.8906 L1694.9819,470.8906 L1694.9819,447.8906 L1684.9819,437.8906 L1520.9819,437.8906 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1684.9819,437.8906 L1684.9819,447.8906 L1694.9819,447.8906 L1684.9819,437.8906 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1526.9819" y="452.1729">AS A forwards attestation data</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1526.9819" y="463.8135">to Attestation Service</text><line style="stroke:#000000;stroke-width:1;" x1="1515.9819" x2="1557.9819" y1="505.4531" y2="505.4531"/><line style="stroke:#000000;stroke-width:1;" x1="1557.9819" x2="1557.9819" y1="505.4531" y2="518.4531"/><line style="stroke:#000000;stroke-width:1;" x1="1516.9819" x2="1557.9819" y1="518.4531" y2="518.4531"/><polygon fill="#000000" points="1526.9819,514.4531,1516.9819,518.4531,1526.9819,522.4531,1522.9819,518.4531" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1522.9819" y="489.4541">Validate Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1522.9819" y="501.0947">Statement</text><polygon fill="#000000" points="567.7773,540.0938,557.7773,544.0938,567.7773,548.0938,563.7773,544.0938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="561.7773" x2="1504.9819" y1="544.0938" y2="544.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.7773" y="539.7354">Attestation Verification Result</text><polygon fill="#000000" points="799.8818,577.375,809.8818,581.375,799.8818,585.375,803.8818,581.375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="556.7773" x2="805.8818" y1="581.375" y2="581.375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="565.376">Request Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="577.0166">Registration Decision</text><path d="M826.8818,557.0938 L826.8818,590.0938 L1050.8818,590.0938 L1050.8818,567.0938 L1040.8818,557.0938 L826.8818,557.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1040.8818,557.0938 L1040.8818,567.0938 L1050.8818,567.0938 L1040.8818,557.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="832.8818" y="571.376">AS A sends input data to Policy Engine A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="832.8818" y="583.0166">for registration request</text><line style="stroke:#000000;stroke-width:1;" x1="821.8818" x2="863.8818" y1="624.6563" y2="624.6563"/><line style="stroke:#000000;stroke-width:1;" x1="863.8818" x2="863.8818" y1="624.6563" y2="637.6563"/><line style="stroke:#000000;stroke-width:1;" x1="822.8818" x2="863.8818" y1="637.6563" y2="637.6563"/><polygon fill="#000000" points="832.8818,633.6563,822.8818,637.6563,832.8818,641.6563,828.8818,637.6563" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="828.8818" y="608.6572">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="828.8818" y="620.2979">on Input Data</text><polygon fill="#000000" points="567.7773,670.9375,557.7773,674.9375,567.7773,678.9375,563.7773,674.9375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="561.7773" x2="810.8818" y1="674.9375" y2="674.9375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.7773" y="658.9385">Client Registration</text><text fill="#000000" font-family="sans-serif" font-size="10" x="573.7773" y="670.5791">Decision (Permit/Deny)</text><line style="stroke:#000000;stroke-width:1;" x1="556.7773" x2="598.7773" y1="712.2188" y2="712.2188"/><line style="stroke:#000000;stroke-width:1;" x1="598.7773" x2="598.7773" y1="712.2188" y2="725.2188"/><line style="stroke:#000000;stroke-width:1;" x1="557.7773" x2="598.7773" y1="725.2188" y2="725.2188"/><polygon fill="#000000" points="567.7773,721.2188,557.7773,725.2188,567.7773,729.2188,563.7773,725.2188" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="696.2197">Generate Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="707.8604">Link and send Email</text><line style="stroke:#000000;stroke-width:1;" x1="187.0552" x2="229.0552" y1="750.8594" y2="750.8594"/><line style="stroke:#000000;stroke-width:1;" x1="229.0552" x2="229.0552" y1="750.8594" y2="763.8594"/><line style="stroke:#000000;stroke-width:1;" x1="188.0552" x2="229.0552" y1="763.8594" y2="763.8594"/><polygon fill="#000000" points="198.0552,759.8594,188.0552,763.8594,198.0552,767.8594,194.0552,763.8594" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="194.0552" y="746.501">Receive Email</text><polygon fill="#000000" points="165.0552,797.1406,175.0552,801.1406,165.0552,805.1406,169.0552,801.1406" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="171.0552" y1="801.1406" y2="801.1406"/><text fill="#000000" font-family="sans-serif" font-size="10" x="31" y="785.1416">Click Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="31" y="796.7822">Link in Email</text><polygon fill="#000000" points="99.1821,846.0625,89.1821,850.0625,99.1821,854.0625,95.1821,850.0625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="93.1821" x2="176.0552" y1="850.0625" y2="850.0625"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="822.4229">Open</text><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="834.0635">Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="845.7041">Link</text><polygon fill="#000000" points="534.7773,883.3438,544.7773,887.3438,534.7773,891.3438,538.7773,887.3438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="540.7773" y1="887.3438" y2="887.3438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="871.3447">Email Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="882.9854">Request</text><line style="stroke:#000000;stroke-width:1;" x1="556.7773" x2="598.7773" y1="936.2656" y2="936.2656"/><line style="stroke:#000000;stroke-width:1;" x1="598.7773" x2="598.7773" y1="936.2656" y2="949.2656"/><line style="stroke:#000000;stroke-width:1;" x1="557.7773" x2="598.7773" y1="949.2656" y2="949.2656"/><polygon fill="#000000" points="567.7773,945.2656,557.7773,949.2656,567.7773,953.2656,563.7773,949.2656" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="908.626">Verify Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="920.2666">Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="931.9072">Request</text><line style="stroke:#000000;stroke-width:1;" x1="556.7773" x2="598.7773" y1="986.5469" y2="986.5469"/><line style="stroke:#000000;stroke-width:1;" x1="598.7773" x2="598.7773" y1="986.5469" y2="999.5469"/><line style="stroke:#000000;stroke-width:1;" x1="557.7773" x2="598.7773" y1="999.5469" y2="999.5469"/><polygon fill="#000000" points="567.7773,995.5469,557.7773,999.5469,567.7773,1003.5469,563.7773,999.5469" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="970.5479">Generate Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="982.1885">Confirmation JWT</text><path d="M662.7744,962.2656 L662.7744,1053.2656 L836.7744,1053.2656 L836.7744,972.2656 L826.7744,962.2656 L662.7744,962.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M826.7744,962.2656 L826.7744,972.2656 L836.7744,972.2656 L826.7744,962.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="668.7744" y="976.5479">JWT Claims:</text><text fill="#000000" font-family="sans-serif" font-size="10" x="671.9531" y="988.1885">- iss: AS_A_ID</text><text fill="#000000" font-family="sans-serif" font-size="10" x="671.9531" y="999.8291">- sub: User_id</text><text fill="#000000" font-family="sans-serif" font-size="10" x="671.9531" y="1011.4697">- aud: (all AS)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="671.9531" y="1023.1104">- exp: (Policy Engine decision)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="671.9531" y="1034.751">- iat: (now)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="671.9531" y="1046.3916">- Email_verified: true</text><polygon fill="#000000" points="325.2925,1084.0313,315.2925,1088.0313,325.2925,1092.0313,321.2925,1088.0313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="545.7773" y1="1088.0313" y2="1088.0313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="1072.0322">Client Registration Response</text><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="1083.6729">(client_id, Email Confirmation JWT)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1791.8901" x="5" y="1114.8516"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1796.8901" y1="1114.8516" y2="1114.8516"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1796.8901" y1="1117.8516" y2="1117.8516"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="480.8311" x="660.5295" y="1106.0313"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="666.5295" y="1119.3135">OAuth 2.0 Authorization Code Flow with PAR, PKCE and DPoP (Resource Server A)</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="1164.9531" y2="1164.9531"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="1164.9531" y2="1177.9531"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="1177.9531" y2="1177.9531"/><polygon fill="#000000" points="325.2925,1173.9531,315.2925,1177.9531,325.2925,1181.9531,321.2925,1177.9531" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1148.9541">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1160.5947">Code Verifier</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="1215.2344" y2="1215.2344"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="1215.2344" y2="1228.2344"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="1228.2344" y2="1228.2344"/><polygon fill="#000000" points="325.2925,1224.2344,315.2925,1228.2344,325.2925,1232.2344,321.2925,1228.2344" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1199.2354">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1210.876">Code Challenge</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="1253.875" y2="1253.875"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="1253.875" y2="1266.875"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="1266.875" y2="1266.875"/><polygon fill="#000000" points="325.2925,1262.875,315.2925,1266.875,325.2925,1270.875,321.2925,1266.875" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1249.5166">Generate DPoP Key Pair</text><polygon fill="#000000" points="534.7773,1288.5156,544.7773,1292.5156,534.7773,1296.5156,538.7773,1292.5156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="540.7773" y1="1292.5156" y2="1292.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1288.1572">PAR Request</text><path d="M561.7773,1279.875 L561.7773,1312.875 L944.7773,1312.875 L944.7773,1289.875 L934.7773,1279.875 L561.7773,1279.875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M934.7773,1279.875 L934.7773,1289.875 L944.7773,1289.875 L934.7773,1279.875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="567.7773" y="1294.1572">Authorization Code Request</text><text fill="#000000" font-family="sans-serif" font-size="10" x="567.7773" y="1305.7979">(inkl. DPoP Proof, code_challenge, code_challenge_method, redirect_uri)</text><line style="stroke:#000000;stroke-width:1;" x1="556.7773" x2="598.7773" y1="1335.7969" y2="1335.7969"/><line style="stroke:#000000;stroke-width:1;" x1="598.7773" x2="598.7773" y1="1335.7969" y2="1348.7969"/><line style="stroke:#000000;stroke-width:1;" x1="557.7773" x2="598.7773" y1="1348.7969" y2="1348.7969"/><polygon fill="#000000" points="567.7773,1344.7969,557.7773,1348.7969,567.7773,1352.7969,563.7773,1348.7969" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="1331.4385">Validate DPoP Proof</text><polygon fill="#000000" points="325.2925,1370.4375,315.2925,1374.4375,325.2925,1378.4375,321.2925,1374.4375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="545.7773" y1="1374.4375" y2="1374.4375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="1370.0791">Request URI</text><polygon fill="#000000" points="99.1821,1396.0781,89.1821,1400.0781,99.1821,1404.0781,95.1821,1400.0781" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="93.1821" x2="303.2925" y1="1400.0781" y2="1400.0781"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1395.7197">Navigate to Request URI</text><polygon fill="#000000" points="534.7773,1421.7188,544.7773,1425.7188,534.7773,1429.7188,538.7773,1425.7188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="540.7773" y1="1425.7188" y2="1425.7188"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1421.3604">Authorization Request (with Request URI)</text><polygon fill="#000000" points="1612.4839,1447.3594,1622.4839,1451.3594,1612.4839,1455.3594,1616.4839,1451.3594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="556.7773" x2="1618.4839" y1="1451.3594" y2="1451.3594"/><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="1447.001">PAR Request (OpenID Connect), redirect_uri</text><path d="M1639.4839,1438.7188 L1639.4839,1471.7188 L1791.4839,1471.7188 L1791.4839,1448.7188 L1781.4839,1438.7188 L1639.4839,1438.7188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1781.4839,1438.7188 L1781.4839,1448.7188 L1791.4839,1448.7188 L1781.4839,1438.7188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1645.4839" y="1453.001">AS A acts as Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1648.6626" y="1464.6416">for the IDP</text><polygon fill="#000000" points="567.7773,1490.6406,557.7773,1494.6406,567.7773,1498.6406,563.7773,1494.6406" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="561.7773" x2="1623.4839" y1="1494.6406" y2="1494.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.7773" y="1490.2822">PAR Response, request_uri, expires_in</text><polygon fill="#000000" points="99.1821,1516.2813,89.1821,1520.2813,99.1821,1524.2813,95.1821,1520.2813" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="545.7773" y1="1520.2813" y2="1520.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1515.9229">Redirect to IDP, request_uri</text><polygon fill="#000000" points="1612.4839,1541.9219,1622.4839,1545.9219,1612.4839,1549.9219,1616.4839,1545.9219" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="1618.4839" y1="1545.9219" y2="1545.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1541.5635">Navigate to request_uri</text><polygon fill="#000000" points="99.1821,1567.5625,89.1821,1571.5625,99.1821,1575.5625,95.1821,1571.5625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="1623.4839" y1="1571.5625" y2="1571.5625"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1567.2041">Authentication Prompt, consent</text><polygon fill="#000000" points="1612.4839,1593.2031,1622.4839,1597.2031,1612.4839,1601.2031,1616.4839,1597.2031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="1618.4839" y1="1597.2031" y2="1597.2031"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1592.8447">User Credentials, consent</text><polygon fill="#000000" points="99.1821,1618.8438,89.1821,1622.8438,99.1821,1626.8438,95.1821,1622.8438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="1623.4839" y1="1622.8438" y2="1622.8438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1618.4854">Redirect to ASA, auth_code, redirect_uri</text><polygon fill="#000000" points="534.7773,1644.4844,544.7773,1648.4844,534.7773,1652.4844,538.7773,1648.4844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="540.7773" y1="1648.4844" y2="1648.4844"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1644.126">Redirect to ASA, auth_code, redirect_uri</text><polygon fill="#000000" points="1612.4839,1670.125,1622.4839,1674.125,1612.4839,1678.125,1616.4839,1674.125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="556.7773" x2="1618.4839" y1="1674.125" y2="1674.125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="1669.7666">Token Request (Authorization Code Grant), auth_code</text><line style="stroke:#000000;stroke-width:1;" x1="1634.4839" x2="1676.4839" y1="1723.0469" y2="1723.0469"/><line style="stroke:#000000;stroke-width:1;" x1="1676.4839" x2="1676.4839" y1="1723.0469" y2="1736.0469"/><line style="stroke:#000000;stroke-width:1;" x1="1635.4839" x2="1676.4839" y1="1736.0469" y2="1736.0469"/><polygon fill="#000000" points="1645.4839,1732.0469,1635.4839,1736.0469,1645.4839,1740.0469,1641.4839,1736.0469" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1641.4839" y="1695.4072">Validate</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1641.4839" y="1707.0479">Authorization</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1641.4839" y="1718.6885">Code</text><polygon fill="#000000" points="567.7773,1757.6875,557.7773,1761.6875,567.7773,1765.6875,563.7773,1761.6875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="561.7773" x2="1623.4839" y1="1761.6875" y2="1761.6875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.7773" y="1757.3291">Authentication Response (ID Token)</text><line style="stroke:#000000;stroke-width:1;" x1="556.7773" x2="598.7773" y1="1798.9688" y2="1798.9688"/><line style="stroke:#000000;stroke-width:1;" x1="598.7773" x2="598.7773" y1="1798.9688" y2="1811.9688"/><line style="stroke:#000000;stroke-width:1;" x1="557.7773" x2="598.7773" y1="1811.9688" y2="1811.9688"/><polygon fill="#000000" points="567.7773,1807.9688,557.7773,1811.9688,567.7773,1815.9688,563.7773,1811.9688" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="1782.9697">Validate</text><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="1794.6104">ID Token</text><polygon fill="#000000" points="99.1821,1833.6094,89.1821,1837.6094,99.1821,1841.6094,95.1821,1837.6094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="545.7773" y1="1837.6094" y2="1837.6094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1833.251">Authorization Code</text><polygon fill="#000000" points="292.2925,1859.25,302.2925,1863.25,292.2925,1867.25,296.2925,1863.25" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="298.2925" y1="1863.25" y2="1863.25"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1858.8916">Redirect with Authorization Code</text><polygon fill="#000000" points="534.7773,1884.8906,544.7773,1888.8906,534.7773,1892.8906,538.7773,1888.8906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="540.7773" y1="1888.8906" y2="1888.8906"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="1884.5322">Token Request (Authorization Code Grant)</text><path d="M561.7773,1876.25 L561.7773,1909.25 L781.7773,1909.25 L781.7773,1886.25 L771.7773,1876.25 L561.7773,1876.25 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M771.7773,1876.25 L771.7773,1886.25 L781.7773,1886.25 L771.7773,1876.25 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="567.7773" y="1890.5322">Enth&#228;lt Authorization Code, DPoP Proof,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="567.7773" y="1902.1729">client_id, redirect_uri, code_verifier</text><line style="stroke:#000000;stroke-width:1;" x1="556.7773" x2="598.7773" y1="1943.8125" y2="1943.8125"/><line style="stroke:#000000;stroke-width:1;" x1="598.7773" x2="598.7773" y1="1943.8125" y2="1956.8125"/><line style="stroke:#000000;stroke-width:1;" x1="557.7773" x2="598.7773" y1="1956.8125" y2="1956.8125"/><polygon fill="#000000" points="567.7773,1952.8125,557.7773,1956.8125,567.7773,1960.8125,563.7773,1956.8125" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="1927.8135">Validate Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="1939.4541">Assertion (JWT)</text><line style="stroke:#000000;stroke-width:1;" x1="556.7773" x2="598.7773" y1="1982.4531" y2="1982.4531"/><line style="stroke:#000000;stroke-width:1;" x1="598.7773" x2="598.7773" y1="1982.4531" y2="1995.4531"/><line style="stroke:#000000;stroke-width:1;" x1="557.7773" x2="598.7773" y1="1995.4531" y2="1995.4531"/><polygon fill="#000000" points="567.7773,1991.4531,557.7773,1995.4531,567.7773,1999.4531,563.7773,1995.4531" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="1978.0947">Validate DPoP Proof</text><line style="stroke:#000000;stroke-width:1;" x1="556.7773" x2="598.7773" y1="2032.7344" y2="2032.7344"/><line style="stroke:#000000;stroke-width:1;" x1="598.7773" x2="598.7773" y1="2032.7344" y2="2045.7344"/><line style="stroke:#000000;stroke-width:1;" x1="557.7773" x2="598.7773" y1="2045.7344" y2="2045.7344"/><polygon fill="#000000" points="567.7773,2041.7344,557.7773,2045.7344,567.7773,2049.7344,563.7773,2045.7344" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="2016.7354">Validate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="2028.376">Code Verifier</text><polygon fill="#000000" points="799.8818,2079.0156,809.8818,2083.0156,799.8818,2087.0156,803.8818,2083.0156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="556.7773" x2="805.8818" y1="2083.0156" y2="2083.0156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="2067.0166">Request Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="2078.6572">Issuance Decision</text><path d="M826.8818,2058.7344 L826.8818,2091.7344 L1050.8818,2091.7344 L1050.8818,2068.7344 L1040.8818,2058.7344 L826.8818,2058.7344 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1040.8818,2058.7344 L1040.8818,2068.7344 L1050.8818,2068.7344 L1040.8818,2058.7344 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="832.8818" y="2073.0166">AS A sends input data to Policy Engine A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="832.8818" y="2084.6572">for token request</text><line style="stroke:#000000;stroke-width:1;" x1="821.8818" x2="863.8818" y1="2126.2969" y2="2126.2969"/><line style="stroke:#000000;stroke-width:1;" x1="863.8818" x2="863.8818" y1="2126.2969" y2="2139.2969"/><line style="stroke:#000000;stroke-width:1;" x1="822.8818" x2="863.8818" y1="2139.2969" y2="2139.2969"/><polygon fill="#000000" points="832.8818,2135.2969,822.8818,2139.2969,832.8818,2143.2969,828.8818,2139.2969" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="828.8818" y="2110.2979">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="828.8818" y="2121.9385">on Input Data</text><polygon fill="#000000" points="567.7773,2172.5781,557.7773,2176.5781,567.7773,2180.5781,563.7773,2176.5781" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="561.7773" x2="810.8818" y1="2176.5781" y2="2176.5781"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.7773" y="2160.5791">Token Issuance</text><text fill="#000000" font-family="sans-serif" font-size="10" x="573.7773" y="2172.2197">Decision (Permit/Deny)</text><polygon fill="#000000" points="325.2925,2198.2188,315.2925,2202.2188,325.2925,2206.2188,321.2925,2202.2188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="545.7773" y1="2202.2188" y2="2202.2188"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="2197.8604">Access Token, Refresh Token</text><path d="M164.5034,2189.5781 L164.5034,2222.5781 L303.5034,2222.5781 L303.5034,2199.5781 L293.5034,2189.5781 L164.5034,2189.5781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M293.5034,2189.5781 L293.5034,2199.5781 L303.5034,2199.5781 L293.5034,2189.5781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="170.5034" y="2203.8604">Access Token bound to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="170.5034" y="2215.501">client's DPoP public key</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="2245.5" y2="2245.5"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="2245.5" y2="2258.5"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="2258.5" y2="2258.5"/><polygon fill="#000000" points="325.2925,2254.5,315.2925,2258.5,325.2925,2262.5,321.2925,2258.5" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2241.1416">Generate DPoP Key Pair</text><polygon fill="#000000" points="668.5332,2291.7813,678.5332,2295.7813,668.5332,2299.7813,672.5332,2295.7813" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="674.5332" y1="2295.7813" y2="2295.7813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2279.7822">Access Protected Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2291.4229">(with Access Token and DPoP Proof)</text><line style="stroke:#000000;stroke-width:1;" x1="690.5332" x2="732.5332" y1="2333.0625" y2="2333.0625"/><line style="stroke:#000000;stroke-width:1;" x1="732.5332" x2="732.5332" y1="2333.0625" y2="2346.0625"/><line style="stroke:#000000;stroke-width:1;" x1="691.5332" x2="732.5332" y1="2346.0625" y2="2346.0625"/><polygon fill="#000000" points="701.5332,2342.0625,691.5332,2346.0625,701.5332,2350.0625,697.5332,2346.0625" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="697.5332" y="2317.0635">Validate Access Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="697.5332" y="2328.7041">and DPoP Proof</text><polygon fill="#000000" points="928.2275,2379.3438,938.2275,2383.3438,928.2275,2387.3438,932.2275,2383.3438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="690.5332" x2="934.2275" y1="2383.3438" y2="2383.3438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="697.5332" y="2367.3447">Forward Request to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="697.5332" y="2378.9854">Resource Server A</text><polygon fill="#000000" points="701.5332,2404.9844,691.5332,2408.9844,701.5332,2412.9844,697.5332,2408.9844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="695.5332" x2="939.2275" y1="2408.9844" y2="2408.9844"/><text fill="#000000" font-family="sans-serif" font-size="10" x="707.5332" y="2404.626">Resource Data</text><polygon fill="#000000" points="325.2925,2430.625,315.2925,2434.625,325.2925,2438.625,321.2925,2434.625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="679.5332" y1="2434.625" y2="2434.625"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="2430.2666">Resource Data</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1791.8901" x="5" y="2461.4453"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1796.8901" y1="2461.4453" y2="2461.4453"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1796.8901" y1="2464.4453" y2="2464.4453"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="449.1904" x="676.3499" y="2452.625"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="682.3499" y="2465.9072">Client Registration with Resource Server B (with Client Attestation and JWT)</text><polygon fill="#000000" points="437.3423,2507.5469,447.3423,2511.5469,437.3423,2515.5469,441.3423,2511.5469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="443.3423" y1="2511.5469" y2="2511.5469"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2495.5479">Generate Key Pair</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2507.1885">for Attestation</text><path d="M464.3423,2487.2656 L464.3423,2520.2656 L590.3423,2520.2656 L590.3423,2497.2656 L580.3423,2487.2656 L464.3423,2487.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M580.3423,2487.2656 L580.3423,2497.2656 L590.3423,2497.2656 L580.3423,2487.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="470.3423" y="2501.5479">Using Android TEE or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="470.3423" y="2513.1885">iOS Secure Enclave</text><polygon fill="#000000" points="325.2925,2539.1875,315.2925,2543.1875,325.2925,2547.1875,321.2925,2543.1875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="448.3423" y1="2543.1875" y2="2543.1875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="2538.8291">Public Key</text><polygon fill="#000000" points="1493.9819,2564.8281,1503.9819,2568.8281,1493.9819,2572.8281,1497.9819,2568.8281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="1499.9819" y1="2568.8281" y2="2568.8281"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2564.4697">Request Attestation Challenge</text><polygon fill="#000000" points="325.2925,2590.4688,315.2925,2594.4688,325.2925,2598.4688,321.2925,2594.4688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="1504.9819" y1="2594.4688" y2="2594.4688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="2590.1104">Attestation Challenge</text><polygon fill="#000000" points="437.3423,2627.75,447.3423,2631.75,437.3423,2635.75,441.3423,2631.75" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="443.3423" y1="2631.75" y2="2631.75"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2615.751">Sign Challenge with</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2627.3916">Attestation Key</text><path d="M464.3423,2607.4688 L464.3423,2640.4688 L691.3423,2640.4688 L691.3423,2617.4688 L681.3423,2607.4688 L464.3423,2607.4688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M681.3423,2607.4688 L681.3423,2617.4688 L691.3423,2617.4688 L681.3423,2607.4688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="470.3423" y="2621.751">Using Android SafetyNet/Play Integrity or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="470.3423" y="2633.3916">iOS DeviceCheck/App Attest API</text><polygon fill="#000000" points="325.2925,2659.3906,315.2925,2663.3906,325.2925,2667.3906,321.2925,2663.3906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="448.3423" y1="2663.3906" y2="2663.3906"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="2659.0322">Attestation Statement</text><polygon fill="#000000" points="1000.3843,2685.0313,1010.3843,2689.0313,1000.3843,2693.0313,1004.3843,2689.0313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="1006.3843" y1="2689.0313" y2="2689.0313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="2684.6729">Client Registration Request (Resource Server B, with Email Confirmation JWT)</text><path d="M1027.3843,2676.3906 L1027.3843,2709.3906 L1281.3843,2709.3906 L1281.3843,2686.3906 L1271.3843,2676.3906 L1027.3843,2676.3906 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1271.3843,2676.3906 L1271.3843,2686.3906 L1281.3843,2686.3906 L1271.3843,2676.3906 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1033.3843" y="2690.6729">Includes attestation statement, public key,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1033.3843" y="2702.3135">User Email and potentially software statement</text><polygon fill="#000000" points="1493.9819,2728.3125,1503.9819,2732.3125,1493.9819,2736.3125,1497.9819,2732.3125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1022.3843" x2="1499.9819" y1="2732.3125" y2="2732.3125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="2727.9541">Verify Client Attestation</text><path d="M1520.9819,2719.6719 L1520.9819,2752.6719 L1694.9819,2752.6719 L1694.9819,2729.6719 L1684.9819,2719.6719 L1520.9819,2719.6719 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1684.9819,2719.6719 L1684.9819,2729.6719 L1694.9819,2729.6719 L1684.9819,2719.6719 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1526.9819" y="2733.9541">AS B forwards attestation data</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1526.9819" y="2745.5947">to Attestation Service</text><line style="stroke:#000000;stroke-width:1;" x1="1515.9819" x2="1557.9819" y1="2787.2344" y2="2787.2344"/><line style="stroke:#000000;stroke-width:1;" x1="1557.9819" x2="1557.9819" y1="2787.2344" y2="2800.2344"/><line style="stroke:#000000;stroke-width:1;" x1="1516.9819" x2="1557.9819" y1="2800.2344" y2="2800.2344"/><polygon fill="#000000" points="1526.9819,2796.2344,1516.9819,2800.2344,1526.9819,2804.2344,1522.9819,2800.2344" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1522.9819" y="2771.2354">Validate Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1522.9819" y="2782.876">Statement</text><polygon fill="#000000" points="1033.3843,2821.875,1023.3843,2825.875,1033.3843,2829.875,1029.3843,2825.875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1027.3843" x2="1504.9819" y1="2825.875" y2="2825.875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1039.3843" y="2821.5166">Attestation Verification Result</text><polygon fill="#000000" points="1280.7476,2859.1563,1290.7476,2863.1563,1280.7476,2867.1563,1284.7476,2863.1563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1022.3843" x2="1286.7476" y1="2863.1563" y2="2863.1563"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="2847.1572">Request Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="2858.7979">Registration Decision</text><path d="M1307.7476,2838.875 L1307.7476,2871.875 L1531.7476,2871.875 L1531.7476,2848.875 L1521.7476,2838.875 L1307.7476,2838.875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1521.7476,2838.875 L1521.7476,2848.875 L1531.7476,2848.875 L1521.7476,2838.875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1313.7476" y="2853.1572">AS B sends input data to Policy Engine B</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1313.7476" y="2864.7979">for registration request</text><line style="stroke:#000000;stroke-width:1;" x1="1302.7476" x2="1344.7476" y1="2906.4375" y2="2906.4375"/><line style="stroke:#000000;stroke-width:1;" x1="1344.7476" x2="1344.7476" y1="2906.4375" y2="2919.4375"/><line style="stroke:#000000;stroke-width:1;" x1="1303.7476" x2="1344.7476" y1="2919.4375" y2="2919.4375"/><polygon fill="#000000" points="1313.7476,2915.4375,1303.7476,2919.4375,1313.7476,2923.4375,1309.7476,2919.4375" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1309.7476" y="2890.4385">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1309.7476" y="2902.0791">on Input Data</text><polygon fill="#000000" points="1033.3843,2952.7188,1023.3843,2956.7188,1033.3843,2960.7188,1029.3843,2956.7188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1027.3843" x2="1291.7476" y1="2956.7188" y2="2956.7188"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1039.3843" y="2940.7197">Client Registration</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1039.3843" y="2952.3604">Decision (Permit/Deny)</text><polygon fill="#000000" points="1698.4614,2978.3594,1708.4614,2982.3594,1698.4614,2986.3594,1702.4614,2982.3594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1022.3843" x2="1704.4614" y1="2982.3594" y2="2982.3594"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="2978.001">Get Entity Statement from Federation Master</text><polygon fill="#000000" points="1033.3843,3004,1023.3843,3008,1033.3843,3012,1029.3843,3008" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1027.3843" x2="1709.4614" y1="3008" y2="3008"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1039.3843" y="3003.6416">Entity Statement from Federation Master</text><line style="stroke:#000000;stroke-width:1;" x1="1022.3843" x2="1064.3843" y1="3045.2813" y2="3045.2813"/><line style="stroke:#000000;stroke-width:1;" x1="1064.3843" x2="1064.3843" y1="3045.2813" y2="3058.2813"/><line style="stroke:#000000;stroke-width:1;" x1="1023.3843" x2="1064.3843" y1="3058.2813" y2="3058.2813"/><polygon fill="#000000" points="1033.3843,3054.2813,1023.3843,3058.2813,1033.3843,3062.2813,1029.3843,3058.2813" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="3029.2822">Extract "iss" (AS_A_ID)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="3040.9229">and "aud" from JWT</text><line style="stroke:#000000;stroke-width:1;" x1="1022.3843" x2="1064.3843" y1="3118.8438" y2="3118.8438"/><line style="stroke:#000000;stroke-width:1;" x1="1064.3843" x2="1064.3843" y1="3118.8438" y2="3131.8438"/><line style="stroke:#000000;stroke-width:1;" x1="1023.3843" x2="1064.3843" y1="3131.8438" y2="3131.8438"/><polygon fill="#000000" points="1033.3843,3127.8438,1023.3843,3131.8438,1033.3843,3135.8438,1029.3843,3131.8438" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="3079.5635">Get Entity Statement</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="3091.2041">URL for AS A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="3102.8447">from Federation Master</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="3114.4854">Entity Statement</text><polygon fill="#000000" points="567.7773,3153.4844,557.7773,3157.4844,567.7773,3161.4844,563.7773,3157.4844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="561.7773" x2="1011.3843" y1="3157.4844" y2="3157.4844"/><text fill="#000000" font-family="sans-serif" font-size="10" x="573.7773" y="3153.126">Get AS A's Entity Statement</text><polygon fill="#000000" points="1000.3843,3179.125,1010.3843,3183.125,1000.3843,3187.125,1004.3843,3183.125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="556.7773" x2="1006.3843" y1="3183.125" y2="3183.125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="563.7773" y="3178.7666">AS A's Entity Statement</text><line style="stroke:#000000;stroke-width:1;" x1="1022.3843" x2="1064.3843" y1="3232.0469" y2="3232.0469"/><line style="stroke:#000000;stroke-width:1;" x1="1064.3843" x2="1064.3843" y1="3232.0469" y2="3245.0469"/><line style="stroke:#000000;stroke-width:1;" x1="1023.3843" x2="1064.3843" y1="3245.0469" y2="3245.0469"/><polygon fill="#000000" points="1033.3843,3241.0469,1023.3843,3245.0469,1033.3843,3249.0469,1029.3843,3245.0469" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="3204.4072">Verify JWT Signature</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="3216.0479">(using AS A's Public Key</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="3227.6885">from Entity Statement)</text><line style="stroke:#000000;stroke-width:1;" x1="1022.3843" x2="1064.3843" y1="3293.9688" y2="3293.9688"/><line style="stroke:#000000;stroke-width:1;" x1="1064.3843" x2="1064.3843" y1="3293.9688" y2="3306.9688"/><line style="stroke:#000000;stroke-width:1;" x1="1023.3843" x2="1064.3843" y1="3306.9688" y2="3306.9688"/><polygon fill="#000000" points="1033.3843,3302.9688,1023.3843,3306.9688,1033.3843,3310.9688,1029.3843,3306.9688" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="3266.3291">Validate JWT Claims</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="3277.9697">(iss, aud, exp,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="3289.6104">iat, Email_verified)</text><path d="M8,3318.9688 L67.9561,3318.9688 L67.9561,3322.6094 L57.9561,3332.6094 L8,3332.6094 L8,3318.9688 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="467.8125" style="stroke:#000000;stroke-width:1.5;" width="1434.0933" x="8" y="3318.9688"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="23" y="3329.251">alt</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="82.9561" y="3330.251">[JWT Valid]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="8" x2="1442.0933" y1="3390.8906" y2="3390.8906"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="13" y="3402.1729">[JWT Invalid or Expired]</text><polygon fill="#000000" points="325.2925,3367.8906,315.2925,3371.8906,325.2925,3375.8906,321.2925,3371.8906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="319.2925" x2="1011.3843" y1="3371.8906" y2="3371.8906"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="3355.8916">Client Registration Response</text><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="3367.5322">(without Email Confirmation JWT)</text><line style="stroke:#000000;stroke-width:1;" x1="1022.3843" x2="1064.3843" y1="3438.8125" y2="3438.8125"/><line style="stroke:#000000;stroke-width:1;" x1="1064.3843" x2="1064.3843" y1="3438.8125" y2="3451.8125"/><line style="stroke:#000000;stroke-width:1;" x1="1023.3843" x2="1064.3843" y1="3451.8125" y2="3451.8125"/><polygon fill="#000000" points="1033.3843,3447.8125,1023.3843,3451.8125,1033.3843,3455.8125,1029.3843,3451.8125" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="3422.8135">Generate Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1029.3843" y="3434.4541">Confirmation Token</text><polygon fill="#000000" points="325.2925,3473.4531,315.2925,3477.4531,325.2925,3481.4531,321.2925,3477.4531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="319.2925" x2="1011.3843" y1="3477.4531" y2="3477.4531"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="3473.0947">Client Registration Response (with Email Confirmation Token)</text><path d="M1027.3843,3464.8125 L1027.3843,3497.8125 L1283.3843,3497.8125 L1283.3843,3474.8125 L1273.3843,3464.8125 L1027.3843,3464.8125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1273.3843,3464.8125 L1273.3843,3474.8125 L1283.3843,3474.8125 L1273.3843,3464.8125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1033.3843" y="3479.0947">AS B sends Email Confirmation Token to client,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1033.3843" y="3490.7354">which will be included in Email to User</text><polygon fill="#000000" points="198.0552,3528.375,188.0552,3532.375,198.0552,3536.375,194.0552,3532.375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="192.0552" x2="303.2925" y1="3532.375" y2="3532.375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="204.0552" y="3516.376">Send Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="204.0552" y="3528.0166">Email</text><path d="M319.2925,3508.0938 L319.2925,3541.0938 L508.2925,3541.0938 L508.2925,3518.0938 L498.2925,3508.0938 L319.2925,3508.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M498.2925,3508.0938 L498.2925,3518.0938 L508.2925,3518.0938 L498.2925,3508.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="325.2925" y="3522.376">Client sends Email including</text><text fill="#000000" font-family="sans-serif" font-size="10" x="325.2925" y="3534.0166">Email Confirmation Token to User</text><polygon fill="#000000" points="165.0552,3548.375,175.0552,3552.375,165.0552,3556.375,169.0552,3552.375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="171.0552" y1="3552.375" y2="3552.375"/><polygon fill="#000000" points="1005.3843,3574.0156,1015.3843,3578.0156,1005.3843,3582.0156,1009.3843,3578.0156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="187.0552" x2="1011.3843" y1="3578.0156" y2="3578.0156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="194.0552" y="3573.6572">User Clicks Confirmation Link in Email</text><line style="stroke:#000000;stroke-width:1;" x1="1027.3843" x2="1069.3843" y1="3615.2969" y2="3615.2969"/><line style="stroke:#000000;stroke-width:1;" x1="1069.3843" x2="1069.3843" y1="3615.2969" y2="3628.2969"/><line style="stroke:#000000;stroke-width:1;" x1="1028.3843" x2="1069.3843" y1="3628.2969" y2="3628.2969"/><polygon fill="#000000" points="1038.3843,3624.2969,1028.3843,3628.2969,1038.3843,3632.2969,1034.3843,3628.2969" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1034.3843" y="3599.2979">Verify Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1034.3843" y="3610.9385">Confirmation Token</text><polygon fill="#000000" points="1280.7476,3661.5781,1290.7476,3665.5781,1280.7476,3669.5781,1284.7476,3665.5781" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1027.3843" x2="1286.7476" y1="3665.5781" y2="3665.5781"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1034.3843" y="3649.5791">Request Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1034.3843" y="3661.2197">Confirmation Decision</text><line style="stroke:#000000;stroke-width:1;" x1="1302.7476" x2="1344.7476" y1="3702.8594" y2="3702.8594"/><line style="stroke:#000000;stroke-width:1;" x1="1344.7476" x2="1344.7476" y1="3702.8594" y2="3715.8594"/><line style="stroke:#000000;stroke-width:1;" x1="1303.7476" x2="1344.7476" y1="3715.8594" y2="3715.8594"/><polygon fill="#000000" points="1313.7476,3711.8594,1303.7476,3715.8594,1313.7476,3719.8594,1309.7476,3715.8594" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1309.7476" y="3686.8604">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1309.7476" y="3698.501">on Input Data</text><polygon fill="#000000" points="1038.3843,3749.1406,1028.3843,3753.1406,1038.3843,3757.1406,1034.3843,3753.1406" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1032.3843" x2="1291.7476" y1="3753.1406" y2="3753.1406"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1044.3843" y="3737.1416">Email Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1044.3843" y="3748.7822">Decision (Permit/Deny)</text><polygon fill="#000000" points="325.2925,3774.7813,315.2925,3778.7813,325.2925,3782.7813,321.2925,3778.7813" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="319.2925" x2="1016.3843" y1="3778.7813" y2="3778.7813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="3774.4229">Client Registration Response (with Email Confirmation JWT)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1791.8901" x="5" y="3819.6016"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1796.8901" y1="3819.6016" y2="3819.6016"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1796.8901" y1="3822.6016" y2="3822.6016"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="480.7139" x="660.5881" y="3810.7813"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="666.5881" y="3824.0635">OAuth 2.0 Authorization Code Flow with PAR, PKCE and DPoP (Resource Server B)</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="3869.7031" y2="3869.7031"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="3869.7031" y2="3882.7031"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="3882.7031" y2="3882.7031"/><polygon fill="#000000" points="325.2925,3878.7031,315.2925,3882.7031,325.2925,3886.7031,321.2925,3882.7031" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="3853.7041">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="3865.3447">Code Verifier</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="3919.9844" y2="3919.9844"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="3919.9844" y2="3932.9844"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="3932.9844" y2="3932.9844"/><polygon fill="#000000" points="325.2925,3928.9844,315.2925,3932.9844,325.2925,3936.9844,321.2925,3932.9844" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="3903.9854">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="3915.626">Code Challenge</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="3958.625" y2="3958.625"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="3958.625" y2="3971.625"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="3971.625" y2="3971.625"/><polygon fill="#000000" points="325.2925,3967.625,315.2925,3971.625,325.2925,3975.625,321.2925,3971.625" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="3954.2666">Generate DPoP Key Pair</text><polygon fill="#000000" points="1005.3843,3993.2656,1015.3843,3997.2656,1005.3843,4001.2656,1009.3843,3997.2656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="1011.3843" y1="3997.2656" y2="3997.2656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="3992.9072">PAR Request</text><path d="M1032.3843,3984.625 L1032.3843,4017.625 L1415.3843,4017.625 L1415.3843,3994.625 L1405.3843,3984.625 L1032.3843,3984.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1405.3843,3984.625 L1405.3843,3994.625 L1415.3843,3994.625 L1405.3843,3984.625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.3843" y="3998.9072">Authorization Code Request</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1038.3843" y="4010.5479">(inkl. DPoP Proof, code_challenge, code_challenge_method, redirect_uri)</text><line style="stroke:#000000;stroke-width:1;" x1="1027.3843" x2="1069.3843" y1="4040.5469" y2="4040.5469"/><line style="stroke:#000000;stroke-width:1;" x1="1069.3843" x2="1069.3843" y1="4040.5469" y2="4053.5469"/><line style="stroke:#000000;stroke-width:1;" x1="1028.3843" x2="1069.3843" y1="4053.5469" y2="4053.5469"/><polygon fill="#000000" points="1038.3843,4049.5469,1028.3843,4053.5469,1038.3843,4057.5469,1034.3843,4053.5469" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1034.3843" y="4036.1885">Validate DPoP Proof</text><polygon fill="#000000" points="1280.7476,4086.8281,1290.7476,4090.8281,1280.7476,4094.8281,1284.7476,4090.8281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1027.3843" x2="1286.7476" y1="4090.8281" y2="4090.8281"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1034.3843" y="4074.8291">Request Authorization</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1034.3843" y="4086.4697">Code Decision</text><path d="M1307.7476,4066.5469 L1307.7476,4099.5469 L1531.7476,4099.5469 L1531.7476,4076.5469 L1521.7476,4066.5469 L1307.7476,4066.5469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1521.7476,4066.5469 L1521.7476,4076.5469 L1531.7476,4076.5469 L1521.7476,4066.5469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1313.7476" y="4080.8291">AS B sends input data to Policy Engine B</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1313.7476" y="4092.4697">for authorization code request</text><line style="stroke:#000000;stroke-width:1;" x1="1302.7476" x2="1344.7476" y1="4134.1094" y2="4134.1094"/><line style="stroke:#000000;stroke-width:1;" x1="1344.7476" x2="1344.7476" y1="4134.1094" y2="4147.1094"/><line style="stroke:#000000;stroke-width:1;" x1="1303.7476" x2="1344.7476" y1="4147.1094" y2="4147.1094"/><polygon fill="#000000" points="1313.7476,4143.1094,1303.7476,4147.1094,1313.7476,4151.1094,1309.7476,4147.1094" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1309.7476" y="4118.1104">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1309.7476" y="4129.751">on Input Data</text><polygon fill="#000000" points="1038.3843,4180.3906,1028.3843,4184.3906,1038.3843,4188.3906,1034.3843,4184.3906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1032.3843" x2="1291.7476" y1="4184.3906" y2="4184.3906"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1044.3843" y="4168.3916">Authorization Code</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1044.3843" y="4180.0322">Decision (Permit/Deny)</text><polygon fill="#000000" points="325.2925,4206.0313,315.2925,4210.0313,325.2925,4214.0313,321.2925,4210.0313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="1016.3843" y1="4210.0313" y2="4210.0313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="4205.6729">Request URI</text><polygon fill="#000000" points="99.1821,4231.6719,89.1821,4235.6719,99.1821,4239.6719,95.1821,4235.6719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="93.1821" x2="303.2925" y1="4235.6719" y2="4235.6719"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="4231.3135">Navigate to Request URI</text><polygon fill="#000000" points="1005.3843,4257.3125,1015.3843,4261.3125,1005.3843,4265.3125,1009.3843,4261.3125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="1011.3843" y1="4261.3125" y2="4261.3125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="4256.9541">Authorization Request (with Request URI)</text><polygon fill="#000000" points="1612.4839,4282.9531,1622.4839,4286.9531,1612.4839,4290.9531,1616.4839,4286.9531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1027.3843" x2="1618.4839" y1="4286.9531" y2="4286.9531"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1034.3843" y="4282.5947">Authentication Request (OpenID Connect)</text><path d="M1639.4839,4274.3125 L1639.4839,4307.3125 L1791.4839,4307.3125 L1791.4839,4284.3125 L1781.4839,4274.3125 L1639.4839,4274.3125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1781.4839,4274.3125 L1781.4839,4284.3125 L1791.4839,4284.3125 L1781.4839,4274.3125 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1645.4839" y="4288.5947">AS B acts as Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1648.6626" y="4300.2354">for the IDP</text><polygon fill="#000000" points="99.1821,4326.2344,89.1821,4330.2344,99.1821,4334.2344,95.1821,4330.2344" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="1623.4839" y1="4330.2344" y2="4330.2344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="4325.876">Authentication Prompt</text><polygon fill="#000000" points="1612.4839,4351.875,1622.4839,4355.875,1612.4839,4359.875,1616.4839,4355.875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="1618.4839" y1="4355.875" y2="4355.875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="4351.5166">User Credentials</text><polygon fill="#000000" points="1038.3843,4377.5156,1028.3843,4381.5156,1038.3843,4385.5156,1034.3843,4381.5156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1032.3843" x2="1623.4839" y1="4381.5156" y2="4381.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1044.3843" y="4377.1572">Authentication Response (ID Token)</text><line style="stroke:#000000;stroke-width:1;" x1="1027.3843" x2="1069.3843" y1="4407.1563" y2="4407.1563"/><line style="stroke:#000000;stroke-width:1;" x1="1069.3843" x2="1069.3843" y1="4407.1563" y2="4420.1563"/><line style="stroke:#000000;stroke-width:1;" x1="1028.3843" x2="1069.3843" y1="4420.1563" y2="4420.1563"/><polygon fill="#000000" points="1038.3843,4416.1563,1028.3843,4420.1563,1038.3843,4424.1563,1034.3843,4420.1563" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1034.3843" y="4402.7979">Validate ID Token</text><polygon fill="#000000" points="99.1821,4441.7969,89.1821,4445.7969,99.1821,4449.7969,95.1821,4445.7969" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="1016.3843" y1="4445.7969" y2="4445.7969"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="4441.4385">Authorization Code</text><polygon fill="#000000" points="292.2925,4467.4375,302.2925,4471.4375,292.2925,4475.4375,296.2925,4471.4375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="298.2925" y1="4471.4375" y2="4471.4375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="4467.0791">Redirect with Authorization Code</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="4497.0781" y2="4497.0781"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="4497.0781" y2="4510.0781"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="4510.0781" y2="4510.0781"/><polygon fill="#000000" points="325.2925,4506.0781,315.2925,4510.0781,325.2925,4514.0781,321.2925,4510.0781" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="4492.7197">Generate DPoP Key Pair</text><polygon fill="#000000" points="1010.3843,4531.7188,1020.3843,4535.7188,1010.3843,4539.7188,1014.3843,4535.7188" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="1016.3843" y1="4535.7188" y2="4535.7188"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="4531.3604">Token Request (Authorization Code Grant)</text><path d="M1037.3843,4523.0781 L1037.3843,4567.0781 L1257.3843,4567.0781 L1257.3843,4533.0781 L1247.3843,4523.0781 L1037.3843,4523.0781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1247.3843,4523.0781 L1247.3843,4533.0781 L1257.3843,4533.0781 L1247.3843,4523.0781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1043.3843" y="4537.3604">Enth&#228;lt Authorization Code, DPoP Proof,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1043.3843" y="4549.001">Client Assertion (JWT, RFC7523),</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1043.3843" y="4560.6416">redirect_uri, code_verifier</text><line style="stroke:#000000;stroke-width:1;" x1="1032.3843" x2="1074.3843" y1="4602.2813" y2="4602.2813"/><line style="stroke:#000000;stroke-width:1;" x1="1074.3843" x2="1074.3843" y1="4602.2813" y2="4615.2813"/><line style="stroke:#000000;stroke-width:1;" x1="1033.3843" x2="1074.3843" y1="4615.2813" y2="4615.2813"/><polygon fill="#000000" points="1043.3843,4611.2813,1033.3843,4615.2813,1043.3843,4619.2813,1039.3843,4615.2813" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1039.3843" y="4586.2822">Validate Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1039.3843" y="4597.9229">Assertion (JWT)</text><line style="stroke:#000000;stroke-width:1;" x1="1032.3843" x2="1074.3843" y1="4640.9219" y2="4640.9219"/><line style="stroke:#000000;stroke-width:1;" x1="1074.3843" x2="1074.3843" y1="4640.9219" y2="4653.9219"/><line style="stroke:#000000;stroke-width:1;" x1="1033.3843" x2="1074.3843" y1="4653.9219" y2="4653.9219"/><polygon fill="#000000" points="1043.3843,4649.9219,1033.3843,4653.9219,1043.3843,4657.9219,1039.3843,4653.9219" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1039.3843" y="4636.5635">Validate DPoP Proof</text><line style="stroke:#000000;stroke-width:1;" x1="1032.3843" x2="1074.3843" y1="4691.2031" y2="4691.2031"/><line style="stroke:#000000;stroke-width:1;" x1="1074.3843" x2="1074.3843" y1="4691.2031" y2="4704.2031"/><line style="stroke:#000000;stroke-width:1;" x1="1033.3843" x2="1074.3843" y1="4704.2031" y2="4704.2031"/><polygon fill="#000000" points="1043.3843,4700.2031,1033.3843,4704.2031,1043.3843,4708.2031,1039.3843,4704.2031" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1039.3843" y="4675.2041">Validate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1039.3843" y="4686.8447">Code Verifier</text><polygon fill="#000000" points="1280.7476,4737.4844,1290.7476,4741.4844,1280.7476,4745.4844,1284.7476,4741.4844" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1032.3843" x2="1286.7476" y1="4741.4844" y2="4741.4844"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1039.3843" y="4725.4854">Request Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1039.3843" y="4737.126">Issuance Decision</text><path d="M1307.7476,4717.2031 L1307.7476,4750.2031 L1531.7476,4750.2031 L1531.7476,4727.2031 L1521.7476,4717.2031 L1307.7476,4717.2031 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1521.7476,4717.2031 L1521.7476,4727.2031 L1531.7476,4727.2031 L1521.7476,4717.2031 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1313.7476" y="4731.4854">AS B sends input data to Policy Engine B</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1313.7476" y="4743.126">for token request</text><line style="stroke:#000000;stroke-width:1;" x1="1302.7476" x2="1344.7476" y1="4784.7656" y2="4784.7656"/><line style="stroke:#000000;stroke-width:1;" x1="1344.7476" x2="1344.7476" y1="4784.7656" y2="4797.7656"/><line style="stroke:#000000;stroke-width:1;" x1="1303.7476" x2="1344.7476" y1="4797.7656" y2="4797.7656"/><polygon fill="#000000" points="1313.7476,4793.7656,1303.7476,4797.7656,1313.7476,4801.7656,1309.7476,4797.7656" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1309.7476" y="4768.7666">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1309.7476" y="4780.4072">on Input Data</text><polygon fill="#000000" points="1043.3843,4831.0469,1033.3843,4835.0469,1043.3843,4839.0469,1039.3843,4835.0469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1037.3843" x2="1291.7476" y1="4835.0469" y2="4835.0469"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1049.3843" y="4819.0479">Token Issuance</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1049.3843" y="4830.6885">Decision (Permit/Deny)</text><polygon fill="#000000" points="325.2925,4856.6875,315.2925,4860.6875,325.2925,4864.6875,321.2925,4860.6875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="1021.3843" y1="4860.6875" y2="4860.6875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="4856.3291">Access Token (JWT), Refresh Token</text><path d="M164.5034,4848.0469 L164.5034,4881.0469 L303.5034,4881.0469 L303.5034,4858.0469 L293.5034,4848.0469 L164.5034,4848.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M293.5034,4848.0469 L293.5034,4858.0469 L303.5034,4858.0469 L293.5034,4848.0469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="170.5034" y="4862.3291">Access Token bound to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="170.5034" y="4873.9697">client's DPoP public key</text><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="356.2925" y1="4903.9688" y2="4903.9688"/><line style="stroke:#000000;stroke-width:1;" x1="356.2925" x2="356.2925" y1="4903.9688" y2="4916.9688"/><line style="stroke:#000000;stroke-width:1;" x1="315.2925" x2="356.2925" y1="4916.9688" y2="4916.9688"/><polygon fill="#000000" points="325.2925,4912.9688,315.2925,4916.9688,325.2925,4920.9688,321.2925,4916.9688" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="4899.6104">Generate DPoP Key Pair</text><polygon fill="#000000" points="1149.3989,4950.25,1159.3989,4954.25,1149.3989,4958.25,1153.3989,4954.25" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="314.2925" x2="1155.3989" y1="4954.25" y2="4954.25"/><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="4938.251">Access Protected Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="321.2925" y="4949.8916">(with Access Token and DPoP Proof)</text><line style="stroke:#000000;stroke-width:1;" x1="1171.3989" x2="1213.3989" y1="4991.5313" y2="4991.5313"/><line style="stroke:#000000;stroke-width:1;" x1="1213.3989" x2="1213.3989" y1="4991.5313" y2="5004.5313"/><line style="stroke:#000000;stroke-width:1;" x1="1172.3989" x2="1213.3989" y1="5004.5313" y2="5004.5313"/><polygon fill="#000000" points="1182.3989,5000.5313,1172.3989,5004.5313,1182.3989,5008.5313,1178.3989,5004.5313" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1178.3989" y="4975.5322">Validate Access Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1178.3989" y="4987.1729">and DPoP Proof</text><polygon fill="#000000" points="1409.0933,5037.8125,1419.0933,5041.8125,1409.0933,5045.8125,1413.0933,5041.8125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="1171.3989" x2="1415.0933" y1="5041.8125" y2="5041.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1178.3989" y="5025.8135">Forward Request to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1178.3989" y="5037.4541">Resource Server B</text><polygon fill="#000000" points="1182.3989,5063.4531,1172.3989,5067.4531,1182.3989,5071.4531,1178.3989,5067.4531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1176.3989" x2="1420.0933" y1="5067.4531" y2="5067.4531"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1188.3989" y="5063.0947">Resource Data</text><polygon fill="#000000" points="325.2925,5089.0938,315.2925,5093.0938,325.2925,5097.0938,321.2925,5093.0938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="319.2925" x2="1160.3989" y1="5093.0938" y2="5093.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="331.2925" y="5088.7354">Resource Data</text><!--SRC=[xLhTRkEw4RxNKx0-5xK1xqzFKHG8i0Kasyb9poOnx6mFMXWm68cssSYKAzB9Uek-JT-aBzRXdqHAj8-IzVOKHP6BsDBCS6Ouyt7u9VoHiXqkyHPbP8NtkRWic9ZJBmJzvdt4gvTZ_VAcO0NVuPHaKkmMRmaQ5VkIajAHpGbRYqsS_NNF1M858v7pafE_xGbB2VfxXD0KbuAcT8UPI8eo8-Meo8iIFUGuVMoyXYVhijYpJ8iyRwWW81AdeYX3klh5CQsoB9vz-OzqHJvIHaAsgdSDSzzTlfS_875RYA2cUjxIcbnEHfFe7r7qgrs9rrkC12c-857k8LFAR_I9GqOVYi-eTrCyq9n0_fzeIdhekwjDmSLF9Ww4TdMAb5Ay9l09SzIJtv3wscj9tdoAbSmDflc2dP8SvTGQr1_R8dEIxaioOMcEduYIZ5bM5ZH3zvC9Aie5etTp8uMCM2yYB4CGOAIZZDa39KAw0I7UJqO_tDvzlBlwirfB2VnbSX-ZgpqkCn2OOvOT4jX2fWIQ3iLp7TrqF5smU2ysyrvGRZgPBeta12H_kB-VecbPV3uS4tVCJekSfWS8PmrreULjH9NFzzVe-xVl5smCUUC2_1xZyd5Ey5L9IDZpcV5yHZXqLKeMR4xA9rBw2nn9NNAMr2MTKvUy97N9jqzTyeBKkPgzM0Z21HQqO5fBTHeOWnVcgwzmFPwgz_3RVt59006K8RHWDvZ3jYX1UAw_HT673xQdPcHDkJ3YprHiaFKTQTTHZFhgkL5m_4ImZMYoXVOTe0yVeaYry9i_6CaB1GLeBi0txgqJuLJG9oo8aOoCQL3rslW2NH4cGo7eHt808ARGnYi09iU7sfQd6Z70F5JIzKRvGTaQ-NY0sd0G-HZonebakd-0Sf5UH1avic8THBrZ5n0td3JSJzjeWtDvF97QUMUJwu-U2s43ZZUEYQFvdDErewts6phCiImZV756vtX5nE6MY7VJ71_GDHDaNL9ng61NdnkZ3KaVtyMxdOa5nTFh4pbttO8Y4cGhIwLB-kVnHR2ypLvuaQHARacXmJ4C16yFU0k7qJKOtMU48-mumQqJGxJJzV183aDpSgasK0t1YvLunb1MbRoppVCuaWT3eqZ-H4gwEWGwB5WWhlln7FeJMW8Mp7nlCopmWed2psEWnXgku9ncPa47ZwfG6jMfSkske4AXgKquXt7jI96QFC21LdU9pi22UTis9YdbNZ90fvq53h3A4KnuUw62Hn2xX_8erkXHkiPBKnFoNBNUJ9vmlbVhQFK7p4csW1aIIbjQ7uDrhN2Ysk3OC7wZ_fIKMohUZGax3Dnio3XiEKWp5ToD2hQYvTOOWgdlKPSMiO1RvmAcg4XEKc03VibKfeH2Asan2ydg5NYPFePiKsRgrrggXhWBTBSZ8DPMgZseXDtGf5lrA6W3rAluncnNEigrHJSxfakKZQP7raWmcm4DzCUVxhqIWk-G7qot_6B1q1j4EPTrjOoNrsFrWEyVz8csf9bwWFVP1Ue3b8BOG3qXdtVmnA-vp1I1bg0Obkgpubb_LOujdrJB4B2cXcyLWeE3OIJZku9nc2_w5i2oOI2xCYoluYG0oTF_JevLShf1yaDHqY_cP2aoWYxpubdF0jDuDaJJ7qSJLNxZQJ55_TPye0x_6dwjtrNwfRxCFbZMw00JI3Vn-fmx8Q-yilD1ynY002hOzvBWmKSx1KO7yWkbdh_LYy1iMQo6A0M1PMfTQtvVRWbOWzqeIKPBaeebt4m7VY5RZAsjjdRT8kAdsNLh_-eOdJwznKzqBKK0zbpbG5Er-zBFW5NlctcmCZRmSoXdMXCN3A5Uib5VuiRrM5OZWoGC_7pKTkJqse9oUClbn3eZ-K4E6l8AVe2EaUWjDbf9BWw_QmpMg-k-65fSbuiDPMF2qXnE-TfdFtipuvpC7bZrz9MEbpCLhPlmfhHrp5b1fXW-sACHTdsx4x9um5tOa_0Q2hv7a3cfYNFkomTMSUE0C8U0KcApb1NQs83MUYg7Br9tj_w-U2HEuGGwwgg4oyd0iLY7O6pOjj1tlafTOq7axNKZcNRRKHygJhdYWPujbr0FBfXLELOQxLZQoQkxrkHFTKv0CtZ8DK6hQpAznfamiVdNFtCHM7NemjU2EIU6kwS6o9uiH0SHomveCGVlrG9zTSHqWhVc-z3149eALJvWepZVondzx0EXKFa-poIezywwsdK8T4klkl-aAU5S6nn2BbQ0O1jJgYhMdAmQOkX14dmGZztaNtEz2VLzvSHXqlbaLPHLjJ9ii80I8XcgMGzzSdYkLGE4AeY1ktTWBT8qM6syleSuHXRCjr9hpMJkB_KzgAeRcOVMj58l33hHp2JTh5f9curLrht-TjzxcoY3S1xCpA3LcMP9JjCiiilyEUi_HfM4gDF_SoN_Arn9Sf8hQO_xoL3Nxx7BXeCkYPU7h-5KTc17JK3v8SIlICBud9HAyijIAidhAPL4GsZo2aebQMVXvq_Gv2IbKdlJyI1DwWoycb99R1eglbk2ev03akopAkze1ICuSiXoGuvNfcg-lFfKkzVLckDQRS_MgpBq6QA3YR57EU_1iASfXu4-wdfud_MqQKbOk7gXaA1lPX_LBKaEGB0rGPyMhAbN6uwrOQaEiqDBharaLWLxHACnRhWHc1QLp8l4MYm0eM1qs6kyrFRgmyH4qrnWu9kqhLRJEV8ApxcyTsJg8WZWGh4ODhWNm2qOdQMMCc46iWHrvs4aA1PGoSTmaUHSktNDdkGIycyG4tKlzLOpUtk2kN8lAvqTDCD5m3bpNPBsZlJ_CIM91dhCX9m-RsYwWPCXpz430SXGM9_Lp2B8gZydotNguqVHadF9QlfqdYOlfQn7A3QTD8PSD_NAK476o16_ArzSWbGzC0oesWTz_PQiAVVjUAofKcjGdvxhyYHiRl5nChEzmHwUXpGgEFUMbL0e7xmOXokb2gC2jEqHA6xamlfmbbBLVSGo7rIISnEQoNyjePaS9JIJNu3G3C2kT-Dlrsw0rpdxA8Azs6KePnf8sabzqJpIXTjDpixj9g_ZTgiPIX5pBROjJF6U97MJJgHkLzuq-dcgr24CazSGXi7whhX2kwMdUS9lmn6-330waub7qQGxisXlMnuvE4Ipoz7lV_VzRmSWSPfm36JyEE7O2Nxyzs72iOrJNGZ7hy6e9k7uDR3q6iAn3KaULQSo_Aqen-JLb6DoLienYVI_ZzN6krEEYQOSaswKO-9IZaaqCwatgxOfnwGxvPZubAFtrVnlrRy1]--></g></svg>