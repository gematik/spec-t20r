<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2979px" preserveAspectRatio="none" style="width:1336px;height:2979px;background:#FFFFFF;" version="1.1" viewBox="0 0 1336 2979" width="1336px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="2967.1563" style="stroke:#181818;stroke-width:0.5;" width="419.4775" x="44.3965" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="214.7163" y="15.2822">Mobile Device</text><rect fill="#C9FFC9" height="2967.1563" style="stroke:#181818;stroke-width:0.5;" width="489.271" x="503.3804" y="6"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="723.6555" y="15.2822">Anbieter</text><rect fill="#F4A460" height="2950.5156" style="stroke:#181818;stroke-width:0.5;" width="370.9473" x="503.3804" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="655.7095" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="2950.5156" style="stroke:#181818;stroke-width:0.5;" width="68.5283" x="924.123" y="22.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="940.2061" y="31.9229">TI 2.0</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="940.2061" y="43.5635">Dienst</text><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="24" x2="24" y1="121.5625" y2="2895.5156"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="83.1821" x2="83.1821" y1="121.5625" y2="2895.5156"/><rect fill="#F0F0F0" height="37.2813" style="stroke:#000000;stroke-width:1;" width="10" x="78.1821" y="900.0625"/><rect fill="#F0F0F0" height="474.8125" style="stroke:#000000;stroke-width:1;" width="10" x="78.1821" y="1792.6875"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="182.0552" x2="182.0552" y1="121.5625" y2="2895.5156"/><rect fill="#F0F0F0" height="116.8438" style="stroke:#000000;stroke-width:1;" width="10" x="177.0552" y="783.2188"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="277.4214" x2="277.4214" y1="121.5625" y2="2895.5156"/><rect fill="#F0F0F0" height="2708.6719" style="stroke:#000000;stroke-width:1;" width="10" x="272.4214" y="186.8438"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="422.4712" x2="422.4712" y1="121.5625" y2="2895.5156"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="417.4712" y="251.7656"/><rect fill="#F0F0F0" height="31.6406" style="stroke:#000000;stroke-width:1;" width="10" x="417.4712" y="365.9688"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="529.2729" x2="529.2729" y1="121.5625" y2="2895.5156"/><rect fill="#F0F0F0" height="758.7031" style="stroke:#000000;stroke-width:1;" width="10" x="524.2729" y="510.1719"/><rect fill="#F0F0F0" height="70.2813" style="stroke:#000000;stroke-width:1;" width="10" x="524.2729" y="1696.7656"/><rect fill="#F0F0F0" height="826.7813" style="stroke:#000000;stroke-width:1;" width="10" x="524.2729" y="1818.3281"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="698.6929" x2="698.6929" y1="121.5625" y2="2895.5156"/><rect fill="#F0F0F0" height="138.8438" style="stroke:#000000;stroke-width:1;" width="10" x="693.6929" y="2738.6719"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="830.0415" x2="830.0415" y1="121.5625" y2="2895.5156"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="825.0415" y="1138.0313"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="825.0415" y="1335.7969"/><rect fill="#F0F0F0" height="93.5625" style="stroke:#000000;stroke-width:1;" width="10" x="825.0415" y="2525.9063"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="958.3872" x2="958.3872" y1="121.5625" y2="2895.5156"/><rect fill="#F0F0F0" height="64.2813" style="stroke:#000000;stroke-width:1;" width="10" x="953.3872" y="2826.2344"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1043.2759" x2="1043.2759" y1="121.5625" y2="2895.5156"/><rect fill="#F0F0F0" height="25.6406" style="stroke:#000000;stroke-width:1;" width="10" x="1038.2759" y="303.0469"/><rect fill="#F0F0F0" height="145.2031" style="stroke:#000000;stroke-width:1;" width="10" x="1038.2759" y="565.0938"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1161.7778" x2="1161.7778" y1="121.5625" y2="2895.5156"/><rect fill="#F0F0F0" height="321.9688" style="stroke:#000000;stroke-width:1;" width="10" x="1156.7778" y="1843.9688"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1247.7554" x2="1247.7554" y1="121.5625" y2="2895.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="9.6035" y="119.2041">User</text><ellipse cx="24" cy="58.4219" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M24,66.4219 L24,93.4219 M11,74.4219 L37,74.4219 M24,93.4219 L11,108.4219 M24,93.4219 L37,108.4219 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="48.3965" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="55.3965" y="111.2041">User Agent</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="147.2695" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="171.8989" y="99.5635">Mail</text><text fill="#000000" font-family="sans-serif" font-size="10" x="154.2695" y="111.2041">User Agent</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="42.9502" x="255.9463" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="262.9463" y="111.2041">Client</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="74.8057" x="385.0684" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="392.0684" y="111.2041">Android TEE</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="507.3804" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="519.3926" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="514.3804" y="111.2041">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="663.1724" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="689.5034" y="99.5635">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="670.1724" y="111.2041">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="789.7554" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="820.1611" y="99.5635">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="796.7554" y="111.2041">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="928.123" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="935.123" y="99.5635">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="941.9907" y="111.2041">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.249" x="1008.6514" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1015.6514" y="99.5635">Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1024.7969" y="111.2041">Service</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="30.6797" x="1146.438" y="94.9219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1153.438" y="111.2041">IDP</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="70.9775" x="1212.2666" y="83.2813"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1219.2666" y="99.5635">Federation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1230.6802" y="111.2041">Master</text><text fill="#000000" font-family="sans-serif" font-size="10" x="9.6035" y="2964.7979">User</text><ellipse cx="24" cy="2904.0156" fill="#FFFFFF" rx="8" ry="8" style="stroke:#000000;stroke-width:0.5;"/><path d="M24,2912.0156 L24,2939.0156 M11,2920.0156 L37,2920.0156 M24,2939.0156 L11,2954.0156 M24,2939.0156 L37,2954.0156 " fill="none" style="stroke:#000000;stroke-width:0.5;"/><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="48.3965" y="2895.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="55.3965" y="2911.7979">User Agent</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.5713" x="147.2695" y="2895.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="171.8989" y="2911.7979">Mail</text><text fill="#000000" font-family="sans-serif" font-size="10" x="154.2695" y="2923.4385">User Agent</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="42.9502" x="255.9463" y="2895.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="262.9463" y="2911.7979">Client</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="74.8057" x="385.0684" y="2895.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="392.0684" y="2911.7979">Android TEE</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="43.7852" x="507.3804" y="2895.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="519.3926" y="2911.7979">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="514.3804" y="2923.4385">AuthS</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="71.041" x="663.1724" y="2895.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="689.5034" y="2911.7979">PEP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="670.1724" y="2923.4385">HTTP Proxy</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="80.5723" x="789.7554" y="2895.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="820.1611" y="2911.7979">PDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="796.7554" y="2923.4385">Policy Engine</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="60.5283" x="928.123" y="2895.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="935.123" y="2911.7979">Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="941.9907" y="2923.4385">Server</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="69.249" x="1008.6514" y="2895.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1015.6514" y="2911.7979">Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1024.7969" y="2923.4385">Service</text><rect fill="#FFFFFF" height="25.6406" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="30.6797" x="1146.438" y="2895.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1153.438" y="2911.7979">IDP</text><rect fill="#FFFFFF" height="37.2813" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="70.9775" x="1212.2666" y="2895.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1219.2666" y="2911.7979">Federation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1230.6802" y="2923.4385">Master</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1324.1646" x="5" y="148.3828"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1329.1646" y1="148.3828" y2="148.3828"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1329.1646" y1="151.3828" y2="151.3828"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="323.1455" x="505.5095" y="139.5625"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="511.5095" y="152.8447">Client Registration (with Client Attestation and Email)</text><polygon fill="#000000" points="260.4214,182.8438,270.4214,186.8438,260.4214,190.8438,264.4214,186.8438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="266.4214" y1="186.8438" y2="186.8438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="31" y="182.4854">User Starts Registration</text><path d="M261.4214,198.8438 L321.3774,198.8438 L321.3774,202.4844 L311.3774,212.4844 L261.4214,212.4844 L261.4214,198.8438 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="279.6875" style="stroke:#000000;stroke-width:1.5;" width="802.8545" x="261.4214" y="198.8438"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="276.4214" y="209.126">alt</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="336.3774" y="210.126">[Android Attestation]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="261.4214" x2="1064.2759" y1="416.6094" y2="416.6094"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="266.4214" y="427.8916">[iOS Attestation]</text><polygon fill="#000000" points="405.4712,247.7656,415.4712,251.7656,405.4712,255.7656,409.4712,251.7656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="411.4712" y1="251.7656" y2="251.7656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="235.7666">Generate Key Pair</text><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="247.4072">for Attestation</text><path d="M432.4712,227.4844 L432.4712,248.4844 L658.4712,248.4844 L658.4712,237.4844 L648.4712,227.4844 L432.4712,227.4844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M648.4712,227.4844 L648.4712,237.4844 L658.4712,237.4844 L648.4712,227.4844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="438.4712" y="241.7666">Using Android TEE or iOS Secure Enclave</text><polygon fill="#000000" points="293.4214,273.4063,283.4214,277.4063,293.4214,281.4063,289.4214,277.4063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="416.4712" y1="277.4063" y2="277.4063"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="273.0479">Public Key</text><polygon fill="#000000" points="1026.2759,299.0469,1036.2759,303.0469,1026.2759,307.0469,1030.2759,303.0469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="1032.2759" y1="303.0469" y2="303.0469"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="298.6885">Request Attestation Challenge</text><polygon fill="#000000" points="293.4214,324.6875,283.4214,328.6875,293.4214,332.6875,289.4214,328.6875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="1037.2759" y1="328.6875" y2="328.6875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="324.3291">Attestation Challenge</text><polygon fill="#000000" points="405.4712,361.9688,415.4712,365.9688,405.4712,369.9688,409.4712,365.9688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="411.4712" y1="365.9688" y2="365.9688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="349.9697">Sign Challenge with</text><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="361.6104">Attestation Key</text><path d="M432.4712,341.6875 L432.4712,374.6875 L659.4712,374.6875 L659.4712,351.6875 L649.4712,341.6875 L432.4712,341.6875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M649.4712,341.6875 L649.4712,351.6875 L659.4712,351.6875 L649.4712,341.6875 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="438.4712" y="355.9697">Using Android SafetyNet/Play Integrity or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="438.4712" y="367.6104">iOS DeviceCheck/App Attest API</text><polygon fill="#000000" points="293.4214,393.6094,283.4214,397.6094,293.4214,401.6094,289.4214,397.6094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="416.4712" y1="397.6094" y2="397.6094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="393.251">Attestation Statement</text><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="324.4214" y1="441.25" y2="441.25"/><line style="stroke:#000000;stroke-width:1;" x1="324.4214" x2="324.4214" y1="441.25" y2="454.25"/><line style="stroke:#000000;stroke-width:1;" x1="283.4214" x2="324.4214" y1="454.25" y2="454.25"/><polygon fill="#000000" points="293.4214,450.25,283.4214,454.25,293.4214,458.25,289.4214,454.25" style="stroke:#000000;stroke-width:1;"/><path d="M337.4214,440.25 L337.4214,473.25 L546.4214,473.25 L546.4214,450.25 L536.4214,440.25 L337.4214,440.25 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M536.4214,440.25 L536.4214,450.25 L546.4214,450.25 L536.4214,440.25 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="343.4214" y="454.5322">iOS Attestation with App Attest API or</text><text fill="#000000" font-family="sans-serif" font-size="10" x="343.4214" y="466.1729">DeviceCheck API</text><polygon fill="#000000" points="512.2729,506.1719,522.2729,510.1719,512.2729,514.1719,516.2729,510.1719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="518.2729" y1="510.1719" y2="510.1719"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="505.8135">Client Registration Request</text><path d="M539.2729,497.5313 L539.2729,541.5313 L774.2729,541.5313 L774.2729,507.5313 L764.2729,497.5313 L539.2729,497.5313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M764.2729,497.5313 L764.2729,507.5313 L774.2729,507.5313 L764.2729,497.5313 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="545.2729" y="511.8135">client_instance.yaml</text><text fill="#000000" font-family="sans-serif" font-size="10" x="545.2729" y="523.4541">Includes attestation statement, public key,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="545.2729" y="535.0947">User Email and software statement</text><polygon fill="#000000" points="1026.2759,561.0938,1036.2759,565.0938,1026.2759,569.0938,1030.2759,565.0938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="534.2729" x2="1032.2759" y1="565.0938" y2="565.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="560.7354">Verify Client Attestation</text><path d="M1053.2759,552.4531 L1053.2759,585.4531 L1227.2759,585.4531 L1227.2759,562.4531 L1217.2759,552.4531 L1053.2759,552.4531 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1217.2759,552.4531 L1217.2759,562.4531 L1227.2759,562.4531 L1217.2759,552.4531 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1059.2759" y="566.7354">AS A forwards attestation data</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1059.2759" y="578.376">to Attestation Service</text><line style="stroke:#000000;stroke-width:1;" x1="1048.2759" x2="1090.2759" y1="620.0156" y2="620.0156"/><line style="stroke:#000000;stroke-width:1;" x1="1090.2759" x2="1090.2759" y1="620.0156" y2="633.0156"/><line style="stroke:#000000;stroke-width:1;" x1="1049.2759" x2="1090.2759" y1="633.0156" y2="633.0156"/><polygon fill="#000000" points="1059.2759,629.0156,1049.2759,633.0156,1059.2759,637.0156,1055.2759,633.0156" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1055.2759" y="604.0166">Validate Attestation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1055.2759" y="615.6572">Statement</text><polygon fill="#000000" points="545.2729,654.6563,535.2729,658.6563,545.2729,662.6563,541.2729,658.6563" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="539.2729" x2="1037.2759" y1="658.6563" y2="658.6563"/><text fill="#000000" font-family="sans-serif" font-size="10" x="551.2729" y="654.2979">Attestation Verification Result</text><line style="stroke:#000000;stroke-width:1;" x1="534.2729" x2="576.2729" y1="684.2969" y2="684.2969"/><line style="stroke:#000000;stroke-width:1;" x1="576.2729" x2="576.2729" y1="684.2969" y2="697.2969"/><line style="stroke:#000000;stroke-width:1;" x1="535.2729" x2="576.2729" y1="697.2969" y2="697.2969"/><polygon fill="#000000" points="545.2729,693.2969,535.2729,697.2969,545.2729,701.2969,541.2729,697.2969" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="679.9385">Verify Email Confirmation JWT</text><path d="M8,709.2969 L67.9561,709.2969 L67.9561,712.9375 L57.9561,722.9375 L8,722.9375 L8,709.2969 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="765.3438" style="stroke:#000000;stroke-width:1.5;" width="1077.2788" x="8" y="709.2969"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="23" y="719.5791">alt</text><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="82.9561" y="720.5791">[Email Confirmation Required]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="8" x2="1085.2788" y1="1287.875" y2="1287.875"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="13" y="1299.1572">[Email Confirmation already done]</text><line style="stroke:#000000;stroke-width:1;" x1="534.2729" x2="576.2729" y1="762.2188" y2="762.2188"/><line style="stroke:#000000;stroke-width:1;" x1="576.2729" x2="576.2729" y1="762.2188" y2="775.2188"/><line style="stroke:#000000;stroke-width:1;" x1="535.2729" x2="576.2729" y1="775.2188" y2="775.2188"/><polygon fill="#000000" points="545.2729,771.2188,535.2729,775.2188,545.2729,779.2188,541.2729,775.2188" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="746.2197">Generate Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="757.8604">Link and send Email</text><line style="stroke:#000000;stroke-width:1;" x1="187.0552" x2="229.0552" y1="800.8594" y2="800.8594"/><line style="stroke:#000000;stroke-width:1;" x1="229.0552" x2="229.0552" y1="800.8594" y2="813.8594"/><line style="stroke:#000000;stroke-width:1;" x1="188.0552" x2="229.0552" y1="813.8594" y2="813.8594"/><polygon fill="#000000" points="198.0552,809.8594,188.0552,813.8594,198.0552,817.8594,194.0552,813.8594" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="194.0552" y="796.501">Receive Email</text><polygon fill="#000000" points="165.0552,847.1406,175.0552,851.1406,165.0552,855.1406,169.0552,851.1406" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="24" x2="171.0552" y1="851.1406" y2="851.1406"/><text fill="#000000" font-family="sans-serif" font-size="10" x="31" y="835.1416">Click Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="31" y="846.7822">Link in Email</text><polygon fill="#000000" points="99.1821,896.0625,89.1821,900.0625,99.1821,904.0625,95.1821,900.0625" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="93.1821" x2="176.0552" y1="900.0625" y2="900.0625"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="872.4229">Open</text><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="884.0635">Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="895.7041">Link</text><polygon fill="#000000" points="512.2729,933.3438,522.2729,937.3438,512.2729,941.3438,516.2729,937.3438" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="518.2729" y1="937.3438" y2="937.3438"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="921.3447">Email Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="932.9854">Request</text><line style="stroke:#000000;stroke-width:1;" x1="534.2729" x2="576.2729" y1="986.2656" y2="986.2656"/><line style="stroke:#000000;stroke-width:1;" x1="576.2729" x2="576.2729" y1="986.2656" y2="999.2656"/><line style="stroke:#000000;stroke-width:1;" x1="535.2729" x2="576.2729" y1="999.2656" y2="999.2656"/><polygon fill="#000000" points="545.2729,995.2656,535.2729,999.2656,545.2729,1003.2656,541.2729,999.2656" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="958.626">Verify Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="970.2666">Confirmation</text><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="981.9072">Request</text><line style="stroke:#000000;stroke-width:1;" x1="534.2729" x2="576.2729" y1="1036.5469" y2="1036.5469"/><line style="stroke:#000000;stroke-width:1;" x1="576.2729" x2="576.2729" y1="1036.5469" y2="1049.5469"/><line style="stroke:#000000;stroke-width:1;" x1="535.2729" x2="576.2729" y1="1049.5469" y2="1049.5469"/><polygon fill="#000000" points="545.2729,1045.5469,535.2729,1049.5469,545.2729,1053.5469,541.2729,1049.5469" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="1020.5479">Generate Email</text><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="1032.1885">Confirmation JWT</text><path d="M640.27,1012.2656 L640.27,1103.2656 L814.27,1103.2656 L814.27,1022.2656 L804.27,1012.2656 L640.27,1012.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M804.27,1012.2656 L804.27,1022.2656 L814.27,1022.2656 L804.27,1012.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="646.27" y="1026.5479">JWT Claims:</text><text fill="#000000" font-family="sans-serif" font-size="10" x="649.4487" y="1038.1885">- iss: AS_A_ID</text><text fill="#000000" font-family="sans-serif" font-size="10" x="649.4487" y="1049.8291">- sub: Client_id</text><text fill="#000000" font-family="sans-serif" font-size="10" x="649.4487" y="1061.4697">- aud: (all AS)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="649.4487" y="1073.1104">- exp: (Policy Engine decision)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="649.4487" y="1084.751">- iat: (now)</text><text fill="#000000" font-family="sans-serif" font-size="10" x="649.4487" y="1096.3916">- Email_verified: true</text><polygon fill="#000000" points="813.0415,1134.0313,823.0415,1138.0313,813.0415,1142.0313,817.0415,1138.0313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="534.2729" x2="819.0415" y1="1138.0313" y2="1138.0313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="1122.0322">Request Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="1133.6729">Registration Decision</text><path d="M840.0415,1113.75 L840.0415,1146.75 L1064.0415,1146.75 L1064.0415,1123.75 L1054.0415,1113.75 L840.0415,1113.75 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1054.0415,1113.75 L1054.0415,1123.75 L1064.0415,1123.75 L1054.0415,1113.75 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="846.0415" y="1128.0322">AS A sends input data to Policy Engine A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="846.0415" y="1139.6729">for registration request</text><line style="stroke:#000000;stroke-width:1;" x1="835.0415" x2="877.0415" y1="1181.3125" y2="1181.3125"/><line style="stroke:#000000;stroke-width:1;" x1="877.0415" x2="877.0415" y1="1181.3125" y2="1194.3125"/><line style="stroke:#000000;stroke-width:1;" x1="836.0415" x2="877.0415" y1="1194.3125" y2="1194.3125"/><polygon fill="#000000" points="846.0415,1190.3125,836.0415,1194.3125,846.0415,1198.3125,842.0415,1194.3125" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="842.0415" y="1165.3135">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="842.0415" y="1176.9541">on Input Data</text><polygon fill="#000000" points="545.2729,1227.5938,535.2729,1231.5938,545.2729,1235.5938,541.2729,1231.5938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="539.2729" x2="824.0415" y1="1231.5938" y2="1231.5938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="551.2729" y="1215.5947">Client Registration</text><text fill="#000000" font-family="sans-serif" font-size="10" x="551.2729" y="1227.2354">Decision (Permit/Deny)</text><polygon fill="#000000" points="293.4214,1264.875,283.4214,1268.875,293.4214,1272.875,289.4214,1268.875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="523.2729" y1="1268.875" y2="1268.875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="1252.876">Client Registration Response</text><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="1264.5166">(client_id, Email Confirmation JWT)</text><polygon fill="#000000" points="813.0415,1331.7969,823.0415,1335.7969,813.0415,1339.7969,817.0415,1335.7969" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="529.2729" x2="819.0415" y1="1335.7969" y2="1335.7969"/><text fill="#000000" font-family="sans-serif" font-size="10" x="536.2729" y="1319.7979">Request Client</text><text fill="#000000" font-family="sans-serif" font-size="10" x="536.2729" y="1331.4385">Registration Decision</text><path d="M840.0415,1311.5156 L840.0415,1344.5156 L1064.0415,1344.5156 L1064.0415,1321.5156 L1054.0415,1311.5156 L840.0415,1311.5156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1054.0415,1311.5156 L1054.0415,1321.5156 L1064.0415,1321.5156 L1054.0415,1311.5156 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="846.0415" y="1325.7979">AS A sends input data to Policy Engine A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="846.0415" y="1337.4385">for registration request</text><line style="stroke:#000000;stroke-width:1;" x1="835.0415" x2="877.0415" y1="1379.0781" y2="1379.0781"/><line style="stroke:#000000;stroke-width:1;" x1="877.0415" x2="877.0415" y1="1379.0781" y2="1392.0781"/><line style="stroke:#000000;stroke-width:1;" x1="836.0415" x2="877.0415" y1="1392.0781" y2="1392.0781"/><polygon fill="#000000" points="846.0415,1388.0781,836.0415,1392.0781,846.0415,1396.0781,842.0415,1392.0781" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="842.0415" y="1363.0791">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="842.0415" y="1374.7197">on Input Data</text><polygon fill="#000000" points="540.2729,1425.3594,530.2729,1429.3594,540.2729,1433.3594,536.2729,1429.3594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="534.2729" x2="824.0415" y1="1429.3594" y2="1429.3594"/><text fill="#000000" font-family="sans-serif" font-size="10" x="546.2729" y="1413.3604">Client Registration</text><text fill="#000000" font-family="sans-serif" font-size="10" x="546.2729" y="1425.001">Decision (Permit/Deny)</text><polygon fill="#000000" points="293.4214,1462.6406,283.4214,1466.6406,293.4214,1470.6406,289.4214,1466.6406" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="528.2729" y1="1466.6406" y2="1466.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="1450.6416">Client Registration Response</text><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="1462.2822">(client_id)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1324.1646" x="5" y="1507.4609"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1329.1646" y1="1507.4609" y2="1507.4609"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1329.1646" y1="1510.4609" y2="1510.4609"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="364.293" x="484.9358" y="1498.6406"/><text fill="#000000" font-family="sans-serif" font-size="10" font-weight="bold" x="490.9358" y="1511.9229">OAuth 2.0 Authorization Code Flow with PAR, PKCE and DPoP</text><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="324.4214" y1="1557.5625" y2="1557.5625"/><line style="stroke:#000000;stroke-width:1;" x1="324.4214" x2="324.4214" y1="1557.5625" y2="1570.5625"/><line style="stroke:#000000;stroke-width:1;" x1="283.4214" x2="324.4214" y1="1570.5625" y2="1570.5625"/><polygon fill="#000000" points="293.4214,1566.5625,283.4214,1570.5625,293.4214,1574.5625,289.4214,1570.5625" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1541.5635">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1553.2041">Code Verifier</text><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="324.4214" y1="1607.8438" y2="1607.8438"/><line style="stroke:#000000;stroke-width:1;" x1="324.4214" x2="324.4214" y1="1607.8438" y2="1620.8438"/><line style="stroke:#000000;stroke-width:1;" x1="283.4214" x2="324.4214" y1="1620.8438" y2="1620.8438"/><polygon fill="#000000" points="293.4214,1616.8438,283.4214,1620.8438,293.4214,1624.8438,289.4214,1620.8438" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1591.8447">Generate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1603.4854">Code Challenge</text><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="324.4214" y1="1646.4844" y2="1646.4844"/><line style="stroke:#000000;stroke-width:1;" x1="324.4214" x2="324.4214" y1="1646.4844" y2="1659.4844"/><line style="stroke:#000000;stroke-width:1;" x1="283.4214" x2="324.4214" y1="1659.4844" y2="1659.4844"/><polygon fill="#000000" points="293.4214,1655.4844,283.4214,1659.4844,293.4214,1663.4844,289.4214,1659.4844" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1642.126">Generate DPoP Key Pair</text><polygon fill="#000000" points="512.2729,1692.7656,522.2729,1696.7656,512.2729,1700.7656,516.2729,1696.7656" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="518.2729" y1="1696.7656" y2="1696.7656"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1680.7666">PAR Request</text><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="1692.4072">(client_id, redirect_uri, scope, etc., dpop_jkt)</text><path d="M539.2729,1672.4844 L539.2729,1705.4844 L922.2729,1705.4844 L922.2729,1682.4844 L912.2729,1672.4844 L539.2729,1672.4844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M912.2729,1672.4844 L912.2729,1682.4844 L922.2729,1682.4844 L912.2729,1672.4844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="545.2729" y="1686.7666">Authorization Code Request</text><text fill="#000000" font-family="sans-serif" font-size="10" x="545.2729" y="1698.4072">(inkl. DPoP Proof, code_challenge, code_challenge_method, redirect_uri)</text><line style="stroke:#000000;stroke-width:1;" x1="534.2729" x2="576.2729" y1="1728.4063" y2="1728.4063"/><line style="stroke:#000000;stroke-width:1;" x1="576.2729" x2="576.2729" y1="1728.4063" y2="1741.4063"/><line style="stroke:#000000;stroke-width:1;" x1="535.2729" x2="576.2729" y1="1741.4063" y2="1741.4063"/><polygon fill="#000000" points="545.2729,1737.4063,535.2729,1741.4063,545.2729,1745.4063,541.2729,1741.4063" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="1724.0479">Validate DPoP Proof</text><polygon fill="#000000" points="293.4214,1763.0469,283.4214,1767.0469,293.4214,1771.0469,289.4214,1767.0469" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="523.2729" y1="1767.0469" y2="1767.0469"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="1762.6885">Request URI</text><polygon fill="#000000" points="99.1821,1788.6875,89.1821,1792.6875,99.1821,1796.6875,95.1821,1792.6875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="93.1821" x2="271.4214" y1="1792.6875" y2="1792.6875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1788.3291">Navigate to Request URI</text><polygon fill="#000000" points="512.2729,1814.3281,522.2729,1818.3281,512.2729,1822.3281,516.2729,1818.3281" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="518.2729" y1="1818.3281" y2="1818.3281"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1813.9697">Authorization Request (with Request URI)</text><polygon fill="#000000" points="1144.7778,1839.9688,1154.7778,1843.9688,1144.7778,1847.9688,1148.7778,1843.9688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="534.2729" x2="1150.7778" y1="1843.9688" y2="1843.9688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="1839.6104">PAR Request (OpenID Connect), redirect_uri, client_id_idpsek</text><path d="M1171.7778,1831.3281 L1171.7778,1875.3281 L1323.7778,1875.3281 L1323.7778,1841.3281 L1313.7778,1831.3281 L1171.7778,1831.3281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1313.7778,1831.3281 L1313.7778,1841.3281 L1323.7778,1841.3281 L1313.7778,1831.3281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1177.7778" y="1845.6104">AS A acts as Relying Party</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1180.9565" y="1857.251">for the IDP</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1177.7778" y="1868.8916">(client_id_idpsek)</text><polygon fill="#000000" points="545.2729,1894.8906,535.2729,1898.8906,545.2729,1902.8906,541.2729,1898.8906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="539.2729" x2="1155.7778" y1="1898.8906" y2="1898.8906"/><text fill="#000000" font-family="sans-serif" font-size="10" x="551.2729" y="1894.5322">PAR Response, request_uri, expires_in</text><polygon fill="#000000" points="99.1821,1920.5313,89.1821,1924.5313,99.1821,1928.5313,95.1821,1924.5313" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="523.2729" y1="1924.5313" y2="1924.5313"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1920.1729">Redirect to IDP, request_uri</text><polygon fill="#000000" points="1144.7778,1946.1719,1154.7778,1950.1719,1144.7778,1954.1719,1148.7778,1950.1719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="1150.7778" y1="1950.1719" y2="1950.1719"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1945.8135">Navigate to request_uri</text><polygon fill="#000000" points="99.1821,1971.8125,89.1821,1975.8125,99.1821,1979.8125,95.1821,1975.8125" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="1155.7778" y1="1975.8125" y2="1975.8125"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="1971.4541">Authentication Prompt, consent</text><polygon fill="#000000" points="1144.7778,1997.4531,1154.7778,2001.4531,1144.7778,2005.4531,1148.7778,2001.4531" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="1150.7778" y1="2001.4531" y2="2001.4531"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="1997.0947">User Credentials, consent</text><polygon fill="#000000" points="99.1821,2023.0938,89.1821,2027.0938,99.1821,2031.0938,95.1821,2027.0938" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="1155.7778" y1="2027.0938" y2="2027.0938"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="2022.7354">Redirect to AuthS, auth_code, redirect_uri</text><polygon fill="#000000" points="512.2729,2048.7344,522.2729,2052.7344,512.2729,2056.7344,516.2729,2052.7344" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="518.2729" y1="2052.7344" y2="2052.7344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="2048.376">Redirect to AuthS, auth_code, redirect_uri</text><polygon fill="#000000" points="1144.7778,2074.375,1154.7778,2078.375,1144.7778,2082.375,1148.7778,2078.375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="534.2729" x2="1150.7778" y1="2078.375" y2="2078.375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="2074.0166">Token Request (Authorization Code Grant), auth_code</text><line style="stroke:#000000;stroke-width:1;" x1="1166.7778" x2="1208.7778" y1="2127.2969" y2="2127.2969"/><line style="stroke:#000000;stroke-width:1;" x1="1208.7778" x2="1208.7778" y1="2127.2969" y2="2140.2969"/><line style="stroke:#000000;stroke-width:1;" x1="1167.7778" x2="1208.7778" y1="2140.2969" y2="2140.2969"/><polygon fill="#000000" points="1177.7778,2136.2969,1167.7778,2140.2969,1177.7778,2144.2969,1173.7778,2140.2969" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="1173.7778" y="2099.6572">Validate</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1173.7778" y="2111.2979">Authorization</text><text fill="#000000" font-family="sans-serif" font-size="10" x="1173.7778" y="2122.9385">Code</text><polygon fill="#000000" points="545.2729,2161.9375,535.2729,2165.9375,545.2729,2169.9375,541.2729,2165.9375" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="539.2729" x2="1155.7778" y1="2165.9375" y2="2165.9375"/><text fill="#000000" font-family="sans-serif" font-size="10" x="551.2729" y="2161.5791">Authentication Response (ID Token)</text><line style="stroke:#000000;stroke-width:1;" x1="534.2729" x2="576.2729" y1="2203.2188" y2="2203.2188"/><line style="stroke:#000000;stroke-width:1;" x1="576.2729" x2="576.2729" y1="2203.2188" y2="2216.2188"/><line style="stroke:#000000;stroke-width:1;" x1="535.2729" x2="576.2729" y1="2216.2188" y2="2216.2188"/><polygon fill="#000000" points="545.2729,2212.2188,535.2729,2216.2188,545.2729,2220.2188,541.2729,2216.2188" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="2187.2197">Validate</text><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="2198.8604">ID Token</text><polygon fill="#000000" points="99.1821,2237.8594,89.1821,2241.8594,99.1821,2245.8594,95.1821,2241.8594" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="93.1821" x2="523.2729" y1="2241.8594" y2="2241.8594"/><text fill="#000000" font-family="sans-serif" font-size="10" x="105.1821" y="2237.501">Authorization Code</text><polygon fill="#000000" points="260.4214,2263.5,270.4214,2267.5,260.4214,2271.5,264.4214,2267.5" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="88.1821" x2="266.4214" y1="2267.5" y2="2267.5"/><text fill="#000000" font-family="sans-serif" font-size="10" x="95.1821" y="2263.1416">Redirect with Authorization Code</text><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="324.4214" y1="2304.7813" y2="2304.7813"/><line style="stroke:#000000;stroke-width:1;" x1="324.4214" x2="324.4214" y1="2304.7813" y2="2317.7813"/><line style="stroke:#000000;stroke-width:1;" x1="283.4214" x2="324.4214" y1="2317.7813" y2="2317.7813"/><polygon fill="#000000" points="293.4214,2313.7813,283.4214,2317.7813,293.4214,2321.7813,289.4214,2317.7813" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="2288.7822">Generate</text><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="2300.4229">DPoP Proof JWT</text><polygon fill="#000000" points="512.2729,2339.4219,522.2729,2343.4219,512.2729,2347.4219,516.2729,2343.4219" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="518.2729" y1="2343.4219" y2="2343.4219"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="2339.0635">Token Request (Authorization Code Grant)</text><path d="M539.2729,2330.7813 L539.2729,2363.7813 L759.2729,2363.7813 L759.2729,2340.7813 L749.2729,2330.7813 L539.2729,2330.7813 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M749.2729,2330.7813 L749.2729,2340.7813 L759.2729,2340.7813 L749.2729,2330.7813 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="545.2729" y="2345.0635">Enth&#228;lt Authorization Code, DPoP Proof,</text><text fill="#000000" font-family="sans-serif" font-size="10" x="545.2729" y="2356.7041">client_id, redirect_uri, code_verifier</text><line style="stroke:#000000;stroke-width:1;" x1="534.2729" x2="576.2729" y1="2398.3438" y2="2398.3438"/><line style="stroke:#000000;stroke-width:1;" x1="576.2729" x2="576.2729" y1="2398.3438" y2="2411.3438"/><line style="stroke:#000000;stroke-width:1;" x1="535.2729" x2="576.2729" y1="2411.3438" y2="2411.3438"/><polygon fill="#000000" points="545.2729,2407.3438,535.2729,2411.3438,545.2729,2415.3438,541.2729,2411.3438" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="2382.3447">Validate</text><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="2393.9854">Authorization Code</text><line style="stroke:#000000;stroke-width:1;" x1="534.2729" x2="576.2729" y1="2436.9844" y2="2436.9844"/><line style="stroke:#000000;stroke-width:1;" x1="576.2729" x2="576.2729" y1="2436.9844" y2="2449.9844"/><line style="stroke:#000000;stroke-width:1;" x1="535.2729" x2="576.2729" y1="2449.9844" y2="2449.9844"/><polygon fill="#000000" points="545.2729,2445.9844,535.2729,2449.9844,545.2729,2453.9844,541.2729,2449.9844" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="2432.626">Validate DPoP Proof</text><line style="stroke:#000000;stroke-width:1;" x1="534.2729" x2="576.2729" y1="2487.2656" y2="2487.2656"/><line style="stroke:#000000;stroke-width:1;" x1="576.2729" x2="576.2729" y1="2487.2656" y2="2500.2656"/><line style="stroke:#000000;stroke-width:1;" x1="535.2729" x2="576.2729" y1="2500.2656" y2="2500.2656"/><polygon fill="#000000" points="545.2729,2496.2656,535.2729,2500.2656,545.2729,2504.2656,541.2729,2500.2656" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="2471.2666">Validate PKCE</text><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="2482.9072">Code Verifier</text><polygon fill="#000000" points="813.0415,2521.9063,823.0415,2525.9063,813.0415,2529.9063,817.0415,2525.9063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="534.2729" x2="819.0415" y1="2525.9063" y2="2525.9063"/><text fill="#000000" font-family="sans-serif" font-size="10" x="541.2729" y="2521.5479">Request Token Issuance Decision</text><path d="M840.0415,2513.2656 L840.0415,2546.2656 L1064.0415,2546.2656 L1064.0415,2523.2656 L1054.0415,2513.2656 L840.0415,2513.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1054.0415,2513.2656 L1054.0415,2523.2656 L1064.0415,2523.2656 L1054.0415,2513.2656 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="846.0415" y="2527.5479">AS A sends input data to Policy Engine A</text><text fill="#000000" font-family="sans-serif" font-size="10" x="846.0415" y="2539.1885">for token request</text><line style="stroke:#000000;stroke-width:1;" x1="835.0415" x2="877.0415" y1="2580.8281" y2="2580.8281"/><line style="stroke:#000000;stroke-width:1;" x1="877.0415" x2="877.0415" y1="2580.8281" y2="2593.8281"/><line style="stroke:#000000;stroke-width:1;" x1="836.0415" x2="877.0415" y1="2593.8281" y2="2593.8281"/><polygon fill="#000000" points="846.0415,2589.8281,836.0415,2593.8281,846.0415,2597.8281,842.0415,2593.8281" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="842.0415" y="2564.8291">Evaluate Policy based</text><text fill="#000000" font-family="sans-serif" font-size="10" x="842.0415" y="2576.4697">on Input Data</text><polygon fill="#000000" points="545.2729,2615.4688,535.2729,2619.4688,545.2729,2623.4688,541.2729,2619.4688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="539.2729" x2="824.0415" y1="2619.4688" y2="2619.4688"/><text fill="#000000" font-family="sans-serif" font-size="10" x="551.2729" y="2615.1104">Token Issuance Decision (Permit/Deny)</text><polygon fill="#000000" points="293.4214,2641.1094,283.4214,2645.1094,293.4214,2649.1094,289.4214,2645.1094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="523.2729" y1="2645.1094" y2="2645.1094"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="2640.751">Access Token, Refresh Token</text><path d="M132.6323,2632.4688 L132.6323,2665.4688 L271.6323,2665.4688 L271.6323,2642.4688 L261.6323,2632.4688 L132.6323,2632.4688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M261.6323,2632.4688 L261.6323,2642.4688 L271.6323,2642.4688 L261.6323,2632.4688 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="138.6323" y="2646.751">Access Token bound to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="138.6323" y="2658.3916">client's DPoP public key</text><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="324.4214" y1="2688.3906" y2="2688.3906"/><line style="stroke:#000000;stroke-width:1;" x1="324.4214" x2="324.4214" y1="2688.3906" y2="2701.3906"/><line style="stroke:#000000;stroke-width:1;" x1="283.4214" x2="324.4214" y1="2701.3906" y2="2701.3906"/><polygon fill="#000000" points="293.4214,2697.3906,283.4214,2701.3906,293.4214,2705.3906,289.4214,2701.3906" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="2684.0322">Generate DPoP Token</text><polygon fill="#000000" points="681.6929,2734.6719,691.6929,2738.6719,681.6929,2742.6719,685.6929,2738.6719" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="282.4214" x2="687.6929" y1="2738.6719" y2="2738.6719"/><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="2722.6729">Access Protected Resource</text><text fill="#000000" font-family="sans-serif" font-size="10" x="289.4214" y="2734.3135">(with Access Token and DPoP Proof)</text><line style="stroke:#000000;stroke-width:1;" x1="703.6929" x2="745.6929" y1="2775.9531" y2="2775.9531"/><line style="stroke:#000000;stroke-width:1;" x1="745.6929" x2="745.6929" y1="2775.9531" y2="2788.9531"/><line style="stroke:#000000;stroke-width:1;" x1="704.6929" x2="745.6929" y1="2788.9531" y2="2788.9531"/><polygon fill="#000000" points="714.6929,2784.9531,704.6929,2788.9531,714.6929,2792.9531,710.6929,2788.9531" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="10" x="710.6929" y="2759.9541">Validate Access Token</text><text fill="#000000" font-family="sans-serif" font-size="10" x="710.6929" y="2771.5947">and DPoP Proof</text><polygon fill="#000000" points="941.3872,2822.2344,951.3872,2826.2344,941.3872,2830.2344,945.3872,2826.2344" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="703.6929" x2="947.3872" y1="2826.2344" y2="2826.2344"/><text fill="#000000" font-family="sans-serif" font-size="10" x="710.6929" y="2810.2354">Forward Request to</text><text fill="#000000" font-family="sans-serif" font-size="10" x="710.6929" y="2821.876">Resource Server A</text><polygon fill="#000000" points="714.6929,2847.875,704.6929,2851.875,714.6929,2855.875,710.6929,2851.875" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="708.6929" x2="952.3872" y1="2851.875" y2="2851.875"/><text fill="#000000" font-family="sans-serif" font-size="10" x="720.6929" y="2847.5166">Resource Data</text><polygon fill="#000000" points="293.4214,2873.5156,283.4214,2877.5156,293.4214,2881.5156,289.4214,2877.5156" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="287.4214" x2="692.6929" y1="2877.5156" y2="2877.5156"/><text fill="#000000" font-family="sans-serif" font-size="10" x="299.4214" y="2873.1572">Resource Data</text><!--SRC=[xLXRRzis57xNh-3IXyM0UzaU0sI0QZkfroOHx7J51WC68ntRh6LI8scdxh1_it-oFxP3KfIeYuDcmDw65eWbdllvpeLIMyOBAkcEPB2Y-rnV2Qxdx2kG7zv4gZeSkyCRmOKgQ0gP8RkbEo0ZiPSCP42R0r_hJPnztYjDkE0G1OSAVjy3Ju7y4H6IKAbPoWhAzLiXCv0ZaGj97dAQRbl7-6OjnPvdZkHnmpGWIPng8VjutS4fBYd5OvF-0rl11yQXJrPrrXBtukgD-OSKjqBtSjht7Qx9rMGqYVwCekyAITSxIZI8hqJBFKRAsaq-AepeW_X2pcx40yi1utzWAPoH5zSReVIdqWz2YZf4bYbU0_wYYfoP9s8VppgKDnzZItD3MRxWJr6ESkO5kfzTafXdKh3iVZAnPEKZmUUp27X6q8t8-HBp1mOQ9BfnFnczkxtxS7VzgvLdZt-RtCVaUazbXWHpohFZMqmJjmGTfNkzcLjzoJXPSFjurakPJ197Dq6wT_Vt2Kca-78yHHpNGXEHi_H89doDkNVqtf_Avlif-V7LcmKVOsoKHhl7L6xdGAybGB_bCsVs31GMJWeBFWTvm9Wqv5Tn2pdFOgr1QQgPu8xDGWAbuK7vs6IOZXDxZd-R1rU0KBM2o8BVK6MJWeJutZr5qUMbJ_uCrapfalpyaUcDFmaC8fWlCjaXe0RayZAABAXU_bHINbXmahb68rH3O4HJpGvKGqaPqRo2L2ZVXgTKYs9hq5sGQ-366I3luOWzWya5Ns4DjPahHJMlVS-nHebawusral4r2I1CK12xcvCvf7i9Y8KqfmTNUW7kNmQE9li7X8snnL9bS4flu4oLlWkC3VP7rGpjQ4DpqrIXvKUTTMjFzTYmvxIWqBIcgFuupzaw444C4B3o0l7Uv-T7UavNe8-te5ydEJsIATUmbamVCVmBRkBl-jze0-dsTLmKfLSaJgPFvI8q3h6dOMSGTZeja2kmwJuDl59qnvyMbuqEQLfgdGaSiTPZfKT1k4qVk-Wjl18OKQWqjNHBXgs7uanzTQGxxETJ1Ea-0qLeO8_oxWz9uH2wXUEmRFwsRcq5Ax7IZnIHNj7N1MgDYrpdRQ7s5v1iTUnf2r4Vn48NOWmRmN95fLdJuengkk1QDBDOYWZ1tZA5vYmh5GRTidAdLIPbn4CTrXcM-h0ht7i2hnrzwR0Bt4Zm5PCxn_3pf_kelx9CP-jXC8bb4Z87v9QUghU5B0kEsyZMvGjyssrM7avu-y9CUfI6VqnhIO4T823tJTeUO_8Gaprw60zOIe7Lhd51xWf0oYvVqw2AeLr-tj9wUwczxqPhmNqTjCGqvJ-LhhQjeS2JuU_Xj9bkjm5yXu6aRASk5foy94mfW_5bl9oExGkrV_3rlMIPVKNtsGKvnxQAX0Fx1huK-AQnVw2lALEerb4mYihEkNXqZzQyvS425r2QtIKR3k5cKmyNfz-u7ZIOSQcWcJVawpXfQzOWJo4sYhssfKgmKfiMnsuEor29389jbYrlsUH0yxtLvqGyK0KO7UIOMWrZr50pFTafJOzrdc08GUwOVZq6VXoq4UCzAqCKZ8t-zgiAmHNkQ-U-wsR34_NVKUKwfrtmp8JfuQAv19eTIMQkI_ydxZzEtC2EtKw2pCvxPtwQdTw-4v9zBLSdaG6voiMZc-n9F1kIvFreOhlmE169sNexQqBTG0ojwHyenSqNtB6_ZRnUsfwWjnRu_RUxKA2v7aDD0EFSmTcJwYLUueT4fQA08G6TlXgIh135ylDM3zeRG0DHtI3LUd08vA-SQNZd4giXIP5WcNg7si_B7Q2qbbM3xkpr4xwM77Mnu4lcuspQa-awGi4akwK7jZP4M14XUy-GwPjMpLXu0Ux258ZhnBDHxdXLQwIBd9lvEXsRTi4n98Dspgfaulz2mRQMRcvzdUh7KsLkUZF8ZsO3DzzOZZX3JC7hZMKA4L8ATJM8Ps49EojTTGrzWt16uG134nLkfgrA3Q8zAzqmqKR93GdTZS369KnGczeR5sWmQl67N-KGARj26z2XmUMYqDLXTw8HnjXmqbmrwNkqX7vOHuSuqVLcQR3TJDR9FUUP8ffWkHTR2E3MKv7N4Y_zWq1cxKefmvUK-v9IiRiE5BNotWghXm0vHvHQOmPXmHaKzgvabKhFTXegNP-weQphleobku5rENkNnYTwAuwbgi_OdQ_JNRyr0urgd72z-VklNFUOE0nxveAVRDUsUnxyD3aTu9uWFAEdTcdwPbd_lk8YCrLgR-wdzQRIcEN_VaFHLhnVJPwzbhHMaXF6jfQHRrf4uZG5fPp48KPZXSrmKwBSkfl3gaL67imdOdJ99_nxvP9HNzUVd6FzAu5JMLCbawHIYrdMY2N8IFqnqashXbtLWcDHCGXpbqJcwweNMz-y0_O5R_9xZXa6_CfT-okq6D-zASHz5YLnhMysZsOkp5PTHLdcCccD__2qaRGaV4IX_m00]--></g></svg>