<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="4607px" preserveAspectRatio="none" style="width:1884px;height:4607px;background:#FFFFFF;" version="1.1" viewBox="0 0 1884 4607" width="1884px" zoomAndPan="magnify"><title>ZETA Client Registrierung und Authentifizierung (TPM + SM(C)-B + DPoP)</title><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="914.665" x="483.4048" y="35.4209">ZETA Client Registrierung und Authentifizierung (TPM + SM(C)-B + DPoP)</text><g><title>ZETA Client</title><rect fill="#FFFFFF" height="4319.6523" style="stroke:#000000;stroke-width:1;" width="10" x="77.7729" y="200.2383"/></g><g><title>Client TPM</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="594.9058" y="403.1016"/></g><g><title>SM(C)-B Card</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="694.8169" y="1695.7422"/></g><g><title>Authorization Server (AS)</title><rect fill="#FFFFFF" height="461.7891" style="stroke:#000000;stroke-width:1;" width="10" x="860.6846" y="461.3672"/></g><g><title>Authorization Server (AS)</title><rect fill="#FFFFFF" height="307.8594" style="stroke:#000000;stroke-width:1;" width="10" x="860.6846" y="1263.0859"/></g><g><title>Authorization Server (AS)</title><rect fill="#FFFFFF" height="473.5234" style="stroke:#000000;stroke-width:1;" width="10" x="860.6846" y="1754.0078"/></g><g><title>Authorization Server (AS)</title><rect fill="#FFFFFF" height="362.8594" style="stroke:#000000;stroke-width:1;" width="10" x="860.6846" y="3204.1094"/></g><g><title>Resource Server (RS)</title><rect fill="#FFFFFF" height="261.1953" style="stroke:#000000;stroke-width:1;" width="10" x="1404.8203" y="4098.2266"/></g><rect fill="#FFFFFF" height="433.3281" style="stroke:#000000;stroke-width:1;" width="1514.2339" x="15" y="758.4922"/><rect fill="#FFFFFF" height="43.9375" style="stroke:none;stroke-width:1;" width="1514.2339" x="15" y="1147.8828"/><rect fill="#FFFFFF" height="263.1328" style="stroke:#000000;stroke-width:1;" width="1354.9902" x="15" y="2147.1328"/><rect fill="#FFFFFF" height="139.6016" style="stroke:none;stroke-width:1;" width="1354.9902" x="15" y="2270.6641"/><rect fill="#FFFFFF" height="369.0625" style="stroke:#000000;stroke-width:1;" width="1257.2046" x="15" y="3486.5703"/><rect fill="#FFFFFF" height="139.6016" style="stroke:none;stroke-width:1;" width="1257.2046" x="15" y="3716.0313"/><rect fill="#FFFFFF" height="232.8672" style="stroke:#000000;stroke-width:1;" width="1852.4746" x="15" y="4279.0234"/><rect fill="#FFFFFF" height="94.2031" style="stroke:none;stroke-width:1;" width="1852.4746" x="15" y="4417.6875"/><g><title>ZETA Client</title><rect fill="#000000" fill-opacity="0.00000" height="4414.9844" width="8" x="78.7729" y="113.9063"/><line style="stroke:#000000;stroke-width:1;" x1="82" x2="82" y1="113.9063" y2="4528.8906"/></g><g><title>Client TPM</title><rect fill="#000000" fill-opacity="0.00000" height="4414.9844" width="8" x="595.9058" y="113.9063"/><line style="stroke:#000000;stroke-width:1;" x1="599.8789" x2="599.8789" y1="113.9063" y2="4528.8906"/></g><g><title>SM(C)-B Card</title><rect fill="#000000" fill-opacity="0.00000" height="4414.9844" width="8" x="695.8169" y="113.9063"/><line style="stroke:#000000;stroke-width:1;" x1="698.9326" x2="698.9326" y1="113.9063" y2="4528.8906"/></g><g><title>Authorization Server (AS)</title><rect fill="#000000" fill-opacity="0.00000" height="4414.9844" width="8" x="861.6846" y="113.9063"/><line style="stroke:#000000;stroke-width:1;" x1="864.7012" x2="864.7012" y1="113.9063" y2="4528.8906"/></g><g><title>Resource Server (RS)</title><rect fill="#000000" fill-opacity="0.00000" height="4414.9844" width="8" x="1405.8203" y="113.9063"/><line style="stroke:#000000;stroke-width:1;" x1="1409.0762" x2="1409.0762" y1="113.9063" y2="4528.8906"/></g><g class="participant participant-head" data-participant="Client"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="95.5459" x="35" y="82.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="81.5459" x="42" y="102.6045">ZETA Client</text></g><g class="participant participant-tail" data-participant="Client"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="95.5459" x="35" y="4527.8906"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="81.5459" x="42" y="4547.8857">ZETA Client</text></g><g class="participant participant-head" data-participant="TPM"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="74.0537" x="559.8789" y="110.6045">Client TPM</text><path d="M581.9058,61.6094 C581.9058,51.6094 599.9058,51.6094 599.9058,51.6094 C599.9058,51.6094 617.9058,51.6094 617.9058,61.6094 L617.9058,87.6094 C617.9058,97.6094 599.9058,97.6094 599.9058,97.6094 C599.9058,97.6094 581.9058,97.6094 581.9058,87.6094 L581.9058,61.6094" fill="#FFFFFF" style="stroke:#000000;stroke-width:1.5;"/><path d="M581.9058,61.6094 C581.9058,71.6094 599.9058,71.6094 599.9058,71.6094 C599.9058,71.6094 617.9058,71.6094 617.9058,61.6094" fill="none" style="stroke:#000000;stroke-width:1.5;"/></g><g class="participant participant-tail" data-participant="TPM"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="74.0537" x="559.8789" y="4540.8857">Client TPM</text><path d="M581.9058,4554.1875 C581.9058,4544.1875 599.9058,4544.1875 599.9058,4544.1875 C599.9058,4544.1875 617.9058,4544.1875 617.9058,4554.1875 L617.9058,4580.1875 C617.9058,4590.1875 599.9058,4590.1875 599.9058,4590.1875 C599.9058,4590.1875 581.9058,4590.1875 581.9058,4580.1875 L581.9058,4554.1875" fill="#FFFFFF" style="stroke:#000000;stroke-width:1.5;"/><path d="M581.9058,4554.1875 C581.9058,4564.1875 599.9058,4564.1875 599.9058,4564.1875 C599.9058,4564.1875 617.9058,4564.1875 617.9058,4554.1875" fill="none" style="stroke:#000000;stroke-width:1.5;"/></g><g class="participant participant-head" data-participant="SMCB"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="93.7686" x="649.9326" y="110.6045">SM(C)-B Card</text><path d="M681.8169,61.6094 C681.8169,51.6094 699.8169,51.6094 699.8169,51.6094 C699.8169,51.6094 717.8169,51.6094 717.8169,61.6094 L717.8169,87.6094 C717.8169,97.6094 699.8169,97.6094 699.8169,97.6094 C699.8169,97.6094 681.8169,97.6094 681.8169,87.6094 L681.8169,61.6094" fill="#FFFFFF" style="stroke:#000000;stroke-width:1.5;"/><path d="M681.8169,61.6094 C681.8169,71.6094 699.8169,71.6094 699.8169,71.6094 C699.8169,71.6094 717.8169,71.6094 717.8169,61.6094" fill="none" style="stroke:#000000;stroke-width:1.5;"/></g><g class="participant participant-tail" data-participant="SMCB"><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="93.7686" x="649.9326" y="4540.8857">SM(C)-B Card</text><path d="M681.8169,4554.1875 C681.8169,4544.1875 699.8169,4544.1875 699.8169,4544.1875 C699.8169,4544.1875 717.8169,4544.1875 717.8169,4554.1875 L717.8169,4580.1875 C717.8169,4590.1875 699.8169,4590.1875 699.8169,4590.1875 C699.8169,4590.1875 681.8169,4590.1875 681.8169,4580.1875 L681.8169,4554.1875" fill="#FFFFFF" style="stroke:#000000;stroke-width:1.5;"/><path d="M681.8169,4554.1875 C681.8169,4564.1875 699.8169,4564.1875 699.8169,4564.1875 C699.8169,4564.1875 717.8169,4564.1875 717.8169,4554.1875" fill="none" style="stroke:#000000;stroke-width:1.5;"/></g><g class="participant participant-head" data-participant="AuthS"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="191.9668" x="769.7012" y="82.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="177.9668" x="776.7012" y="102.6045">Authorization Server (AS)</text></g><g class="participant participant-tail" data-participant="AuthS"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="191.9668" x="769.7012" y="4527.8906"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="177.9668" x="776.7012" y="4547.8857">Authorization Server (AS)</text></g><g class="participant participant-head" data-participant="RS"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="163.4883" x="1328.0762" y="82.6094"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="149.4883" x="1335.0762" y="102.6045">Resource Server (RS)</text></g><g class="participant participant-tail" data-participant="RS"><rect fill="#FFFFFF" height="30.2969" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="163.4883" x="1328.0762" y="4527.8906"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="149.4883" x="1335.0762" y="4547.8857">Resource Server (RS)</text></g><g><title>ZETA Client</title><rect fill="#FFFFFF" height="4319.6523" style="stroke:#000000;stroke-width:1;" width="10" x="77.7729" y="200.2383"/></g><g><title>Client TPM</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="594.9058" y="403.1016"/></g><g><title>SM(C)-B Card</title><rect fill="#FFFFFF" height="29.1328" style="stroke:#000000;stroke-width:1;" width="10" x="694.8169" y="1695.7422"/></g><g><title>Authorization Server (AS)</title><rect fill="#FFFFFF" height="461.7891" style="stroke:#000000;stroke-width:1;" width="10" x="860.6846" y="461.3672"/></g><g><title>Authorization Server (AS)</title><rect fill="#FFFFFF" height="307.8594" style="stroke:#000000;stroke-width:1;" width="10" x="860.6846" y="1263.0859"/></g><g><title>Authorization Server (AS)</title><rect fill="#FFFFFF" height="473.5234" style="stroke:#000000;stroke-width:1;" width="10" x="860.6846" y="1754.0078"/></g><g><title>Authorization Server (AS)</title><rect fill="#FFFFFF" height="362.8594" style="stroke:#000000;stroke-width:1;" width="10" x="860.6846" y="3204.1094"/></g><g><title>Resource Server (RS)</title><rect fill="#FFFFFF" height="261.1953" style="stroke:#000000;stroke-width:1;" width="10" x="1404.8203" y="4098.2266"/></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1872.4746" x="5" y="144.4727"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1877.4746" y1="144.4727" y2="144.4727"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1877.4746" y1="147.4727" y2="147.4727"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="150.5254" x="865.9746" y="133.9063"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="131.9995" x="871.9746" y="149.9731">1. Key Generation</text><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="82.7729" x2="129.7729" y1="187.2383" y2="187.2383"/><line style="stroke:#000000;stroke-width:1;" x1="129.7729" x2="129.7729" y1="187.2383" y2="200.2383"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="129.7729" y1="200.2383" y2="200.2383"/><polygon fill="#000000" points="98.7729,196.2383,88.7729,200.2383,98.7729,204.2383,94.7729,200.2383" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="327.6724" x="94.7729" y="182.1724">Generate Client Instance Key Pair (for Client Auth)</text></g><path d="M433.6724,172.0391 L433.6724,212.0391 L896.6724,212.0391 L896.6724,182.0391 L886.6724,172.0391 L433.6724,172.0391" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M886.6724,172.0391 L886.6724,182.0391 L896.6724,182.0391 L886.6724,172.0391" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="180.7749" x="439.6724" y="189.106">Key Pair for private_key_jwt</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="442.749" x="439.6724" y="204.2388">(could potentially be TPM-backed, but distinct from Attestation Key)</text><g class="message" data-participant-1="Client" data-participant-2="TPM"><polygon fill="#000000" points="587.9058,245.0039,597.9058,249.0039,587.9058,253.0039,591.9058,249.0039" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="87.7729" x2="593.9058" y1="249.0039" y2="249.0039"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="304.3892" x="94.7729" y="243.938">Trigger Generation of TPM Attestation Key Pair</text></g><path d="M604,222.3047 L604,262.3047 L859,262.3047 L859,232.3047 L849,222.3047 L604,222.3047" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M849,222.3047 L849,232.3047 L859,232.3047 L849,222.3047" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="234.5713" x="610" y="239.3716">Key Pair generated securely in TPM.</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="208.0952" x="610" y="254.5044">Private key does not leave TPM.</text><g class="message" data-participant-1="TPM" data-participant-2="Client"><polygon fill="#000000" points="98.7729,284.7031,88.7729,288.7031,98.7729,292.7031,94.7729,288.7031" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="92.7729" x2="598.9058" y1="288.7031" y2="288.7031"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="312.5269" x="104.7729" y="283.6372">Return Attestation Public Key / Certificate Chain</text></g><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="87.7729" x2="129.7729" y1="317.8359" y2="317.8359"/><line style="stroke:#000000;stroke-width:1;" x1="129.7729" x2="129.7729" y1="317.8359" y2="330.8359"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="129.7729" y1="330.8359" y2="330.8359"/><polygon fill="#000000" points="98.7729,326.8359,88.7729,330.8359,98.7729,334.8359,94.7729,330.8359" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="245.8257" x="94.7729" y="312.77">Generate DPoP Key Pair (for API calls)</text></g><path d="M361.8257,305.2031 L361.8257,330.2031 L731.8257,330.2031 L731.8257,315.2031 L721.8257,305.2031 L361.8257,305.2031" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M721.8257,305.2031 L721.8257,315.2031 L731.8257,315.2031 L721.8257,305.2031" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="349.6353" x="367.8257" y="322.27">Ephemeral or session-based Key Pair for DPoP Proofs.</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1872.4746" x="5" y="359.4023"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1877.4746" y1="359.4023" y2="359.4023"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1877.4746" y1="362.4023" y2="362.4023"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="448.8906" x="716.792" y="348.8359"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="430.3647" x="722.792" y="364.9028">2. Dynamic Client Registration (DCR) with TPM Attestation</text><g class="message" data-participant-1="Client" data-participant-2="TPM"><polygon fill="#000000" points="582.9058,399.1016,592.9058,403.1016,582.9058,407.1016,586.9058,403.1016" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="87.7729" x2="588.9058" y1="403.1016" y2="403.1016"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="307.0044" x="94.7729" y="398.0356">Request Attestation Statement for Registration</text></g><g class="message" data-participant-1="TPM" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="432.2344" y2="428.2344"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="432.2344" y2="436.2344"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="87.7729" x2="598.9058" y1="432.2344" y2="432.2344"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="483.1328" x="104.7729" y="427.1685">Return Attestation Statement (e.g., Certificate Chain with Extension Data)</text></g><g class="message" data-participant-1="Client" data-participant-2="AuthS"><polygon fill="#000000" points="848.6846,457.3672,858.6846,461.3672,848.6846,465.3672,852.6846,461.3672" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="87.7729" x2="854.6846" y1="461.3672" y2="461.3672"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="170.2759" x="94.7729" y="456.3013">POST /register (RFC 7591)</text></g><path d="M92,474.3672 L92,680.3672 L676,680.3672 L676,484.3672 L666,474.3672 L92,474.3672" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><path d="M666,474.3672 L666,484.3672 L676,484.3672 L666,474.3672" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="141.3687" x="98" y="491.4341">DCR Request Body:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="98" y="506.5669">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="140.3657" x="106.2646" y="521.6997">"redirect_uris": ["..."],</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="128.0322" x="106.2646" y="536.8325">"client_name": "...",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="331.792" x="106.2646" y="551.9653">"token_endpoint_auth_method": "private_key_jwt",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="554.7407" x="106.2646" y="567.0981">"grant_types": ["urn:ietf:params:oauth:grant-type:token-exchange","refresh_token"],</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="375.6733" x="106.2646" y="582.231">"jwks": { "keys": [ &lt;Client_Instance_Public_Key_JWK&gt; ] },</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="236.8755" x="106.2646" y="597.3638">// Custom parameter for attestation:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="391.3521" x="106.2646" y="612.4966">"urn:gematik:params:oauth:client-attestation-type:tpm2": {</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="398.8613" x="118.6616" y="627.6294">"attestation_data": "&lt;Base64(TPM Attestation Statement)&gt;",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="279.062" x="118.6616" y="642.7622">"attestation_format": "tpm-attestation-jwt"</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="110.397" y="657.895">}</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="98" y="673.0278">}</text><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="912.6846" y1="718.8594" y2="718.8594"/><line style="stroke:#000000;stroke-width:1;" x1="912.6846" x2="912.6846" y1="718.8594" y2="731.8594"/><line style="stroke:#000000;stroke-width:1;" x1="871.6846" x2="912.6846" y1="731.8594" y2="731.8594"/><polygon fill="#000000" points="881.6846,727.8594,871.6846,731.8594,881.6846,735.8594,877.6846,731.8594" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="233.0225" x="877.6846" y="713.7935">Validate TPM Attestation Statement</text></g><path d="M1132.0225,691.0938 L1132.0225,746.0938 L1403.0225,746.0938 L1403.0225,701.0938 L1393.0225,691.0938 L1132.0225,691.0938" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1393.0225,691.0938 L1393.0225,701.0938 L1403.0225,701.0938 L1393.0225,691.0938" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="250.0024" x="1138.0225" y="708.1606">Check signature against trusted roots.</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="194.2446" x="1138.0225" y="723.2935">Extract device/OS/App status.</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="217.312" x="1138.0225" y="738.4263">Verify Attestation Key properties.</text><path d="M15,758.4922 L79.4429,758.4922 L79.4429,765.625 L69.4429,775.625 L15,775.625 L15,758.4922" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="433.3281" style="stroke:#000000;stroke-width:1;" width="1514.2339" x="15" y="758.4922"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="30" y="771.5591">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="114.0283" x="94.4429" y="770.7026">[Attestation valid]</text><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="912.6846" y1="796.7578" y2="796.7578"/><line style="stroke:#000000;stroke-width:1;" x1="912.6846" x2="912.6846" y1="796.7578" y2="809.7578"/><line style="stroke:#000000;stroke-width:1;" x1="871.6846" x2="912.6846" y1="809.7578" y2="809.7578"/><polygon fill="#000000" points="881.6846,805.7578,871.6846,809.7578,881.6846,813.7578,877.6846,809.7578" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="118.917" x="877.6846" y="791.6919">Generate client_id</text></g><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="912.6846" y1="838.8906" y2="838.8906"/><line style="stroke:#000000;stroke-width:1;" x1="912.6846" x2="912.6846" y1="838.8906" y2="851.8906"/><line style="stroke:#000000;stroke-width:1;" x1="871.6846" x2="912.6846" y1="851.8906" y2="851.8906"/><polygon fill="#000000" points="881.6846,847.8906,871.6846,851.8906,881.6846,855.8906,877.6846,851.8906" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="306.1729" x="877.6846" y="833.8247">Store client metadata, incl. Client Instance Key</text></g><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="912.6846" y1="881.0234" y2="881.0234"/><line style="stroke:#000000;stroke-width:1;" x1="912.6846" x2="912.6846" y1="881.0234" y2="894.0234"/><line style="stroke:#000000;stroke-width:1;" x1="871.6846" x2="912.6846" y1="894.0234" y2="894.0234"/><polygon fill="#000000" points="881.6846,890.0234,871.6846,894.0234,881.6846,898.0234,877.6846,894.0234" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="463.5947" x="877.6846" y="875.9575">Generate Nonce (Challenge) // Short-lived for Client to SM(C)-B Binding</text></g><g class="message" data-participant-1="AuthS" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="923.1563" y2="919.1563"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="923.1563" y2="927.1563"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="87.7729" x2="864.6846" y1="923.1563" y2="923.1563"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="80.6787" x="104.7729" y="918.0903">201 Created</text></g><path d="M870,936.1563 L870,1142.1563 L1519,1142.1563 L1519,946.1563 L1509,936.1563 L870,936.1563" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><path d="M1509,936.1563 L1509,946.1563 L1519,946.1563 L1509,936.1563" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="151.8232" x="876" y="953.2231">DCR Response Body:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="876" y="968.356">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="236.5137" x="884.2646" y="983.4888">"client_id": "&lt;generated-client-id&gt;",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="158.7803" x="884.2646" y="998.6216">"client_id_issued_at": ...,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="128.0322" x="884.2646" y="1013.7544">"client_name": "...",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="331.792" x="884.2646" y="1028.8872">"token_endpoint_auth_method": "private_key_jwt",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="554.7407" x="884.2646" y="1044.02">"grant_types": ["urn:ietf:params:oauth:grant-type:token-exchange","refresh_token"],</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="493.5493" x="884.2646" y="1059.1528">"jwks": { &lt;Client_Instance_Public_Key_JWK&gt; }, // Confirming registered key</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="201.9951" x="884.2646" y="1074.2856">// ... other registered metadata</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="412.4897" x="884.2646" y="1089.4185">"registration_access_token": "...", // Optional for config updates</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="384.7695" x="884.2646" y="1104.5513">"registration_client_uri": "...", // Optional for config updates</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="619.9692" x="884.2646" y="1119.6841">"challenge": "&lt;random_nonce_value&gt;" // For Client to SM(C)-B Binding during Token Exchange</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="876" y="1134.8169">}</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="15" x2="1529.2339" y1="1148.8828" y2="1148.8828"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="125.6299" x="20" y="1159.0933">[Attestation invalid]</text><g class="message" data-participant-1="AuthS" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="1183.8203" y2="1179.8203"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="1183.8203" y2="1187.8203"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="87.7729" x2="864.6846" y1="1183.8203" y2="1183.8203"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="111.6045" x="104.7729" y="1178.7544">400 Bad Request</text></g><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1872.4746" x="5" y="1219.3867"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1877.4746" y1="1219.3867" y2="1219.3867"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1877.4746" y1="1222.3867" y2="1222.3867"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="156.5303" x="862.9722" y="1208.8203"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="138.0044" x="868.9722" y="1224.8872">3. SM(C)-B Binding</text><g class="message" data-participant-1="Client" data-participant-2="AuthS"><polygon fill="#000000" points="848.6846,1259.0859,858.6846,1263.0859,848.6846,1267.0859,852.6846,1263.0859" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="87.7729" x2="854.6846" y1="1263.0859" y2="1263.0859"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="293.2871" x="94.7729" y="1258.02">POST /bind-smcb (oder spezifischer Request)</text></g><path d="M92,1276.0859 L92,1460.0859 L621,1460.0859 L621,1286.0859 L611,1276.0859 L92,1276.0859" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><path d="M611,1276.0859 L611,1286.0859 L621,1286.0859 L611,1276.0859" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="125.8232" x="98" y="1293.1528">Binding Request:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="58.4873" x="98" y="1308.2856">Headers:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="356.6177" x="106.2646" y="1323.4185">Authorization: &lt;Calculated based on Client Assertion&gt;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="37.1973" x="98" y="1338.5513">Body:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="500.6841" x="106.2646" y="1353.6841">client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="412.9341" x="106.2646" y="1368.8169">client_assertion=&lt;JWT signed by Client_Instance_Private_Key&gt;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="321.9087" x="106.2646" y="1383.9497">smcb_certificate=&lt;Base64(SM(C)-B Certificate)&gt;</text><line style="stroke:#000000;stroke-width:1;" x1="93" x2="620.9487" y1="1387.0156" y2="1387.0156"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="207.689" x="98" y="1403.0825">Client Assertion JWT Claims:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="281.7915" x="98" y="1418.2153">{ "iss": "&lt;client_id&gt;", "sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="390.9839" x="106.2646" y="1433.3481">"aud": "&lt;AS_Binding_Endpoint_URL&gt;", "jti": "...", "exp": ... }</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="235.187" x="106.2646" y="1448.481">(sig by Client_Instance_Private_Key)</text><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="912.6846" y1="1486.6797" y2="1486.6797"/><line style="stroke:#000000;stroke-width:1;" x1="912.6846" x2="912.6846" y1="1486.6797" y2="1499.6797"/><line style="stroke:#000000;stroke-width:1;" x1="871.6846" x2="912.6846" y1="1499.6797" y2="1499.6797"/><polygon fill="#000000" points="881.6846,1495.6797,871.6846,1499.6797,881.6846,1503.6797,877.6846,1499.6797" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="242.4424" x="877.6846" y="1481.6138">Validate client_assertion (sig, claims)</text></g><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="912.6846" y1="1528.8125" y2="1528.8125"/><line style="stroke:#000000;stroke-width:1;" x1="912.6846" x2="912.6846" y1="1528.8125" y2="1541.8125"/><line style="stroke:#000000;stroke-width:1;" x1="871.6846" x2="912.6846" y1="1541.8125" y2="1541.8125"/><polygon fill="#000000" points="881.6846,1537.8125,871.6846,1541.8125,881.6846,1545.8125,877.6846,1541.8125" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="185.1802" x="877.6846" y="1523.7466">Generate Nonce (Challenge)</text></g><g class="message" data-participant-1="AuthS" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="1570.9453" y2="1566.9453"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="1570.9453" y2="1574.9453"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="87.7729" x2="864.6846" y1="1570.9453" y2="1570.9453"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="310.2227" x="104.7729" y="1565.8794">200 OK (or 201 Created for challenge resource)</text></g><path d="M870,1583.9453 L870,1668.9453 L1159,1668.9453 L1159,1593.9453 L1149,1583.9453 L870,1583.9453" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><path d="M1149,1583.9453 L1149,1593.9453 L1159,1593.9453 L1149,1583.9453" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="153.0103" x="876" y="1601.0122">Challenge Response:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="876" y="1616.145">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="259.9175" x="884.2646" y="1631.2778">"challenge": "&lt;random_nonce_value&gt;",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="111.3062" x="884.2646" y="1646.4106">"expires_in": 300</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="876" y="1661.5435">}</text><g class="message" data-participant-1="Client" data-participant-2="SMCB"><polygon fill="#000000" points="682.8169,1691.7422,692.8169,1695.7422,682.8169,1699.7422,686.8169,1695.7422" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="87.7729" x2="688.8169" y1="1695.7422" y2="1695.7422"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="263.6563" x="94.7729" y="1690.6763">Sign Challenge with SM(C)-B Private Key</text></g><g class="message" data-participant-1="SMCB" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="1724.875" y2="1720.875"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="1724.875" y2="1728.875"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="87.7729" x2="698.8169" y1="1724.875" y2="1724.875"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="111.084" x="104.7729" y="1719.8091">Return Signature</text></g><g class="message" data-participant-1="Client" data-participant-2="AuthS"><polygon fill="#000000" points="848.6846,1750.0078,858.6846,1754.0078,848.6846,1758.0078,852.6846,1754.0078" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="87.7729" x2="854.6846" y1="1754.0078" y2="1754.0078"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="334.585" x="94.7729" y="1748.9419">POST /bind-smcb/verify (oder spezifischer Request)</text></g><path d="M92,1767.0078 L92,1966.0078 L621,1966.0078 L621,1777.0078 L611,1767.0078 L92,1767.0078" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><path d="M611,1767.0078 L611,1777.0078 L621,1777.0078 L611,1767.0078" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="155.0732" x="98" y="1784.0747">Verification Request:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="58.4873" x="98" y="1799.2075">Headers:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="356.6177" x="106.2646" y="1814.3403">Authorization: &lt;Calculated based on Client Assertion&gt;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="37.1973" x="98" y="1829.4731">Body:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="500.6841" x="106.2646" y="1844.606">client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="412.9341" x="106.2646" y="1859.7388">client_assertion=&lt;JWT signed by Client_Instance_Private_Key&gt;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="246.2065" x="106.2646" y="1874.8716">challenge="&lt;random_nonce_value&gt;"</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="347.9785" x="106.2646" y="1890.0044">smcb_signature=&lt;Base64(Signature from SM(C)-B)&gt;</text><line style="stroke:#000000;stroke-width:1;" x1="93" x2="620.9487" y1="1893.0703" y2="1893.0703"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="207.689" x="98" y="1909.1372">Client Assertion JWT Claims:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="281.7915" x="98" y="1924.27">{ "iss": "&lt;client_id&gt;", "sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="471.5356" x="106.2646" y="1939.4028">"aud": "&lt;AS_Binding_Verification_Endpoint_URL&gt;", "jti": "...", "exp": ... }</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="235.187" x="106.2646" y="1954.5356">(sig by Client_Instance_Private_Key)</text><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="912.6846" y1="1992.7344" y2="1992.7344"/><line style="stroke:#000000;stroke-width:1;" x1="912.6846" x2="912.6846" y1="1992.7344" y2="2005.7344"/><line style="stroke:#000000;stroke-width:1;" x1="871.6846" x2="912.6846" y1="2005.7344" y2="2005.7344"/><polygon fill="#000000" points="881.6846,2001.7344,871.6846,2005.7344,881.6846,2009.7344,877.6846,2005.7344" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="242.4424" x="877.6846" y="1987.6685">Validate client_assertion (sig, claims)</text></g><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="912.6846" y1="2034.8672" y2="2034.8672"/><line style="stroke:#000000;stroke-width:1;" x1="912.6846" x2="912.6846" y1="2034.8672" y2="2047.8672"/><line style="stroke:#000000;stroke-width:1;" x1="871.6846" x2="912.6846" y1="2047.8672" y2="2047.8672"/><polygon fill="#000000" points="881.6846,2043.8672,871.6846,2047.8672,881.6846,2051.8672,877.6846,2047.8672" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="404.4917" x="877.6846" y="2029.8013">Retrieve previously submitted SM(C)-B Certificate for client_id</text></g><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="912.6846" y1="2077" y2="2077"/><line style="stroke:#000000;stroke-width:1;" x1="912.6846" x2="912.6846" y1="2077" y2="2090"/><line style="stroke:#000000;stroke-width:1;" x1="871.6846" x2="912.6846" y1="2090" y2="2090"/><polygon fill="#000000" points="881.6846,2086,871.6846,2090,881.6846,2094,877.6846,2090" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="420.5449" x="877.6846" y="2071.9341">Verify smcb_signature against challenge and SM(C)-B Public Key</text></g><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="912.6846" y1="2119.1328" y2="2119.1328"/><line style="stroke:#000000;stroke-width:1;" x1="912.6846" x2="912.6846" y1="2119.1328" y2="2132.1328"/><line style="stroke:#000000;stroke-width:1;" x1="871.6846" x2="912.6846" y1="2132.1328" y2="2132.1328"/><polygon fill="#000000" points="881.6846,2128.1328,871.6846,2132.1328,881.6846,2136.1328,877.6846,2132.1328" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="351.3809" x="877.6846" y="2114.0669">Validate SM(C)-B Certificate Chain (Trust, Revocation)</text></g><path d="M15,2147.1328 L79.4429,2147.1328 L79.4429,2154.2656 L69.4429,2164.2656 L15,2164.2656 L15,2147.1328" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="263.1328" style="stroke:#000000;stroke-width:1;" width="1354.9902" x="15" y="2147.1328"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="30" y="2160.1997">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="255.7983" x="94.4429" y="2159.3433">[SM(C)-B Signature and Certificate Valid]</text><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="912.6846" y1="2185.3984" y2="2185.3984"/><line style="stroke:#000000;stroke-width:1;" x1="912.6846" x2="912.6846" y1="2185.3984" y2="2198.3984"/><line style="stroke:#000000;stroke-width:1;" x1="871.6846" x2="912.6846" y1="2198.3984" y2="2198.3984"/><polygon fill="#000000" points="881.6846,2194.3984,871.6846,2198.3984,881.6846,2202.3984,877.6846,2198.3984" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="392.52" x="877.6846" y="2180.3325">Associate SM(C)-B Identity (e.g., Telematik-ID) with client_id</text></g><g class="message" data-participant-1="AuthS" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="2227.5313" y2="2223.5313"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="2227.5313" y2="2231.5313"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="87.7729" x2="864.6846" y1="2227.5313" y2="2227.5313"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="162.8047" x="104.7729" y="2222.4653">200 OK / 204 No Content</text></g><path d="M870,2240.5313 L870,2265.5313 L1159,2265.5313 L1159,2250.5313 L1149,2240.5313 L870,2240.5313" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><path d="M1149,2240.5313 L1149,2250.5313 L1159,2250.5313 L1149,2240.5313" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="138.6582" x="876" y="2257.5981">Success Response:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="126.0518" x="1018.7905" y="2257.5981">(Binding Complete)</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="15" x2="1369.9902" y1="2271.6641" y2="2271.6641"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="177.5576" x="20" y="2281.8745">[SM(C)-B Verification Failed]</text><g class="message" data-participant-1="AuthS" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="2306.6016" y2="2302.6016"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="2306.6016" y2="2310.6016"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="87.7729" x2="864.6846" y1="2306.6016" y2="2306.6016"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="240.4746" x="104.7729" y="2301.5356">400 Bad Request / 401 Unauthorized</text></g><path d="M870,2319.6016 L870,2404.6016 L1359,2404.6016 L1359,2329.6016 L1349,2319.6016 L870,2319.6016" fill="#FFC0CB" style="stroke:#000000;stroke-width:1;"/><path d="M1349,2319.6016 L1349,2329.6016 L1359,2329.6016 L1349,2319.6016" fill="#FFC0CB" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="117.3809" x="876" y="2336.6685">Error Response:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="876" y="2351.8013">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="325.0952" x="884.2646" y="2366.9341">"error": "invalid_grant", // Or a more specific error</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="460.7256" x="884.2646" y="2382.0669">"error_description": "SM(C)-B signature or certificate validation failed."</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="876" y="2397.1997">}</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1872.4746" x="5" y="2437.832"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1877.4746" y1="2437.832" y2="2437.832"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1877.4746" y1="2440.832" y2="2440.832"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="303.7388" x="789.3679" y="2427.2656"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="285.2129" x="795.3679" y="2443.3325">4. Token Acquisition (Token Exchange)</text><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="87.7729" x2="129.7729" y1="2561.2617" y2="2561.2617"/><line style="stroke:#000000;stroke-width:1;" x1="129.7729" x2="129.7729" y1="2561.2617" y2="2574.2617"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="129.7729" y1="2574.2617" y2="2574.2617"/><polygon fill="#000000" points="98.7729,2570.2617,88.7729,2574.2617,98.7729,2578.2617,94.7729,2574.2617" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="243.4326" x="94.7729" y="2556.1958">Create "SM(C)-B Access Token" (JWT)</text></g><path d="M359.4326,2465.3984 L359.4326,2656.3984 L819.4326,2656.3984 L819.4326,2475.3984 L809.4326,2465.3984 L359.4326,2465.3984" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><path d="M809.4326,2465.3984 L809.4326,2475.3984 L819.4326,2475.3984 L809.4326,2465.3984" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="220.5938" x="365.4326" y="2482.4653">SM(C)-B Access Token Claims:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="365.4326" y="2497.5981">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="265.3828" x="373.6973" y="2512.731">"iss": "&lt;client_id&gt;", // Issuer is the client</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="430.9741" x="373.6973" y="2527.8638">"sub": "&lt;Telematik-ID from SM(C)-B&gt;", // Subject is the institution</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="381.4243" x="373.6973" y="2542.9966">"aud": "&lt;AS_Token_Endpoint_URL&gt;", // Audience is the AS</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="148.7129" x="373.6973" y="2558.1294">"exp": ..., // Short-lived</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="53.6758" x="373.6973" y="2573.2622">"iat": ...,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="61.2803" x="373.6973" y="2588.395">"jti": "...",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="345.4268" x="373.6973" y="2603.5278">"nonce": "&lt;Challenge from DCR&gt;", // Binding to DCR</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="369.6494" x="373.6973" y="2618.6606">"scope": ... // As required for the Resource Server access</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="365.4326" y="2633.7935">}</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="188.0557" x="365.4326" y="2648.9263">(sig by SM(C)-B_Private_Key)</text><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="87.7729" x2="129.7729" y1="2683.125" y2="2683.125"/><line style="stroke:#000000;stroke-width:1;" x1="129.7729" x2="129.7729" y1="2683.125" y2="2696.125"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="129.7729" y1="2696.125" y2="2696.125"/><polygon fill="#000000" points="98.7729,2692.125,88.7729,2696.125,98.7729,2700.125,94.7729,2696.125" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="282.3247" x="94.7729" y="2678.0591">Create DPoP Key Pair (for Token Exchange)</text></g><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="87.7729" x2="129.7729" y1="2850.3867" y2="2850.3867"/><line style="stroke:#000000;stroke-width:1;" x1="129.7729" x2="129.7729" y1="2850.3867" y2="2863.3867"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="129.7729" y1="2863.3867" y2="2863.3867"/><polygon fill="#000000" points="98.7729,2859.3867,88.7729,2863.3867,98.7729,2867.3867,94.7729,2863.3867" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="281.4995" x="94.7729" y="2845.3208">Create DPoP Proof JWT for Token Exchange</text></g><path d="M397.4995,2709.125 L397.4995,2991.125 L752.4995,2991.125 L752.4995,2719.125 L742.4995,2709.125 L397.4995,2709.125" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><path d="M742.4995,2709.125 L742.4995,2719.125 L752.4995,2719.125 L742.4995,2709.125" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="334.915" x="403.4995" y="2726.1919">DPoP Proof JWT Claims (for Token Exchange):</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="403.4995" y="2741.3247">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="120.5483" x="411.7642" y="2756.4575">"typ": "dpop+jwt",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="97.6714" x="411.7642" y="2771.5903">"alg": "ES256",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="50.5146" x="411.7642" y="2786.7231">"jwk": {</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="74.1724" x="420.0288" y="2801.856">"kty": "EC",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="56.6528" x="420.0288" y="2816.9888">"x": "...",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="56.6528" x="420.0288" y="2832.1216">"y": "...",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="89.959" x="420.0288" y="2847.2544">"crv": "P-256"</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="411.7642" y="2862.3872">}</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="12.4033" x="403.4995" y="2877.52">}.</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="403.4995" y="2892.6528">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="61.2803" x="411.7642" y="2907.7856">"jti": "...",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="96.8271" x="411.7642" y="2922.9185">"htm": "POST",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="239.8779" x="411.7642" y="2938.0513">"htu": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="49.5435" x="411.7642" y="2953.1841">"iat": ...</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="12.4033" x="403.4995" y="2968.3169">}.</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169.3999" x="403.4995" y="2983.4497">(sig by DPoP_Private_Key)</text><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="87.7729" x2="129.7729" y1="3089.8125" y2="3089.8125"/><line style="stroke:#000000;stroke-width:1;" x1="129.7729" x2="129.7729" y1="3089.8125" y2="3102.8125"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="129.7729" y1="3102.8125" y2="3102.8125"/><polygon fill="#000000" points="98.7729,3098.8125,88.7729,3102.8125,98.7729,3106.8125,94.7729,3102.8125" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="379.2598" x="94.7729" y="3084.7466">Create Client Assertion JWT for Token Exchange (for Auth)</text></g><path d="M495.2598,3001.5156 L495.2598,3177.5156 L916.2598,3177.5156 L916.2598,3011.5156 L906.2598,3001.5156 L495.2598,3001.5156" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><path d="M906.2598,3001.5156 L906.2598,3011.5156 L916.2598,3011.5156 L906.2598,3001.5156" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="284.4067" x="501.2598" y="3018.5825">Client Assertion JWT Claims (for Auth):</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="501.2598" y="3033.7153">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="129.5747" x="509.5244" y="3048.8481">"iss": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="135.6812" x="509.5244" y="3063.981">"sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="242.7598" x="509.5244" y="3079.1138">"aud": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="148.7129" x="509.5244" y="3094.2466">"exp": ..., // Short-lived</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="61.2803" x="509.5244" y="3109.3794">"jti": "...",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="203.9375" x="509.5244" y="3124.5122">// Include DPoP public key hash</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="392.2598" x="509.5244" y="3139.645">"cnf": { "jkt": "&lt;Base64URL(SHA256(DPoP_Public_JWK))&gt;" }</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="501.2598" y="3154.7778">}</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="235.187" x="501.2598" y="3169.9106">(sig by Client_Instance_Private_Key)</text><g class="message" data-participant-1="Client" data-participant-2="AuthS"><polygon fill="#000000" points="848.6846,3200.1094,858.6846,3204.1094,848.6846,3208.1094,852.6846,3204.1094" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="87.7729" x2="854.6846" y1="3204.1094" y2="3204.1094"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="156.6729" x="94.7729" y="3199.0435">POST /token (RFC 8693)</text></g><path d="M92,3217.1094 L92,3348.1094 L632,3348.1094 L632,3227.1094 L622,3217.1094 L92,3217.1094" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><path d="M622,3217.1094 L622,3227.1094 L632,3227.1094 L622,3217.1094" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="230.4453" x="98" y="3234.1763">Token Exchange Request Body:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="406.4722" x="106.2646" y="3249.3091">grant_type=urn:ietf:params:oauth:grant-type:token-exchange</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="298.8921" x="106.2646" y="3264.4419">&amp;subject_token=&lt;SM(C)-B_Assertion_Token&gt;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="472.9702" x="106.2646" y="3279.5747">&amp;subject_token_type=urn:ietf:params:oauth:token-type:jwt // Or custom</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="510.8213" x="106.2646" y="3294.7075">&amp;client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="342.0688" x="106.2646" y="3309.8403">&amp;client_assertion=&lt;Client_Assertion_JWT_for_Auth&gt;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="296.8228" x="106.2646" y="3324.9731">&amp;resource=&lt;Optional: Target Resource URI&gt;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="272.854" x="106.2646" y="3340.106">&amp;audience=&lt;Optional: Target Audience&gt;</text><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="912.6846" y1="3374.3047" y2="3374.3047"/><line style="stroke:#000000;stroke-width:1;" x1="912.6846" x2="912.6846" y1="3374.3047" y2="3387.3047"/><line style="stroke:#000000;stroke-width:1;" x1="871.6846" x2="912.6846" y1="3387.3047" y2="3387.3047"/><polygon fill="#000000" points="881.6846,3383.3047,871.6846,3387.3047,881.6846,3391.3047,877.6846,3387.3047" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="388.9463" x="877.6846" y="3369.2388">Validate client_assertion (sig by Client_Instance_PK, claims)</text></g><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="912.6846" y1="3416.4375" y2="3416.4375"/><line style="stroke:#000000;stroke-width:1;" x1="912.6846" x2="912.6846" y1="3416.4375" y2="3429.4375"/><line style="stroke:#000000;stroke-width:1;" x1="871.6846" x2="912.6846" y1="3429.4375" y2="3429.4375"/><polygon fill="#000000" points="881.6846,3425.4375,871.6846,3429.4375,881.6846,3433.4375,877.6846,3429.4375" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="330.2876" x="877.6846" y="3411.3716">Validate subject_token (sig by SM(C)-B_PK, claims)</text></g><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="912.6846" y1="3458.5703" y2="3458.5703"/><line style="stroke:#000000;stroke-width:1;" x1="912.6846" x2="912.6846" y1="3458.5703" y2="3471.5703"/><line style="stroke:#000000;stroke-width:1;" x1="871.6846" x2="912.6846" y1="3471.5703" y2="3471.5703"/><polygon fill="#000000" points="881.6846,3467.5703,871.6846,3471.5703,881.6846,3475.5703,877.6846,3471.5703" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="510.1357" x="877.6846" y="3453.5044">Check if client_id is bound to the SM(C)-B identity (sub claim in subject_token)</text></g><path d="M15,3486.5703 L79.4429,3486.5703 L79.4429,3493.7031 L69.4429,3503.7031 L15,3503.7031 L15,3486.5703" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="369.0625" style="stroke:#000000;stroke-width:1;" width="1257.2046" x="15" y="3486.5703"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="30" y="3499.6372">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="149.3594" x="94.4429" y="3498.7808">[Validations Successful]</text><g class="message" data-participant-1="AuthS" data-participant-2="AuthS"><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="912.6846" y1="3524.8359" y2="3524.8359"/><line style="stroke:#000000;stroke-width:1;" x1="912.6846" x2="912.6846" y1="3524.8359" y2="3537.8359"/><line style="stroke:#000000;stroke-width:1;" x1="871.6846" x2="912.6846" y1="3537.8359" y2="3537.8359"/><polygon fill="#000000" points="881.6846,3533.8359,871.6846,3537.8359,881.6846,3541.8359,877.6846,3537.8359" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="363.4858" x="877.6846" y="3519.77">Generate AS Access Token (AT) and Refresh Token (RT)</text></g><g class="message" data-participant-1="AuthS" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="3566.9688" y2="3562.9688"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="3566.9688" y2="3570.9688"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="87.7729" x2="864.6846" y1="3566.9688" y2="3566.9688"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="47.7026" x="104.7729" y="3561.9028">200 OK</text></g><path d="M870,3579.9688 L870,3710.9688 L1234,3710.9688 L1234,3589.9688 L1224,3579.9688 L870,3579.9688" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><path d="M1224,3579.9688 L1224,3589.9688 L1234,3589.9688 L1224,3579.9688" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="165.9976" x="876" y="3597.0356">Token Response Body:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="876" y="3612.1685">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="260.0063" x="884.2646" y="3627.3013">"access_token": "&lt;AS_Access_Token&gt;",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="323.1973" x="884.2646" y="3642.4341">"token_type": "DPoP", // Indicate DPoP is required</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="123.7095" x="884.2646" y="3657.5669">"expires_in": 3600,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="335.5625" x="884.2646" y="3672.6997">"refresh_token": "&lt;AS_Refresh_Token&gt;" // Optional</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="143.5903" x="884.2646" y="3687.8325">// ... other parameters</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="876" y="3702.9653">}</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="15" x2="1272.2046" y1="3717.0313" y2="3717.0313"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="114.8877" x="20" y="3727.2417">[Validation Failed]</text><g class="message" data-participant-1="AuthS" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="3751.9688" y2="3747.9688"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="3751.9688" y2="3755.9688"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="87.7729" x2="864.6846" y1="3751.9688" y2="3751.9688"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="111.6045" x="104.7729" y="3746.9028">400 Bad Request</text></g><path d="M870,3764.9688 L870,3849.9688 L1262,3849.9688 L1262,3774.9688 L1252,3764.9688 L870,3764.9688" fill="#FFC0CB" style="stroke:#000000;stroke-width:1;"/><path d="M1252,3764.9688 L1252,3774.9688 L1262,3774.9688 L1252,3764.9688" fill="#FFC0CB" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="117.3809" x="876" y="3782.0356">Error Response:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="876" y="3797.1685">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="286.8188" x="884.2646" y="3812.3013">"error": "invalid_grant", // Or "invalid_client"</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="362.9399" x="884.2646" y="3827.4341">"error_description": "Token exchange validation failed."</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="876" y="3842.5669">}</text><rect fill="#FFFFFF" height="3" style="stroke:#FFFFFF;stroke-width:1;" width="1872.4746" x="5" y="3883.1992"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1877.4746" y1="3883.1992" y2="3883.1992"/><line style="stroke:#000000;stroke-width:0.5;" x1="5" x2="1877.4746" y1="3886.1992" y2="3886.1992"/><rect fill="#FFFFFF" height="23.1328" style="stroke:#000000;stroke-width:1;" width="246.8511" x="817.8118" y="3872.6328"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="228.3252" x="823.8118" y="3888.6997">5. Resource Access using DPoP</text><g class="message" data-participant-1="Client" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="87.7729" x2="129.7729" y1="3991.4961" y2="3991.4961"/><line style="stroke:#000000;stroke-width:1;" x1="129.7729" x2="129.7729" y1="3991.4961" y2="4004.4961"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="129.7729" y1="4004.4961" y2="4004.4961"/><polygon fill="#000000" points="98.7729,4000.4961,88.7729,4004.4961,98.7729,4008.4961,94.7729,4004.4961" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="147.8179" x="94.7729" y="3986.4302">Create DPoP Proof JWT</text></g><path d="M263.8179,3910.7656 L263.8179,4071.7656 L709.8179,4071.7656 L709.8179,3920.7656 L699.8179,3910.7656 L263.8179,3910.7656" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><path d="M699.8179,3910.7656 L699.8179,3920.7656 L709.8179,3920.7656 L699.8179,3910.7656" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="178.0581" x="269.8179" y="3927.8325">DPoP Proof JWT Header:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="425.877" x="269.8179" y="3942.9653">{ "typ": "dpop+jwt", "alg": "ES256", "jwk": &lt;DPoP_Public_JWK&gt; }</text><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="183.2949" x="269.8179" y="3958.0981">DPoP Proof JWT Payload:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="269.8179" y="3973.231">{</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="154.2036" x="278.0825" y="3988.3638">"jti": "...", "htm": "GET",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="221.8315" x="278.0825" y="4003.4966">"htu": "&lt;Resource_Server_URL&gt;",</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="53.6758" x="278.0825" y="4018.6294">"iat": ...,</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="336.064" x="278.0825" y="4033.7622">"ath": "&lt;Base64URL(SHA256(AS_Access_Token))&gt;"</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="8.271" x="269.8179" y="4048.895">}</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="169.3999" x="269.8179" y="4064.0278">(sig by DPoP_Private_Key)</text><g class="message" data-participant-1="Client" data-participant-2="RS"><polygon fill="#000000" points="1392.8203,4094.2266,1402.8203,4098.2266,1392.8203,4102.2266,1396.8203,4098.2266" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="87.7729" x2="1398.8203" y1="4098.2266" y2="4098.2266"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="91.5396" x="94.7729" y="4093.1606">GET /resource</text></g><path d="M92,4111.2266 L92,4166.2266 L382,4166.2266 L382,4121.2266 L372,4111.2266 L92,4111.2266" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><path d="M372,4111.2266 L372,4121.2266 L382,4121.2266 L372,4111.2266" fill="#ADD8E6" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="159.5737" x="98" y="4128.2935">API Request Headers:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="269.6802" x="98" y="4143.4263">Authorization: DPoP &lt;AS_Access_Token&gt;</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="168.8794" x="98" y="4158.5591">DPoP: &lt;DPoP_Proof_JWT&gt;</text><g class="message" data-participant-1="RS" data-participant-2="AuthS"><polygon fill="#000000" points="876.6846,4188.7578,866.6846,4192.7578,876.6846,4196.7578,872.6846,4192.7578" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="870.6846" x2="1403.8203" y1="4192.7578" y2="4192.7578"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="236.5454" x="882.6846" y="4187.6919">(Optional) Introspect/Validate Token</text></g><g class="message" data-participant-1="AuthS" data-participant-2="RS"><polygon fill="#000000" points="1392.8203,4217.8906,1402.8203,4221.8906,1392.8203,4225.8906,1396.8203,4221.8906" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="865.6846" x2="1398.8203" y1="4221.8906" y2="4221.8906"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="311.0986" x="872.6846" y="4216.8247">Token Information (valid, active, claims, cnf.jkt)</text></g><g class="message" data-participant-1="RS" data-participant-2="RS"><line style="stroke:#000000;stroke-width:1;" x1="1414.8203" x2="1456.8203" y1="4251.0234" y2="4251.0234"/><line style="stroke:#000000;stroke-width:1;" x1="1456.8203" x2="1456.8203" y1="4251.0234" y2="4264.0234"/><line style="stroke:#000000;stroke-width:1;" x1="1415.8203" x2="1456.8203" y1="4264.0234" y2="4264.0234"/><polygon fill="#000000" points="1425.8203,4260.0234,1415.8203,4264.0234,1425.8203,4268.0234,1421.8203,4264.0234" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="128.9717" x="1421.8203" y="4245.9575">Validate DPoP Proof</text></g><path d="M15,4279.0234 L79.4429,4279.0234 L79.4429,4286.1563 L69.4429,4296.1563 L15,4296.1563 L15,4279.0234" fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="232.8672" style="stroke:#000000;stroke-width:1;" width="1852.4746" x="15" y="4279.0234"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="30" y="4292.0903">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="183.7183" x="94.4429" y="4291.2339">[DPoP Proof and Token Valid]</text><g class="message" data-participant-1="RS" data-participant-2="RS"><line style="stroke:#000000;stroke-width:1;" x1="1414.8203" x2="1456.8203" y1="4317.2891" y2="4317.2891"/><line style="stroke:#000000;stroke-width:1;" x1="1456.8203" x2="1456.8203" y1="4317.2891" y2="4330.2891"/><line style="stroke:#000000;stroke-width:1;" x1="1415.8203" x2="1456.8203" y1="4330.2891" y2="4330.2891"/><polygon fill="#000000" points="1425.8203,4326.2891,1415.8203,4330.2891,1425.8203,4334.2891,1421.8203,4330.2891" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="224.9673" x="1421.8203" y="4312.2231">Process Request, Access Resource</text></g><g class="message" data-participant-1="RS" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="4359.4219" y2="4355.4219"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="4359.4219" y2="4363.4219"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="87.7729" x2="1408.8203" y1="4359.4219" y2="4359.4219"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="47.7026" x="104.7729" y="4354.356">200 OK</text></g><path d="M1414,4372.4219 L1414,4412.4219 L1588,4412.4219 L1588,4382.4219 L1578,4372.4219 L1414,4372.4219" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><path d="M1578,4372.4219 L1578,4382.4219 L1588,4382.4219 L1578,4372.4219" fill="#90EE90" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="145.9072" x="1420" y="4389.4888">API Response Body:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="153.5244" x="1420" y="4404.6216">{ ... Resource Data ... }</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="15" x2="1867.4746" y1="4418.6875" y2="4418.6875"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="184.1533" x="20" y="4428.8979">[DPoP Proof or Token Invalid]</text><g class="message" data-participant-1="RS" data-participant-2="Client"><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="4453.625" y2="4449.625"/><line style="stroke:#000000;stroke-width:1;" x1="88.7729" x2="98.7729" y1="4453.625" y2="4457.625"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="87.7729" x2="1408.8203" y1="4453.625" y2="4453.625"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="116.2256" x="104.7729" y="4448.5591">401 Unauthorized</text></g><path d="M1414,4466.625 L1414,4506.625 L1857,4506.625 L1857,4476.625 L1847,4466.625 L1414,4466.625" fill="#FFC0CB" style="stroke:#000000;stroke-width:1;"/><path d="M1847,4466.625 L1847,4476.625 L1857,4476.625 L1847,4466.625" fill="#FFC0CB" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="182.6475" x="1420" y="4483.6919">Error Response Headers:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="422.4746" x="1420" y="4498.8247">WWW-Authenticate: DPoP error="invalid_token" / "invalid_proof"</text><!--SRC=[vLfjRzl84VwkNx5bWQkKIBBpsfvW6P1bv-BaqWYI4WDj3WH5hgIrAPAt99KeX_ptczatBbyasJbSYwBv42Vaxkpip3FFlD1_oTPqGqaIUYngPImBAVdNrNn4nY6ZKKQcTCNIZ3FAysX5yYWWennsH1bRig_gQNi-UKSUazcxzhZJku1_NKxYIQVLIZoUCPyb7iXnBA4EyLBrprRWPTx2Iobnr84WIxo7dzPBBNliyK2ydhqRNvGFGBrYphvw6OiZCgDyIpbfZsOTiHxVpieRfZIDS-vJitQgravdhTPmI9xqoLkw8p_HY78fT3XiAIrxvzf0Zn-JWLv3zSFhACsy24IZW8d7GFWovlejwj9fHJ6ivsorpWR5CboLSBO5MUuTtRctdpFoAMhxSHu6984TO7Wl37TaGT52lONdtz6WInPvHW9m58lyZ2nvl26ZBAEWXD0Rn7SipM7ZWCpXw1NSshfUlCHNrPr2iMPjL-hQ0KcfdtCAUh48PVG_HHDv2mAt845CKm8II4YzhL2ytyAJUiQC0m1QblEeTFWaNuJC5yUTa37bY3bVM7cDOAswmd830h1Y-z7aclXWkhHi-Qi4uS-zaC2QbAOf7Dn3p0LbfmY94nx7oxGlqF6qJovtaRS11SkX8dLlNuwd7VAPPUkQJKie4g6349hINtDOKbevWv-W7Qn45MpvhRyH-nRs9e10c0Sq7NoAUZLVfcmLUM1eYYylwPO1HbaWmvdo59zUnE0et4Exv2Fb-2Am7kAIzpDyWwRgWeKoVqr-fbiQYWEJX5nVTiLFimR_CzCdazTUkjRkDs7Kwv5631GcQDF-gj-juq0Q-UeBn0QUHYw1D81y2XEBq9T6dhoVpSa95uOK4VzgJFx-uiSdDYOm3DJcluRuO17cj4NWpwD7u5JZg8ius0qUFH9lVXD_4-9m6Z1E_SpDEKkT0Vctq-_tdL-w-hql1Bk06mflnKlpBellQEJIA4XY1ciyKDlTK22r09TMMA7OjkB0PcwsIwWy42muO3HR3e3il4qwY57GGApguQg1EAT7l_XhBrfHfmjABpbDrwvuOIbx-_aEHVv673XK22TdqZAk9ZXNngWBs7BVtBmz9x-GRth_2GHjdcR0HK8JYXP777k5UmVwA5HwHJVmyAwijpHOpzgZBf5idg9kIW3AiDQuc3dGQcSN4CeldxUhCMXWrJatbgpA05r18PG2XvKqGFlhJTzQyc_mcmZ9LalYpG1lG3vw8GiGhtkrA57IU4tzko9IYRS2b0FWCWxMX5W44ifIO5Y0FFU0xWCHnYVlPoSOPoWxnzSYTdSr1aXud608KU0nBopppHOL5VUftS5GgqBmldMpBEPw4G6VU-Y9hY2bVbDsR91Y7VRF69Ur8Sx3a09OEmYg6QJvh1UoBTZ2ogfPR2gG2nO5B5hPigjKy_Jq2HbpYibBB2l7lzmamt_5AOqCH3G7f4aSGM5Yau1D17QmCn6_PoPPzXIcML32dhNUPMcQqy0Lw0EEQ5hLH25_W4R-N2efqybH4ldM5UGHHql6D-18eXaRF7wdC6Cu1Wn0OYX9kRrA8yy-drlvq_Ly7vAzqbER4SMzJ_0zr0C8BHzLWB8tmV1DzmfJBW7E_nvHlaQtW0aODuWtReJ8To4WSthkeB1NXv1E0ZWRVipnEf0BfJ_C8PAZ34FH491RBXbgaL-Db-Udf-J22tJs4tG7z25AeMVzcZwb6gUMW1UmgfTk_0Lfnm4uBateLyZfgOzUL2VSDoNh4zKs7OolgGUIKvrWIit1013eXNuUYj9L5djW1LsTfodoOnoTYxqYmfKKvMTFhn2XCcoE4fsuz5ePC11olGNrEELxH0xFtjpC1VcZQZjI2nKLln0hvqe46jBrYx9eg9EUQPgATnsvgTVhAVDLBqtm-34qWt0HNTmG1_X8WDCm530NST9yKNkg4xgNIzORpLpb8VTAKzA7wSzY_srcnOj3loIIxHHS2Mc36OxOe7Ell5irif3SXSTupKvhVxAhvP_MtdHoIjw_1JXpExF8mDURWPzamrc5TdEs0T-OdJhVrEhDuznXF0BsXT8qTHdotRFJqrhTKWGiDjSoNh5g9uKUejJMiD8T7cPniMDVFMzA_zQzIE5aAokNFyuDidtn9Sdz_nA40Scm6I8sZvYois0HKuYAkOBo_d-JI6ot_W-n2aG3Pz0dGmaE5NkSfo7qu_bYmp94MGDPI_emzNPT4nadPR-PTg7W7N1v4RHcfdBWPaswo5wxFSScf0jtsSRI0HtHHUWT1LZmK7l_n_sz1M0czfbzyBKOIMGxtVJFQIYRmzxrfPggDFOXUsZv1Fxn7CWSIqeSeJsmuf_bebYqMPYqTTqnZZT92Brjfw76qjSfyT0hZuNq8RKMgFySSig7o5CSTQXbILXqPwb-nRcO79NJHwrJeRWCeqPLWgweyLKL2nqxsM1N1rJiups8M5xRxmOqzJaJHI_AqhSle8bmjY2nbNX3eoo5KVhEtfBLAZUVzrMTE_9_pLdAPEoLIzzEuwnse19peTj8UbPiTaWREAkKMsePfMbVbUKqSpLo7HZq6fixJbXAe6jHEDPxD1FQW2_nhf8nonUt57f_9GG3dcMvc0pMULDeMIDAa3BA0pWSHu1Ip6Xc5GkgzQnqtEPorTwqnBlwcKWpGesYXX2tWIPQwQ3Z29eQU6ZiuCS9LSIDYgPGF86pkQgfKDdg-5vsTAq2F9hebUNs4Vn-b3HCaIiegunXPqVcnmjvr_wnCyMSMIJG-fa7uLdPBO7Pg7aDhL1zeAC08ydZqdpH2rVuuchszCLBnvuDbiPlpbss4yl6raZ1-LAVK3YxXcS-t-BJIG_FQ9K6Q_socaqeMsSRiHlAIFjXVX3_DI3Rnsdee3qVZfl6KgZk0_LTel8ngExK0vML9U9Uz5EbcIC5rq737QM81bSX-ydF4nBeYQn6y1lH6hyAQ3X4IpbtlhtBh2akdD-UlHu1HjhICN9izERcRQTpxfX9x7SKUGVQ4Z4XabyA_l7onsVtRJqghcxwQ418CMyRFd3KfWJyaCey8ETOmpDDTGOhqeNdZSiF7InFqns9AWDyCStNilw4NkU7UhEZ75XS2C2FataN7MNkfJlhuPcUkGt8tEChcXLfuiFqsgptLE9hMAzpuldtzm2Dm7jxe3Cmuah-gIUmGpBaLmEsB0fZpEgB63_PGsx5ZAcB5sQgQpXFIiJljgN3PLd_qLHeAL5Ly38FZtmX6CtAvL5xDE-8Tc0gXyFwyNGkQ-RAfynvIMz14yWFRI25Fl21rBVpAOA5FfJpsEmegn0FjcMM0Up6HxSKnzk51tO7yZRt-o9GdJeZoKfRgK1j6kLZhE1YD8Mg8A6Cy4srm8hYg5IJb-OzBqzFk-NvjJseLwee1sbTx1dslfcx-RIN7fms5q1wUF_p7svsp6E98-TedoC1e9dvUxkQ5_s2gbJuv2aMniB71xkPSjNta09H3i6i-Koj2gpMVxhoEwjau7DrjzeH4syNnbvGAq_AOnfLmlrqrL31QREuij3VLxyL1KosRYuQAi66HKD3oN2_cc-gYWJG67-XG6fupze0VnL55mHw3AdCKnb32blMI4Ain5V63MXjp8nsqfgMsBcj0xa3x97n67lvxAJuCes2Y-4sNc-WUFewaX_2HNOJuEv2hvL1fQUp4VoKtDpHfqvBMQr0HALVqWCiCo2GY0SugIuHDww5XVgV8fdX07wYLYGR_CKJckgprMyzpSr2W4yN_jh8XO8YmU3cDQ34Y81KWYBDEy1Kbm10IPlJ9FHsOcA7wIEEElAhkGLoJ3BIKiM8ox82B5B38t5-LmUtHhLPV-zaDDsNYIIkzkKXGTg6Ol2tPAonQ9cjhTkPhkNQ-aOuRIJjeoEgwJ7AhaO3_hcvkUdfNpd4dAU2GZ3nq72rJ6Faf63l1DLtcldsTm00]--></g></svg>