<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2095px" preserveAspectRatio="none" style="width:1762px;height:2095px;background:#FFFFFF;" version="1.1" viewBox="0 0 1762 2095" width="1762px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="2083.3281" style="stroke:#181818;stroke-width:0.5;" width="609.5342" x="147.9648" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="444.27" y="15.2822">LEI</text><rect fill="#E6E6FA" height="2066.6875" style="stroke:#181818;stroke-width:0.5;" width="393.4497" x="147.9648" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="305.593" y="31.9229">Prim&#228;rsystem</text><rect fill="#F4A460" height="2050.0469" style="stroke:#181818;stroke-width:0.5;" width="89" x="147.9648" y="39.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="159.9648" y="48.5635">ZETA Client</text><rect fill="#C9FFC9" height="2083.3281" style="stroke:#181818;stroke-width:0.5;" width="598.979" x="769.499" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1044.6282" y="15.2822">Anbieter</text><rect fill="#F4A460" height="2066.6875" style="stroke:#181818;stroke-width:0.5;" width="598.979" x="769.499" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1035.844" y="31.9229">ZETA Guard</text><rect fill="#C9FFC9" height="2083.3281" style="stroke:#181818;stroke-width:0.5;" width="339.8984" x="1380.478" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1526.0669" y="15.2822">Anbieter</text><rect fill="#F4A460" height="2066.6875" style="stroke:#181818;stroke-width:0.5;" width="223.3984" x="1380.478" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1459.0327" y="31.9229">ZETA Guard</text><rect fill="#8FBC8F" height="2066.6875" style="stroke:#181818;stroke-width:0.5;" width="104.5" x="1615.8765" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1649.9453" y="31.9229">TI 2.0</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1649.9453" y="43.5635">Dienst</text><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="1885.125" width="8" x="15.8965" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="19.3965" x2="19.3965" y1="126.5625" y2="2011.6875"/></g><g><title>ZETA</title><rect fill="#000000" fill-opacity="0.00000" height="1885.125" width="8" x="188.9648" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="192.4648" x2="192.4648" y1="126.5625" y2="2011.6875"/></g><g><title/><rect fill="#FFFFFF" height="1837.4844" style="stroke:#181818;stroke-width:1;" width="10" x="187.4648" y="174.2031"/></g><g><title/><rect fill="#FFFFFF" height="1548.7188" style="stroke:#181818;stroke-width:1;" width="10" x="192.4648" y="444.9688"/></g><g><title>TPM</title><rect fill="#000000" fill-opacity="0.00000" height="1885.125" width="8" x="508.293" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="511.793" x2="511.793" y1="126.5625" y2="2011.6875"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="506.793" y="598.1719"/></g><g><title>Konnektor or</title><rect fill="#000000" fill-opacity="0.00000" height="1885.125" width="8" x="593.3413" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="596.8413" x2="596.8413" y1="126.5625" y2="2011.6875"/></g><g><title/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1;" width="10" x="591.8413" y="960.7813"/></g><g><title>SM(C)-B</title><rect fill="#000000" fill-opacity="0.00000" height="1885.125" width="8" x="722.8843" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="726.3843" x2="726.3843" y1="126.5625" y2="2011.6875"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="721.3843" y="986.4219"/></g><g><title>PEP</title><rect fill="#000000" fill-opacity="0.00000" height="1885.125" width="8" x="802.8999" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="806.3999" x2="806.3999" y1="126.5625" y2="2011.6875"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="801.3999" y="219.4844"/></g><g><title/><rect fill="#FFFFFF" height="239.4063" style="stroke:#181818;stroke-width:1;" width="10" x="801.3999" y="1754.2813"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="1885.125" width="8" x="1024.0396" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1027.5396" x2="1027.5396" y1="126.5625" y2="2011.6875"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="1022.5396" y="300.4063"/></g><g><title/><rect fill="#FFFFFF" height="819.1406" style="stroke:#181818;stroke-width:1;" width="10" x="1022.5396" y="847.5781"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="1885.125" width="8" x="1320.6919" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1324.1919" x2="1324.1919" y1="126.5625" y2="2011.6875"/></g><g><title/><rect fill="#FFFFFF" height="37.2813" style="stroke:#181818;stroke-width:1;" width="10" x="1319.1919" y="1553.5156"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="1885.125" width="8" x="1402.8706" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1406.3706" x2="1406.3706" y1="126.5625" y2="2011.6875"/></g><g><title/><rect fill="#FFFFFF" height="66.5625" style="stroke:#181818;stroke-width:1;" width="10" x="1401.3706" y="649.4531"/></g><g><title>PEP</title><rect fill="#000000" fill-opacity="0.00000" height="1885.125" width="8" x="1470.2837" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1473.7837" x2="1473.7837" y1="126.5625" y2="2011.6875"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="1885.125" width="8" x="1556.0903" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1559.5903" x2="1559.5903" y1="126.5625" y2="2011.6875"/></g><g><title>Resource Server</title><rect fill="#000000" fill-opacity="0.00000" height="1885.125" width="8" x="1664.6265" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1668.1265" x2="1668.1265" y1="126.5625" y2="2011.6875"/></g><g><title/><rect fill="#FFFFFF" height="87.5625" style="stroke:#181818;stroke-width:1;" width="10" x="1663.1265" y="1880.4844"/></g><text fill="#000000" font-family="Helvetica" font-size="10" x="5" y="124.2041">User</text><ellipse cx="19.3965" cy="63.4219" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M19.3965,71.4219 L19.3965,98.4219 M6.3965,79.4219 L32.3965,79.4219 M19.3965,98.4219 L6.3965,113.4219 M19.3965,98.4219 L32.3965,113.4219" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="170.9897" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="179.4058" y="104.5635">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="177.9897" y="116.2041">Client</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="494.4097" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="501.4097" y="116.2041">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="557.4146" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="564.4146" y="104.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="568.4209" y="116.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="699.2695" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="706.2695" y="116.2041">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="773.499" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="797.2104" y="104.5635">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="780.499" y="116.2041">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="969.0649" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1017.6592" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="976.0649" y="116.2041">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1283.9058" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1314.3115" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1290.9058" y="116.2041">Policy Engine</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.7852" x="1384.478" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1396.4902" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1391.478" y="116.2041">AuthS</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.041" x="1438.2632" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1464.5942" y="104.5635">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1445.2632" y="116.2041">HTTP Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1519.3042" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1549.71" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1526.3042" y="116.2041">Policy Engine</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.5" x="1619.8765" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1626.8765" y="116.2041">Resource Server</text><text fill="#000000" font-family="Helvetica" font-size="10" x="5" y="2080.9697">User</text><ellipse cx="19.3965" cy="2020.1875" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M19.3965,2028.1875 L19.3965,2055.1875 M6.3965,2036.1875 L32.3965,2036.1875 M19.3965,2055.1875 L6.3965,2070.1875 M19.3965,2055.1875 L32.3965,2070.1875" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="170.9897" y="2011.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="179.4058" y="2027.9697">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="177.9897" y="2039.6104">Client</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="494.4097" y="2011.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="501.4097" y="2027.9697">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="557.4146" y="2011.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="564.4146" y="2027.9697">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="568.4209" y="2039.6104">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="699.2695" y="2011.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="706.2695" y="2027.9697">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="773.499" y="2011.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="797.2104" y="2027.9697">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="780.499" y="2039.6104">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="969.0649" y="2011.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1017.6592" y="2027.9697">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="976.0649" y="2039.6104">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1283.9058" y="2011.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1314.3115" y="2027.9697">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1290.9058" y="2039.6104">Policy Engine</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="43.7852" x="1384.478" y="2011.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1396.4902" y="2027.9697">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1391.478" y="2039.6104">AuthS</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.041" x="1438.2632" y="2011.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1464.5942" y="2027.9697">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1445.2632" y="2039.6104">HTTP Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1519.3042" y="2011.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1549.71" y="2027.9697">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1526.3042" y="2039.6104">Policy Engine</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.5" x="1619.8765" y="2011.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1626.8765" y="2027.9697">Resource Server</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1750.3452" x="5" y="153.3828"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1755.3452" y1="153.3828" y2="153.3828"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1755.3452" y1="156.3828" y2="156.3828"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="72.7109" x="843.8171" y="144.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="849.8171" y="157.8447">Discovery</text><path d="M176.4648,178.2031 L236.4209,178.2031 L236.4209,181.8438 L226.4209,191.8438 L176.4648,191.8438 L176.4648,178.2031" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="155.8438" style="stroke:#000000;stroke-width:1.5;" width="872.0747" x="176.4648" y="178.2031"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="191.4648" y="188.4854">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="251.4209" y="189.4854">[Client has no Authorization Server FQDN (AS-FQDN) but Resource Server FQDN (RS-FQDN)]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="176.4648" x2="1048.5396" y1="264.125" y2="264.125"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="181.4648" y="275.4072">[Client has Authorization Server FQDN]</text><polygon fill="#181818" points="789.3999,215.4844,799.3999,219.4844,789.3999,223.4844,793.3999,219.4844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="197.4648" x2="795.3999" y1="219.4844" y2="219.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="204.4648" y="215.126">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="228.9922" y="215.126">GET /.well-known/oauth-protected-resource Host: RS-FQDN</text><polygon fill="#181818" points="208.4648,241.125,198.4648,245.125,208.4648,249.125,204.4648,245.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="202.4648" x2="800.3999" y1="245.125" y2="245.125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="214.4648" y="240.7666">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="238.9922" y="240.7666">Client: 200 OK; json body with Well-Known json Document (RFC8414)</text><polygon fill="#181818" points="1010.5396,296.4063,1020.5396,300.4063,1010.5396,304.4063,1014.5396,300.4063" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="197.4648" x2="1016.5396" y1="300.4063" y2="300.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="204.4648" y="296.0479">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="228.9922" y="296.0479">GET /.well-known/oauth-authorization-server&#160;Host: AS-FQDN</text><polygon fill="#181818" points="208.4648,322.0469,198.4648,326.0469,208.4648,330.0469,204.4648,326.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="202.4648" x2="1021.5396" y1="326.0469" y2="326.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="214.4648" y="321.6885">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="238.9922" y="321.6885">200 OK; json body with Well-Known json Document (RFC8414)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1750.3452" x="5" y="366.8672"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1755.3452" y1="366.8672" y2="366.8672"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1755.3452" y1="369.8672" y2="369.8672"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="123.5166" x="818.4143" y="358.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="824.4143" y="371.3291">Client Registration</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1750.3452" x="5" y="406.5078"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1755.3452" y1="406.5078" y2="406.5078"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1755.3452" y1="409.5078" y2="409.5078"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="171.2803" x="794.5325" y="397.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="800.5325" y="410.9697">Dynamic client registration</text><polygon fill="#181818" points="180.4648,440.9688,190.4648,444.9688,180.4648,448.9688,184.4648,444.9688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="19.3965" x2="186.4648" y1="444.9688" y2="444.9688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="26.3965" y="440.6104">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="50.9238" y="440.6104">User Starts Registration</text><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="244.4648" y1="482.25" y2="482.25"/><line style="stroke:#181818;stroke-width:1;" x1="244.4648" x2="244.4648" y1="482.25" y2="495.25"/><line style="stroke:#181818;stroke-width:1;" x1="203.4648" x2="244.4648" y1="495.25" y2="495.25"/><polygon fill="#181818" points="213.4648,491.25,203.4648,495.25,213.4648,499.25,209.4648,495.25" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="472.0713">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="466.251">Generate Client Key Pair</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="477.8916">for Client registration</text><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="244.4648" y1="520.8906" y2="520.8906"/><line style="stroke:#181818;stroke-width:1;" x1="244.4648" x2="244.4648" y1="520.8906" y2="533.8906"/><line style="stroke:#181818;stroke-width:1;" x1="203.4648" x2="244.4648" y1="533.8906" y2="533.8906"/><polygon fill="#181818" points="213.4648,529.8906,203.4648,533.8906,213.4648,537.8906,209.4648,533.8906" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="516.5322">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="516.5322">Create client statement</text><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="244.4648" y1="559.5313" y2="559.5313"/><line style="stroke:#181818;stroke-width:1;" x1="244.4648" x2="244.4648" y1="559.5313" y2="572.5313"/><line style="stroke:#181818;stroke-width:1;" x1="203.4648" x2="244.4648" y1="572.5313" y2="572.5313"/><polygon fill="#181818" points="213.4648,568.5313,203.4648,572.5313,213.4648,576.5313,209.4648,572.5313" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="555.1729">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="555.1729">Sign client statement</text><polygon fill="#181818" points="494.793,594.1719,504.793,598.1719,494.793,602.1719,498.793,598.1719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="500.793" y1="598.1719" y2="598.1719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="593.8135">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="593.8135">Sign client statement</text><polygon fill="#181818" points="213.4648,619.8125,203.4648,623.8125,213.4648,627.8125,209.4648,623.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="207.4648" x2="505.793" y1="623.8125" y2="623.8125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="219.4648" y="619.4541">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="243.9922" y="619.4541">client statement Signature (Attestation Statement)</text><polygon fill="#181818" points="1389.3706,645.4531,1399.3706,649.4531,1389.3706,653.4531,1393.3706,649.4531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="1395.3706" y1="649.4531" y2="649.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="645.0947">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="645.0947">Client Registration Request</text><path d="M1416.3706,636.8125 L1416.3706,680.8125 L1651.3706,680.8125 L1651.3706,646.8125 L1641.3706,636.8125 L1416.3706,636.8125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1641.3706,636.8125 L1641.3706,646.8125 L1651.3706,646.8125 L1641.3706,636.8125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1422.3706" y="651.0947">client_statement.yaml</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1422.3706" y="662.7354">Includes attestation statement, public key,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1422.3706" y="674.376">and client statement</text><polygon fill="#181818" points="213.4648,712.0156,203.4648,716.0156,213.4648,720.0156,209.4648,716.0156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="207.4648" x2="1400.3706" y1="716.0156" y2="716.0156"/><text fill="#000000" font-family="Helvetica" font-size="10" x="219.4648" y="705.8369">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="243.9922" y="700.0166">Client Registration Response</text><text fill="#000000" font-family="Helvetica" font-size="10" x="243.9922" y="711.6572">(client_id)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1750.3452" x="5" y="742.8359"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1755.3452" y1="742.8359" y2="742.8359"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1755.3452" y1="745.8359" y2="745.8359"/><rect fill="#EEEEEE" height="19.6406" style="stroke:#000000;stroke-width:2;" width="101.4805" x="829.4324" y="734.0156"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="835.4324" y="747.2979">Token Request</text><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="244.4648" y1="781.2969" y2="781.2969"/><line style="stroke:#181818;stroke-width:1;" x1="244.4648" x2="244.4648" y1="781.2969" y2="794.2969"/><line style="stroke:#181818;stroke-width:1;" x1="203.4648" x2="244.4648" y1="794.2969" y2="794.2969"/><polygon fill="#181818" points="213.4648,790.2969,203.4648,794.2969,213.4648,798.2969,209.4648,794.2969" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="776.9385">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="776.9385">generate DPoP key pair</text><path d="M176.4648,806.2969 L236.4209,806.2969 L236.4209,809.9375 L226.4209,819.9375 L176.4648,819.9375 L176.4648,806.2969" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="715.5781" style="stroke:#000000;stroke-width:1.5;" width="1116.2856" x="176.4648" y="806.2969"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="191.4648" y="816.5791">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="251.4209" y="817.5791">[Client has no valid refresh token]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="176.4648" x2="1292.7505" y1="1326.75" y2="1326.75"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="181.4648" y="1338.0322">[Client has valid Refresh token]</text><polygon fill="#181818" points="1010.5396,843.5781,1020.5396,847.5781,1010.5396,851.5781,1014.5396,847.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="1016.5396" y1="847.5781" y2="847.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="843.2197">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="843.2197">GET /nonce</text><polygon fill="#181818" points="213.4648,869.2188,203.4648,873.2188,213.4648,877.2188,209.4648,873.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="207.4648" x2="1021.5396" y1="873.2188" y2="873.2188"/><text fill="#000000" font-family="Helvetica" font-size="10" x="219.4648" y="868.8604">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="243.9922" y="868.8604">return 200 OK new-nonce: nonce</text><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="244.4648" y1="922.1406" y2="922.1406"/><line style="stroke:#181818;stroke-width:1;" x1="244.4648" x2="244.4648" y1="922.1406" y2="935.1406"/><line style="stroke:#181818;stroke-width:1;" x1="203.4648" x2="244.4648" y1="935.1406" y2="935.1406"/><polygon fill="#181818" points="213.4648,931.1406,203.4648,935.1406,213.4648,939.1406,209.4648,935.1406" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="906.1416">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="894.501">create Client Assertion JWT with nonce</text><text fill="#000000" font-family="Helvetica" font-size="10" x="240.3496" y="906.1416">Client and OS Information</text><text fill="#000000" font-family="Helvetica" font-size="10" x="240.3496" y="917.7822">DPoP Thumbprint</text><polygon fill="#181818" points="579.8413,956.7813,589.8413,960.7813,579.8413,964.7813,583.8413,960.7813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="585.8413" y1="960.7813" y2="960.7813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="956.4229">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="956.4229">externalAuthenticate JWT-hash</text><polygon fill="#181818" points="709.3843,982.4219,719.3843,986.4219,709.3843,990.4219,713.3843,986.4219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="601.8413" x2="715.3843" y1="986.4219" y2="986.4219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="608.8413" y="982.0635">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="633.3687" y="982.0635">sign JWT-hash</text><polygon fill="#181818" points="612.8413,1008.0625,602.8413,1012.0625,612.8413,1016.0625,608.8413,1012.0625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="606.8413" x2="720.3843" y1="1012.0625" y2="1012.0625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="618.8413" y="1007.7041">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="643.3687" y="1007.7041">JWT-Signature</text><polygon fill="#181818" points="213.4648,1033.7031,203.4648,1037.7031,213.4648,1041.7031,209.4648,1037.7031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="207.4648" x2="590.8413" y1="1037.7031" y2="1037.7031"/><text fill="#000000" font-family="Helvetica" font-size="10" x="219.4648" y="1033.3447">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="243.9922" y="1033.3447">JWT-signature</text><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="244.4648" y1="1074.9844" y2="1074.9844"/><line style="stroke:#181818;stroke-width:1;" x1="244.4648" x2="244.4648" y1="1074.9844" y2="1087.9844"/><line style="stroke:#181818;stroke-width:1;" x1="203.4648" x2="244.4648" y1="1087.9844" y2="1087.9844"/><polygon fill="#181818" points="213.4648,1083.9844,203.4648,1087.9844,213.4648,1091.9844,209.4648,1087.9844" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="1064.8057">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="1058.9854">add SM-B Signature to Client Assertion JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="1070.626">cC4h... (Client Assertion JWT)</text><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="244.4648" y1="1113.625" y2="1113.625"/><line style="stroke:#181818;stroke-width:1;" x1="244.4648" x2="244.4648" y1="1113.625" y2="1126.625"/><line style="stroke:#181818;stroke-width:1;" x1="203.4648" x2="244.4648" y1="1126.625" y2="1126.625"/><polygon fill="#181818" points="213.4648,1122.625,203.4648,1126.625,213.4648,1130.625,209.4648,1126.625" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="1109.2666">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="1109.2666">create DPoP JWT with nonce</text><polygon fill="#181818" points="1010.5396,1194.8281,1020.5396,1198.8281,1010.5396,1202.8281,1014.5396,1198.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="1016.5396" y1="1198.8281" y2="1198.8281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="1171.1885">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="1147.9072">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="240.3496" y="1159.5479">Content-Type: application/x-www-form-urlencoded</text><text fill="#000000" font-family="Helvetica" font-size="10" x="240.3496" y="1171.1885">DPoP: ... (DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="240.3496" y="1182.8291">grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="240.3496" y="1194.4697">assertion=eyJh... (Client Assertion JWT)</text><path d="M756.144,1211.8281 L756.144,1232.8281 L1022.144,1232.8281 L1022.144,1221.8281 L1012.144,1211.8281 L756.144,1211.8281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1012.144,1211.8281 L1012.144,1221.8281 L1022.144,1221.8281 L1012.144,1211.8281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="762.144" y="1226.1104">RFC7523 (JWT Client Assertion), RFC9449 (DPoP)</text><line style="stroke:#181818;stroke-width:1;" x1="1032.5396" x2="1074.5396" y1="1256.1094" y2="1256.1094"/><line style="stroke:#181818;stroke-width:1;" x1="1074.5396" x2="1074.5396" y1="1256.1094" y2="1269.1094"/><line style="stroke:#181818;stroke-width:1;" x1="1033.5396" x2="1074.5396" y1="1269.1094" y2="1269.1094"/><polygon fill="#181818" points="1043.5396,1265.1094,1033.5396,1269.1094,1043.5396,1273.1094,1039.5396,1269.1094" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1039.5396" y="1251.751">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1064.0669" y="1251.751">verify Client Assertion JWT and DPoP JWT</text><line style="stroke:#181818;stroke-width:1;" x1="1032.5396" x2="1074.5396" y1="1294.75" y2="1294.75"/><line style="stroke:#181818;stroke-width:1;" x1="1074.5396" x2="1074.5396" y1="1294.75" y2="1307.75"/><line style="stroke:#181818;stroke-width:1;" x1="1033.5396" x2="1074.5396" y1="1307.75" y2="1307.75"/><polygon fill="#181818" points="1043.5396,1303.75,1033.5396,1307.75,1043.5396,1311.75,1039.5396,1307.75" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1039.5396" y="1290.3916">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1064.0669" y="1290.3916">Create state for Identity/App/Device</text><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="244.4648" y1="1363.0313" y2="1363.0313"/><line style="stroke:#181818;stroke-width:1;" x1="244.4648" x2="244.4648" y1="1363.0313" y2="1376.0313"/><line style="stroke:#181818;stroke-width:1;" x1="203.4648" x2="244.4648" y1="1376.0313" y2="1376.0313"/><polygon fill="#181818" points="213.4648,1372.0313,203.4648,1376.0313,213.4648,1380.0313,209.4648,1376.0313" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="1358.6729">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="1358.6729">create DPoP JWT without nonce</text><polygon fill="#181818" points="1010.5396,1432.5938,1020.5396,1436.5938,1010.5396,1440.5938,1014.5396,1436.5938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="1016.5396" y1="1436.5938" y2="1436.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="1414.7744">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="1397.3135">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="240.3496" y="1408.9541">DPoP: ... (DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="240.3496" y="1420.5947">grant_type=refresh_token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="240.3496" y="1432.2354">refresh_token= ... (Refresh token)</text><line style="stroke:#181818;stroke-width:1;" x1="1032.5396" x2="1074.5396" y1="1462.2344" y2="1462.2344"/><line style="stroke:#181818;stroke-width:1;" x1="1074.5396" x2="1074.5396" y1="1462.2344" y2="1475.2344"/><line style="stroke:#181818;stroke-width:1;" x1="1033.5396" x2="1074.5396" y1="1475.2344" y2="1475.2344"/><polygon fill="#181818" points="1043.5396,1471.2344,1033.5396,1475.2344,1043.5396,1479.2344,1039.5396,1475.2344" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1039.5396" y="1457.876">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1064.0669" y="1457.876">verify Refresh token and DPoP JWT</text><line style="stroke:#181818;stroke-width:1;" x1="1032.5396" x2="1074.5396" y1="1500.875" y2="1500.875"/><line style="stroke:#181818;stroke-width:1;" x1="1074.5396" x2="1074.5396" y1="1500.875" y2="1513.875"/><line style="stroke:#181818;stroke-width:1;" x1="1033.5396" x2="1074.5396" y1="1513.875" y2="1513.875"/><polygon fill="#181818" points="1043.5396,1509.875,1033.5396,1513.875,1043.5396,1517.875,1039.5396,1513.875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1039.5396" y="1496.5166">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1064.0669" y="1496.5166">invalidate Refresh token</text><polygon fill="#181818" points="1307.1919,1549.5156,1317.1919,1553.5156,1307.1919,1557.5156,1311.1919,1553.5156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1032.5396" x2="1313.1919" y1="1553.5156" y2="1553.5156"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1039.5396" y="1549.1572">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1064.0669" y="1549.1572">POST /v1/data/authz, json body {  "input": {...}}</text><polygon fill="#181818" points="1043.5396,1586.7969,1033.5396,1590.7969,1043.5396,1594.7969,1039.5396,1590.7969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1037.5396" x2="1318.1919" y1="1590.7969" y2="1590.7969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1049.5396" y="1580.6182">(31)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1074.0669" y="1574.7979">200 OK, json body {"result": {"allow": true,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1074.0669" y="1586.4385">"access_token_attributes": {...}}</text><line style="stroke:#181818;stroke-width:1;" x1="1032.5396" x2="1074.5396" y1="1628.0781" y2="1628.0781"/><line style="stroke:#181818;stroke-width:1;" x1="1074.5396" x2="1074.5396" y1="1628.0781" y2="1641.0781"/><line style="stroke:#181818;stroke-width:1;" x1="1033.5396" x2="1074.5396" y1="1641.0781" y2="1641.0781"/><polygon fill="#181818" points="1043.5396,1637.0781,1033.5396,1641.0781,1043.5396,1645.0781,1039.5396,1641.0781" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1039.5396" y="1617.8994">(32)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1064.0669" y="1612.0791">issue Access and Refresh token with DPoP Binding</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1070.4243" y="1623.7197">and Access token attributes</text><polygon fill="#181818" points="213.4648,1662.7188,203.4648,1666.7188,213.4648,1670.7188,209.4648,1666.7188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="207.4648" x2="1021.5396" y1="1666.7188" y2="1666.7188"/><text fill="#000000" font-family="Helvetica" font-size="10" x="219.4648" y="1662.3604">(33)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="243.9922" y="1662.3604">200 OK, Access token, Refresh token, bound to DPoP</text><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="244.4648" y1="1692.3594" y2="1692.3594"/><line style="stroke:#181818;stroke-width:1;" x1="244.4648" x2="244.4648" y1="1692.3594" y2="1705.3594"/><line style="stroke:#181818;stroke-width:1;" x1="203.4648" x2="244.4648" y1="1705.3594" y2="1705.3594"/><polygon fill="#181818" points="213.4648,1701.3594,203.4648,1705.3594,213.4648,1709.3594,209.4648,1705.3594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="1688.001">(34)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="1688.001">Create DPoP Proof for RS</text><polygon fill="#181818" points="789.3999,1750.2813,799.3999,1754.2813,789.3999,1758.2813,793.3999,1754.2813" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="202.4648" x2="795.3999" y1="1754.2813" y2="1754.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="209.4648" y="1738.2822">(35)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="233.9922" y="1726.6416">GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="240.3496" y="1738.2822">Authorization: DPoP ... (Accesss token)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="240.3496" y="1749.9229">DPoP: ... (DPoP token)</text><line style="stroke:#181818;stroke-width:1;" x1="811.3999" x2="853.3999" y1="1779.9219" y2="1779.9219"/><line style="stroke:#181818;stroke-width:1;" x1="853.3999" x2="853.3999" y1="1779.9219" y2="1792.9219"/><line style="stroke:#181818;stroke-width:1;" x1="812.3999" x2="853.3999" y1="1792.9219" y2="1792.9219"/><polygon fill="#181818" points="822.3999,1788.9219,812.3999,1792.9219,822.3999,1796.9219,818.3999,1792.9219" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="818.3999" y="1775.5635">(36)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="842.9272" y="1775.5635">verify Access token and DPoP Proof</text><line style="stroke:#181818;stroke-width:1;" x1="811.3999" x2="853.3999" y1="1830.2031" y2="1830.2031"/><line style="stroke:#181818;stroke-width:1;" x1="853.3999" x2="853.3999" y1="1830.2031" y2="1843.2031"/><line style="stroke:#181818;stroke-width:1;" x1="812.3999" x2="853.3999" y1="1843.2031" y2="1843.2031"/><polygon fill="#181818" points="822.3999,1839.2031,812.3999,1843.2031,822.3999,1847.2031,818.3999,1843.2031" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="818.3999" y="1820.0244">(37)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="842.9272" y="1814.2041">additional checks according to</text><text fill="#000000" font-family="Helvetica" font-size="10" x="842.9272" y="1825.8447">Access token attributes</text><polygon fill="#181818" points="1651.1265,1876.4844,1661.1265,1880.4844,1651.1265,1884.4844,1655.1265,1880.4844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="811.3999" x2="1657.1265" y1="1880.4844" y2="1880.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="818.3999" y="1870.3057">(38)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="842.9272" y="1864.4854">forward GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="842.9272" y="1876.126">with header and header content as json</text><line style="stroke:#181818;stroke-width:1;" x1="1673.1265" x2="1715.1265" y1="1929.4063" y2="1929.4063"/><line style="stroke:#181818;stroke-width:1;" x1="1715.1265" x2="1715.1265" y1="1929.4063" y2="1942.4063"/><line style="stroke:#181818;stroke-width:1;" x1="1674.1265" x2="1715.1265" y1="1942.4063" y2="1942.4063"/><polygon fill="#181818" points="1684.1265,1938.4063,1674.1265,1942.4063,1684.1265,1946.4063,1680.1265,1942.4063" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1680.1265" y="1913.4072">(39)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1704.6538" y="1901.7666">provide</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1704.6538" y="1913.4072">resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1704.6538" y="1925.0479">access</text><polygon fill="#181818" points="822.3999,1964.0469,812.3999,1968.0469,822.3999,1972.0469,818.3999,1968.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="816.3999" x2="1662.1265" y1="1968.0469" y2="1968.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="828.3999" y="1963.6885">(40)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="852.9272" y="1963.6885">200 OK, resource</text><polygon fill="#181818" points="213.4648,1989.6875,203.4648,1993.6875,213.4648,1997.6875,209.4648,1993.6875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="207.4648" x2="800.3999" y1="1993.6875" y2="1993.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="219.4648" y="1989.3291">(41)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="243.9922" y="1989.3291">200 OK, resource</text><!--SRC=[hLVTRjis5BxNKvof6103KPos6RPwo037TfCqJQDP7eeD1W9QOcmsCkbIb1sbwBliOa-olTWEIKcMBDdhnQviYT_v_yxX4KcLuEboHYMuHwUd7TT97XbV4KcM4D47aiRghU0gOCyKNfws7tuWImfND5vJnK9ImGmjvbPmaQn8IACIFH2fP5HMi37bSxNeHv_IH04Nd3hEToj9vai2YefdK3B5L_rG2Gc_9IWw4q_WlXzTk_3YSY4IzN7157K0p7jVikK_VyaaInHT8k8zMLCUeHH0ZlXZDEd386QKApmF28-o2oast200q2aCXgq8LpaAI6AbfZmNCr1KgnKwkq8J_zP8uAy6Rc5Lq8tWd3xga3Hq-oJab4-klKkYw8PaxevKS7jXyC7jqQ3ZNRXEeTpcfCzdZ2egCQp9Q73ruUxztUNlJZNiovJ8g1brrSQLRqpu8t_A5qgjm9VYANCRk7vWSKF4zLEr498z4yK4Xu3AjNQY8UAFjYA-Y5cOmOZF6QVrF5c79zVmwkGKXfXmvCMB8P6F0IMNajAsIesjDsEQ8Bz2MlXGArIPhFDpL9k40X4Pd9yx95HiZHdFw-sGk2pz0hLo0Mq1mjjVXn_Wg1zu-ay7PYcwKRUVGyOv1Bt9rNg_O9vxS3cQGFTaG-FOU-HOZAuWQCXRIQ5eg6ZaoKBV5VAy1xaYr5EwVENZ4zRCGvLMUQ_yVNLw2dStFyEd19sUYIY33LCB-AZjtMXxzcGemdIflJeQlntyTFRoJ3iQqQe96YUqcfAz-QY5s0_sXaYg2hp4AFZxJnjblnbbFy0dP5mrolyfEbIDn32ao3qVqpbBbBIn8JqEDzStj5UZTJ3udUu9t5OaTk6s6wyc4x_QZKrm_q1_DJlCjIqsvRR7tDOcEzXcK_wVVPPnicGXX3QrSZUrUg13fQZcEL1eCgdLeT6ZMvOLefUKKxb5m0tDm2SC1-e33jP1qu4M7GD9jORSsqJXmxBTMi3c_10Ef_y-K1aAOXnzMrHPlOisEeXA9SLHenJL1wRd2a37gP1PQwmuOPZLQ-Nrc7vEKPd3STI0PFD5QVk-j7sIaMKyvTSyZDE89a0gzalGCQpI6N8D7cbsFEN8_0CH6uSSo__cnDhrC5a9dY39ZdB7M5GBrYhJB9k8Hrg6f7dLhDUyOCVG5xxs5NdDfDCowzSaPX4IvG67xmAKLksqp3JSL4BgLCV8pdoI5Al6yp45d6uy8z83AzbqCRJaom_w2RQ2ISIxZnCxsepWb9SZLkVwBe1hJV2bIPe-D05E5hZQhIIhSR9SCtf0dt2KSHBh7E8fRcze6Grvc8J5DgfImjckAAW8zv0U99hSJH4yS_IUKhUdSIMJgqNKy9hk8XjQ8ccJsFhKaaCIHQZIkwYqZHAjAPtoS72sE3avWQEsuyx-0fa4rukoGn3_Ba266EgOSk7oYwVU95jX-Sbg5Ujyew7kaxVPR3nTFY-Lk0Y78g9HKSGU6EyASntzVYvn3DyhL7IEvFh-TH_lf0VyCQjqWd_CzOg_1kXf83vysYXlHecaKkiWHPpdD7jtA0DcDiJqGO5ui5SmNg4__l3gDHpfy7U5EiVw_CtPsHlhTCVS15g9QGsR6hmjs4FMJdBDvoBQYaW-bCqu0JtBhoDDMPLr-wjLTqZN30lGM55i6u_tjF6XaefKVKjLlw54-H2vBsLgBywjSCt5JZDLjVDzEMBSnAjZgOTiTXkByqT53EkNNOIIhkRAyt5bW_e2uE9tMQhS7dn1xxv-XMrd-oC7DtWljsZdMatOHRlurQTbNHB7OeF_zDSRNWik2KEQ93RmUxn89CDzcIQbdMg7ew5AP4cIudWruYRwUZvC3vg4N30UCJut34TOBf5dhJJej6wHnpNuSTt6COQNeaOS9DgGKryUzsyHnYlSrx1vD6l7WTEo_SjobOBwLjspyeOYrhdSkquR-NBoL7Ts_L5W3UL4gcUau95ni0B62SgqVH93kA3X8oOz38NKgKLHt5RtvDLg66F5CDWDxi6xyPbABIZ1Zt5ZFVyRsk6ezqfDfMq8cAznKEZ4Jw8rYr3BLfzbbC7ahXUrB33LIg6sdQ-aG-WhVqUsyfGleFy2]--></g></svg>