<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1556px" preserveAspectRatio="none" style="width:1212px;height:1556px;background:#FFFFFF;" version="1.1" viewBox="0 0 1212 1556" width="1212px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="1544.7188" style="stroke:#181818;stroke-width:0.5;" width="438.6836" x="11" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="221.8799" y="15.2822">LEI</text><rect fill="#C9FFC9" height="1544.7188" style="stroke:#181818;stroke-width:0.5;" width="715.479" x="461.6836" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="792.824" y="15.2822">Betreiber</text><rect fill="#F4A460" height="1528.0781" style="stroke:#181818;stroke-width:0.5;" width="598.979" x="461.6836" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="732.2302" y="31.9229">ZT Cluster</text><rect fill="#8FBC8F" height="1528.0781" style="stroke:#181818;stroke-width:0.5;" width="104.5" x="1072.6626" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1087.3809" y="31.9229">TI 2.0 Dienst</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="36.4751" x2="36.4751" y1="76.5625" y2="1506.4375"/><rect fill="#FFFFFF" height="1403.875" style="stroke:#181818;stroke-width:1.0;" width="10" x="31.4751" y="84.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="296.4185" x2="296.4185" y1="76.5625" y2="1506.4375"/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1.0;" width="10" x="291.4185" y="455.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="425.9614" x2="425.9614" y1="76.5625" y2="1506.4375"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="420.9614" y="481.1719"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="498.5845" x2="498.5845" y1="76.5625" y2="1506.4375"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="493.5845" y="129.8438"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="493.5845" y="210.7656"/><rect fill="#FFFFFF" height="239.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="493.5845" y="1249.0313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="719.7241" x2="719.7241" y1="76.5625" y2="1506.4375"/><rect fill="#FFFFFF" height="819.1406" style="stroke:#181818;stroke-width:1.0;" width="10" x="714.7241" y="342.3281"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1016.3765" x2="1016.3765" y1="76.5625" y2="1506.4375"/><rect fill="#FFFFFF" height="37.2813" style="stroke:#181818;stroke-width:1.0;" width="10" x="1011.3765" y="1048.2656"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1124.9126" x2="1124.9126" y1="76.5625" y2="1506.4375"/><rect fill="#FFFFFF" height="87.5625" style="stroke:#181818;stroke-width:1.0;" width="10" x="1119.9126" y="1375.2344"/><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="15" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="22" y="66.2041">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="256.9917" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="263.9917" y="54.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="267.998" y="66.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="39.4443" x="406.2393" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="413.2393" y="66.2041">SM-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="465.6836" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="489.395" y="54.5635">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="472.6836" y="66.2041">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="661.2495" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="709.8438" y="54.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="668.2495" y="66.2041">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="976.0903" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1006.4961" y="54.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="983.0903" y="66.2041">Policy Engine</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.5" x="1076.6626" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1083.6626" y="66.2041">Resource Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="15" y="1506.4375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="22" y="1522.7197">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="256.9917" y="1506.4375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="263.9917" y="1522.7197">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="267.998" y="1534.3604">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="39.4443" x="406.2393" y="1506.4375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="413.2393" y="1522.7197">SM-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="465.6836" y="1506.4375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="489.395" y="1522.7197">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="472.6836" y="1534.3604">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="661.2495" y="1506.4375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="709.8438" y="1522.7197">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="668.2495" y="1534.3604">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="976.0903" y="1506.4375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1006.4961" y="1522.7197">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="983.0903" y="1534.3604">Policy Engine</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.5" x="1076.6626" y="1506.4375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1083.6626" y="1522.7197">Resource Server</text><path d="M20.4751,88.5625 L80.4312,88.5625 L80.4312,92.2031 L70.4312,102.2031 L20.4751,102.2031 L20.4751,88.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="155.8438" style="stroke:#000000;stroke-width:1.5;" width="611.6836" x="20.4751" y="88.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="35.4751" y="98.8447">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="95.4312" y="99.8447">[Client has no Authorization Server FQDN (AS-FQDN) but Resource Server FQDN (RS-FQDN)]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20.4751" x2="632.1587" y1="174.4844" y2="174.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="25.4751" y="185.7666">[Client has Authorization Server FQDN]</text><polygon fill="#181818" points="481.5845,125.8438,491.5845,129.8438,481.5845,133.8438,485.5845,129.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="487.5845" y1="129.8438" y2="129.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="125.4854">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="125.4854">GET /.well-known/oauth-protected-resource Host: RS-FQDN</text><polygon fill="#181818" points="52.4751,151.4844,42.4751,155.4844,52.4751,159.4844,48.4751,155.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.4751" x2="492.5845" y1="155.4844" y2="155.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="151.126">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="151.126">Client: 200 OK; json body with Well-Known json Document (RFC8414)</text><polygon fill="#181818" points="481.5845,206.7656,491.5845,210.7656,481.5845,214.7656,485.5845,210.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="487.5845" y1="210.7656" y2="210.7656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="206.4072">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="206.4072">GET /.well-known/oauth-authorization-server&#160;Host: AS-FQDN</text><polygon fill="#181818" points="52.4751,232.4063,42.4751,236.4063,52.4751,240.4063,48.4751,236.4063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.4751" x2="492.5845" y1="236.4063" y2="236.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="232.0479">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="232.0479">200 OK; json body with Well-Known json Document (RFC8414)</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="276.0469" y2="276.0469"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="276.0469" y2="289.0469"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="289.0469" y2="289.0469"/><polygon fill="#181818" points="52.4751,285.0469,42.4751,289.0469,52.4751,293.0469,48.4751,289.0469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="271.6885">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="271.6885">generate DPoP key pair</text><path d="M20.4751,301.0469 L80.4312,301.0469 L80.4312,304.6875 L70.4312,314.6875 L20.4751,314.6875 L20.4751,301.0469 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="715.5781" style="stroke:#000000;stroke-width:1.5;" width="964.46" x="20.4751" y="301.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="35.4751" y="311.3291">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="95.4312" y="312.3291">[Client has no valid refresh token]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20.4751" x2="984.9351" y1="821.5" y2="821.5"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="25.4751" y="832.7822">[Client has valid Refresh token]</text><polygon fill="#181818" points="702.7241,338.3281,712.7241,342.3281,702.7241,346.3281,706.7241,342.3281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="708.7241" y1="342.3281" y2="342.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="337.9697">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="337.9697">GET /nonce</text><polygon fill="#181818" points="52.4751,363.9688,42.4751,367.9688,52.4751,371.9688,48.4751,367.9688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.4751" x2="713.7241" y1="367.9688" y2="367.9688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="363.6104">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="363.6104">return 200 OK new-nonce: nonce</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="416.8906" y2="416.8906"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="416.8906" y2="429.8906"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="429.8906" y2="429.8906"/><polygon fill="#181818" points="52.4751,425.8906,42.4751,429.8906,52.4751,433.8906,48.4751,429.8906" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="400.8916">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="389.251">create Client Assertion JWT with nonce</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="400.8916">Client and OS Information</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="412.5322">DPoP Thumbprint</text><polygon fill="#181818" points="279.4185,451.5313,289.4185,455.5313,279.4185,459.5313,283.4185,455.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="285.4185" y1="455.5313" y2="455.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="451.1729">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="451.1729">externalAuthenticate JWT-hash</text><polygon fill="#181818" points="408.9614,477.1719,418.9614,481.1719,408.9614,485.1719,412.9614,481.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="301.4185" x2="414.9614" y1="481.1719" y2="481.1719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="308.4185" y="476.8135">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.9458" y="476.8135">sign JWT-hash</text><polygon fill="#181818" points="312.4185,502.8125,302.4185,506.8125,312.4185,510.8125,308.4185,506.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="306.4185" x2="419.9614" y1="506.8125" y2="506.8125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="318.4185" y="502.4541">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="342.9458" y="502.4541">JWT-Signature</text><polygon fill="#181818" points="52.4751,528.4531,42.4751,532.4531,52.4751,536.4531,48.4751,532.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="46.4751" x2="290.4185" y1="532.4531" y2="532.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="528.0947">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="528.0947">JWT-signature</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="569.7344" y2="569.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="569.7344" y2="582.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="582.7344" y2="582.7344"/><polygon fill="#181818" points="52.4751,578.7344,42.4751,582.7344,52.4751,586.7344,48.4751,582.7344" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="559.5557">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="553.7354">add SM-B Signature to Client Assertion JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="565.376">cC4h... (Client Assertion JWT)</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="608.375" y2="608.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="608.375" y2="621.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="621.375" y2="621.375"/><polygon fill="#181818" points="52.4751,617.375,42.4751,621.375,52.4751,625.375,48.4751,621.375" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="604.0166">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="604.0166">create DPoP JWT with nonce</text><polygon fill="#181818" points="702.7241,689.5781,712.7241,693.5781,702.7241,697.5781,706.7241,693.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="708.7241" y1="693.5781" y2="693.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="665.9385">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="642.6572">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="654.2979">Content-Type: application/x-www-form-urlencoded</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="665.9385">DPoP: ... (DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="677.5791">grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="689.2197">assertion=eyJh... (Client Assertion JWT)</text><path d="M448.3286,706.5781 L448.3286,727.5781 L714.3286,727.5781 L714.3286,716.5781 L704.3286,706.5781 L448.3286,706.5781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M704.3286,706.5781 L704.3286,716.5781 L714.3286,716.5781 L704.3286,706.5781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="454.3286" y="720.8604">RFC7523 (JWT Client Assertion), RFC9449 (DPoP)</text><line style="stroke:#181818;stroke-width:1.0;" x1="724.7241" x2="766.7241" y1="750.8594" y2="750.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="766.7241" x2="766.7241" y1="750.8594" y2="763.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="725.7241" x2="766.7241" y1="763.8594" y2="763.8594"/><polygon fill="#181818" points="735.7241,759.8594,725.7241,763.8594,735.7241,767.8594,731.7241,763.8594" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="731.7241" y="746.501">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="756.2515" y="746.501">verify Client Assertion JWT and DPoP JWT</text><line style="stroke:#181818;stroke-width:1.0;" x1="724.7241" x2="766.7241" y1="789.5" y2="789.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="766.7241" x2="766.7241" y1="789.5" y2="802.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="725.7241" x2="766.7241" y1="802.5" y2="802.5"/><polygon fill="#181818" points="735.7241,798.5,725.7241,802.5,735.7241,806.5,731.7241,802.5" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="731.7241" y="785.1416">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="756.2515" y="785.1416">Create state for Identity/App/Device</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="857.7813" y2="857.7813"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="857.7813" y2="870.7813"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="870.7813" y2="870.7813"/><polygon fill="#181818" points="52.4751,866.7813,42.4751,870.7813,52.4751,874.7813,48.4751,870.7813" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="853.4229">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="853.4229">create DPoP JWT without nonce</text><polygon fill="#181818" points="702.7241,927.3438,712.7241,931.3438,702.7241,935.3438,706.7241,931.3438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="708.7241" y1="931.3438" y2="931.3438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="909.5244">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="892.0635">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="903.7041">DPoP: ... (DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="915.3447">grant_type=refresh_token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="926.9854">refresh_token= ... (Refresh token)</text><line style="stroke:#181818;stroke-width:1.0;" x1="724.7241" x2="766.7241" y1="956.9844" y2="956.9844"/><line style="stroke:#181818;stroke-width:1.0;" x1="766.7241" x2="766.7241" y1="956.9844" y2="969.9844"/><line style="stroke:#181818;stroke-width:1.0;" x1="725.7241" x2="766.7241" y1="969.9844" y2="969.9844"/><polygon fill="#181818" points="735.7241,965.9844,725.7241,969.9844,735.7241,973.9844,731.7241,969.9844" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="731.7241" y="952.626">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="756.2515" y="952.626">verify Refresh token and DPoP JWT</text><line style="stroke:#181818;stroke-width:1.0;" x1="724.7241" x2="766.7241" y1="995.625" y2="995.625"/><line style="stroke:#181818;stroke-width:1.0;" x1="766.7241" x2="766.7241" y1="995.625" y2="1008.625"/><line style="stroke:#181818;stroke-width:1.0;" x1="725.7241" x2="766.7241" y1="1008.625" y2="1008.625"/><polygon fill="#181818" points="735.7241,1004.625,725.7241,1008.625,735.7241,1012.625,731.7241,1008.625" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="731.7241" y="991.2666">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="756.2515" y="991.2666">invalidate Refresh token</text><polygon fill="#181818" points="999.3765,1044.2656,1009.3765,1048.2656,999.3765,1052.2656,1003.3765,1048.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="724.7241" x2="1005.3765" y1="1048.2656" y2="1048.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="731.7241" y="1043.9072">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="756.2515" y="1043.9072">POST /v1/data/authz, json body {  "input": {...}}</text><polygon fill="#181818" points="735.7241,1081.5469,725.7241,1085.5469,735.7241,1089.5469,731.7241,1085.5469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="729.7241" x2="1010.3765" y1="1085.5469" y2="1085.5469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="741.7241" y="1075.3682">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="766.2515" y="1069.5479">200 OK, json body {"result": {"allow": true,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="766.2515" y="1081.1885">"access_token_attributes": {...}}</text><line style="stroke:#181818;stroke-width:1.0;" x1="724.7241" x2="766.7241" y1="1122.8281" y2="1122.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="766.7241" x2="766.7241" y1="1122.8281" y2="1135.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="725.7241" x2="766.7241" y1="1135.8281" y2="1135.8281"/><polygon fill="#181818" points="735.7241,1131.8281,725.7241,1135.8281,735.7241,1139.8281,731.7241,1135.8281" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="731.7241" y="1112.6494">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="756.2515" y="1106.8291">issue Access and Refresh token with DPoP Binding</text><text fill="#000000" font-family="Helvetica" font-size="10" x="762.6089" y="1118.4697">and Access token attributes</text><polygon fill="#181818" points="52.4751,1157.4688,42.4751,1161.4688,52.4751,1165.4688,48.4751,1161.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.4751" x2="713.7241" y1="1161.4688" y2="1161.4688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="1157.1104">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="1157.1104">200 OK, Access token, Refresh token, bound to DPoP</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="1187.1094" y2="1187.1094"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="1187.1094" y2="1200.1094"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="1200.1094" y2="1200.1094"/><polygon fill="#181818" points="52.4751,1196.1094,42.4751,1200.1094,52.4751,1204.1094,48.4751,1200.1094" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="1182.751">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="1182.751">Create DPoP Proof for RS</text><polygon fill="#181818" points="481.5845,1245.0313,491.5845,1249.0313,481.5845,1253.0313,485.5845,1249.0313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="487.5845" y1="1249.0313" y2="1249.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="1233.0322">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="1221.3916">GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="1233.0322">Authorization: DPoP ... (Accesss token)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="1244.6729">DPoP: ... (DPoP token)</text><line style="stroke:#181818;stroke-width:1.0;" x1="503.5845" x2="545.5845" y1="1274.6719" y2="1274.6719"/><line style="stroke:#181818;stroke-width:1.0;" x1="545.5845" x2="545.5845" y1="1274.6719" y2="1287.6719"/><line style="stroke:#181818;stroke-width:1.0;" x1="504.5845" x2="545.5845" y1="1287.6719" y2="1287.6719"/><polygon fill="#181818" points="514.5845,1283.6719,504.5845,1287.6719,514.5845,1291.6719,510.5845,1287.6719" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="510.5845" y="1270.3135">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="535.1118" y="1270.3135">verify Access token and DPoP Proof</text><line style="stroke:#181818;stroke-width:1.0;" x1="503.5845" x2="545.5845" y1="1324.9531" y2="1324.9531"/><line style="stroke:#181818;stroke-width:1.0;" x1="545.5845" x2="545.5845" y1="1324.9531" y2="1337.9531"/><line style="stroke:#181818;stroke-width:1.0;" x1="504.5845" x2="545.5845" y1="1337.9531" y2="1337.9531"/><polygon fill="#181818" points="514.5845,1333.9531,504.5845,1337.9531,514.5845,1341.9531,510.5845,1337.9531" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="510.5845" y="1314.7744">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="535.1118" y="1308.9541">additional checks according to</text><text fill="#000000" font-family="Helvetica" font-size="10" x="535.1118" y="1320.5947">Access token attributes</text><polygon fill="#181818" points="1107.9126,1371.2344,1117.9126,1375.2344,1107.9126,1379.2344,1111.9126,1375.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="503.5845" x2="1113.9126" y1="1375.2344" y2="1375.2344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="510.5845" y="1365.0557">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="535.1118" y="1359.2354">forward GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="535.1118" y="1370.876">with header and header content as json</text><line style="stroke:#181818;stroke-width:1.0;" x1="1129.9126" x2="1171.9126" y1="1424.1563" y2="1424.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1171.9126" x2="1171.9126" y1="1424.1563" y2="1437.1563"/><line style="stroke:#181818;stroke-width:1.0;" x1="1130.9126" x2="1171.9126" y1="1437.1563" y2="1437.1563"/><polygon fill="#181818" points="1140.9126,1433.1563,1130.9126,1437.1563,1140.9126,1441.1563,1136.9126,1437.1563" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1136.9126" y="1408.1572">(31)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1161.4399" y="1396.5166">provide</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1161.4399" y="1408.1572">resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1161.4399" y="1419.7979">access</text><polygon fill="#181818" points="514.5845,1458.7969,504.5845,1462.7969,514.5845,1466.7969,510.5845,1462.7969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="508.5845" x2="1118.9126" y1="1462.7969" y2="1462.7969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="520.5845" y="1458.4385">(32)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="545.1118" y="1458.4385">200 OK, resource</text><polygon fill="#181818" points="52.4751,1484.4375,42.4751,1488.4375,52.4751,1492.4375,48.4751,1488.4375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.4751" x2="492.5845" y1="1488.4375" y2="1488.4375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="1484.0791">(33)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="1484.0791">200 OK, resource</text><!--SRC=[hLRXJkD64FxlfvZcL8b8c8GxglPIKIaaWN0SuCQHK2iajDYJU8cp6wtN2U5qxz9dwPDrTct7TZ0dVlHFOdjdvfllczdPPQcM8bq-eeBMGRVRRZd9WeiLKsm98SvO6kjpARJFNn2EkysBDso9CCPuZPe7h68pp6okfP39YWKOxgm7CbKSLSKsHZ7NKJzyIXCDGWfqd9zMYisN33JA5z0gfK-FyXbQNqUNBVXm4Sb4tqLSemD0CGYRhvZGC8Wv2httyKeAWGij5R04MkMRLFTYUkbUC8qRjctjUVdNPzRUltRFMWwA42Y1F8ipr0ev2KUvJ4U3yStjrzkBloY0NVrxIdaG5RliCn5kpvJS25gk8umz2-2Dl7iHQRq2JybdcqVThkzdTaEowwSwaeg_CCsb01_Lsg2ySl56fOidOnviOIJcNA29JbmC5SZIdLx2nwCk34auKl_3aAc5Z-n28RxEU99bCi64QXXWWL_6tCd40itN96nH4HONnO68GWW9JKpW_C_X3HpqVTSyjE4n9SmwM6uooKq8EW_h_a62zk1YD8NEqGRZs5q8KhqZ6G6vAoKr1Xf3LnNnnjH3FSW3KPnTocEFtgWuBeNCWlTs_n-xNRYz-XsU4ahwKOPRs70TmPt1kp9usSfG1kdIP7KmEH_yTd9yOX8DiGg1SO9LITxKuxqKMJM0czW0__wJiUo_Z-N_o4w4ZbEcNG3CKQ0o9aDFUh30BRKNLqv3UwnPp4DGEADwHQ3bWjgnZDVtSnbeMWHOTblVTsYtL2afrAaIEJCGk76jImyopzSf1WhBleL-GaBQYdovcsPgMCTxiQiARN2uzU5IpAHQMl7DeYKuZMYyhXId3L02xGPG3_2PXeHWiQazhT849MG2Sac4g6Iryt3AuKM1Q4Br8E5pqU12QuwPO7KyO-UJ0oDDqAbKp9ZNOXTg68-aoQFCgK535ePWvYRimAY2ZPBUYs1m4XqT7S51qtBxxG9PWUj5sMiGxzQd3h6jOyj51n2jkjFjYihFLglOw4r0dMTtizcufdnkgkWm2cI8OL747jZi2hYs-JvND0qVD0KwfURw-LEVevxHdptE4dgmEvB-hQ5h3EdbQQFTHsGAbOd12fwdkFto8mK4JIuw8cSQvCmqE03jkbz_-VW93WpzVQVseLd_V7BoEKkwROUo2MAtHYODZGO-spOtkUddWct5PP39dcZpIrh1PMXQLcyx_TMgCyGrfmAycchPDfwyiOr_L5APwlTKzHqboeV8mywdzk4qSwwbs7ujLMtzBOsui7mDbpfbEmupEszKS5WVTyYKTKoll1nMXkutW1RTZLBTwi4tokxxToXtjZTow7HtSyHihjMSMuHBDo_Zss9nB3VqP6vGX_UYnO80aoGZ_i2qLfoEM4nsEDKTJa0LPacIqdYrxfPzNG-x1wqWPro4NCnjXvDPxf6hjWFSdz85ZQhvOHtZaEYb5946YG6gPagReg6f1fMcefiLRHxJjHFVQJXDYqk1IRjs4FSoVziYMN9vTkscvikRfteGcXCs0yeRgQv8qKSsmOenJL1ky5aCGOJ1WaGF0gcCjEHAzy0tTCqYJAXYH7R3LBZFprOgGXRIxSAWvuz1DXpDzSwqKac1z9huHKowHQrvI57AU5b7MPiyzQAMXKsrKXIjyShHR3tszdmhR_czyZy0]--></g></svg>