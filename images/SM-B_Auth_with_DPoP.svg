<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1417px" preserveAspectRatio="none" style="width:1050px;height:1417px;background:#FFFFFF;" version="1.1" viewBox="0 0 1050 1417" width="1050px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="1405.5156" style="stroke:#181818;stroke-width:0.5;" width="193" x="236.5" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="325.5" y="15.2822">LEI</text><rect fill="#C9FFC9" height="1405.5156" style="stroke:#181818;stroke-width:0.5;" width="575" x="441.5" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="702.5" y="15.2822">Betreiber</text><rect fill="#F4A460" height="1388.875" style="stroke:#181818;stroke-width:0.5;" width="460" x="441.5" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="643" y="31.9229">ZT Cluster</text><rect fill="#8FBC8F" height="1388.875" style="stroke:#181818;stroke-width:0.5;" width="103" x="913.5" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="928.5" y="31.9229">TI 2.0 Dienst</text><rect fill="#FFFFFF" height="144.2031" style="stroke:#FFFFFF;stroke-width:1.0;" width="761.5" x="10" y="88.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="26" x2="26" y1="76.5625" y2="1367.2344"/><rect fill="#FFFFFF" height="1264.6719" style="stroke:#181818;stroke-width:1.0;" width="10" x="21" y="84.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="279" x2="279" y1="76.5625" y2="1367.2344"/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1.0;" width="10" x="274" y="443.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="405" x2="405" y1="76.5625" y2="1367.2344"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="400" y="469.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="502.5" x2="502.5" y1="76.5625" y2="1367.2344"/><rect fill="#FFFFFF" height="753.5" style="stroke:#181818;stroke-width:1.0;" width="10" x="497.5" y="330.6875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="722.5" x2="722.5" y1="76.5625" y2="1367.2344"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="717.5" y="129.8438"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="717.5" y="199.125"/><rect fill="#FFFFFF" height="200.7656" style="stroke:#181818;stroke-width:1.0;" width="10" x="717.5" y="1148.4688"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="879.5" x2="879.5" y1="76.5625" y2="1367.2344"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="874.5" y="994.2656"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="965" x2="965" y1="76.5625" y2="1367.2344"/><rect fill="#FFFFFF" height="87.5625" style="stroke:#181818;stroke-width:1.0;" width="10" x="960" y="1236.0313"/><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42" x="5" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="12" y="66.2041">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="240.5" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="247.5" y="54.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="251" y="66.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="384.5" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="391.5" y="66.2041">SM-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="445.5" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="492" y="54.5635">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="452.5" y="66.2041">Authorization Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66" x="689.5" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="696.5" y="66.2041">http Proxy</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="36" x="861.5" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="868.5" y="66.2041">PDP</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95" x="917.5" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="924.5" y="66.2041">Resource Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42" x="5" y="1367.2344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="12" y="1383.5166">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="240.5" y="1367.2344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="247.5" y="1383.5166">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="251" y="1395.1572">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="384.5" y="1367.2344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="391.5" y="1383.5166">SM-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="445.5" y="1367.2344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="492" y="1383.5166">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="452.5" y="1395.1572">Authorization Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66" x="689.5" y="1367.2344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="696.5" y="1383.5166">http Proxy</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="36" x="861.5" y="1367.2344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="868.5" y="1383.5166">PDP</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95" x="917.5" y="1367.2344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="924.5" y="1383.5166">Resource Server</text><path d="M10,88.5625 L70,88.5625 L70,92.2031 L60,102.2031 L10,102.2031 L10,88.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="144.2031" style="stroke:#000000;stroke-width:1.5;" width="761.5" x="10" y="88.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="25" y="98.8447">alt</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="771.5" y1="174.4844" y2="174.4844"/><polygon fill="#181818" points="705.5,125.8438,715.5,129.8438,705.5,133.8438,709.5,129.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="711.5" y1="129.8438" y2="129.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="125.4854">[01]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="125.4854">GET /resource</text><polygon fill="#181818" points="42,151.4844,32,155.4844,42,159.4844,38,155.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="716.5" y1="155.4844" y2="155.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="151.126">[02]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="151.126">401 Unauthorized; json body with Well-Known json Document (RFC8414)</text><polygon fill="#181818" points="705.5,195.125,715.5,199.125,705.5,203.125,709.5,199.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="711.5" y1="199.125" y2="199.125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="194.7666">[03]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="194.7666">GET /.well-known/oauth-authorization-server&#160;</text><polygon fill="#181818" points="42,220.7656,32,224.7656,42,228.7656,38,224.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="716.5" y1="224.7656" y2="224.7656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="220.4072">[04]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="220.4072">200 OK; json body with Well-Known json Document (RFC8414)</text><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="73" y1="264.4063" y2="264.4063"/><line style="stroke:#181818;stroke-width:1.0;" x1="73" x2="73" y1="264.4063" y2="277.4063"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="73" y1="277.4063" y2="277.4063"/><polygon fill="#181818" points="42,273.4063,32,277.4063,42,281.4063,38,277.4063" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="260.0479">[05]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="260.0479">generate DPoP keypair</text><path d="M10,289.4063 L70,289.4063 L70,293.0469 L60,303.0469 L10,303.0469 L10,289.4063 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="673.2188" style="stroke:#000000;stroke-width:1.5;" width="728.5" x="10" y="289.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="25" y="299.6885">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="85" y="300.6885">[Client Assertion JWT]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="738.5" y1="821.5" y2="821.5"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="15" y="832.7822">[Use Refresh token]</text><polygon fill="#181818" points="485.5,326.6875,495.5,330.6875,485.5,334.6875,489.5,330.6875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="491.5" y1="330.6875" y2="330.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="326.3291">[06]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="326.3291">GET /nonce</text><polygon fill="#181818" points="42,352.3281,32,356.3281,42,360.3281,38,356.3281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="496.5" y1="356.3281" y2="356.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="351.9697">[07]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="351.9697">return 200 OK new-nonce: nonce</text><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="73" y1="405.25" y2="405.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="73" x2="73" y1="405.25" y2="418.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="73" y1="418.25" y2="418.25"/><polygon fill="#181818" points="42,414.25,32,418.25,42,422.25,38,418.25" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="389.251">[08]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="377.6104">create Client Assertion JWT with nonce</text><text fill="#000000" font-family="Helvetica" font-size="10" x="68" y="389.251">Client and OS Information</text><text fill="#000000" font-family="Helvetica" font-size="10" x="68" y="400.8916">DPoP Thumbprint</text><polygon fill="#181818" points="262,439.8906,272,443.8906,262,447.8906,266,443.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="268" y1="443.8906" y2="443.8906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="439.5322">[09]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="439.5322">externalAuthenticate JWT-hash</text><polygon fill="#181818" points="388,465.5313,398,469.5313,388,473.5313,392,469.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="284" x2="394" y1="469.5313" y2="469.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="291" y="465.1729">[10]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="315" y="465.1729">sign JWT-hash</text><polygon fill="#181818" points="295,491.1719,285,495.1719,295,499.1719,291,495.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="289" x2="399" y1="495.1719" y2="495.1719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="301" y="490.8135">[11]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="325" y="490.8135">JWT-Signature</text><polygon fill="#181818" points="42,516.8125,32,520.8125,42,524.8125,38,520.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="273" y1="520.8125" y2="520.8125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="516.4541">[12]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="516.4541">JWT-signature</text><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="73" y1="558.0938" y2="558.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="73" x2="73" y1="558.0938" y2="571.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="73" y1="571.0938" y2="571.0938"/><polygon fill="#181818" points="42,567.0938,32,571.0938,42,575.0938,38,571.0938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="547.915">[13]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="542.0947">add SM-B Signature to Client Assertion JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="553.7354">cC4h... (Client Assertion JWT)</text><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="73" y1="596.7344" y2="596.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="73" x2="73" y1="596.7344" y2="609.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="73" y1="609.7344" y2="609.7344"/><polygon fill="#181818" points="42,605.7344,32,609.7344,42,613.7344,38,609.7344" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="592.376">[14]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="592.376">create DPoP Proof JWT</text><polygon fill="#181818" points="485.5,689.5781,495.5,693.5781,485.5,697.5781,489.5,693.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="491.5" y1="693.5781" y2="693.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="660.1182">[15]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="631.0166">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="68" y="642.6572">(Client Assertion JWT and DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="654.2979">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="654.2979">DPoP:&#160;eyJh...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="665.9385">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="665.9385">grant_type=urn:ietf:params:oauth:grant-type:jwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="677.5791">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="677.5791">assertion=cC4h...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="689.2197">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="689.2197">scope=...</text><path d="M234.5,706.5781 L234.5,727.5781 L497.5,727.5781 L497.5,716.5781 L487.5,706.5781 L234.5,706.5781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M487.5,706.5781 L487.5,716.5781 L497.5,716.5781 L487.5,706.5781 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="240.5" y="720.8604">RFC7523 (JWT Client Assertion), RFC9449 (DPoP)</text><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="549.5" y1="750.8594" y2="750.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="549.5" x2="549.5" y1="750.8594" y2="763.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="508.5" x2="549.5" y1="763.8594" y2="763.8594"/><polygon fill="#181818" points="518.5,759.8594,508.5,763.8594,518.5,767.8594,514.5,763.8594" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="746.501">[16]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="746.501">verify Client Assertion JWT, DPoP</text><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="549.5" y1="789.5" y2="789.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="549.5" x2="549.5" y1="789.5" y2="802.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="508.5" x2="549.5" y1="802.5" y2="802.5"/><polygon fill="#181818" points="518.5,798.5,508.5,802.5,518.5,806.5,514.5,802.5" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="785.1416">[17]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="785.1416">Create state for Identity/App/Device</text><polygon fill="#181818" points="485.5,911.9844,495.5,915.9844,485.5,919.9844,489.5,915.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="491.5" y1="915.9844" y2="915.9844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="882.5244">[18]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="853.4229">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="68" y="865.0635">(Refresh token and DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="876.7041">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="876.7041">grant_type=refresh_token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="888.3447">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="888.3447">refresh_token=eyJ0...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="899.9854">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="899.9854">scope=...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="911.626">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="911.626">DPoP:&#160;eyJh...</text><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="549.5" y1="941.625" y2="941.625"/><line style="stroke:#181818;stroke-width:1.0;" x1="549.5" x2="549.5" y1="941.625" y2="954.625"/><line style="stroke:#181818;stroke-width:1.0;" x1="508.5" x2="549.5" y1="954.625" y2="954.625"/><polygon fill="#181818" points="518.5,950.625,508.5,954.625,518.5,958.625,514.5,954.625" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="937.2666">[19]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="937.2666">verify Refresh token, DPoP</text><polygon fill="#181818" points="862.5,990.2656,872.5,994.2656,862.5,998.2656,866.5,994.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="868.5" y1="994.2656" y2="994.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="989.9072">[20]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="989.9072">POST /v1/data/authz, json body {  "input": {...}}</text><polygon fill="#181818" points="518.5,1015.9063,508.5,1019.9063,518.5,1023.9063,514.5,1019.9063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="512.5" x2="873.5" y1="1019.9063" y2="1019.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="524.5" y="1015.5479">[21]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="548.5" y="1015.5479">200 OK, json body {"result": {"allow": true, ...}}</text><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="549.5" y1="1045.5469" y2="1045.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="549.5" x2="549.5" y1="1045.5469" y2="1058.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="508.5" x2="549.5" y1="1058.5469" y2="1058.5469"/><polygon fill="#181818" points="518.5,1054.5469,508.5,1058.5469,518.5,1062.5469,514.5,1058.5469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="1041.1885">[22]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="1041.1885">issue tokens</text><polygon fill="#181818" points="42,1080.1875,32,1084.1875,42,1088.1875,38,1084.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="496.5" y1="1084.1875" y2="1084.1875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="1079.8291">[23]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="1079.8291">200 OK, access token, refresh token, bound to DPoP</text><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="73" y1="1109.8281" y2="1109.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="73" x2="73" y1="1109.8281" y2="1122.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="73" y1="1122.8281" y2="1122.8281"/><polygon fill="#181818" points="42,1118.8281,32,1122.8281,42,1126.8281,38,1122.8281" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="1105.4697">[24]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="1105.4697">Create DPoP Proof for RS</text><polygon fill="#181818" points="705.5,1144.4688,715.5,1148.4688,705.5,1152.4688,709.5,1148.4688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="711.5" y1="1148.4688" y2="1148.4688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="1144.1104">[25]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="1144.1104">GET /resource (access token, DPoP)</text><line style="stroke:#181818;stroke-width:1.0;" x1="727.5" x2="769.5" y1="1185.75" y2="1185.75"/><line style="stroke:#181818;stroke-width:1.0;" x1="769.5" x2="769.5" y1="1185.75" y2="1198.75"/><line style="stroke:#181818;stroke-width:1.0;" x1="728.5" x2="769.5" y1="1198.75" y2="1198.75"/><polygon fill="#181818" points="738.5,1194.75,728.5,1198.75,738.5,1202.75,734.5,1198.75" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="734.5" y="1175.5713">[26]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="758.5" y="1169.751">verify access token and</text><text fill="#000000" font-family="Helvetica" font-size="10" x="758.5" y="1181.3916">DPoP Binding</text><polygon fill="#181818" points="948,1232.0313,958,1236.0313,948,1240.0313,952,1236.0313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="727.5" x2="954" y1="1236.0313" y2="1236.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="734.5" y="1225.8525">[27]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="758.5" y="1220.0322">forward GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="758.5" y="1231.6729">(access token, DPoP)</text><line style="stroke:#181818;stroke-width:1.0;" x1="970" x2="1012" y1="1284.9531" y2="1284.9531"/><line style="stroke:#181818;stroke-width:1.0;" x1="1012" x2="1012" y1="1284.9531" y2="1297.9531"/><line style="stroke:#181818;stroke-width:1.0;" x1="971" x2="1012" y1="1297.9531" y2="1297.9531"/><polygon fill="#181818" points="981,1293.9531,971,1297.9531,981,1301.9531,977,1297.9531" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="977" y="1268.9541">[28]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1001" y="1257.3135">provide</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1001" y="1268.9541">resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1001" y="1280.5947">access</text><polygon fill="#181818" points="738.5,1319.5938,728.5,1323.5938,738.5,1327.5938,734.5,1323.5938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="732.5" x2="959" y1="1323.5938" y2="1323.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="744.5" y="1319.2354">[29]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="768.5" y="1319.2354">200 OK, resource</text><polygon fill="#181818" points="42,1345.2344,32,1349.2344,42,1353.2344,38,1349.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="716.5" y1="1349.2344" y2="1349.2344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="1344.876">[30]</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="1344.876">200 OK, resource</text><!--SRC=[hLPjJ-D64FxkNp7rVG49aq1JjUUAIf1mm74SKPmJQflgjCIJU2_EhhMxJWYd-o_zBVrbdLtRiKDCsmz5EZXxdvbdvfcNDSkD5Fdo4HNultUxV_YUNd2HCSMM4EECvQbv9uM9-3F2IRVzy2DR8bnZkaB3fwo16HIOEocapjWKuoswBtF5KJMmAOgvISxZBxas8AH0p_ikKso-P61GFeDHERqYB77mZ0a3_PIZCDwZV0B_m-MD3s-k4gdDGy8DUa0_JV2j508NHYfW6lpwIQg96Dy4LypWcctyFRlexi9PH7V1XU-XY87ul8Bq0er2Jj8HzVYoV_tn_iFzrQ_EXJl_RKmnKZeE434HRowKN0i7UCbpdfiaSap3o-54s4Uf-3CpN0g8KAsiarRBww4pIup9OAZaKvd4IzXmKE3eRm6WN6mgLRJZ6pWzxiA0DAK2l1amjOYGNId4ze17HRGZr5JAALOnDbrlrM9JmrUaS5KobX93NQVYBGI_K2uXN5sEeQDAj-vyQtuzTC-KSK3WmYo4NlS4FWbMAeRnp_15asYFCjx0cfi47Z1DWrj1qXSd0pdDbvRnOFIk_rFlf7VetCRO9C9K8xmMtl7QkbnObnrfcGFMB5YWdHX__VbVmZ_jTk7-zdyAMiIULyTRKSnHeBAGmL0EOO6RZ77bgb1YppL5x5hj_SEuuS1rPPappIJLOylcZhoYRPlfA3Iv4cLM870TECCG2llzuAOAwzROZQHGmXbEnBOGD4Xm7y6Dc4crT7hRGvVQEA5LbYbEFLOJROSz17oYOHGijM7JAMqhOYQY864wgNFRMdZreY17j0j2q7mkMapepBExOfVFuY8oOAG9UerQMVYExqeDQw7RBEgOMZHaSGnsGy6M38nibNGYflrUSdny30TjnuUl5yW9J0j6pjgRP7WVKPSOkK1NZrRthdREaUMoCD-tZrIPpNiRbUyNB-UATindiydmZBefv6XceRidTEZcBNI0m0B2BsiJF29Jj7rAQrPndfN9LWTwAicZU-49IKcbE3D06HNT342pzUCFfz_3WGtsPGQ7H_RyRQ_t5Wvir8Tkmra_rHninQ3fvxDDQmMEd01x5lr2PMtiR-fik8bjXvfDvppBEWDSSPeUjvG-qRyHpcX59k3a_lTQxC3RYj3GMnNOpmvR2RVpyeoArMrNjRMahwcp4rKfYzjWMpnTLbKogvDEp0phsEe_7pMsvLTYf8-8tFWXV2M-Rz-W7ajouDcRBwZ9Yysquu7Iq_ITOXtuB4tbclvdlpUEmFbhZg5r-38ThdMEHHQwPIDMX6mwHQshRDLkyeyofwhGq3eL6eH5P-vFPNzlActJZABcUjYxJk5WDuYYYvitYBsS2iEoI4q3spaJuIWlk8Yvc9Vu4Qb0z6kcubt2YVXdHeft55KUCYLNF2QRshemTfWoh4hDxHT2GolordgvjgElXozi6q_bXyhV]--></g></svg>