<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1518px" preserveAspectRatio="none" style="width:1212px;height:1518px;background:#FFFFFF;" version="1.1" viewBox="0 0 1212 1518" width="1212px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="1506.0781" style="stroke:#181818;stroke-width:0.5;" width="438.6836" x="11" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="221.8799" y="15.2822">LEI</text><rect fill="#C9FFC9" height="1506.0781" style="stroke:#181818;stroke-width:0.5;" width="715.479" x="461.6836" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="792.824" y="15.2822">Betreiber</text><rect fill="#F4A460" height="1489.4375" style="stroke:#181818;stroke-width:0.5;" width="598.979" x="461.6836" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="732.2302" y="31.9229">ZT Cluster</text><rect fill="#8FBC8F" height="1489.4375" style="stroke:#181818;stroke-width:0.5;" width="104.5" x="1072.6626" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1087.3809" y="31.9229">TI 2.0 Dienst</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="36.4751" x2="36.4751" y1="76.5625" y2="1467.7969"/><rect fill="#FFFFFF" height="1365.2344" style="stroke:#181818;stroke-width:1.0;" width="10" x="31.4751" y="84.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="296.4185" x2="296.4185" y1="76.5625" y2="1467.7969"/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1.0;" width="10" x="291.4185" y="416.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="425.9614" x2="425.9614" y1="76.5625" y2="1467.7969"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="420.9614" y="442.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="498.5845" x2="498.5845" y1="76.5625" y2="1467.7969"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="493.5845" y="129.8438"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="493.5845" y="210.7656"/><rect fill="#FFFFFF" height="239.4063" style="stroke:#181818;stroke-width:1.0;" width="10" x="493.5845" y="1210.3906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="719.7241" x2="719.7241" y1="76.5625" y2="1467.7969"/><rect fill="#FFFFFF" height="819.1406" style="stroke:#181818;stroke-width:1.0;" width="10" x="714.7241" y="303.6875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1016.3765" x2="1016.3765" y1="76.5625" y2="1467.7969"/><rect fill="#FFFFFF" height="37.2813" style="stroke:#181818;stroke-width:1.0;" width="10" x="1011.3765" y="1009.625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1124.9126" x2="1124.9126" y1="76.5625" y2="1467.7969"/><rect fill="#FFFFFF" height="87.5625" style="stroke:#181818;stroke-width:1.0;" width="10" x="1119.9126" y="1336.5938"/><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="15" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="22" y="66.2041">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="256.9917" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="263.9917" y="54.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="267.998" y="66.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="39.4443" x="406.2393" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="413.2393" y="66.2041">SM-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="465.6836" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="489.395" y="54.5635">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="472.6836" y="66.2041">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="661.2495" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="709.8438" y="54.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="668.2495" y="66.2041">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="976.0903" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1006.4961" y="54.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="983.0903" y="66.2041">Policy Engine</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.5" x="1076.6626" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1083.6626" y="66.2041">Resource Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="15" y="1467.7969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="22" y="1484.0791">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="256.9917" y="1467.7969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="263.9917" y="1484.0791">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="267.998" y="1495.7197">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="39.4443" x="406.2393" y="1467.7969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="413.2393" y="1484.0791">SM-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="465.6836" y="1467.7969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="489.395" y="1484.0791">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="472.6836" y="1495.7197">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="661.2495" y="1467.7969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="709.8438" y="1484.0791">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="668.2495" y="1495.7197">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="976.0903" y="1467.7969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1006.4961" y="1484.0791">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="983.0903" y="1495.7197">Policy Engine</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.5" x="1076.6626" y="1467.7969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1083.6626" y="1484.0791">Resource Server</text><path d="M20.4751,88.5625 L80.4312,88.5625 L80.4312,92.2031 L70.4312,102.2031 L20.4751,102.2031 L20.4751,88.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="155.8438" style="stroke:#000000;stroke-width:1.5;" width="499.1094" x="20.4751" y="88.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="35.4751" y="98.8447">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="95.4312" y="99.8447">[Client has no Authorization Server FQDN]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20.4751" x2="519.5845" y1="174.4844" y2="174.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="25.4751" y="185.7666">[Client has Authorization Server FQDN]</text><polygon fill="#181818" points="481.5845,125.8438,491.5845,129.8438,481.5845,133.8438,485.5845,129.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="487.5845" y1="129.8438" y2="129.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="125.4854">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="125.4854">GET /resource</text><polygon fill="#181818" points="52.4751,151.4844,42.4751,155.4844,52.4751,159.4844,48.4751,155.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.4751" x2="492.5845" y1="155.4844" y2="155.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="151.126">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="151.126">401 Unauthorized; json body with Well-Known json Document (RFC8414)</text><polygon fill="#181818" points="481.5845,206.7656,491.5845,210.7656,481.5845,214.7656,485.5845,210.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="487.5845" y1="210.7656" y2="210.7656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="206.4072">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="206.4072">GET /.well-known/oauth-authorization-server&#160;</text><polygon fill="#181818" points="52.4751,232.4063,42.4751,236.4063,52.4751,240.4063,48.4751,236.4063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.4751" x2="492.5845" y1="236.4063" y2="236.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="232.0479">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="232.0479">200 OK; json body with Well-Known json Document (RFC8414)</text><path d="M20.4751,262.4063 L80.4312,262.4063 L80.4312,266.0469 L70.4312,276.0469 L20.4751,276.0469 L20.4751,262.4063 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="715.5781" style="stroke:#000000;stroke-width:1.5;" width="964.46" x="20.4751" y="262.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="35.4751" y="272.6885">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="95.4312" y="273.6885">[Client has no valid refresh token]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20.4751" x2="984.9351" y1="782.8594" y2="782.8594"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="25.4751" y="794.1416">[Client has valid Refresh token]</text><polygon fill="#181818" points="702.7241,299.6875,712.7241,303.6875,702.7241,307.6875,706.7241,303.6875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="708.7241" y1="303.6875" y2="303.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="299.3291">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="299.3291">GET /nonce</text><polygon fill="#181818" points="52.4751,325.3281,42.4751,329.3281,52.4751,333.3281,48.4751,329.3281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.4751" x2="713.7241" y1="329.3281" y2="329.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="324.9697">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="324.9697">return 200 OK new-nonce: nonce</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="378.25" y2="378.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="378.25" y2="391.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="391.25" y2="391.25"/><polygon fill="#181818" points="52.4751,387.25,42.4751,391.25,52.4751,395.25,48.4751,391.25" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="362.251">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="350.6104">create Client Assertion JWT with nonce</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="362.251">Client and OS Information</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="373.8916">DPoP Thumbprint</text><polygon fill="#181818" points="279.4185,412.8906,289.4185,416.8906,279.4185,420.8906,283.4185,416.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="285.4185" y1="416.8906" y2="416.8906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="412.5322">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="412.5322">externalAuthenticate JWT-hash</text><polygon fill="#181818" points="408.9614,438.5313,418.9614,442.5313,408.9614,446.5313,412.9614,442.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="301.4185" x2="414.9614" y1="442.5313" y2="442.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="308.4185" y="438.1729">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.9458" y="438.1729">sign JWT-hash</text><polygon fill="#181818" points="312.4185,464.1719,302.4185,468.1719,312.4185,472.1719,308.4185,468.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="306.4185" x2="419.9614" y1="468.1719" y2="468.1719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="318.4185" y="463.8135">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="342.9458" y="463.8135">JWT-Signature</text><polygon fill="#181818" points="52.4751,489.8125,42.4751,493.8125,52.4751,497.8125,48.4751,493.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="46.4751" x2="290.4185" y1="493.8125" y2="493.8125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="489.4541">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="489.4541">JWT-signature</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="531.0938" y2="531.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="531.0938" y2="544.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="544.0938" y2="544.0938"/><polygon fill="#181818" points="52.4751,540.0938,42.4751,544.0938,52.4751,548.0938,48.4751,544.0938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="520.915">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="515.0947">add SM-B Signature to Client Assertion JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="526.7354">cC4h... (Client Assertion JWT)</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="569.7344" y2="569.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="569.7344" y2="582.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="582.7344" y2="582.7344"/><polygon fill="#181818" points="52.4751,578.7344,42.4751,582.7344,52.4751,586.7344,48.4751,582.7344" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="565.376">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="565.376">create DPoP JWT with nonce</text><polygon fill="#181818" points="702.7241,650.9375,712.7241,654.9375,702.7241,658.9375,706.7241,654.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="708.7241" y1="654.9375" y2="654.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="627.2979">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="604.0166">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="615.6572">Content-Type: application/x-www-form-urlencoded</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="627.2979">DPoP: ... (DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="638.9385">grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="650.5791">assertion=eyJh... (Client Assertion JWT)</text><path d="M448.3286,667.9375 L448.3286,688.9375 L714.3286,688.9375 L714.3286,677.9375 L704.3286,667.9375 L448.3286,667.9375 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M704.3286,667.9375 L704.3286,677.9375 L714.3286,677.9375 L704.3286,667.9375 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="454.3286" y="682.2197">RFC7523 (JWT Client Assertion), RFC9449 (DPoP)</text><line style="stroke:#181818;stroke-width:1.0;" x1="724.7241" x2="766.7241" y1="712.2188" y2="712.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="766.7241" x2="766.7241" y1="712.2188" y2="725.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="725.7241" x2="766.7241" y1="725.2188" y2="725.2188"/><polygon fill="#181818" points="735.7241,721.2188,725.7241,725.2188,735.7241,729.2188,731.7241,725.2188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="731.7241" y="707.8604">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="756.2515" y="707.8604">verify Client Assertion JWT and DPoP JWT</text><line style="stroke:#181818;stroke-width:1.0;" x1="724.7241" x2="766.7241" y1="750.8594" y2="750.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="766.7241" x2="766.7241" y1="750.8594" y2="763.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="725.7241" x2="766.7241" y1="763.8594" y2="763.8594"/><polygon fill="#181818" points="735.7241,759.8594,725.7241,763.8594,735.7241,767.8594,731.7241,763.8594" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="731.7241" y="746.501">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="756.2515" y="746.501">Create state for Identity/App/Device</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="819.1406" y2="819.1406"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="819.1406" y2="832.1406"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="832.1406" y2="832.1406"/><polygon fill="#181818" points="52.4751,828.1406,42.4751,832.1406,52.4751,836.1406,48.4751,832.1406" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="814.7822">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="814.7822">create DPoP JWT without nonce</text><polygon fill="#181818" points="702.7241,888.7031,712.7241,892.7031,702.7241,896.7031,706.7241,892.7031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="708.7241" y1="892.7031" y2="892.7031"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="870.8838">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="853.4229">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="865.0635">DPoP: ... (DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="876.7041">grant_type=refresh_token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="888.3447">refresh_token= ... (Refresh token)</text><line style="stroke:#181818;stroke-width:1.0;" x1="724.7241" x2="766.7241" y1="918.3438" y2="918.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="766.7241" x2="766.7241" y1="918.3438" y2="931.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="725.7241" x2="766.7241" y1="931.3438" y2="931.3438"/><polygon fill="#181818" points="735.7241,927.3438,725.7241,931.3438,735.7241,935.3438,731.7241,931.3438" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="731.7241" y="913.9854">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="756.2515" y="913.9854">verify Refresh token and DPoP JWT</text><line style="stroke:#181818;stroke-width:1.0;" x1="724.7241" x2="766.7241" y1="956.9844" y2="956.9844"/><line style="stroke:#181818;stroke-width:1.0;" x1="766.7241" x2="766.7241" y1="956.9844" y2="969.9844"/><line style="stroke:#181818;stroke-width:1.0;" x1="725.7241" x2="766.7241" y1="969.9844" y2="969.9844"/><polygon fill="#181818" points="735.7241,965.9844,725.7241,969.9844,735.7241,973.9844,731.7241,969.9844" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="731.7241" y="952.626">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="756.2515" y="952.626">invalidate Refresh token</text><polygon fill="#181818" points="999.3765,1005.625,1009.3765,1009.625,999.3765,1013.625,1003.3765,1009.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="724.7241" x2="1005.3765" y1="1009.625" y2="1009.625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="731.7241" y="1005.2666">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="756.2515" y="1005.2666">POST /v1/data/authz, json body {  "input": {...}}</text><polygon fill="#181818" points="735.7241,1042.9063,725.7241,1046.9063,735.7241,1050.9063,731.7241,1046.9063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="729.7241" x2="1010.3765" y1="1046.9063" y2="1046.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="741.7241" y="1036.7275">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="766.2515" y="1030.9072">200 OK, json body {"result": {"allow": true,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="766.2515" y="1042.5479">"access_token_attributes": {...}}</text><line style="stroke:#181818;stroke-width:1.0;" x1="724.7241" x2="766.7241" y1="1084.1875" y2="1084.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="766.7241" x2="766.7241" y1="1084.1875" y2="1097.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="725.7241" x2="766.7241" y1="1097.1875" y2="1097.1875"/><polygon fill="#181818" points="735.7241,1093.1875,725.7241,1097.1875,735.7241,1101.1875,731.7241,1097.1875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="731.7241" y="1074.0088">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="756.2515" y="1068.1885">issue Access and Refresh token with DPoP Binding</text><text fill="#000000" font-family="Helvetica" font-size="10" x="762.6089" y="1079.8291">and Access token attributes</text><polygon fill="#181818" points="52.4751,1118.8281,42.4751,1122.8281,52.4751,1126.8281,48.4751,1122.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.4751" x2="713.7241" y1="1122.8281" y2="1122.8281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="1118.4697">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="1118.4697">200 OK, Access token, Refresh token, bound to DPoP</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="1148.4688" y2="1148.4688"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="1148.4688" y2="1161.4688"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="1161.4688" y2="1161.4688"/><polygon fill="#181818" points="52.4751,1157.4688,42.4751,1161.4688,52.4751,1165.4688,48.4751,1161.4688" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="1144.1104">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="1144.1104">Create DPoP Proof for RS</text><polygon fill="#181818" points="481.5845,1206.3906,491.5845,1210.3906,481.5845,1214.3906,485.5845,1210.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="487.5845" y1="1210.3906" y2="1210.3906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="1194.3916">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="1182.751">GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="1194.3916">Authorization: DPoP ... (Accesss token)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="1206.0322">DPoP: ... (DPoP token)</text><line style="stroke:#181818;stroke-width:1.0;" x1="503.5845" x2="545.5845" y1="1236.0313" y2="1236.0313"/><line style="stroke:#181818;stroke-width:1.0;" x1="545.5845" x2="545.5845" y1="1236.0313" y2="1249.0313"/><line style="stroke:#181818;stroke-width:1.0;" x1="504.5845" x2="545.5845" y1="1249.0313" y2="1249.0313"/><polygon fill="#181818" points="514.5845,1245.0313,504.5845,1249.0313,514.5845,1253.0313,510.5845,1249.0313" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="510.5845" y="1231.6729">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="535.1118" y="1231.6729">verify Access token and DPoP Proof</text><line style="stroke:#181818;stroke-width:1.0;" x1="503.5845" x2="545.5845" y1="1286.3125" y2="1286.3125"/><line style="stroke:#181818;stroke-width:1.0;" x1="545.5845" x2="545.5845" y1="1286.3125" y2="1299.3125"/><line style="stroke:#181818;stroke-width:1.0;" x1="504.5845" x2="545.5845" y1="1299.3125" y2="1299.3125"/><polygon fill="#181818" points="514.5845,1295.3125,504.5845,1299.3125,514.5845,1303.3125,510.5845,1299.3125" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="510.5845" y="1276.1338">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="535.1118" y="1270.3135">additional checks according to</text><text fill="#000000" font-family="Helvetica" font-size="10" x="535.1118" y="1281.9541">Access token attributes</text><polygon fill="#181818" points="1107.9126,1332.5938,1117.9126,1336.5938,1107.9126,1340.5938,1111.9126,1336.5938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="503.5845" x2="1113.9126" y1="1336.5938" y2="1336.5938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="510.5845" y="1326.415">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="535.1118" y="1320.5947">forward GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="535.1118" y="1332.2354">with header and header content as json</text><line style="stroke:#181818;stroke-width:1.0;" x1="1129.9126" x2="1171.9126" y1="1385.5156" y2="1385.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="1171.9126" x2="1171.9126" y1="1385.5156" y2="1398.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="1130.9126" x2="1171.9126" y1="1398.5156" y2="1398.5156"/><polygon fill="#181818" points="1140.9126,1394.5156,1130.9126,1398.5156,1140.9126,1402.5156,1136.9126,1398.5156" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1136.9126" y="1369.5166">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1161.4399" y="1357.876">provide</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1161.4399" y="1369.5166">resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1161.4399" y="1381.1572">access</text><polygon fill="#181818" points="514.5845,1420.1563,504.5845,1424.1563,514.5845,1428.1563,510.5845,1424.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="508.5845" x2="1118.9126" y1="1424.1563" y2="1424.1563"/><text fill="#000000" font-family="Helvetica" font-size="10" x="520.5845" y="1419.7979">(31)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="545.1118" y="1419.7979">200 OK, resource</text><polygon fill="#181818" points="52.4751,1445.7969,42.4751,1449.7969,52.4751,1453.7969,48.4751,1449.7969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.4751" x2="492.5845" y1="1449.7969" y2="1449.7969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="1445.4385">(32)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="1445.4385">200 OK, resource</text><!--SRC=[hLRhRjis5FwlfpXJCI06ejX9NMpra06ExLoQ9j4i3y66004ZqHPZcHGeoevJz5tsB7so7b9tHyawO7ziIUVodVET2qbI9NYwUg0IxBrUhsDRoPBnc4YoWe3EIHgfKy6Lnvuf7FRQXTTaHU6SHckgc4zgEkDCvqfmaSJ4fq6fFHAfP5JMT2FA5oeS1ezfee0BJYthfrYInOg0ek8Pb4pnquDu0llpvCA6TsUXIDHjo1Ir0D07OhEOS0MZY56kTZvU2ixfKWa9906xUXFoZiykd3EYw8PixHqhx-h4w7jNpebjKHu01f17SKALf0o9mrXcaz7vzStdcxE_q86H_Zt3E30L8_O83xOdKcmuYfi8vwu1S2Vk7G-LYi6Luid4qTGRUfdU6FM6gGg5PCz4CS71etAjKLwOk9FAn1KHyxSmuGl6gVQEkUXK80jtTW571pqO8t78_hinaKkFaZD9wSk8fraaKvfW3NrQu5S-Ivg8hzWQYIqgGgAYE12Y2owWBHCu_MDyZTvoJUTtv6W0PvCPT6MEYTBIzxcBRyYYWugPoG3wlKFuavFSEGr-WyS4_J-8O0iRfaAufL7aN78iI2OP2pzTQRIzwUder_vXluDE0re7eL52wz7_nz0FDXfogI6xGaVcaBe39p4ElltpRwaTzNfmS_c_9CG3osgfoPf4B019vyXs24eiiGUgX8PUdX2EA1QYT3ZqB6pHUgIIgbJoF63WTECOam5abfNBmi2Nj6eM62P8YU7sq-qiIz8Otl6INvmgkF7WWi-5N1aQjN3i2XTc8UwqM3BikWgedFe1q2USJ4uYNKMKujf2P0Hoa8ImoggqiAgDWOvmBGmWOGlUOe8oIw-D9fxMyz2082VKgXL2gpTy5sneYwJDeegfXKCI1A2N5PHWMC5MIk-uF-g71mS7iDScxhnU84DmioWx3UBUUDWXfdLCkN3hezIPRMCiFudZIFEDGDqdPxFPEBfyJYhn1F15G8EYY0CmqHLm7Vrz8N45tIjqT8pDzVFx8QDgZd_c34dmmSmM_Xj5HolYo-D6EG-KI2gr3rBaUKotdzvYW0lCDg9p1MAk6nm0X-cN3qVlOK-dlslKsTVoZ_t-nopeZjc4seaPZOmQ778stxOtkUxd8jkQoIYZFL7w5xc2Yq2thDfsXt7S7TCrmmAys4_P64zV6UEtIYfIzIDL_O4IvKlalhHfV3ZEZ1iXTbvIrP2_nX7Z9b-TIpDbi-KoFNTIvB0-xA8gwUfUUTwlxT8l03PUI59b3-0BHlVrArIJxKuiF5AT737RQmrZ6t7nkgDjRH95OeDF-jgoVyTjuliqIRB4xubIaZsaYYObJdt24QYMMPAak5wDkSc-oOUPGKF82UC1umlJuQYMM-IibO2xMxf8eww-tyJOn_HIz8YBH0FL8yMXQ6cgKQsfy3g3mwExTkfPRnpfEkp6aJh8x4sBPC7bqNNQcYzldlhvfW_E32Xlf2OZHH-P06lAk46PnYSH-27rbqYwxmkfgKLJl7ozmclcOOeLmsGtH0Qx-PbAXPG4U4_GwFcZdor7VQVIhLIbW7nDlS9dBCMQ1UYbyfTrbD79GozgMLwJQfL2RwqtYNRjStV7jlQMN-Q-0m00]--></g></svg>