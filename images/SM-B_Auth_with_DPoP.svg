<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1429px" preserveAspectRatio="none" style="width:1072px;height:1429px;background:#FFFFFF;" version="1.1" viewBox="0 0 1072 1429" width="1072px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="1417.1563" style="stroke:#181818;stroke-width:0.5;" width="193" x="236.5" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="325.5" y="15.2822">LEI</text><rect fill="#C9FFC9" height="1417.1563" style="stroke:#181818;stroke-width:0.5;" width="597" x="441.5" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="713.5" y="15.2822">Betreiber</text><rect fill="#F4A460" height="1400.5156" style="stroke:#181818;stroke-width:0.5;" width="482" x="441.5" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="654" y="31.9229">ZT Cluster</text><rect fill="#8FBC8F" height="1400.5156" style="stroke:#181818;stroke-width:0.5;" width="103" x="935.5" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="950.5" y="31.9229">TI 2.0 Dienst</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="26" x2="26" y1="76.5625" y2="1378.875"/><rect fill="#FFFFFF" height="1276.3125" style="stroke:#181818;stroke-width:1.0;" width="10" x="21" y="84.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="279" x2="279" y1="76.5625" y2="1378.875"/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1.0;" width="10" x="274" y="455.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="405" x2="405" y1="76.5625" y2="1378.875"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="400" y="481.1719"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="502.5" x2="502.5" y1="76.5625" y2="1378.875"/><rect fill="#FFFFFF" height="753.5" style="stroke:#181818;stroke-width:1.0;" width="10" x="497.5" y="342.3281"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="744.5" x2="744.5" y1="76.5625" y2="1378.875"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="739.5" y="129.8438"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="739.5" y="210.7656"/><rect fill="#FFFFFF" height="200.7656" style="stroke:#181818;stroke-width:1.0;" width="10" x="739.5" y="1160.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="901.5" x2="901.5" y1="76.5625" y2="1378.875"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="896.5" y="967.2656"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="987" x2="987" y1="76.5625" y2="1378.875"/><rect fill="#FFFFFF" height="87.5625" style="stroke:#181818;stroke-width:1.0;" width="10" x="982" y="1247.6719"/><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42" x="5" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="12" y="66.2041">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="240.5" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="247.5" y="54.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="251" y="66.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="384.5" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="391.5" y="66.2041">SM-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="445.5" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="492" y="54.5635">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="452.5" y="66.2041">Authorization Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66" x="711.5" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="718.5" y="66.2041">http Proxy</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="36" x="883.5" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="890.5" y="66.2041">PDP</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95" x="939.5" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="946.5" y="66.2041">Resource Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42" x="5" y="1378.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="12" y="1395.1572">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="240.5" y="1378.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="247.5" y="1395.1572">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="251" y="1406.7979">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="384.5" y="1378.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="391.5" y="1395.1572">SM-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="445.5" y="1378.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="492" y="1395.1572">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="452.5" y="1406.7979">Authorization Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66" x="711.5" y="1378.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="718.5" y="1395.1572">http Proxy</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="36" x="883.5" y="1378.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="890.5" y="1395.1572">PDP</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95" x="939.5" y="1378.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="946.5" y="1395.1572">Resource Server</text><path d="M10,88.5625 L70,88.5625 L70,92.2031 L60,102.2031 L10,102.2031 L10,88.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="155.8438" style="stroke:#000000;stroke-width:1.5;" width="783.5" x="10" y="88.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="25" y="98.8447">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="85" y="99.8447">[Client has no Authorization Server FQDN]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="793.5" y1="174.4844" y2="174.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="15" y="185.7666">[Client has Authorization Server FQDN]</text><polygon fill="#181818" points="727.5,125.8438,737.5,129.8438,727.5,133.8438,731.5,129.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="733.5" y1="129.8438" y2="129.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="125.4854">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="125.4854">GET /resource</text><polygon fill="#181818" points="42,151.4844,32,155.4844,42,159.4844,38,155.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="738.5" y1="155.4844" y2="155.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="151.126">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="151.126">401 Unauthorized; json body with Well-Known json Document (RFC8414)</text><polygon fill="#181818" points="727.5,206.7656,737.5,210.7656,727.5,214.7656,731.5,210.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="733.5" y1="210.7656" y2="210.7656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="206.4072">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="206.4072">GET /.well-known/oauth-authorization-server&#160;</text><polygon fill="#181818" points="42,232.4063,32,236.4063,42,240.4063,38,236.4063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="738.5" y1="236.4063" y2="236.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="232.0479">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="232.0479">200 OK; json body with Well-Known json Document (RFC8414)</text><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="73" y1="276.0469" y2="276.0469"/><line style="stroke:#181818;stroke-width:1.0;" x1="73" x2="73" y1="276.0469" y2="289.0469"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="73" y1="289.0469" y2="289.0469"/><polygon fill="#181818" points="42,285.0469,32,289.0469,42,293.0469,38,289.0469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="271.6885">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="271.6885">generate DPoP keypair</text><path d="M10,301.0469 L70,301.0469 L70,304.6875 L60,314.6875 L10,314.6875 L10,301.0469 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="634.5781" style="stroke:#000000;stroke-width:1.5;" width="750.5" x="10" y="301.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="25" y="311.3291">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="85" y="312.3291">[Client has no valid refrash token]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="760.5" y1="794.5" y2="794.5"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="15" y="805.7822">[Client has valid Refresh token]</text><polygon fill="#181818" points="485.5,338.3281,495.5,342.3281,485.5,346.3281,489.5,342.3281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="491.5" y1="342.3281" y2="342.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="337.9697">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="337.9697">GET /nonce</text><polygon fill="#181818" points="42,363.9688,32,367.9688,42,371.9688,38,367.9688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="496.5" y1="367.9688" y2="367.9688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="363.6104">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="363.6104">return 200 OK new-nonce: nonce</text><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="73" y1="416.8906" y2="416.8906"/><line style="stroke:#181818;stroke-width:1.0;" x1="73" x2="73" y1="416.8906" y2="429.8906"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="73" y1="429.8906" y2="429.8906"/><polygon fill="#181818" points="42,425.8906,32,429.8906,42,433.8906,38,429.8906" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="400.8916">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="389.251">create Client Assertion JWT with nonce</text><text fill="#000000" font-family="Helvetica" font-size="10" x="68" y="400.8916">Client and OS Information</text><text fill="#000000" font-family="Helvetica" font-size="10" x="68" y="412.5322">DPoP Thumbprint</text><polygon fill="#181818" points="262,451.5313,272,455.5313,262,459.5313,266,455.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="268" y1="455.5313" y2="455.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="451.1729">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="451.1729">externalAuthenticate JWT-hash</text><polygon fill="#181818" points="388,477.1719,398,481.1719,388,485.1719,392,481.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="284" x2="394" y1="481.1719" y2="481.1719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="291" y="476.8135">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="315" y="476.8135">sign JWT-hash</text><polygon fill="#181818" points="295,502.8125,285,506.8125,295,510.8125,291,506.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="289" x2="399" y1="506.8125" y2="506.8125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="301" y="502.4541">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="325" y="502.4541">JWT-Signature</text><polygon fill="#181818" points="42,528.4531,32,532.4531,42,536.4531,38,532.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="273" y1="532.4531" y2="532.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="528.0947">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="528.0947">JWT-signature</text><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="73" y1="569.7344" y2="569.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="73" x2="73" y1="569.7344" y2="582.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="73" y1="582.7344" y2="582.7344"/><polygon fill="#181818" points="42,578.7344,32,582.7344,42,586.7344,38,582.7344" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="559.5557">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="553.7354">add SM-B Signature to Client Assertion JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="565.376">cC4h... (Client Assertion JWT)</text><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="73" y1="608.375" y2="608.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="73" x2="73" y1="608.375" y2="621.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="73" y1="621.375" y2="621.375"/><polygon fill="#181818" points="42,617.375,32,621.375,42,625.375,38,621.375" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="604.0166">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="604.0166">create DPoP Proof JWT with nonce</text><polygon fill="#181818" points="485.5,701.2188,495.5,705.2188,485.5,709.2188,489.5,705.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="491.5" y1="705.2188" y2="705.2188"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="671.7588">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="642.6572">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="68" y="654.2979">(Client Assertion JWT and DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="665.9385">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="665.9385">DPoP:&#160;eyJh...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="677.5791">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="677.5791">grant_type=urn:ietf:params:oauth:grant-type:jwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="689.2197">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="689.2197">assertion=cC4h...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="700.8604">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="700.8604">scope=...</text><path d="M234.5,718.2188 L234.5,739.2188 L497.5,739.2188 L497.5,728.2188 L487.5,718.2188 L234.5,718.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M487.5,718.2188 L487.5,728.2188 L497.5,728.2188 L487.5,718.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="240.5" y="732.501">RFC7523 (JWT Client Assertion), RFC9449 (DPoP)</text><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="549.5" y1="762.5" y2="762.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="549.5" x2="549.5" y1="762.5" y2="775.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="508.5" x2="549.5" y1="775.5" y2="775.5"/><polygon fill="#181818" points="518.5,771.5,508.5,775.5,518.5,779.5,514.5,775.5" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="758.1416">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="758.1416">verify Client Assertion JWT and DPoP JWT</text><polygon fill="#181818" points="485.5,884.9844,495.5,888.9844,485.5,892.9844,489.5,888.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="491.5" y1="888.9844" y2="888.9844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="855.5244">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="826.4229">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="68" y="838.0635">(Refresh token and DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="849.7041">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="849.7041">grant_type=refresh_token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="861.3447">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="861.3447">refresh_token=eyJ0...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="872.9854">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="872.9854">scope=...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="884.626">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="884.626">DPoP:&#160;eyJh...</text><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="549.5" y1="914.625" y2="914.625"/><line style="stroke:#181818;stroke-width:1.0;" x1="549.5" x2="549.5" y1="914.625" y2="927.625"/><line style="stroke:#181818;stroke-width:1.0;" x1="508.5" x2="549.5" y1="927.625" y2="927.625"/><polygon fill="#181818" points="518.5,923.625,508.5,927.625,518.5,931.625,514.5,927.625" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="910.2666">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="910.2666">verify Refresh token, DPoP</text><polygon fill="#181818" points="884.5,963.2656,894.5,967.2656,884.5,971.2656,888.5,967.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="890.5" y1="967.2656" y2="967.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="962.9072">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="962.9072">POST /v1/data/authz, json body {  "input": {...}}</text><polygon fill="#181818" points="518.5,988.9063,508.5,992.9063,518.5,996.9063,514.5,992.9063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="512.5" x2="895.5" y1="992.9063" y2="992.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="524.5" y="988.5479">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="548.5" y="988.5479">200 OK, json body {"result": {"allow": true, ...}}</text><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="549.5" y1="1018.5469" y2="1018.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="549.5" x2="549.5" y1="1018.5469" y2="1031.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="508.5" x2="549.5" y1="1031.5469" y2="1031.5469"/><polygon fill="#181818" points="518.5,1027.5469,508.5,1031.5469,518.5,1035.5469,514.5,1031.5469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="1014.1885">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="1014.1885">Create state for Identity/App/Device</text><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="549.5" y1="1057.1875" y2="1057.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="549.5" x2="549.5" y1="1057.1875" y2="1070.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="508.5" x2="549.5" y1="1070.1875" y2="1070.1875"/><polygon fill="#181818" points="518.5,1066.1875,508.5,1070.1875,518.5,1074.1875,514.5,1070.1875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="1052.8291">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="1052.8291">issue tokens</text><polygon fill="#181818" points="42,1091.8281,32,1095.8281,42,1099.8281,38,1095.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="496.5" y1="1095.8281" y2="1095.8281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="1091.4697">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="1091.4697">200 OK, access token, refresh token, bound to DPoP</text><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="73" y1="1121.4688" y2="1121.4688"/><line style="stroke:#181818;stroke-width:1.0;" x1="73" x2="73" y1="1121.4688" y2="1134.4688"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="73" y1="1134.4688" y2="1134.4688"/><polygon fill="#181818" points="42,1130.4688,32,1134.4688,42,1138.4688,38,1134.4688" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="1117.1104">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="1117.1104">Create DPoP Proof for RS</text><polygon fill="#181818" points="727.5,1156.1094,737.5,1160.1094,727.5,1164.1094,731.5,1160.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="733.5" y1="1160.1094" y2="1160.1094"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="1155.751">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="1155.751">GET /resource (access token, DPoP)</text><line style="stroke:#181818;stroke-width:1.0;" x1="749.5" x2="791.5" y1="1197.3906" y2="1197.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="791.5" x2="791.5" y1="1197.3906" y2="1210.3906"/><line style="stroke:#181818;stroke-width:1.0;" x1="750.5" x2="791.5" y1="1210.3906" y2="1210.3906"/><polygon fill="#181818" points="760.5,1206.3906,750.5,1210.3906,760.5,1214.3906,756.5,1210.3906" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="756.5" y="1187.2119">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="780.5" y="1181.3916">verify access token and</text><text fill="#000000" font-family="Helvetica" font-size="10" x="780.5" y="1193.0322">DPoP Binding</text><polygon fill="#181818" points="970,1243.6719,980,1247.6719,970,1251.6719,974,1247.6719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="749.5" x2="976" y1="1247.6719" y2="1247.6719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="756.5" y="1237.4932">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="780.5" y="1231.6729">forward GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="780.5" y="1243.3135">(access token, DPoP)</text><line style="stroke:#181818;stroke-width:1.0;" x1="992" x2="1034" y1="1296.5938" y2="1296.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="1034" x2="1034" y1="1296.5938" y2="1309.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="993" x2="1034" y1="1309.5938" y2="1309.5938"/><polygon fill="#181818" points="1003,1305.5938,993,1309.5938,1003,1313.5938,999,1309.5938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="999" y="1280.5947">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1023" y="1268.9541">provide</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1023" y="1280.5947">resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1023" y="1292.2354">access</text><polygon fill="#181818" points="760.5,1331.2344,750.5,1335.2344,760.5,1339.2344,756.5,1335.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="754.5" x2="981" y1="1335.2344" y2="1335.2344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="766.5" y="1330.876">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="790.5" y="1330.876">200 OK, resource</text><polygon fill="#181818" points="42,1356.875,32,1360.875,42,1364.875,38,1360.875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="738.5" y1="1360.875" y2="1360.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="1356.5166">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="1356.5166">200 OK, resource</text><!--SRC=[hLRRRjj647tdLqoP5namBTbLq8I52zYIRt5igw8AeuM0O2sEnBMeNMAvb2m7-PT-IxwiiykBA8dk1QWVR9DxPixCcSkIPLgARF642jnMftFWEkcSYuGfje0GfooBzQKKEk2l2CUTviDxja2undY9cazO3TFFCNTIo3HX4mmhT4zcYgEgOMCKCnsTXSzPga58WOxpGwBORC50etm5hJ9wHLZYu0aJ6denHw6T9_a2xkUB6nVUNKKorOyHr-W0_TJ1jr88d6kfWANWRfwa6elHZNV5DAxOsjsp2-xEhKLmvvsx3eeGYC_9ISzHA-Ga7L6FBdhNzm-V7wv-joxi-HyZYf7IiO20YN1zhkHAMC0kprccey0o3Iu6Os4UfUAlJ7Cf842rD4uQBQy7rYpIEe61aYz54hkmGJ_7qTySGBcOLCfeHpTmSjI1FcbA1NZNPseU8BjIYCq13_DeXvXIAITOnbXtNQd59felIU6oP2mkgmSHEH4IclA5or_xzzPVWVL-eMHzkBeOGLiLlFQyydyziCyaYKVWtCo7RkSOVXEieC3mPtXEYUL9XcjOSHt18yQnTokeDlb9NqwoXM5i3Izx7xh7tGFhDiGw4SOfrhFupoaShGpjtD2sfOdEOtKNNcfTVF_ptwHuqkd0m-t_b9W87MSJRqanGu7AGFe3EO0vhXF6LKCfbopc8IYSAfP6eEMS6cZZpVPv8G1DEHMmehP7JZu8zTmKwao98aKGkFAieG-v_Nwa4uMRPeEpb8IqDVdqECfbiOPZKLM5HXCU0hWHKwaMLdnpQFCSHRGS4yMfQpT4rVhm0Lzel0MBJTXqIlkFc8d88pMYJMwLXRDPFUI8jeiFAP-91XCwSypssUOpk80C66c2Jgrm1hxbkrJ3MAHD5fkO6ZHaOGXcvq55HgLib7Gi9hrkT7Hq1AscuuEt2sG5ffKbfpkbsU-NmKD03MERoPIcaScMqVeqj0RckkQHYhJ-P09qtVpbJD42-wBN2PvIO_aSzTItbr3gspdqBS0p0FzvfRqdP8fMMs7DIixJ8k_o89r8ycXVE49IVZ5EDL1oUMC3qCpzzFxaHsYPO7SpE3Wqvn-xtO_GCb4VsFLf_9GZKOb1Mu5Fr_2F6kojg7mqXpIQ-FPexagz1M_Ik2Qdoh5VBBRKPUlbATMYqonQOyNUIduhgaCRKhwuAZnTT6Koo-Dso3Hhc-A-7jQMv5TYf0-GJBi-V2M-RzzWCu3am36tfhSXptVGbWTABwLl7EF0PN4iL_IV-LOv1EklFd36uMuwlNmKKcr-q_g1cz2i4RrkdoL9kuzBFjbl09wc6UQffmqBiuoIJIQOfgL4Qbkn9vbHAMcchNIrAFDktH_QtjxGcd27GNrxx5tFqDeE8k_i-crZBhBSiAXitS2qsrXOodCkGYvc1Nv8AX3zYgbmct0i_fwHuXq6fOT4oIKFoMPZdHjRJ15MgMRrnL7JYhmrNiJDwEl1ZctjgVWo-Wi0]--></g></svg>