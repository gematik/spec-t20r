<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1456px" preserveAspectRatio="none" style="width:1249px;height:1456px;background:#FFFFFF;" version="1.1" viewBox="0 0 1249 1456" width="1249px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="1444.1563" style="stroke:#181818;stroke-width:0.5;" width="438.6836" x="11" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="221.8799" y="15.2822">LEI</text><rect fill="#C9FFC9" height="1444.1563" style="stroke:#181818;stroke-width:0.5;" width="752.6152" x="461.6836" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="811.3921" y="15.2822">Betreiber</text><rect fill="#F4A460" height="1427.5156" style="stroke:#181818;stroke-width:0.5;" width="636.1152" x="461.6836" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="750.7983" y="31.9229">ZT Cluster</text><rect fill="#8FBC8F" height="1427.5156" style="stroke:#181818;stroke-width:0.5;" width="104.5" x="1109.7988" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1124.5171" y="31.9229">TI 2.0 Dienst</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="36.4751" x2="36.4751" y1="76.5625" y2="1405.875"/><rect fill="#FFFFFF" height="1303.3125" style="stroke:#181818;stroke-width:1.0;" width="10" x="31.4751" y="84.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="296.4185" x2="296.4185" y1="76.5625" y2="1405.875"/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1.0;" width="10" x="291.4185" y="416.8906"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="425.9614" x2="425.9614" y1="76.5625" y2="1405.875"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="420.9614" y="442.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="524.1582" x2="524.1582" y1="76.5625" y2="1405.875"/><rect fill="#FFFFFF" height="795.8594" style="stroke:#181818;stroke-width:1.0;" width="10" x="519.1582" y="303.6875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="820.4834" x2="820.4834" y1="76.5625" y2="1405.875"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="815.4834" y="129.8438"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="815.4834" y="210.7656"/><rect fill="#FFFFFF" height="200.7656" style="stroke:#181818;stroke-width:1.0;" width="10" x="815.4834" y="1187.1094"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1053.5127" x2="1053.5127" y1="76.5625" y2="1405.875"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="1048.5127" y="1009.625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1162.0488" x2="1162.0488" y1="76.5625" y2="1405.875"/><rect fill="#FFFFFF" height="87.5625" style="stroke:#181818;stroke-width:1.0;" width="10" x="1157.0488" y="1274.6719"/><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="15" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="22" y="66.2041">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="256.9917" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="263.9917" y="54.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="267.998" y="66.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="39.4443" x="406.2393" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="413.2393" y="66.2041">SM-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="465.6836" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.2778" y="54.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="472.6836" y="66.2041">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="787.5825" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="811.2939" y="54.5635">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="794.5825" y="66.2041">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1013.2266" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1043.6323" y="54.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1020.2266" y="66.2041">Policy Engine</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.5" x="1113.7988" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1120.7988" y="66.2041">Resource Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="15" y="1405.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="22" y="1422.1572">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="256.9917" y="1405.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="263.9917" y="1422.1572">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="267.998" y="1433.7979">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="39.4443" x="406.2393" y="1405.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="413.2393" y="1422.1572">SM-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="465.6836" y="1405.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.2778" y="1422.1572">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="472.6836" y="1433.7979">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.8018" x="787.5825" y="1405.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="811.2939" y="1422.1572">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="794.5825" y="1433.7979">http Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1013.2266" y="1405.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1043.6323" y="1422.1572">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1020.2266" y="1433.7979">Policy Engine</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.5" x="1113.7988" y="1405.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1120.7988" y="1422.1572">Resource Server</text><path d="M20.4751,88.5625 L80.4312,88.5625 L80.4312,92.2031 L70.4312,102.2031 L20.4751,102.2031 L20.4751,88.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="155.8438" style="stroke:#000000;stroke-width:1.5;" width="821.0083" x="20.4751" y="88.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="35.4751" y="98.8447">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="95.4312" y="99.8447">[Client has no Authorization Server FQDN]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20.4751" x2="841.4834" y1="174.4844" y2="174.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="25.4751" y="185.7666">[Client has Authorization Server FQDN]</text><polygon fill="#181818" points="803.4834,125.8438,813.4834,129.8438,803.4834,133.8438,807.4834,129.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="809.4834" y1="129.8438" y2="129.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="125.4854">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="125.4854">GET /resource</text><polygon fill="#181818" points="52.4751,151.4844,42.4751,155.4844,52.4751,159.4844,48.4751,155.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.4751" x2="814.4834" y1="155.4844" y2="155.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="151.126">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="151.126">401 Unauthorized; json body with Well-Known json Document (RFC8414)</text><polygon fill="#181818" points="803.4834,206.7656,813.4834,210.7656,803.4834,214.7656,807.4834,210.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="809.4834" y1="210.7656" y2="210.7656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="206.4072">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="206.4072">GET /.well-known/oauth-authorization-server&#160;</text><polygon fill="#181818" points="52.4751,232.4063,42.4751,236.4063,52.4751,240.4063,48.4751,236.4063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.4751" x2="814.4834" y1="236.4063" y2="236.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="232.0479">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="232.0479">200 OK; json body with Well-Known json Document (RFC8414)</text><path d="M20.4751,262.4063 L80.4312,262.4063 L80.4312,266.0469 L70.4312,276.0469 L20.4751,276.0469 L20.4751,262.4063 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="715.5781" style="stroke:#000000;stroke-width:1.5;" width="768.894" x="20.4751" y="262.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="35.4751" y="272.6885">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="95.4312" y="273.6885">[Client has no valid refresh token]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20.4751" x2="789.3691" y1="782.8594" y2="782.8594"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="25.4751" y="794.1416">[Client has valid Refresh token]</text><polygon fill="#181818" points="507.1582,299.6875,517.1582,303.6875,507.1582,307.6875,511.1582,303.6875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="513.1582" y1="303.6875" y2="303.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="299.3291">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="299.3291">GET /nonce</text><polygon fill="#181818" points="52.4751,325.3281,42.4751,329.3281,52.4751,333.3281,48.4751,329.3281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.4751" x2="518.1582" y1="329.3281" y2="329.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="324.9697">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="324.9697">return 200 OK new-nonce: nonce</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="378.25" y2="378.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="378.25" y2="391.25"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="391.25" y2="391.25"/><polygon fill="#181818" points="52.4751,387.25,42.4751,391.25,52.4751,395.25,48.4751,391.25" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="362.251">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="350.6104">create Client Assertion JWT with nonce</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="362.251">Client and OS Information</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="373.8916">DPoP Thumbprint</text><polygon fill="#181818" points="279.4185,412.8906,289.4185,416.8906,279.4185,420.8906,283.4185,416.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="285.4185" y1="416.8906" y2="416.8906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="412.5322">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="412.5322">externalAuthenticate JWT-hash</text><polygon fill="#181818" points="408.9614,438.5313,418.9614,442.5313,408.9614,446.5313,412.9614,442.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="301.4185" x2="414.9614" y1="442.5313" y2="442.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="308.4185" y="438.1729">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.9458" y="438.1729">sign JWT-hash</text><polygon fill="#181818" points="312.4185,464.1719,302.4185,468.1719,312.4185,472.1719,308.4185,468.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="306.4185" x2="419.9614" y1="468.1719" y2="468.1719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="318.4185" y="463.8135">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="342.9458" y="463.8135">JWT-Signature</text><polygon fill="#181818" points="52.4751,489.8125,42.4751,493.8125,52.4751,497.8125,48.4751,493.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="46.4751" x2="290.4185" y1="493.8125" y2="493.8125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="489.4541">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="489.4541">JWT-signature</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="531.0938" y2="531.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="531.0938" y2="544.0938"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="544.0938" y2="544.0938"/><polygon fill="#181818" points="52.4751,540.0938,42.4751,544.0938,52.4751,548.0938,48.4751,544.0938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="520.915">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="515.0947">add SM-B Signature to Client Assertion JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="526.7354">cC4h... (Client Assertion JWT)</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="569.7344" y2="569.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="569.7344" y2="582.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="582.7344" y2="582.7344"/><polygon fill="#181818" points="52.4751,578.7344,42.4751,582.7344,52.4751,586.7344,48.4751,582.7344" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="565.376">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="565.376">create DPoP JWT with nonce</text><polygon fill="#181818" points="507.1582,650.9375,517.1582,654.9375,507.1582,658.9375,511.1582,654.9375" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="513.1582" y1="654.9375" y2="654.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="627.2979">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="604.0166">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="615.6572">Content-Type: application/x-www-form-urlencoded</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="627.2979">DPoP: ... (DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="638.9385">grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="650.5791">assertion=eyJh... (Client Assertion JWT)</text><path d="M252.7627,667.9375 L252.7627,688.9375 L518.7627,688.9375 L518.7627,677.9375 L508.7627,667.9375 L252.7627,667.9375 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M508.7627,667.9375 L508.7627,677.9375 L518.7627,677.9375 L508.7627,667.9375 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="258.7627" y="682.2197">RFC7523 (JWT Client Assertion), RFC9449 (DPoP)</text><line style="stroke:#181818;stroke-width:1.0;" x1="529.1582" x2="571.1582" y1="712.2188" y2="712.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="571.1582" x2="571.1582" y1="712.2188" y2="725.2188"/><line style="stroke:#181818;stroke-width:1.0;" x1="530.1582" x2="571.1582" y1="725.2188" y2="725.2188"/><polygon fill="#181818" points="540.1582,721.2188,530.1582,725.2188,540.1582,729.2188,536.1582,725.2188" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="536.1582" y="707.8604">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="560.6855" y="707.8604">verify Client Assertion JWT and DPoP JWT</text><line style="stroke:#181818;stroke-width:1.0;" x1="529.1582" x2="571.1582" y1="750.8594" y2="750.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="571.1582" x2="571.1582" y1="750.8594" y2="763.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="530.1582" x2="571.1582" y1="763.8594" y2="763.8594"/><polygon fill="#181818" points="540.1582,759.8594,530.1582,763.8594,540.1582,767.8594,536.1582,763.8594" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="536.1582" y="746.501">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="560.6855" y="746.501">Create state for Identity/App/Device</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="819.1406" y2="819.1406"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="819.1406" y2="832.1406"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="832.1406" y2="832.1406"/><polygon fill="#181818" points="52.4751,828.1406,42.4751,832.1406,52.4751,836.1406,48.4751,832.1406" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="814.7822">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="814.7822">create DPoP JWT without nonce</text><polygon fill="#181818" points="507.1582,888.7031,517.1582,892.7031,507.1582,896.7031,511.1582,892.7031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="513.1582" y1="892.7031" y2="892.7031"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="870.8838">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="853.4229">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="865.0635">DPoP: ... (DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="876.7041">grant_type=refresh_token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="888.3447">refresh_token= ... (Refresh token)</text><line style="stroke:#181818;stroke-width:1.0;" x1="529.1582" x2="571.1582" y1="918.3438" y2="918.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="571.1582" x2="571.1582" y1="918.3438" y2="931.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="530.1582" x2="571.1582" y1="931.3438" y2="931.3438"/><polygon fill="#181818" points="540.1582,927.3438,530.1582,931.3438,540.1582,935.3438,536.1582,931.3438" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="536.1582" y="913.9854">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="560.6855" y="913.9854">verify Refresh token and DPoP JWT</text><line style="stroke:#181818;stroke-width:1.0;" x1="529.1582" x2="571.1582" y1="956.9844" y2="956.9844"/><line style="stroke:#181818;stroke-width:1.0;" x1="571.1582" x2="571.1582" y1="956.9844" y2="969.9844"/><line style="stroke:#181818;stroke-width:1.0;" x1="530.1582" x2="571.1582" y1="969.9844" y2="969.9844"/><polygon fill="#181818" points="540.1582,965.9844,530.1582,969.9844,540.1582,973.9844,536.1582,969.9844" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="536.1582" y="952.626">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="560.6855" y="952.626">invalidate Refresh token</text><polygon fill="#181818" points="1036.5127,1005.625,1046.5127,1009.625,1036.5127,1013.625,1040.5127,1009.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="529.1582" x2="1042.5127" y1="1009.625" y2="1009.625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="536.1582" y="1005.2666">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="560.6855" y="1005.2666">POST /v1/data/authz, json body {  "input": {...}}</text><polygon fill="#181818" points="540.1582,1031.2656,530.1582,1035.2656,540.1582,1039.2656,536.1582,1035.2656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="534.1582" x2="1047.5127" y1="1035.2656" y2="1035.2656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="546.1582" y="1030.9072">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="570.6855" y="1030.9072">200 OK, json body {"result": {"allow": true, ...}}</text><line style="stroke:#181818;stroke-width:1.0;" x1="529.1582" x2="571.1582" y1="1060.9063" y2="1060.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="571.1582" x2="571.1582" y1="1060.9063" y2="1073.9063"/><line style="stroke:#181818;stroke-width:1.0;" x1="530.1582" x2="571.1582" y1="1073.9063" y2="1073.9063"/><polygon fill="#181818" points="540.1582,1069.9063,530.1582,1073.9063,540.1582,1077.9063,536.1582,1073.9063" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="536.1582" y="1056.5479">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="560.6855" y="1056.5479">issue Access and Refresh token with DPoP Binding</text><polygon fill="#181818" points="52.4751,1095.5469,42.4751,1099.5469,52.4751,1103.5469,48.4751,1099.5469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.4751" x2="518.1582" y1="1099.5469" y2="1099.5469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="1095.1885">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="1095.1885">200 OK, Access token, Refresh token, bound to DPoP</text><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="83.4751" y1="1125.1875" y2="1125.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="83.4751" x2="83.4751" y1="1125.1875" y2="1138.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="42.4751" x2="83.4751" y1="1138.1875" y2="1138.1875"/><polygon fill="#181818" points="52.4751,1134.1875,42.4751,1138.1875,52.4751,1142.1875,48.4751,1138.1875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="1120.8291">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="1120.8291">Create DPoP Proof for RS</text><polygon fill="#181818" points="803.4834,1183.1094,813.4834,1187.1094,803.4834,1191.1094,807.4834,1187.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="41.4751" x2="809.4834" y1="1187.1094" y2="1187.1094"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48.4751" y="1171.1104">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="73.0024" y="1159.4697">GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="1171.1104">Authorization: DPoP ... (Accesss token)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="79.3599" y="1182.751">DPoP: ... (DPoP token)</text><line style="stroke:#181818;stroke-width:1.0;" x1="825.4834" x2="867.4834" y1="1212.75" y2="1212.75"/><line style="stroke:#181818;stroke-width:1.0;" x1="867.4834" x2="867.4834" y1="1212.75" y2="1225.75"/><line style="stroke:#181818;stroke-width:1.0;" x1="826.4834" x2="867.4834" y1="1225.75" y2="1225.75"/><polygon fill="#181818" points="836.4834,1221.75,826.4834,1225.75,836.4834,1229.75,832.4834,1225.75" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="832.4834" y="1208.3916">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="857.0107" y="1208.3916">verify Access token and DPoP Binding</text><polygon fill="#181818" points="1145.0488,1270.6719,1155.0488,1274.6719,1145.0488,1278.6719,1149.0488,1274.6719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="825.4834" x2="1151.0488" y1="1274.6719" y2="1274.6719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="832.4834" y="1258.6729">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="857.0107" y="1247.0322">forward GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="863.3682" y="1258.6729">Authorization: DPoP ... (Accesss token)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="863.3682" y="1270.3135">DPoP: ... (DPoP token)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1167.0488" x2="1209.0488" y1="1323.5938" y2="1323.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="1209.0488" x2="1209.0488" y1="1323.5938" y2="1336.5938"/><line style="stroke:#181818;stroke-width:1.0;" x1="1168.0488" x2="1209.0488" y1="1336.5938" y2="1336.5938"/><polygon fill="#181818" points="1178.0488,1332.5938,1168.0488,1336.5938,1178.0488,1340.5938,1174.0488,1336.5938" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1174.0488" y="1307.5947">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1198.5762" y="1295.9541">provide</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1198.5762" y="1307.5947">resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1198.5762" y="1319.2354">access</text><polygon fill="#181818" points="836.4834,1358.2344,826.4834,1362.2344,836.4834,1366.2344,832.4834,1362.2344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="830.4834" x2="1156.0488" y1="1362.2344" y2="1362.2344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="842.4834" y="1357.876">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="867.0107" y="1357.876">200 OK, resource</text><polygon fill="#181818" points="52.4751,1383.875,42.4751,1387.875,52.4751,1391.875,48.4751,1387.875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="46.4751" x2="814.4834" y1="1387.875" y2="1387.875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="58.4751" y="1383.5166">(31)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="83.0024" y="1383.5166">200 OK, resource</text><!--SRC=[jLR_JkD64FxVJp7DgHAHC0bSglPIKIaa43WEIEDKg1NIQR4dyOApQwtN2U5qxz9dwPDrTct7TZ3qAhN_4EoT-UQRRtwiMQgbI9VtgA2rr-ssMqxoo4NC55j2W7EMHlfC2ktnPuJ3RlFXDLiYd6EqGirzLh4PPJPNKiWaPZu6M-kXJ1L7LR6DK2nqE0WUqaI3a08TvxjOiSMIWKRv35gbzEfUFa7hq-b52zwDGvdesv1hT008WsBpc0aDmuYZq3ilBwKG-AYb0fP0gtoIwaxCBjmnqxXcczQEbtTrOkszA_UavQ08W0ZaB4vGA-Ga776PdGxFhsy-tOn_9m1x-iUCU50gzjXZ8jYSABaMT5oFCF1iWCbeSYS6gGwbuizCSod0GxKotYzSpYUPoocvX5h7C57ooLAlsn5cYJsH4VStS2eMNA2nfMHCBf3ndLt0qK4NHgGSoVzknDIZXsoi45zIdcQKfvXG4NqiY9QOMvsOh_cAb2rAmgAYEX0IX93Gb3AS_Jgw9hJSqls5Ckx3-7G67PN7fDCjzlc4daWJbmmpbpxqkeVmcs0vE0O_mqD2-FSosC2Qwn1kCOhSIq4LoKv6qa-N9jhUz6puK- -mroRG0Aj1C4gmolvVKZzOcv2F9cH76cOkgmAuYGNuwyz_IksesuMRo_ya8H4uJaDDLYpY0IYSazeXQFb8FL0cDF3oX6X6gH1Rm87dK2zNcIhKgH8vOH2uTgrB7pBF4h9my1MMpGA3X2InsdwydML9MiSxiTMNnWfkFBWGSwcMLaPpE9h82Sn2McgnujHrPQ3jsFS1dsWq1OjC5UcKzXP5fa0kYH2MMMqzd79b413jXJuaV24QNEZCCNkZ7i_OUUJ0I1DqAeKmvZNiGWtZaJHvb9mQD6H106PRmJOOLR1HqZlX3tlXmS41x3KTjryla1MuNfIT1fdSUDGXjdLikMZjqwaxsyHKVXR7aT6R0dMUtFLwxPhokQcYAy2N0GP54VjWsHNXskRzGj4A-gm9w9YQw_lt0uvwJZ_s4ade7pjRz6iDNMD83mzhxTuZKwWC1YloFCRDnxSK49AoZN2kGSvDWmFGCFtumz5xs3FfxpgrzytvXrxlGqQwRJUX0R6ZaKb3Gyxdc-OcD_rSP5jn6MQo9zhy9QtW8Z0jgpUTGHntHhZYL80N-oaRu-ahO_nMIMMglwMgtr2YV8bytlhKNXndpZMAxPTIrSvVquWBcw_9fPwotNAP7Ls4HHAhmmxPievfbkVzoZBz0j2YJv9Kj_hmXUXz_GhbQ1E0OsvLDm-QhRQQUuj2qoUFyMwnA99h-izykko31QlEiK6h990aAMrHtySaiKdMqxQZPlC-uIBWOh6xRGikEOBrsg-3x1F7b91f8HYaAXTgxeRc65QQWpuoQ0XCzqqzvushsLIvTZNsCtzRwenSpgxTr4Hv4rJlANC1Pe7oXgYcMFP3eKjcFYL9YUoQgU1_vKTYJBqYOApaYWSKeWp6BAAroPCe2hNzbgcKWT0Qh_jcw_F9Zc_bAV_Y-Xi0]--></g></svg>