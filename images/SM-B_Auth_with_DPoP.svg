<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1421px" preserveAspectRatio="none" style="width:1117px;height:1421px;background:#FFFFFF;" version="1.1" viewBox="0 0 1117 1421" width="1117px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="1409.2344" style="stroke:#181818;stroke-width:0.5;" width="193" x="236.5" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="325.5" y="15.2822">LEI</text><rect fill="#C9FFC9" height="1409.2344" style="stroke:#181818;stroke-width:0.5;" width="642" x="441.5" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="736" y="15.2822">Betreiber</text><rect fill="#F4A460" height="1392.5938" style="stroke:#181818;stroke-width:0.5;" width="527" x="441.5" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="676.5" y="31.9229">ZT Cluster</text><rect fill="#8FBC8F" height="1392.5938" style="stroke:#181818;stroke-width:0.5;" width="103" x="980.5" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="995.5" y="31.9229">TI 2.0 Dienst</text><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="26" x2="26" y1="76.5625" y2="1370.9531"/><rect fill="#FFFFFF" height="1268.3906" style="stroke:#181818;stroke-width:1.0;" width="10" x="21" y="84.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="279" x2="279" y1="76.5625" y2="1370.9531"/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1.0;" width="10" x="274" y="455.5313"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="405" x2="405" y1="76.5625" y2="1370.9531"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="400" y="481.1719"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="502.5" x2="502.5" y1="76.5625" y2="1370.9531"/><rect fill="#FFFFFF" height="745.5781" style="stroke:#181818;stroke-width:1.0;" width="10" x="497.5" y="342.3281"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="789.5" x2="789.5" y1="76.5625" y2="1370.9531"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="784.5" y="129.8438"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="784.5" y="210.7656"/><rect fill="#FFFFFF" height="200.7656" style="stroke:#181818;stroke-width:1.0;" width="10" x="784.5" y="1152.1875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="946.5" x2="946.5" y1="76.5625" y2="1370.9531"/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1.0;" width="10" x="941.5" y="997.9844"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1032" x2="1032" y1="76.5625" y2="1370.9531"/><rect fill="#FFFFFF" height="87.5625" style="stroke:#181818;stroke-width:1.0;" width="10" x="1027" y="1239.75"/><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42" x="5" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="12" y="66.2041">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="240.5" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="247.5" y="54.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="251" y="66.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="384.5" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="391.5" y="66.2041">SM-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="445.5" y="38.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="492" y="54.5635">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="452.5" y="66.2041">Authorization Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66" x="756.5" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="763.5" y="66.2041">http Proxy</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="36" x="928.5" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="935.5" y="66.2041">PDP</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95" x="984.5" y="49.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="991.5" y="66.2041">Resource Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42" x="5" y="1370.9531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="12" y="1387.2354">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77" x="240.5" y="1370.9531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="247.5" y="1387.2354">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="251" y="1398.876">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="41" x="384.5" y="1370.9531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="391.5" y="1387.2354">SM-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="114" x="445.5" y="1370.9531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="492" y="1387.2354">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="452.5" y="1398.876">Authorization Server</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="66" x="756.5" y="1370.9531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="763.5" y="1387.2354">http Proxy</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="36" x="928.5" y="1370.9531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="935.5" y="1387.2354">PDP</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="95" x="984.5" y="1370.9531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="991.5" y="1387.2354">Resource Server</text><path d="M10,88.5625 L70,88.5625 L70,92.2031 L60,102.2031 L10,102.2031 L10,88.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="155.8438" style="stroke:#000000;stroke-width:1.5;" width="828.5" x="10" y="88.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="25" y="98.8447">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="85" y="99.8447">[Client has no Authorization Server FQDN]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="838.5" y1="174.4844" y2="174.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="15" y="185.7666">[Client has Authorization Server FQDN]</text><polygon fill="#181818" points="772.5,125.8438,782.5,129.8438,772.5,133.8438,776.5,129.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="778.5" y1="129.8438" y2="129.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="125.4854">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="125.4854">GET /resource</text><polygon fill="#181818" points="42,151.4844,32,155.4844,42,159.4844,38,155.4844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="783.5" y1="155.4844" y2="155.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="151.126">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="151.126">401 Unauthorized; json body with Well-Known json Document (RFC8414)</text><polygon fill="#181818" points="772.5,206.7656,782.5,210.7656,772.5,214.7656,776.5,210.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="778.5" y1="210.7656" y2="210.7656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="206.4072">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="206.4072">GET /.well-known/oauth-authorization-server&#160;</text><polygon fill="#181818" points="42,232.4063,32,236.4063,42,240.4063,38,236.4063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="783.5" y1="236.4063" y2="236.4063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="232.0479">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="232.0479">200 OK; json body with Well-Known json Document (RFC8414)</text><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="73" y1="276.0469" y2="276.0469"/><line style="stroke:#181818;stroke-width:1.0;" x1="73" x2="73" y1="276.0469" y2="289.0469"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="73" y1="289.0469" y2="289.0469"/><polygon fill="#181818" points="42,285.0469,32,289.0469,42,293.0469,38,289.0469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="271.6885">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="271.6885">generate DPoP keypair</text><path d="M10,301.0469 L70,301.0469 L70,304.6875 L60,314.6875 L10,314.6875 L10,301.0469 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="665.2969" style="stroke:#000000;stroke-width:1.5;" width="750.5" x="10" y="301.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="25" y="311.3291">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="85" y="312.3291">[Client has no valid refrash token]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="760.5" y1="833.1406" y2="833.1406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="15" y="844.4229">[Client has valid Refresh token]</text><polygon fill="#181818" points="485.5,338.3281,495.5,342.3281,485.5,346.3281,489.5,342.3281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="491.5" y1="342.3281" y2="342.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="337.9697">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="337.9697">GET /nonce</text><polygon fill="#181818" points="42,363.9688,32,367.9688,42,371.9688,38,367.9688" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="496.5" y1="367.9688" y2="367.9688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="363.6104">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="363.6104">return 200 OK new-nonce: nonce</text><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="73" y1="416.8906" y2="416.8906"/><line style="stroke:#181818;stroke-width:1.0;" x1="73" x2="73" y1="416.8906" y2="429.8906"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="73" y1="429.8906" y2="429.8906"/><polygon fill="#181818" points="42,425.8906,32,429.8906,42,433.8906,38,429.8906" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="400.8916">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="389.251">create Client Assertion JWT with nonce</text><text fill="#000000" font-family="Helvetica" font-size="10" x="68" y="400.8916">Client and OS Information</text><text fill="#000000" font-family="Helvetica" font-size="10" x="68" y="412.5322">DPoP Thumbprint</text><polygon fill="#181818" points="262,451.5313,272,455.5313,262,459.5313,266,455.5313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="268" y1="455.5313" y2="455.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="451.1729">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="451.1729">externalAuthenticate JWT-hash</text><polygon fill="#181818" points="388,477.1719,398,481.1719,388,485.1719,392,481.1719" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="284" x2="394" y1="481.1719" y2="481.1719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="291" y="476.8135">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="315" y="476.8135">sign JWT-hash</text><polygon fill="#181818" points="295,502.8125,285,506.8125,295,510.8125,291,506.8125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="289" x2="399" y1="506.8125" y2="506.8125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="301" y="502.4541">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="325" y="502.4541">JWT-Signature</text><polygon fill="#181818" points="42,528.4531,32,532.4531,42,536.4531,38,532.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="36" x2="273" y1="532.4531" y2="532.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="528.0947">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="528.0947">JWT-signature</text><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="73" y1="569.7344" y2="569.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="73" x2="73" y1="569.7344" y2="582.7344"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="73" y1="582.7344" y2="582.7344"/><polygon fill="#181818" points="42,578.7344,32,582.7344,42,586.7344,38,582.7344" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="559.5557">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="553.7354">add SM-B Signature to Client Assertion JWT</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="565.376">cC4h... (Client Assertion JWT)</text><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="73" y1="608.375" y2="608.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="73" x2="73" y1="608.375" y2="621.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="73" y1="621.375" y2="621.375"/><polygon fill="#181818" points="42,617.375,32,621.375,42,625.375,38,621.375" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="604.0166">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="604.0166">create DPoP Proof JWT with nonce</text><polygon fill="#181818" points="485.5,701.2188,495.5,705.2188,485.5,709.2188,489.5,705.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="491.5" y1="705.2188" y2="705.2188"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="671.7588">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="642.6572">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="68" y="654.2979">(Client Assertion JWT and DPoP JWT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="665.9385">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="665.9385">DPoP:&#160;eyJh...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="677.5791">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="677.5791">grant_type=urn:ietf:params:oauth:grant-type:jwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="689.2197">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="689.2197">assertion=cC4h...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="700.8604">&#160;&#160;</text><text fill="#000000" font-family="Courier" font-size="10" x="68" y="700.8604">scope=...</text><path d="M234.5,718.2188 L234.5,739.2188 L497.5,739.2188 L497.5,728.2188 L487.5,718.2188 L234.5,718.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M487.5,718.2188 L487.5,728.2188 L497.5,728.2188 L487.5,718.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="240.5" y="732.501">RFC7523 (JWT Client Assertion), RFC9449 (DPoP)</text><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="549.5" y1="762.5" y2="762.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="549.5" x2="549.5" y1="762.5" y2="775.5"/><line style="stroke:#181818;stroke-width:1.0;" x1="508.5" x2="549.5" y1="775.5" y2="775.5"/><polygon fill="#181818" points="518.5,771.5,508.5,775.5,518.5,779.5,514.5,775.5" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="758.1416">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="758.1416">verify Client Assertion JWT and DPoP JWT</text><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="549.5" y1="801.1406" y2="801.1406"/><line style="stroke:#181818;stroke-width:1.0;" x1="549.5" x2="549.5" y1="801.1406" y2="814.1406"/><line style="stroke:#181818;stroke-width:1.0;" x1="508.5" x2="549.5" y1="814.1406" y2="814.1406"/><polygon fill="#181818" points="518.5,810.1406,508.5,814.1406,518.5,818.1406,514.5,814.1406" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="796.7822">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="796.7822">Create state for Identity/App/Device</text><polygon fill="#181818" points="485.5,877.0625,495.5,881.0625,485.5,885.0625,489.5,881.0625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="491.5" y1="881.0625" y2="881.0625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="870.8838">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="865.0635">POST /token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="68" y="876.7041">(Refresh token and DPoP JWT)</text><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="549.5" y1="906.7031" y2="906.7031"/><line style="stroke:#181818;stroke-width:1.0;" x1="549.5" x2="549.5" y1="906.7031" y2="919.7031"/><line style="stroke:#181818;stroke-width:1.0;" x1="508.5" x2="549.5" y1="919.7031" y2="919.7031"/><polygon fill="#181818" points="518.5,915.7031,508.5,919.7031,518.5,923.7031,514.5,919.7031" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="902.3447">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="902.3447">verify Refresh token, DPoP</text><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="549.5" y1="945.3438" y2="945.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="549.5" x2="549.5" y1="945.3438" y2="958.3438"/><line style="stroke:#181818;stroke-width:1.0;" x1="508.5" x2="549.5" y1="958.3438" y2="958.3438"/><polygon fill="#181818" points="518.5,954.3438,508.5,958.3438,518.5,962.3438,514.5,958.3438" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="940.9854">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="940.9854">invalidate Refresh token</text><polygon fill="#181818" points="929.5,993.9844,939.5,997.9844,929.5,1001.9844,933.5,997.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="935.5" y1="997.9844" y2="997.9844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="993.626">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="993.626">POST /v1/data/authz, json body {  "input": {...}}</text><polygon fill="#181818" points="518.5,1019.625,508.5,1023.625,518.5,1027.625,514.5,1023.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="512.5" x2="940.5" y1="1023.625" y2="1023.625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="524.5" y="1019.2666">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="548.5" y="1019.2666">200 OK, json body {"result": {"allow": true, ...}}</text><line style="stroke:#181818;stroke-width:1.0;" x1="507.5" x2="549.5" y1="1049.2656" y2="1049.2656"/><line style="stroke:#181818;stroke-width:1.0;" x1="549.5" x2="549.5" y1="1049.2656" y2="1062.2656"/><line style="stroke:#181818;stroke-width:1.0;" x1="508.5" x2="549.5" y1="1062.2656" y2="1062.2656"/><polygon fill="#181818" points="518.5,1058.2656,508.5,1062.2656,518.5,1066.2656,514.5,1062.2656" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="514.5" y="1044.9072">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="538.5" y="1044.9072">issue Access and Refresh token with DPoP Binding</text><polygon fill="#181818" points="42,1083.9063,32,1087.9063,42,1091.9063,38,1087.9063" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="496.5" y1="1087.9063" y2="1087.9063"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="1083.5479">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="1083.5479">200 OK, Access token, Refresh token, bound to DPoP</text><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="73" y1="1113.5469" y2="1113.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="73" x2="73" y1="1113.5469" y2="1126.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="32" x2="73" y1="1126.5469" y2="1126.5469"/><polygon fill="#181818" points="42,1122.5469,32,1126.5469,42,1130.5469,38,1126.5469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="1109.1885">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="1109.1885">Create DPoP Proof for RS</text><polygon fill="#181818" points="772.5,1148.1875,782.5,1152.1875,772.5,1156.1875,776.5,1152.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="31" x2="778.5" y1="1152.1875" y2="1152.1875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="38" y="1147.8291">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="62" y="1147.8291">GET /resource (Access token, DPoP Proof)</text><line style="stroke:#181818;stroke-width:1.0;" x1="794.5" x2="836.5" y1="1189.4688" y2="1189.4688"/><line style="stroke:#181818;stroke-width:1.0;" x1="836.5" x2="836.5" y1="1189.4688" y2="1202.4688"/><line style="stroke:#181818;stroke-width:1.0;" x1="795.5" x2="836.5" y1="1202.4688" y2="1202.4688"/><polygon fill="#181818" points="805.5,1198.4688,795.5,1202.4688,805.5,1206.4688,801.5,1202.4688" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="801.5" y="1179.29">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="825.5" y="1173.4697">verify access token and</text><text fill="#000000" font-family="Helvetica" font-size="10" x="825.5" y="1185.1104">DPoP Binding</text><polygon fill="#181818" points="1015,1235.75,1025,1239.75,1015,1243.75,1019,1239.75" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="794.5" x2="1021" y1="1239.75" y2="1239.75"/><text fill="#000000" font-family="Helvetica" font-size="10" x="801.5" y="1229.5713">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="825.5" y="1223.751">forward GET /resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="825.5" y="1235.3916">(access token, DPoP)</text><line style="stroke:#181818;stroke-width:1.0;" x1="1037" x2="1079" y1="1288.6719" y2="1288.6719"/><line style="stroke:#181818;stroke-width:1.0;" x1="1079" x2="1079" y1="1288.6719" y2="1301.6719"/><line style="stroke:#181818;stroke-width:1.0;" x1="1038" x2="1079" y1="1301.6719" y2="1301.6719"/><polygon fill="#181818" points="1048,1297.6719,1038,1301.6719,1048,1305.6719,1044,1301.6719" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1044" y="1272.6729">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1068" y="1261.0322">provide</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1068" y="1272.6729">resource</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1068" y="1284.3135">access</text><polygon fill="#181818" points="805.5,1323.3125,795.5,1327.3125,805.5,1331.3125,801.5,1327.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="799.5" x2="1026" y1="1327.3125" y2="1327.3125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="811.5" y="1322.9541">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="835.5" y="1322.9541">200 OK, resource</text><polygon fill="#181818" points="42,1348.9531,32,1352.9531,42,1356.9531,38,1352.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="36" x2="783.5" y1="1352.9531" y2="1352.9531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="48" y="1348.5947">(31)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="72" y="1348.5947">200 OK, resource</text><!--SRC=[hLPjR-964FxkNp7rVG4f3YJbr3kggvH0tYwNX6Agg1LIjS43tc1shVKQGaxtN_fRxfTrTcrZ6norbPeFIUnzPfwPPrxMBDLIfAidLE2skjsswoHBBcAcs0e2dBCqqfTIQ9-_8fnqcm_lsGhX6gCrQZvZ5Smmmzn98PEOpJ3OeGSoLHnL1HkXMEZmB7XE4mr22dIS7sB55Yi66kKhQ9NIAy8I1u-Pq328E0hjFCaNSBzStBZmxYgKYNuCkKO7wASAlfL2u59B1Im1jtoIQYecDzuLqxXXM_V0phyxjnR-dNVkEYW283ud8pr7hP2JT4GzkHXStpzyURZwtRgmvtzCA4PAnm9y9eBjkP8ROG7xF6Uf3dtBDBeOJOLvb8g_Cisb01_LsZXfjBmUMRDGwnX6IhxaIUp3HiCCHtyp0ELYKYcYdTp0wN4NXgGf5U3TaAcbZ-nA8JO7FCwY7MD2fPnX4MFLzKujDjDyJGeN9MDHKJq8oOcGq9GlNFuwlBV-Sgpt2oNRXwkB2NHKpclFT_wlH_QP9F48d9dreTSzWTy4ooam-1cU4s9vai4MDbo7y8XHvDqAgarsCfIpT6KOM-FBmOVUIQzjtGPO9S8emMeM_pc5uusXNHhQZZJHUQpgmakiY-z__PiKJxjTUBZzdn8JWUEKyHOK2nIe36GuaYDOuZPcN3MKSiqY7e32kM9925ekgO5ARxRFSm5eogc0Esfxv6I3KCrDeKwLo5C4WHlF6lOXip-CTAQmR3OuIqX8MvFFZvDC5ciu5Rkgq6Z2WmytOYxLoefl3csUav2MOwmuTMr9j5iVVS0N6c_18XCsdTB-8sOYyaYDiCnjP-6KguSSqNRfGy8Nei64pXopVUfy1kUJ0IDDqAaKpi1hlWirZ4NIP576rA0X2m8mEmzsP5JAHacdOZReXSV7nz1gEcw_NI0hCAqiETyhpM6_Z1vyQXZRJAOqZKosZDQdeJKmrpMFLAJjPnEWwsOl5ueMs9zw6-CdQgm-HptlsqiewTivx5k0Pm3zvutsdf0fMcsvDIiuF-Lv5mV9J997-y8HalABSAw1aiiQ6u1cxgVtfpz2omIxdq7xo9n_xFK-Gij4tRRhq_WfHc8d1cq5Fj_2FsfmO3Z8T4-q-Ksz3ZU1wLczxPp5SMU8QqxQx- -rR9x7DC_uzZplrwS6hnVchNHg9aSMVm3bmaPZmgy7P7VM3artN17I-gH3SDOnTNqzgkp7hrGo-lP8jTk7hrIqRz-Wd3rou9WBqokfi_LJy-1I0FHvOnouB8haXlupdob7OFrLPyquF4WcILBQUhCP9ecLg2wQ7GUhsZaN0HUBXjLO19KxoQNRK_99fkISfjTAMWagwyl3yHmSZAVfbR5VtHC75p6qwa6KrcsdUhkOYoipp-lEAcP6Xgce9PtXnwGN1R5XAgZJJaMB7V1M62dgiLzuY9LSyu1iIklCs6Boi0fDTryO5SN8M-F5suo-7ktPLfxoBw6_0G00]--></g></svg>