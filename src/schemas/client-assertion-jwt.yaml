# Schema for the Client Assertion JWT (RFC 7523) object with TPM Attestation. Issuer is a ZETA Client.
$schema: "http://json-schema.org/draft-07/schema#"
client_assertion_jwt:
  type: object
  properties:
    nonce:
      type: string
      description: A **unique value** to prevent replay attacks.
    sub:
      type: string
      description: The **client_id** of the OAuth Client (Subject Claim according to RFC 7523).
    product_id:
      type: string
      description: The **product identifier** (according to).
    posture:
      description: The posture of the client instance
      $ref: "./posture.yaml"
    attestation:
      description: The attestation information of the client instance
      $ref: "./attestation-info.yaml"
  required:
    - nonce
    - sub
    - product_id
    - posture
    - attestation